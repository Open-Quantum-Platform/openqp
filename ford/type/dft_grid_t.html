<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="">
    <meta name="author" content="OpenQP Team" >
    <link rel="icon" href="../favicon.png">

    <title>dft_grid_t &ndash; OPENQP </title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">OPENQP <small>v1.0-dev</small></a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">OPENQP</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>dft_grid_t
      <small>Derived Type</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title="<p> 3.8% of total for derived types.</p>Including implementation: 381 statements,  5.4% of total for derived types.">37 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dft_molgrid.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/dft_molgrid.f90.html'>dft_molgrid.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/mod_dft_molgrid.html'>mod_dft_molgrid</a></li>
            <li class="breadcrumb-item active" aria-current="page">dft_grid_t</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-nslices">nSlices</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-maxslices">maxSlices</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-maxatompts">maxAtomPts</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-maxslicepts">maxSlicePts</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-maxnradtimesnang">maxNRadTimesNAng</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-nmolpts~2">nMolPts</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-spherical_grids">spherical_grids</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-idang">idAng</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-iangstart">iAngStart</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-nangpts">nAngPts</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-iradstart">iRadStart</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-nradpts">nRadPts</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-ntotpts">nTotPts</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-idorigin">idOrigin</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-chunktype">chunkType</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-wtstart">wtStart</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-isinner">isInner</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-ratm">rAtm</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-rinner">rInner</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-dummyatom~2">dummyAtom</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-rad_pts">rad_pts</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-rad_wts">rad_wts</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#variable-totwts">totWts</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#boundprocs-0"
         aria-expanded="false" aria-controls="boundprocs-0">
         <h4 class="card-header bg-primary text-white">Type-Bound Procedures</h4>
      </a>
      <div id="boundprocs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-getslicedata">getSliceData</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-getslicenonzero">getSliceNonZero</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-exportgrid">exportGrid</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-setslice">setSlice</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-reset">reset</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-compress">compress</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-extend">extend</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-add_atomic_grid">add_atomic_grid</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-add_slices">add_slices</a>
            <a class="list-group-item" href="../type/dft_grid_t.html#boundprocedure-find_neighbours">find_neighbours</a>
        </div>
      </div>
    </div>

  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../type/dft_grid_t.html#src">dft_grid_t</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2 id="type-def-statement">
        type, public :: dft_grid_t</h2>
    <p>@brief Type to store molecular grid information</p>
<br>      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Inherits</h3>
        </div>
        <div class="card-body">
          <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: type~~dft_grid_t~~InheritsGraph Pages: 1 -->
<svg id="typedft_grid_tInheritsGraph" width="614pt" height="32pt"
 viewBox="0.00 0.00 614.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="type~~dft_grid_t~~InheritsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>type~~dft_grid_t~~InheritsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 610,-28 610,4 -4,4"/>
<!-- type~dft_grid_t -->
<g id="type~~dft_grid_t~~InheritsGraph_node1" class="node">
<title>type~dft_grid_t</title>
<polygon fill="none" stroke="#000000" points="606,-24 544,-24 544,0 606,0 606,-24"/>
<text text-anchor="middle" x="575" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">dft_grid_t</text>
</g>
<!-- type~sorted_grid_t -->
<g id="type~~dft_grid_t~~InheritsGraph_node2" class="node">
<title>type~sorted_grid_t</title>
<g id="a_type~~dft_grid_t~~InheritsGraph_node2"><a xlink:href="../type/sorted_grid_t.html" xlink:title="sorted_grid_t">
<polygon fill="#5cb85c" stroke="#5cb85c" points="434,-24 352,-24 352,0 434,0 434,-24"/>
<text text-anchor="middle" x="393" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sorted_grid_t</text>
</a>
</g>
</g>
<!-- type~dft_grid_t&#45;&gt;type~sorted_grid_t -->
<g id="type~~dft_grid_t~~InheritsGraph_edge1" class="edge">
<title>type~dft_grid_t&#45;&gt;type~sorted_grid_t</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.7131,-12C516.3839,-12 476.1902,-12 444.1827,-12"/>
<polygon fill="#000000" stroke="#000000" points="444.105,-8.5001 434.105,-12 444.105,-15.5001 444.105,-8.5001"/>
<text text-anchor="middle" x="489" y="-14.4" font-family="Helvetica,sans-Serif" font-size="9.50" fill="#000000">spherical_grids</text>
</g>
<!-- type~list_grid_3d_t -->
<g id="type~~dft_grid_t~~InheritsGraph_node3" class="node">
<title>type~list_grid_3d_t</title>
<g id="a_type~~dft_grid_t~~InheritsGraph_node3"><a xlink:href="../type/list_grid_3d_t.html" xlink:title="list_grid_3d_t">
<polygon fill="#5cb85c" stroke="#5cb85c" points="315,-24 233,-24 233,0 315,0 315,-24"/>
<text text-anchor="middle" x="274" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">list_grid_3d_t</text>
</a>
</g>
</g>
<!-- type~sorted_grid_t&#45;&gt;type~list_grid_3d_t -->
<g id="type~~dft_grid_t~~InheritsGraph_edge2" class="edge">
<title>type~sorted_grid_t&#45;&gt;type~list_grid_3d_t</title>
<path fill="none" stroke="#000000" d="M351.7135,-12C343.2217,-12 334.1821,-12 325.3838,-12"/>
<polygon fill="#000000" stroke="#000000" points="325.2135,-8.5001 315.2135,-12 325.2134,-15.5001 325.2135,-8.5001"/>
</g>
<!-- type~grid_3d_pt -->
<g id="type~~dft_grid_t~~InheritsGraph_node4" class="node">
<title>type~grid_3d_pt</title>
<g id="a_type~~dft_grid_t~~InheritsGraph_node4"><a xlink:href="../type/grid_3d_pt.html" xlink:title="grid_3d_pt">
<polygon fill="#5cb85c" stroke="#5cb85c" points="172,-24 104,-24 104,0 172,0 172,-24"/>
<text text-anchor="middle" x="138" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_3d_pt</text>
</a>
</g>
</g>
<!-- type~list_grid_3d_t&#45;&gt;type~grid_3d_pt -->
<g id="type~~dft_grid_t~~InheritsGraph_edge3" class="edge">
<title>type~list_grid_3d_t&#45;&gt;type~grid_3d_pt</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232.8264,-12C216.9216,-12 198.685,-12 182.4806,-12"/>
<polygon fill="#000000" stroke="#000000" points="182.1704,-8.5001 172.1704,-12 182.1704,-15.5001 182.1704,-8.5001"/>
<text text-anchor="middle" x="202.5" y="-14.4" font-family="Helvetica,sans-Serif" font-size="9.50" fill="#000000">elem</text>
</g>
<!-- type~grid_3d_t -->
<g id="type~~dft_grid_t~~InheritsGraph_node5" class="node">
<title>type~grid_3d_t</title>
<g id="a_type~~dft_grid_t~~InheritsGraph_node5"><a xlink:href="../type/grid_3d_t.html" xlink:title="grid_3d_t">
<polygon fill="#5cb85c" stroke="#5cb85c" points="61,-24 0,-24 0,0 61,0 61,-24"/>
<text text-anchor="middle" x="30.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_3d_t</text>
</a>
</g>
</g>
<!-- type~grid_3d_pt&#45;&gt;type~grid_3d_t -->
<g id="type~~dft_grid_t~~InheritsGraph_edge4" class="edge">
<title>type~grid_3d_pt&#45;&gt;type~grid_3d_t</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M103.9863,-12C93.5447,-12 81.9491,-12 71.1124,-12"/>
<polygon fill="#000000" stroke="#000000" points="71.0177,-8.5001 61.0176,-12 71.0176,-15.5001 71.0177,-8.5001"/>
<text text-anchor="middle" x="82.5" y="-14.4" font-family="Helvetica,sans-Serif" font-size="9.50" fill="#000000">p</text>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#InheritsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="InheritsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="184pt" height="32pt"
 viewBox="0.00 0.00 184.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 180,-28 180,4 -4,4"/>
<!-- Type -->
<g id="node1" class="node">
<title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Type</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="176,-24 72,-24 72,0 176,0 176,-24"/>
<text text-anchor="middle" x="124" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a derived type to the parent type which it
extends. Dashed arrows point from a derived type to the other
types it contains as a components, with a label listing the name(s) of
said component(s).
</p>
 </div>
            </div>
          </div>
        </div>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Inherited by</h3>
        </div>
        <div class="card-body">
          <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: type~~dft_grid_t~~InheritedByGraph Pages: 1 -->
<svg id="typedft_grid_tInheritedByGraph" width="224pt" height="32pt"
 viewBox="0.00 0.00 224.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="type~~dft_grid_t~~InheritedByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>type~~dft_grid_t~~InheritedByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 220,-28 220,4 -4,4"/>
<!-- type~dft_grid_t -->
<g id="type~~dft_grid_t~~InheritedByGraph_node1" class="node">
<title>type~dft_grid_t</title>
<polygon fill="none" stroke="#000000" points="62,-24 0,-24 0,0 62,0 62,-24"/>
<text text-anchor="middle" x="31" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">dft_grid_t</text>
</g>
<!-- type~xc_options_t -->
<g id="type~~dft_grid_t~~InheritedByGraph_node2" class="node">
<title>type~xc_options_t</title>
<g id="a_type~~dft_grid_t~~InheritedByGraph_node2"><a xlink:href="../type/xc_options_t.html" xlink:title="xc_options_t">
<polygon fill="#5cb85c" stroke="#5cb85c" points="216,-24 138,-24 138,0 216,0 216,-24"/>
<text text-anchor="middle" x="177" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">xc_options_t</text>
</a>
</g>
</g>
<!-- type~xc_options_t&#45;&gt;type~dft_grid_t -->
<g id="type~~dft_grid_t~~InheritedByGraph_edge1" class="edge">
<title>type~xc_options_t&#45;&gt;type~dft_grid_t</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M137.8747,-12C117.6423,-12 92.9491,-12 72.3973,-12"/>
<polygon fill="#000000" stroke="#000000" points="72.3767,-8.5001 62.3767,-12 72.3767,-15.5001 72.3767,-8.5001"/>
<text text-anchor="middle" x="100" y="-14.4" font-family="Helvetica,sans-Serif" font-size="9.50" fill="#000000">molGrid</text>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#InheritedByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="InheritedByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="184pt" height="32pt"
 viewBox="0.00 0.00 184.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 180,-28 180,4 -4,4"/>
<!-- Type -->
<g id="node1" class="node">
<title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Type</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="176,-24 72,-24 72,0 176,0 176,-24"/>
<text text-anchor="middle" x="124" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a derived type to the parent type which it
extends. Dashed arrows point from a derived type to the other
types it contains as a components, with a label listing the name(s) of
said component(s).
</p>
 </div>
            </div>
          </div>
        </div>
        </div>
      </div>
    <br>

    <section>
    <h2>Components</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-nslices"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nSlices</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxslices"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxSlices</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxatompts"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxAtomPts</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxslicepts"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxSlicePts</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxnradtimesnang"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxNRadTimesNAng</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nmolpts~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nMolPts</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-spherical_grids"></span>
              type(<a href='sorted_grid_t.html'>sorted_grid_t</a>),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>spherical_grids</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idang"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>idAng</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iangstart"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>iAngStart</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nangpts"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nAngPts</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iradstart"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>iRadStart</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nradpts"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nRadPts</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ntotpts"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nTotPts</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idorigin"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>idOrigin</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-chunktype"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>chunkType</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wtstart"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wtStart</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isinner"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>isInner</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ratm"></span>
              real(kind=fp),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>rAtm</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rinner"></span>
              real(kind=fp),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>rInner</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dummyatom~2"></span>
              logical,
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dummyAtom</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rad_pts"></span>
              real(kind=fp),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>rad_pts</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rad_wts"></span>
              real(kind=fp),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>rad_wts</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-totwts"></span>
              real(kind=fp),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>totWts</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    


      <section>
        <h2>Type-Bound Procedures</h2>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-getslicedata"></span>
      <h3>
          procedure, public, pass ::
  <strong>getSliceData</strong>
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine getSliceData(grid, iSlice, xyzw)  
</h3>

  <p>@brief Get coordinates and weight for quadrature points, which
  belong to a slice
@param[in]     iSlice    index of a slice
@param[out]    xyzw      coordinates and weights
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iSlice</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              contiguous
            </td>
            <td>::</td>
            <td><strong>xyzw</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-getslicenonzero"></span>
      <h3>
          procedure, public, pass ::
  <strong>getSliceNonZero</strong>
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine getSliceNonZero(grid, cutoff, iSlice, xyzw, nPt)  
</h3>

  <p>@brief Get grid points from a slice, which weights are larger
 than a cutoff.
@param[in]    cutoff    cutoff to skip small weights
@param[in]    iSlice    index of current slice
@param[out]   xyzw      coordinates and weights of grid points
@param[out]   nPt       number of nonzero point for slice
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>cutoff</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iSlice</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              contiguous
            </td>
            <td>::</td>
            <td><strong>xyzw</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nPt</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-exportgrid"></span>
      <h3>
          procedure, public, pass ::
  <strong>exportGrid</strong>
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine exportGrid(grid, xyz, w, kcp, c, npts, cutoff)  
</h3>

  <p>@brief Export grid for use in legacy TD-DFT code
@param[out]   xyz       coordinates of grid points
@param[out]   w         weights of grid points
@param[out]   kcp       atoms, which the points belongs to
@param[out]   npts      number of nonzero point
@param[in]    cutoff    cutoff to skip small weights
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>xyz</strong>(3,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>w</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>kcp</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>c</strong>(3,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>npts</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>cutoff</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-setslice"></span>
      <h3>
          procedure, public, pass ::
  <strong>setSlice</strong>
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine setSlice(grid, iSlice, iRadStart, nRadPts, idAng, iAngStart, nAngPts, wtStart, idAtm, rAtm, chunkType)  
</h3>

  <p>@brief Set slice data
@param[in]    iSlice     index of current slice
@param[in]    iRadStart  index of the first point in radial grid array
@param[in]    nRadPts    number of radial grid points
@param[in]    idAng      index of angular grid
@param[in]    idAngStart index of the first point in angular grid array
@param[in]    nAngPts    number of angular grid points
@param[in]    wtStart    index of the first point in weights array
@param[in]    idAtm      index of atom which owns the slice
@param[in]    rAtm       effective radius of current atom
@param[in]    chunkType  type of chunk -- used for different processing
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iSlice</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iRadStart</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nRadPts</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>idAng</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iAngStart</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nAngPts</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>wtStart</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>idAtm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rAtm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>chunkType</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-reset"></span>
      <h3>
          procedure, public, pass ::
  <strong>reset</strong> => reset_dft_grid_t
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine reset_dft_grid_t(grid, nAt, maxPtPerAt, nRad)  
</h3>

  <p>@brief Clean up <code>grid</code> dataset and reallocate arrays if needed
@param[in]   maxSlices   guess for maximum number of slices
@param[in]   nAt         number of atoms in a system
@param[in]   maxPtPerAt  maximum number of points per atom
@param[in]   nRad        size of the radial grid
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nAt</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxPtPerAt</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nRad</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-compress"></span>
      <h3>
          procedure, public, pass ::
  <strong>compress</strong> => compress_dft_grid_t
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine compress_dft_grid_t(grid)  
</h3>

  <p>@brief Compress the grid for eaach atom</p>
<div class="alert alert-info">
<p class="alert-title h4">Note</p>
<p>This is a very basic implementation and it will be changed in future
@author Vladimir Mironov</p>
</div>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-extend"></span>
      <h3>
          procedure, public, pass ::
  <strong>extend</strong> => extend_dft_grid_t
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine extend_dft_grid_t(grid)  
</h3>

  <p>@brief Extend arrays in molecular grid type
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-add_atomic_grid"></span>
      <h3>
          procedure, public, pass ::
  <strong>add_atomic_grid</strong>
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine add_atomic_grid(grid, atomic_grid)  
</h3>

  <p>@brief Split atomic 3D grid on spacially localized clusters ("slices")
 and appended the data to <code>grid</code> dataset
@details First, decompose atomic grid on layers, depending on the pruning
 scheme and the distance from the nuclei. It is done in this procedure.
 Then, split layers on slices and append their data to the <code>grid</code>
 dataset. It is done by calling subroutine <code>addSlices</code>.
@param[in]   idAtm       index of current atom
@param[in]   nGrids      number of grids in pruning scheme
@param[in]   rAtm        effective radius of current atom
@param[in]   pruneRads   radii of the pruning scheme
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              type(<a href='atomic_grid_t.html'>atomic_grid_t</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>atomic_grid</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-add_slices"></span>
      <h3>
          procedure, public, pass ::
  <strong>add_slices</strong>
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine add_slices(grid, idAtm, layers, nLayers, rAtm)  
</h3>

  <p>@brief Append slice data of an atom to <code>grid</code> arrays
@param[in]   idAtom      index of current atom
@param[in]   layers      meta-data for atom grid layers: radial grid, angular grid, and angular grid separation depth
@param[in]   nLayers     number of atom grid layers
@param[in]   rAtm        effective radius of current atom
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>idAtm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layers</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nLayers</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rAtm</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-find_neighbours"></span>
      <h3>
          procedure, public, pass ::
  <strong>find_neighbours</strong>
        
      </h3>
    </div>
    <ul class="list-group">
        <li class="list-group-item">
                  <h3>
    private  subroutine find_neighbours(grid, rij, partFunType)  
</h3>

  <p>@brief Find nearest neghbours of every atom and the corresponding distance
 The results are stored into <code>grid</code> dataset
@details This is needed for screening inner points in SSF variant of
 Becke's fuzzy cell method
@param[in]    rij       array of interatomic distances
@param[in]    nAt       number of atoms
@author Vladimir Mironov</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='dft_grid_t.html'>dft_grid_t</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>grid</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=fp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rij</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>partFunType</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>


        </li>
    </ul>
  </div>

          </div>
      </section>

    <section>
    <h3><span class="anchor" id="src"></span>Source Code</h3>
    <div class="hl codehilite"><pre><span></span><span class="w">  </span><span class="k">type</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dft_grid_t</span>
<span class="w">    </span><span class="c">!&lt; current number of slices</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nSlices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="c">!&lt; maximum number of slices</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxSlices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="c">!&lt; maximum number of grid points per atom</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxAtomPts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="c">!&lt; maximum number of nonzero grid points per slice</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxSlicePts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="c">!&lt; maximum possible number of grid points per slice</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxNRadTimesNAng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="c">!&lt; total number of nonzero grid points</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nMolPts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="c">!&lt; spherical atomic grids used in this molecular grid</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">sorted_grid_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">spherical_grids</span>

<span class="w">    </span><span class="c">! Every slice is a spacially localized subgrid of molecular grid:</span>
<span class="w">    </span><span class="c">! slice = (few radial points)x(few angular points)</span>
<span class="w">    </span><span class="c">! The following arrays contains data for each slice</span>

<span class="w">    </span><span class="c">!&lt; index of angular grid</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">idAng</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; index of the first point in angular grid array</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iAngStart</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; number of angular grid points</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nAngPts</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; index of the first point in radial grid array</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iRadStart</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; number of radial grid points</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nRadPts</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; number of grid points with nonzero weight</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nTotPts</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; index of atom which owns the slice</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">idOrigin</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; type of chunk -- used for different processing</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">chunkType</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; index of the first point in weights array</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wtStart</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; isInner == 1 means that the slice is &#39;inner&#39; -- i.e. its weight is not modified and is equal to wtRad*wtAng</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">isInner</span><span class="p">(:)</span>

<span class="w">    </span><span class="c">! The following arrays contains information about atoms</span>
<span class="w">    </span><span class="c">!&lt; effective radii of atoms</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">fp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rAtm</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; max radii for &#39;inner&#39; points</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">fp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rInner</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; .TRUE. for dummy atoms</span>
<span class="w">    </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dummyAtom</span><span class="p">(:)</span>

<span class="w">    </span><span class="c">! The following arrays contains information about the radial grid</span>
<span class="w">    </span><span class="c">!&lt; Radial grid points</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">fp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rad_pts</span><span class="p">(:)</span>
<span class="w">    </span><span class="c">!&lt; Radial grid weights</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">fp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rad_wts</span><span class="p">(:)</span>

<span class="w">    </span><span class="c">!&lt; array to store grid point weights</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">fp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">totWts</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">    </span><span class="c">!&lt; number of nonzero grid points per atom</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wt_top</span><span class="p">(:)</span>

<span class="w">  </span><span class="k">contains</span>
<span class="k">    procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">getSliceData</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getSliceData</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">getSliceNonZero</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getSliceNonZero</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">exportGrid</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">exportGrid</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">setSlice</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">setSlice</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">reset_dft_grid_t</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">compress_dft_grid_t</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">extend</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">extend_dft_grid_t</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">add_atomic_grid</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">add_atomic_grid</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">add_slices</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">add_slices</span>
<span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">find_neighbours</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">find_neighbours</span>
<span class="w">  </span><span class="k">end type </span><span class="n">dft_grid_t</span>
</pre></div>

    </section>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              OPENQP
 was developed by OpenQP Team<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </body>
</html>