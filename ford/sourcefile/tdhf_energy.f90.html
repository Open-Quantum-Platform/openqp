<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="">
    <meta name="author" content="OpenQP Team" >
    <link rel="icon" href="../favicon.png">

    <title>tdhf_energy.F90 &ndash; OPENQP</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">OPENQP <small>v1.0-dev</small></a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">OPENQP</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tdhf_energy.F90
      <small>Source File</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.6% of total for source files.">260 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tdhf_energy.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
            <li class="breadcrumb-item active" aria-current="page">tdhf_energy.F90</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#mods-0"
         aria-expanded="false" aria-controls="mods-0">
         <h4 class="card-header bg-primary text-white">Modules</h4>
      </a>
      <div id="mods-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tdhf_energy_mod.html">tdhf_energy_mod</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/tdhf_energy.f90.html#src">tdhf_energy.F90</a>
      </div>
    </div>


  </div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">This file depends on</h3>
          </div>
          <div class="card-body">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: sourcefile~~tdhf_energy.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefiletdhf_energyf90EfferentGraph" width="641pt" height="1231pt"
 viewBox="0.00 0.00 641.00 1230.94" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph" class="graph" transform="scale(.4745 .4745) rotate(0) translate(4 2590.3795)">
<title>sourcefile~~tdhf_energy.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2590.3795 1347,-2590.3795 1347,4 -4,4"/>
<!-- sourcefile~tdhf_energy.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~tdhf_energy.f90</title>
<polygon fill="none" stroke="#000000" points="1343,-980.2562 1246,-980.2562 1246,-956.2562 1343,-956.2562 1343,-980.2562"/>
<text text-anchor="middle" x="1294.5" y="-965.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">tdhf_energy.F90</text>
</g>
<!-- sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~basis_tools.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/basis_tools.f90.html" xlink:title="basis_tools.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="604.5,-1156.2562 511.5,-1156.2562 511.5,-1132.2562 604.5,-1132.2562 604.5,-1156.2562"/>
<text text-anchor="middle" x="558" y="-1141.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_tools.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1293.4827,-956.1511C1289.0012,-911.0901 1266.8317,-751.8891 1173,-678.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-678.2562C978.375,-525.5276 820.4,-339.855 642,-511.2562 593.2797,-558.0652 642.2773,-1061.2587 606,-1118.2562 604.168,-1121.1345 601.9021,-1123.7174 599.3605,-1126.0312"/>
<polygon fill="#000000" stroke="#000000" points="597.008,-1123.4186 591.0668,-1132.1909 601.1817,-1129.0383 597.008,-1123.4186"/>
</g>
<!-- sourcefile~c_interop.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~c_interop.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/c_interop.f90.html" xlink:title="c_interop.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="908.5,-650.2562 823.5,-650.2562 823.5,-626.2562 908.5,-626.2562 908.5,-650.2562"/>
<text text-anchor="middle" x="866" y="-635.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">c_interop.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~c_interop.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~c_interop.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-678.2562C1124.8298,-640.2903 1096.2904,-675.9626 1035,-678.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-678.2562C989.4781,-679.9598 938.8237,-665.7201 904.9508,-653.7625"/>
<polygon fill="#000000" stroke="#000000" points="906.0255,-650.4292 895.4314,-650.3056 903.6362,-657.0088 906.0255,-650.4292"/>
</g>
<!-- sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~constants_io.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/constants_io.f90.html" xlink:title="constants_io.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="118,-808.2562 17,-808.2562 17,-784.2562 118,-784.2562 118,-808.2562"/>
<text text-anchor="middle" x="67.5" y="-793.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants_io.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-64.2562C392.2292,-65.3329 257.664,-90.9797 242,-102.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-102.2562C121.8391,-188.7602 163.193,-652.9668 135,-719.2562 125.224,-742.2423 105.8452,-763.1921 90.3497,-777.4164"/>
<polygon fill="#000000" stroke="#000000" points="87.8371,-774.9663 82.672,-784.2169 92.4785,-780.2064 87.8371,-774.9663"/>
</g>
<!-- sourcefile~dft.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~dft.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/dft.f90.html" xlink:title="dft.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1200,-980.2562 1146,-980.2562 1146,-956.2562 1200,-956.2562 1200,-980.2562"/>
<text text-anchor="middle" x="1173" y="-965.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~dft.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~dft.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1245.7814,-968.2562C1233.9741,-968.2562 1221.5352,-968.2562 1210.3466,-968.2562"/>
<polygon fill="#000000" stroke="#000000" points="1210.0639,-964.7563 1200.0638,-968.2562 1210.0638,-971.7563 1210.0639,-964.7563"/>
</g>
<!-- sourcefile~dft_gridint_fxc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~dft_gridint_fxc.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/dft_gridint_fxc.f90.html" xlink:title="dft_gridint_fxc.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1090,-768.2562 980,-768.2562 980,-744.2562 1090,-744.2562 1090,-768.2562"/>
<text text-anchor="middle" x="1035" y="-753.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_gridint_fxc.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~dft_gridint_fxc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~dft_gridint_fxc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-678.2562C1141.7149,-653.5984 1134.963,-711.1681 1100,-730.2562 1093.3993,-733.8599 1086.1922,-737.2404 1079.0574,-740.2951"/>
<polygon fill="#000000" stroke="#000000" points="1077.3555,-737.2105 1069.4367,-744.2491 1080.0165,-743.685 1077.3555,-737.2105"/>
</g>
<!-- sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dft_molgrid.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dft_molgrid.f90.html" xlink:title="dft_molgrid.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="606,-1456.2562 510,-1456.2562 510,-1432.2562 606,-1432.2562 606,-1456.2562"/>
<text text-anchor="middle" x="558" y="-1441.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_molgrid.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-2445.2562C940.7222,-2490.2922 806.5174,-2577.3011 642,-2407.2562 569.5551,-2332.3773 661.0239,-1558.7293 606,-1470.2562 604.1981,-1467.359 601.9538,-1464.7625 599.4271,-1462.4393"/>
<polygon fill="#000000" stroke="#000000" points="601.266,-1459.4442 591.16,-1456.2629 597.0763,-1465.052 601.266,-1459.4442"/>
</g>
<!-- sourcefile~int1.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~int1.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/int1.f90.html" xlink:title="int1.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1062.5,-2398.2562 1007.5,-2398.2562 1007.5,-2374.2562 1062.5,-2374.2562 1062.5,-2398.2562"/>
<text text-anchor="middle" x="1035" y="-2383.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int1.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~int1.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~int1.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-2445.2562C1151.3137,-2449.461 1097.8152,-2422.213 1064.159,-2403.3323"/>
<polygon fill="#000000" stroke="#000000" points="1065.659,-2400.1591 1055.2354,-2398.262 1062.2009,-2406.2453 1065.659,-2400.1591"/>
</g>
<!-- sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~int2.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/int2.f90.html" xlink:title="int2.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1062.5,-1691.2562 1007.5,-1691.2562 1007.5,-1667.2562 1062.5,-1667.2562 1062.5,-1691.2562"/>
<text text-anchor="middle" x="1035" y="-1676.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~int2.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1294.1481,-980.453C1290.015,-1121.0643 1249.4862,-2430.4264 1173,-2445.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-2445.2562C1096.7037,-2460.0492 1046.089,-1829.6424 1036.6138,-1701.7181"/>
<polygon fill="#000000" stroke="#000000" points="1040.0896,-1701.2578 1035.8688,-1691.5401 1033.1083,-1701.769 1040.0896,-1701.2578"/>
</g>
<!-- sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~mathlib.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/mathlib.f90.html" xlink:title="mathlib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="904,-418.2562 828,-418.2562 828,-394.2562 904,-394.2562 904,-418.2562"/>
<text text-anchor="middle" x="866" y="-403.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mathlib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-678.2562C1059.8944,-589.1105 933.8957,-471.0586 885.9652,-425.4091"/>
<polygon fill="#000000" stroke="#000000" points="888.3521,-422.8489 878.7018,-418.4758 883.5187,-427.9124 888.3521,-422.8489"/>
</g>
<!-- sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~messages.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/messages.f90.html" xlink:title="messages.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="286,-668.2562 198,-668.2562 198,-644.2562 286,-644.2562 286,-668.2562"/>
<text text-anchor="middle" x="242" y="-653.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">messages.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-82.2562C1122.5495,-55.951 1133.6049,-162.5351 1100,-192.2562 1090.1538,-200.9645 654.2508,-306.4919 642,-311.2562 580.11,-335.3251 554.3754,-331.8548 510,-381.2562 481.2109,-413.306 499.6958,-436.677 474,-471.2562 417.2781,-547.5877 321.7231,-610.0316 272.8353,-638.9251"/>
<polygon fill="#000000" stroke="#000000" points="270.8604,-636.0251 263.9874,-644.0882 274.3884,-642.071 270.8604,-636.0251"/>
</g>
<!-- sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~physical_constants.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/physical_constants.f90.html" xlink:title="physical_constants.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="135,-353.2562 0,-353.2562 0,-329.2562 135,-329.2562 135,-353.2562"/>
<text text-anchor="middle" x="67.5" y="-338.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">physical_constants.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1294.0178,-956.1787C1289.9596,-856.7738 1260.4099,-175.4523 1210,-101.2562 1199.6113,-85.9656 1189.1683,-91.2181 1173,-82.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-82.2562C1118.7958,-52.2114 1095.5957,-115.2544 1035,-102.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-102.2562C886.5708,-70.4173 853.8056,-26.2562 702,-26.2562 702,-26.2562 702,-26.2562 558,-26.2562 417.5556,-26.2562 369.7043,32.1924 242,-26.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-26.2562C212.036,-40.8058 194.7382,-26.8889 171,-50.2562 93.4054,-126.6384 73.7883,-264.9322 68.993,-318.8664"/>
<polygon fill="#000000" stroke="#000000" points="65.4876,-318.795 68.1791,-329.0422 72.4653,-319.3531 65.4876,-318.795"/>
</g>
<!-- sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~precision.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/precision.f90.html" xlink:title="precision.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="109.5,-1378.2562 25.5,-1378.2562 25.5,-1354.2562 109.5,-1354.2562 109.5,-1378.2562"/>
<text text-anchor="middle" x="67.5" y="-1363.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1294.256,-980.3214C1291.3368,-1122.2344 1262.2798,-2469.4622 1210,-2533.2562 1159.0966,-2595.3708 1114.6078,-2567.6744 1035,-2578.2562"/>
</g>
<!-- sourcefile~printing.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~printing.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/printing.f90.html" xlink:title="printing.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="904,-768.2562 828,-768.2562 828,-744.2562 904,-744.2562 904,-768.2562"/>
<text text-anchor="middle" x="866" y="-753.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">printing.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~printing.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~printing.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-678.2562C978.6228,-680.366 920.541,-715.8753 889.3001,-738.2475"/>
<polygon fill="#000000" stroke="#000000" points="887.2179,-735.4342 881.224,-744.1706 891.3577,-741.0788 887.2179,-735.4342"/>
</g>
<!-- sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~strings.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/strings.f90.html" xlink:title="strings.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="102.5,-710.2562 32.5,-710.2562 32.5,-686.2562 102.5,-686.2562 102.5,-710.2562"/>
<text text-anchor="middle" x="67.5" y="-695.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">strings.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-82.2562C1141.3601,-65.5259 1134.9443,-108.5176 1100,-116.2562 1043.5889,-128.7488 1027.7155,-118.9373 970,-116.2562 720.9727,-104.6882 660.4076,-50.3492 411.5,-64.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-64.2562C336.2701,-68.202 306.7443,-25.7427 242,-64.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-64.2562C213.3725,-81.2855 192.1445,-62.5183 171,-88.2562 132.0164,-135.7086 145.0535,-301.6725 135,-362.2562 115.2258,-481.4173 84.3647,-622.8887 72.4367,-676.3468"/>
<polygon fill="#000000" stroke="#000000" points="69.0211,-675.583 70.2508,-686.1062 75.8519,-677.113 69.0211,-675.583"/>
</g>
<!-- sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~tagarray_driver.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/tagarray_driver.f90.html" xlink:title="tagarray_driver.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="760.5,-690.2562 643.5,-690.2562 643.5,-666.2562 760.5,-666.2562 760.5,-690.2562"/>
<text text-anchor="middle" x="702" y="-675.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tagarray_driver.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-678.2562C959.9414,-681.0651 940.9935,-682.4586 866,-678.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-678.2562C834.849,-676.5106 800.3174,-676.2594 771.0069,-676.5431"/>
<polygon fill="#000000" stroke="#000000" points="770.8287,-673.0449 760.8713,-676.6642 770.9124,-680.0444 770.8287,-673.0449"/>
</g>
<!-- sourcefile~tdhf_lib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~tdhf_lib.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/tdhf_lib.f90.html" xlink:title="tdhf_lib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1210,-134.2562 1136,-134.2562 1136,-110.2562 1210,-110.2562 1210,-134.2562"/>
<text text-anchor="middle" x="1173" y="-119.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tdhf_lib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~tdhf_lib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~tdhf_lib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1292.7356,-955.9708C1279.3502,-862.7689 1193.8519,-267.4476 1176.1896,-144.4656"/>
<polygon fill="#000000" stroke="#000000" points="1179.6242,-143.7592 1174.7381,-134.3583 1172.6953,-144.7544 1179.6242,-143.7592"/>
</g>
<!-- sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~types.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/types.f90.html" xlink:title="types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="734,-884.2562 670,-884.2562 670,-860.2562 734,-860.2562 734,-884.2562"/>
<text text-anchor="middle" x="702" y="-869.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1173,-678.2562C1130.16,-644.2949 1138.7393,-738.6828 1100,-777.2562 1054.3612,-822.6996 918.0994,-986.1199 866,-948.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-948.2562C840.1102,-929.365 826.3922,-939.1238 798,-924.2562 780.5156,-915.1005 779.1552,-908.0149 762,-898.2562 755.9668,-894.8242 749.393,-891.5485 742.881,-888.5502"/>
<polygon fill="#000000" stroke="#000000" points="744.0148,-885.2244 733.4545,-884.37 741.177,-891.6234 744.0148,-885.2244"/>
</g>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~util.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/util.f90.html" xlink:title="util.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1200,-2524.2562 1146,-2524.2562 1146,-2500.2562 1200,-2500.2562 1200,-2524.2562"/>
<text text-anchor="middle" x="1173" y="-2509.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">util.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~tdhf_energy.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1294.21,-980.6407C1290.9958,-1115.6172 1261.1731,-2311.3231 1210,-2459.2562 1205.8992,-2471.1108 1198.3253,-2482.7179 1191.093,-2492.0333"/>
<polygon fill="#000000" stroke="#000000" points="1188.2892,-2489.9328 1184.6567,-2499.8855 1193.7029,-2494.3704 1188.2892,-2489.9328"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M531.4215,-1132.2259C524.109,-1128.3025 516.4283,-1123.5698 510,-1118.2562 490.5249,-1102.1583 493.3957,-1090.4497 474,-1074.2562 355.7995,-975.5706 292.5452,-1000.7919 171,-906.2562 135.9748,-879.0143 102.0309,-839.7239 83.0425,-816.2163"/>
<polygon fill="#000000" stroke="#000000" points="85.7193,-813.9593 76.7491,-808.3213 80.2456,-818.3226 85.7193,-813.9593"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M526.0927,-1132.026C519.9927,-1128.4072 514.2071,-1123.8674 510,-1118.2562 464.4531,-1057.5074 525.4205,-1007.121 474,-951.2562 454.3379,-929.8947 427.7892,-956.289 411.5,-932.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-932.2562C395.2108,-908.2234 368.0022,-935.2069 349,-913.2562 279.5558,-833.0366 382.7464,-757.2132 313,-677.2562 308.3447,-671.9194 302.4048,-667.9071 295.9487,-664.8962"/>
<polygon fill="#000000" stroke="#000000" points="296.8004,-661.4745 286.2101,-661.1641 294.2954,-668.0109 296.8004,-661.4745"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M511.3082,-1149.4407C457.922,-1156.1218 374.5982,-1169.0792 349,-1187.2562 273.429,-1240.9185 334.4989,-1360.3764 242,-1366.2562"/>
</g>
<!-- sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~atomic_structure.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/atomic_structure.f90.html" xlink:title="atomic_structure.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="474,-1140.2562 349,-1140.2562 349,-1116.2562 474,-1116.2562 474,-1140.2562"/>
<text text-anchor="middle" x="411.5" y="-1125.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atomic_structure.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M511.2437,-1139.1497C502.5728,-1138.2027 493.3295,-1137.1932 484.1,-1136.1852"/>
<polygon fill="#000000" stroke="#000000" points="484.439,-1132.7015 474.1181,-1135.0951 483.6789,-1139.6601 484.439,-1132.7015"/>
</g>
<!-- sourcefile~basis_library.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~basis_library.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/basis_library.f90.html" xlink:title="basis_library.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="461.5,-984.2562 361.5,-984.2562 361.5,-960.2562 461.5,-960.2562 461.5,-984.2562"/>
<text text-anchor="middle" x="411.5" y="-969.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_library.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~basis_library.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~basis_library.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.4139,-1132.1964C521.748,-1128.4655 515.1349,-1123.8345 510,-1118.2562 483.0437,-1088.9721 496.2637,-1069.249 474,-1036.2562 462.6334,-1019.412 446.559,-1003.0674 433.5584,-991.1119"/>
<polygon fill="#000000" stroke="#000000" points="435.7117,-988.3417 425.9305,-984.2699 431.0377,-993.5526 435.7117,-988.3417"/>
</g>
<!-- sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~constants.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/constants.f90.html" xlink:title="constants.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="285,-1811.2562 199,-1811.2562 199,-1787.2562 285,-1787.2562 285,-1811.2562"/>
<text text-anchor="middle" x="242" y="-1796.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M554.306,-1156.3109C544.9047,-1185.4313 517.6784,-1260.7779 474,-1309.2562 429.6878,-1358.438 383.3064,-1333.6392 349,-1390.2562 304.6989,-1463.3679 365.1928,-1705.5524 313,-1773.2562 308.1537,-1779.5427 301.6356,-1784.31 294.5058,-1787.9251"/>
<polygon fill="#000000" stroke="#000000" points="293.0309,-1784.7494 285.2273,-1791.9156 295.7966,-1791.1799 293.0309,-1784.7494"/>
</g>
<!-- sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~elements.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/elements.f90.html" xlink:title="elements.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="284.5,-710.2562 199.5,-710.2562 199.5,-686.2562 284.5,-686.2562 284.5,-710.2562"/>
<text text-anchor="middle" x="242" y="-695.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">elements.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~elements.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-932.2562C395.2108,-908.2234 368.598,-934.6766 349,-913.2562 296.2799,-855.6338 358.1429,-804.9891 313,-741.2562 305.3102,-730.3997 293.933,-721.7812 282.5281,-715.1986"/>
<polygon fill="#000000" stroke="#000000" points="283.9158,-711.972 273.4455,-710.352 280.6203,-718.1477 283.9158,-711.972"/>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="449.5,-1220.2562 373.5,-1220.2562 373.5,-1196.2562 449.5,-1196.2562 449.5,-1220.2562"/>
<text text-anchor="middle" x="411.5" y="-1205.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M531.9837,-1156.2731C515.4377,-1163.8542 493.5278,-1173.7798 474,-1182.2562 466.4125,-1185.5497 458.2728,-1188.9975 450.4582,-1192.2659"/>
<polygon fill="#000000" stroke="#000000" points="449.0339,-1189.0675 441.1461,-1196.141 451.7234,-1195.5303 449.0339,-1189.0675"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-638.2562C678.0583,-652.7204 659.3926,-635.3492 642,-657.2562 578.1071,-737.7333 661.9819,-1032.0884 606,-1118.2562 604.1412,-1121.1173 601.856,-1123.6878 599.3011,-1125.993"/>
<polygon fill="#000000" stroke="#000000" points="596.9472,-1123.3803 590.9836,-1132.1374 601.1066,-1129.0106 596.9472,-1123.3803"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M823.3823,-626.828C788.2438,-619.9425 738.4333,-616.2453 702,-638.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-638.2562C698.4336,-640.4108 562.155,-679.9449 558,-680.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-680.2562C492.4686,-685.1661 476.7139,-708.3565 411.5,-700.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-700.2562C388.8537,-697.4433 334.4796,-682.7987 293.3767,-671.1662"/>
<polygon fill="#000000" stroke="#000000" points="294.0816,-667.7279 283.5055,-668.3586 292.1665,-674.4609 294.0816,-667.7279"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M855.2732,-626.056C839.914,-607.8626 811.9719,-571.9264 798,-536.2562 761.0644,-441.9601 822.8168,-392.2335 762,-311.2562 640.1002,-148.9473 521.9364,-222.5425 349,-116.2562 303.9536,-88.5708 288.6797,-39.4235 242,-64.2562"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M823.3391,-648.6613C804.4169,-653.2765 781.8322,-658.785 761.3066,-663.7912"/>
<polygon fill="#000000" stroke="#000000" points="760.3067,-660.4324 751.4209,-666.2024 761.9654,-667.233 760.3067,-660.4324"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M857.4136,-650.5076C830.7896,-688.4955 749.4312,-804.58 716.2824,-851.8777"/>
<polygon fill="#000000" stroke="#000000" points="713.3746,-849.9283 710.5014,-860.1261 719.107,-853.9458 713.3746,-849.9283"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1161.3695,-980.4956C1123.4753,-1019.1879 998.3599,-1137.7539 866,-1162.2562"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1171.9136,-956.1308C1165.1495,-888.083 1122.7106,-550.8298 934,-385.2562 871.4455,-330.3712 839.2331,-342.2478 762,-311.2562 580.1902,-238.3009 528.2047,-236.395 349,-157.2562 300.087,-135.6557 287.5298,-74.2187 242,-102.2562"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1172.3479,-980.4343C1167.7445,-1061.2828 1137.2985,-1519.8293 1035,-1602.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-1602.2562C993.9855,-1635.3036 982.9768,-1559.6365 934,-1540.2562 905.3085,-1528.9029 896.1698,-1532.7278 866,-1526.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1526.2562C774.0045,-1506.5226 668.339,-1476.8282 607.7469,-1459.1104"/>
<polygon fill="#000000" stroke="#000000" points="608.6376,-1455.7242 598.0566,-1456.2665 606.6663,-1462.4409 608.6376,-1455.7242"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1170.7764,-956.2222C1162.5925,-913.1539 1132.9092,-767.5385 1100,-735.2562 1078.514,-714.1795 1053.0873,-740.313 1035,-716.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-716.2562C1016.4936,-691.642 989.9599,-715.7072 970,-692.2562 915.9908,-628.8007 965.7272,-585.3081 934,-508.2562 921.2941,-477.3991 898.643,-446.0768 882.9959,-426.4349"/>
<polygon fill="#000000" stroke="#000000" points="885.5876,-424.0744 876.5644,-418.5217 880.1555,-428.4894 885.5876,-424.0744"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1159.2223,-956.2223C1125.7337,-926.7765 1037.8337,-848.3073 970,-777.2562 953.0228,-759.4737 955.6645,-746.8792 934,-735.2562 818.7751,-673.4381 770.8184,-721.7082 642,-699.2562 604.292,-692.684 596.1695,-677.3964 558,-680.2562"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1171.257,-956.1652C1165.734,-917.6715 1148.2637,-794.4989 1136,-692.2562 1126.9516,-616.819 1145.3297,-413.2305 1100,-352.2562 922.6038,-113.6354 757.5867,-205.631 474,-116.2562 418.6193,-98.8025 400.5555,-104.9711 349,-78.2562 331.0029,-68.9305 330.8511,-59.8584 313,-50.2562 283.665,-34.4769 272.3849,-12.6075 242,-26.2562"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-1602.2562C997.8998,-1633.9394 980.8486,-1631.6382 934,-1645.2562 859.172,-1667.0074 304.995,-1805.1253 242,-1759.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-1759.2562C113.6745,-1666.3894 78.1938,-1457.4765 69.8079,-1388.6887"/>
<polygon fill="#000000" stroke="#000000" points="73.2617,-1388.0849 68.6479,-1378.5475 66.3071,-1388.8805 73.2617,-1388.0849"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-716.2562C1016.4936,-691.642 992.7726,-712.9867 970,-692.2562 942.6579,-667.3661 964.4082,-638.2908 934,-617.2562 778.4322,-509.644 697.9303,-601.7955 510,-580.2562 422.1397,-570.1863 401.2152,-558.494 313,-552.2562 250.0461,-547.8047 227.0647,-523.2775 171,-552.2562 119.9723,-578.6314 88.6677,-643.0548 75.2118,-676.8167"/>
<polygon fill="#000000" stroke="#000000" points="71.9132,-675.6437 71.6067,-686.2341 78.4506,-678.1463 71.9132,-675.6437"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-716.2562C1023.4337,-700.8727 885.2165,-679.333 866,-678.2562"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1145.9348,-962.1949C1118.2306,-956.4964 1073.8515,-948.7638 1035,-948.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-948.2562C997.4476,-947.7656 896.38,-970.3351 866,-948.2562"/>
</g>
<!-- sourcefile~bragg_slater.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~bragg_slater.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/bragg_slater.f90.html" xlink:title="bragg_slater.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462,-1536.2562 361,-1536.2562 361,-1512.2562 462,-1512.2562 462,-1536.2562"/>
<text text-anchor="middle" x="411.5" y="-1521.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bragg_slater.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~bragg_slater.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~bragg_slater.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1526.2562C819.9139,-1516.2725 808.653,-1540.3934 762,-1547.2562 671.9105,-1560.5088 648.8284,-1572.733 558,-1566.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1566.2562C547.9757,-1565.89 498.4194,-1551.2194 459.6844,-1539.3201"/>
<polygon fill="#000000" stroke="#000000" points="460.6876,-1535.9669 450.1003,-1536.365 458.625,-1542.6562 460.6876,-1535.9669"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1172.6521,-980.5237C1169.9473,-1071.9502 1151.0164,-1645.0196 1100,-1700.2562 960.0507,-1851.7824 838.3525,-1712.0765 642,-1775.2562 532.6357,-1810.446 525.504,-1906.4674 411.5,-1892.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1892.2562C353.2045,-1881.8659 294.7613,-1841.6318 264.0574,-1817.6198"/>
<polygon fill="#000000" stroke="#000000" points="266.1559,-1814.8166 256.1561,-1811.3157 261.7901,-1820.2883 266.1559,-1814.8166"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~dft_fuzzycell.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/dft_fuzzycell.f90.html" xlink:title="dft_fuzzycell.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="752,-1538.2562 652,-1538.2562 652,-1514.2562 752,-1514.2562 752,-1538.2562"/>
<text text-anchor="middle" x="702" y="-1523.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_fuzzycell.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~dft_fuzzycell.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~dft_fuzzycell.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1526.2562C832.2344,-1519.0133 793.6506,-1518.6336 762.3936,-1520.2395"/>
<polygon fill="#000000" stroke="#000000" points="761.866,-1516.7646 752.0919,-1520.8532 762.2823,-1523.7522 761.866,-1516.7646"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dft_gridint_energy.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/dft_gridint_energy.f90.html" xlink:title="dft_gridint_energy.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1100,-1000.2562 970,-1000.2562 970,-976.2562 1100,-976.2562 1100,-1000.2562"/>
<text text-anchor="middle" x="1035" y="-985.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_gridint_energy.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~dft_gridint_energy.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~dft_gridint_energy.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1145.7356,-972.2076C1135.3849,-973.7077 1123.027,-975.4987 1110.3808,-977.3315"/>
<polygon fill="#000000" stroke="#000000" points="1109.6044,-973.9073 1100.2098,-978.8055 1110.6085,-980.835 1109.6044,-973.9073"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dft_gridint_grad.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dft_gridint_grad.f90.html" xlink:title="dft_gridint_grad.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1094.5,-1214.2562 975.5,-1214.2562 975.5,-1190.2562 1094.5,-1190.2562 1094.5,-1214.2562"/>
<text text-anchor="middle" x="1035" y="-1199.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_gridint_grad.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~dft_gridint_grad.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~dft_gridint_grad.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1172.1611,-980.3686C1169.102,-1015.4335 1155.5947,-1118.2195 1100,-1176.2562 1096.792,-1179.6051 1093.0963,-1182.5334 1089.1295,-1185.0919"/>
<polygon fill="#000000" stroke="#000000" points="1087.1304,-1182.199 1080.0967,-1190.1222 1090.5362,-1188.3146 1087.1304,-1182.199"/>
</g>
<!-- sourcefile~grid_storage.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~grid_storage.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/grid_storage.f90.html" xlink:title="grid_storage.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462.5,-1578.2562 360.5,-1578.2562 360.5,-1554.2562 462.5,-1554.2562 462.5,-1578.2562"/>
<text text-anchor="middle" x="411.5" y="-1563.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_storage.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~grid_storage.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~grid_storage.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1566.2562C530.0641,-1565.2355 499.1116,-1565.0913 472.8823,-1565.259"/>
<polygon fill="#000000" stroke="#000000" points="472.6763,-1561.7605 462.7048,-1565.341 472.7327,-1568.7603 472.6763,-1561.7605"/>
</g>
<!-- sourcefile~libxc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~libxc.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/libxc.f90.html" xlink:title="libxc.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="896,-1000.2562 836,-1000.2562 836,-976.2562 896,-976.2562 896,-1000.2562"/>
<text text-anchor="middle" x="866" y="-985.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libxc.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~libxc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~libxc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-948.2562C989.7245,-947.6647 939.4108,-961.5323 905.5505,-973.0984"/>
<polygon fill="#000000" stroke="#000000" points="904.3024,-969.8271 896.0249,-976.4402 906.6197,-976.4324 904.3024,-969.8271"/>
</g>
<!-- sourcefile~radial_grid_types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~radial_grid_types.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/radial_grid_types.f90.html" xlink:title="radial_grid_types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="305,-1537.2562 179,-1537.2562 179,-1513.2562 305,-1513.2562 305,-1537.2562"/>
<text text-anchor="middle" x="242" y="-1522.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">radial_grid_types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~radial_grid_types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~radial_grid_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-1602.2562C975.629,-1650.0943 420.3471,-1646.1445 349,-1619.2562 310.0178,-1604.5652 276.002,-1568.4984 257.2994,-1545.554"/>
<polygon fill="#000000" stroke="#000000" points="259.8542,-1543.1424 250.9027,-1537.4747 254.3661,-1547.4875 259.8542,-1543.1424"/>
</g>
<!-- sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1030.3704,-768.2668C1019.4041,-796.8555 991.1764,-871.2651 970,-934.2562 952.6632,-985.8259 961.2325,-1004.1564 934,-1051.2562 911.806,-1089.6418 900.2849,-1096.1392 866,-1124.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1124.2562C837.6113,-1147.5378 738.7143,-1144.1443 702,-1144.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1144.2562C673.3087,-1144.3437 641.4017,-1144.3527 614.9285,-1144.3361"/>
<polygon fill="#000000" stroke="#000000" points="614.6962,-1140.836 604.6935,-1144.3282 614.6908,-1147.836 614.6962,-1140.836"/>
</g>
<!-- sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1124.2562C851.0548,-1136.5127 715.2021,-1168.1394 702,-1182.2562"/>
</g>
<!-- sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M987.709,-744.2238C980.9542,-740.6939 974.712,-736.1368 970,-730.2562 907.497,-652.2531 970.5535,-601.2882 934,-508.2562 921.7964,-477.197 899.0323,-445.9201 883.2221,-426.3439"/>
<polygon fill="#000000" stroke="#000000" points="885.7811,-423.9458 876.7169,-418.4603 880.3819,-428.4011 885.7811,-423.9458"/>
</g>
<!-- sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-522.2562C777.8206,-443.2501 723.6836,-567.2893 606,-580.2562 492.4099,-592.7721 463.1181,-578.291 349,-572.2562 301.4362,-569.741 274.3022,-531.2533 242,-566.2562"/>
</g>
<!-- sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1015.5265,-768.413C995.646,-780.3995 963.5905,-798.5723 934,-810.2562 869.694,-835.6477 791.3485,-854.1594 744.1366,-864.0497"/>
<polygon fill="#000000" stroke="#000000" points="743.351,-860.638 734.2648,-866.0869 744.7658,-867.4935 743.351,-860.638"/>
</g>
<!-- sourcefile~dft_gridint.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dft_gridint.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dft_gridint.f90.html" xlink:title="dft_gridint.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="910.5,-1042.2562 821.5,-1042.2562 821.5,-1018.2562 910.5,-1018.2562 910.5,-1042.2562"/>
<text text-anchor="middle" x="866" y="-1027.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_gridint.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~dft_gridint.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~dft_gridint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1030.5157,-768.3187C1012.2055,-817.4592 943.6235,-1000.376 934,-1009.2562 929.9138,-1013.0268 925.163,-1016.1207 920.1076,-1018.6592"/>
<polygon fill="#000000" stroke="#000000" points="918.5768,-1015.5072 910.7565,-1022.6551 921.3274,-1021.9441 918.5768,-1015.5072"/>
</g>
<!-- sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~oqp_linalg.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/oqp_linalg.f90.html" xlink:title="oqp_linalg.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="603,-457.2562 513,-457.2562 513,-433.2562 603,-433.2562 603,-457.2562"/>
<text text-anchor="middle" x="558" y="-442.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_linalg.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dft_gridint_fxc.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M988.7722,-744.2215C981.7211,-740.6837 975.1058,-736.1246 970,-730.2562 926.132,-679.8363 968.1679,-641.6942 934,-584.2562 913.0907,-549.1066 896.4606,-549.548 866,-522.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-522.2562C792.4311,-456.3407 800.5948,-366.232 702,-372.2562"/>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.5482,-1432.1313C510.4682,-1416.1756 456.9538,-1391.5611 411.5,-1404.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1404.2562C337.1425,-1425.0241 319.0478,-1361.3586 242,-1366.2562"/>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~bragg_slater.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~bragg_slater.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M535.5213,-1456.4018C527.4665,-1460.762 518.3219,-1465.7213 510,-1470.2562 487.337,-1482.6062 461.7814,-1496.6189 442.3808,-1507.2746"/>
<polygon fill="#000000" stroke="#000000" points="440.4698,-1504.331 433.3909,-1512.2139 443.8406,-1510.466 440.4698,-1504.331"/>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1404.2562C383.5372,-1412.0662 367.4601,-1400.8478 349,-1423.2562 249.5711,-1543.9518 409.0166,-1649.8287 313,-1773.2562 308.1262,-1779.5214 301.5935,-1784.2775 294.4575,-1787.8878"/>
<polygon fill="#000000" stroke="#000000" points="292.9819,-1784.7123 285.1755,-1791.8754 295.745,-1791.1439 292.9819,-1784.7123"/>
</g>
<!-- sourcefile~dft_partfunc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~dft_partfunc.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/dft_partfunc.f90.html" xlink:title="dft_partfunc.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="461.5,-1456.2562 361.5,-1456.2562 361.5,-1432.2562 461.5,-1432.2562 461.5,-1456.2562"/>
<text text-anchor="middle" x="411.5" y="-1441.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_partfunc.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~dft_partfunc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~dft_partfunc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M509.6244,-1444.2562C497.4581,-1444.2562 484.253,-1444.2562 471.5903,-1444.2562"/>
<polygon fill="#000000" stroke="#000000" points="471.5817,-1440.7563 461.5816,-1444.2562 471.5816,-1447.7563 471.5817,-1440.7563"/>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~grid_storage.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~grid_storage.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.7968,-1456.301C522.0431,-1460.0527 515.2939,-1464.6969 510,-1470.2562 484.5021,-1497.0325 501.7069,-1520.7728 474,-1545.2562 472.4882,-1546.5922 470.8883,-1547.8437 469.2196,-1549.0161"/>
<polygon fill="#000000" stroke="#000000" points="467.2135,-1546.1363 460.3923,-1554.2432 470.7802,-1552.1595 467.2135,-1546.1363"/>
</g>
<!-- sourcefile~lebedev.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~lebedev.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/lebedev.f90.html" xlink:title="lebedev.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="450,-1300.2562 373,-1300.2562 373,-1276.2562 450,-1276.2562 450,-1300.2562"/>
<text text-anchor="middle" x="411.5" y="-1285.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lebedev.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~lebedev.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~lebedev.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.2911,-1431.9094C533.5651,-1423.5469 520.6861,-1412.0882 510,-1401.2562 479.397,-1370.2354 446.6891,-1331.4534 427.7213,-1308.3329"/>
<polygon fill="#000000" stroke="#000000" points="430.4182,-1306.1018 421.3841,-1300.5668 424.9947,-1310.5274 430.4182,-1306.1018"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1033.4097,-2374.1531C1025.4904,-2315.6774 988.5077,-2063.0299 934,-2009.2562 886.3463,-1962.2443 684.9393,-1986.6099 642,-1935.2562 605.4181,-1891.5057 612.8433,-1479.8735 606,-1423.2562 594.3702,-1327.0387 572.177,-1213.5109 562.5942,-1166.429"/>
<polygon fill="#000000" stroke="#000000" points="565.9814,-1165.5232 560.5445,-1156.4298 559.124,-1166.9289 565.9814,-1165.5232"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2144.2562C671.8827,-2113.6045 384.8098,-2010.0099 349,-1986.2562 258.8548,-1926.4602 217.853,-1917.7576 171,-1820.2562 125.1502,-1724.8425 145.4619,-1450.5963 135,-1345.2562 114.6437,-1140.2901 81.014,-893.3924 70.6431,-818.7121"/>
<polygon fill="#000000" stroke="#000000" points="74.081,-818.0229 69.2347,-808.6014 67.1479,-818.9887 74.081,-818.0229"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.1785,-2374.2094C981.5372,-2357.1425 920.7108,-2325.8282 866,-2306.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2306.2562C804.1551,-2284.1321 808.9266,-2247.2145 762,-2201.2562 735.7217,-2175.5202 728.4793,-2169.7853 702,-2144.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2144.2562C664.6868,-2108.282 661.7196,-2092.1891 642,-2044.2562 616.4086,-1982.0507 637.8441,-1956.5049 606,-1897.2562 526.3407,-1749.0432 413.3114,-1774.7449 349,-1619.2562 308.9666,-1522.4655 377.2784,-759.9569 313,-677.2562 308.4445,-671.3951 302.3311,-667.1096 295.5947,-663.9873"/>
<polygon fill="#000000" stroke="#000000" points="296.702,-660.6643 286.1102,-660.4117 294.2326,-667.2143 296.702,-660.6643"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2306.2562C853.8831,-2301.9216 653.0281,-2358.6238 642,-2365.2562 594.8321,-2393.6238 613.0044,-2454.2458 558,-2456.2562"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~printing.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~printing.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1033.6294,-2374.0926C1026.0952,-2306.8267 989.3569,-1973.5257 970,-1700.2562 945.9185,-1360.2878 1003.6928,-1267.8748 934,-934.2562 921.6779,-875.2704 892.4629,-810.1056 876.6339,-777.4196"/>
<polygon fill="#000000" stroke="#000000" points="879.7349,-775.794 872.1847,-768.3612 873.4518,-778.88 879.7349,-775.794"/>
</g>
<!-- sourcefile~ecp.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~ecp.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/ecp.f90.html" xlink:title="ecp.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="729.5,-2276.2562 674.5,-2276.2562 674.5,-2252.2562 729.5,-2252.2562 729.5,-2276.2562"/>
<text text-anchor="middle" x="702" y="-2261.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ecp.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~ecp.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~ecp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2306.2562C823.6161,-2291.094 773.2466,-2279.0411 739.6167,-2271.8041"/>
<polygon fill="#000000" stroke="#000000" points="740.2526,-2268.3612 729.7446,-2269.7146 738.8031,-2275.2095 740.2526,-2268.3612"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~mod_1e_primitives.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/mod_1e_primitives.f90.html" xlink:title="mod_1e_primitives.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="934,-2398.2562 798,-2398.2562 798,-2374.2562 934,-2374.2562 934,-2398.2562"/>
<text text-anchor="middle" x="866" y="-2383.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_1e_primitives.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~mod_1e_primitives.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~mod_1e_primitives.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1007.4711,-2386.2562C990.117,-2386.2562 966.762,-2386.2562 944.0344,-2386.2562"/>
<polygon fill="#000000" stroke="#000000" points="944.0073,-2382.7563 934.0073,-2386.2562 944.0073,-2389.7563 944.0073,-2382.7563"/>
</g>
<!-- sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~mod_shell_tools.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/mod_shell_tools.f90.html" xlink:title="mod_shell_tools.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="762,-2318.2562 642,-2318.2562 642,-2294.2562 762,-2294.2562 762,-2318.2562"/>
<text text-anchor="middle" x="702" y="-2303.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_shell_tools.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~mod_shell_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2306.2562C836.5034,-2295.7042 802.0671,-2294.2226 772.386,-2295.9638"/>
<polygon fill="#000000" stroke="#000000" points="771.8243,-2292.4951 762.1016,-2296.7045 772.3272,-2299.477 771.8243,-2292.4951"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1007.3426,-2396.6207C916.0275,-2428.8784 623.5273,-2516.0971 510,-2356.2562 439.8957,-2257.5527 523.766,-1377.6208 474,-1267.2562 466.6035,-1250.8532 452.3077,-1236.8124 439.2535,-1226.5478"/>
<polygon fill="#000000" stroke="#000000" points="441.0512,-1223.5228 430.9392,-1220.3609 436.8723,-1229.1386 441.0512,-1223.5228"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1018.7414,-1667.1692C1004.1542,-1655.5631 983.086,-1636.8016 970,-1616.2562 934.118,-1559.9205 915.9986,-1378.5436 866,-1334.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1334.2562C799.5506,-1275.3972 783.4096,-1255.6453 702,-1220.2562"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1007.437,-1686.4896C882.41,-1717.4561 366.2558,-1825.0114 171,-1546.2562 160.1909,-1530.8247 85.6831,-941.1174 70.2819,-818.4613"/>
<polygon fill="#000000" stroke="#000000" points="73.7337,-817.8577 69.0161,-808.3711 66.7881,-818.7291 73.7337,-817.8577"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1007.2367,-1677.6104C884.4477,-1670.0598 394.2492,-1636.9609 349,-1587.2562 280.8801,-1512.4289 375.1517,-757.11 313,-677.2562 308.4405,-671.3981 302.3251,-667.1144 295.5876,-663.9928"/>
<polygon fill="#000000" stroke="#000000" points="296.6943,-660.6696 286.1024,-660.4177 294.2254,-667.2198 296.6943,-660.6696"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2126.2562C761.7015,-2204.1035 488.7277,-2182.8877 411.5,-2182.2562"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1016.1241,-1667.0566C1000.6742,-1655.8943 979.8251,-1637.857 970,-1616.2562 907.1637,-1478.1089 992.3306,-1074.3656 934,-934.2562 921.9427,-905.2946 774.6478,-752.6961 721.2085,-697.8828"/>
<polygon fill="#000000" stroke="#000000" points="723.5222,-695.2424 714.0323,-690.5314 718.5131,-700.1321 723.5222,-695.2424"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1016.1386,-1667.05C1000.6979,-1655.8835 979.854,-1637.8438 970,-1616.2562 940.0098,-1550.5554 979.2369,-1023.5558 934,-967.2562 914.345,-942.7946 891.3842,-966.7044 866,-948.2562"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1334.2562C784.387,-1261.9656 741.3062,-1279.2551 642,-1234.2562 572.666,-1202.8388 491.8983,-1165.5326 446.7315,-1144.6061"/>
<polygon fill="#000000" stroke="#000000" points="447.9274,-1141.3028 437.3827,-1140.273 444.9837,-1147.6537 447.9274,-1141.3028"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1033.7992,-1691.2654C1028.5799,-1739.375 1004.8484,-1921.8153 934,-2051.2562 912.397,-2090.7252 903.0943,-2100.7905 866,-2126.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2126.2562C815.7009,-2160.7872 398.1424,-1977.4145 349,-1941.2562 304.1298,-1908.2414 269.3476,-1851.2059 252.729,-1820.4238"/>
<polygon fill="#000000" stroke="#000000" points="255.7405,-1818.6308 247.9819,-1811.4159 249.5478,-1821.8943 255.7405,-1818.6308"/>
</g>
<!-- sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~int2_pairs.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/int2_pairs.f90.html" xlink:title="int2_pairs.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="745.5,-1926.2562 658.5,-1926.2562 658.5,-1902.2562 745.5,-1902.2562 745.5,-1926.2562"/>
<text text-anchor="middle" x="702" y="-1911.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_pairs.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1029.1094,-1691.2945C1015.6937,-1717.5813 980.4014,-1780.6828 934,-1817.2562 903.8573,-1841.0146 805.6782,-1877.8953 747.1406,-1898.6651"/>
<polygon fill="#000000" stroke="#000000" points="745.6655,-1895.474 737.4001,-1902.1023 747.9949,-1902.0751 745.6655,-1895.474"/>
</g>
<!-- sourcefile~int_libint.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~int_libint.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/int_libint.f90.html" xlink:title="int_libint.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="906,-1808.2562 826,-1808.2562 826,-1784.2562 906,-1784.2562 906,-1808.2562"/>
<text text-anchor="middle" x="866" y="-1793.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_libint.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_libint.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_libint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1017.5506,-1691.3366C987.6962,-1712.005 926.6772,-1754.2489 891.8601,-1778.3531"/>
<polygon fill="#000000" stroke="#000000" points="889.8374,-1775.4965 883.6077,-1784.0663 893.8219,-1781.2518 889.8374,-1775.4965"/>
</g>
<!-- sourcefile~int_rotaxis.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~int_rotaxis.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/int_rotaxis.f90.html" xlink:title="int_rotaxis.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="911,-1917.2562 821,-1917.2562 821,-1893.2562 911,-1893.2562 911,-1917.2562"/>
<text text-anchor="middle" x="866" y="-1902.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_rotaxis.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_rotaxis.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_rotaxis.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1030.5431,-1691.5036C1018.7492,-1722.6355 984.1532,-1806.159 934,-1860.2562 924.0296,-1871.0107 910.9933,-1880.4302 899.0052,-1887.834"/>
<polygon fill="#000000" stroke="#000000" points="896.9379,-1884.9902 890.1102,-1893.0916 900.4998,-1891.0162 896.9379,-1884.9902"/>
</g>
<!-- sourcefile~int_rys.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~int_rys.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/int_rys.f90.html" xlink:title="int_rys.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="901,-2042.2562 831,-2042.2562 831,-2018.2562 901,-2018.2562 901,-2042.2562"/>
<text text-anchor="middle" x="866" y="-2027.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_rys.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_rys.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1030.9482,-1691.447C1018.5928,-1728.035 979.4537,-1839.7136 934,-1926.2562 918.0097,-1956.7013 895.5666,-1989.5563 880.9072,-2010.0149"/>
<polygon fill="#000000" stroke="#000000" points="877.9854,-2008.0823 874.9567,-2018.235 883.6556,-2012.187 877.9854,-2008.0823"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1012.9292,-1667.2075C961.7304,-1639.1148 836.3278,-1569.446 798,-1540.2562 780.2469,-1526.7358 778.5222,-1520.256 762,-1505.2562 641.7967,-1396.1292 491.1538,-1272.7722 434.472,-1226.8061"/>
<polygon fill="#000000" stroke="#000000" points="436.4763,-1223.9255 426.5025,-1220.3514 432.0706,-1229.3651 436.4763,-1223.9255"/>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-566.2562C498.248,-597.1495 470.5621,-572.0637 411.5,-604.2562"/>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M827.929,-403.5807C780.6103,-402.1122 699.1324,-405.8478 642,-442.2562 585.8638,-478.0297 617.1302,-535.6844 558,-566.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-566.2562C431.7634,-627.8108 337.8055,-463.5628 242,-566.2562"/>
</g>
<!-- sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~eigen.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/eigen.f90.html" xlink:title="eigen.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="734.5,-344.2562 669.5,-344.2562 669.5,-320.2562 734.5,-320.2562 734.5,-344.2562"/>
<text text-anchor="middle" x="702" y="-329.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">eigen.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~eigen.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M840.4327,-394.2526C819.4274,-384.4398 788.8653,-370.2747 762,-358.2562 754.7136,-354.9966 746.9035,-351.5661 739.407,-348.3046"/>
<polygon fill="#000000" stroke="#000000" points="740.7095,-345.0546 730.1423,-344.2893 737.9258,-351.4773 740.7095,-345.0546"/>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M833.3921,-394.1992C800.563,-383.3222 748.2925,-369.4277 702,-372.2562"/>
</g>
<!-- sourcefile~messages.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~messages.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M197.8452,-665.0438C188.5352,-668.0414 179.0911,-672.0143 171,-677.2562 150.3664,-690.624 151.1036,-700.6788 135,-719.2562 118.1996,-738.6375 98.8956,-760.6308 85.2466,-776.1355"/>
<polygon fill="#000000" stroke="#000000" points="82.2815,-774.2067 78.2975,-784.0239 87.534,-778.8338 82.2815,-774.2067"/>
</g>
<!-- sourcefile~messages.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~messages.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M197.7774,-661.1532C187.6912,-664.2932 177.9198,-669.3052 171,-677.2562 148.3771,-703.2506 84.0023,-1229.056 70.1477,-1344.1301"/>
<polygon fill="#000000" stroke="#000000" points="66.6527,-1343.8798 68.9351,-1354.2259 73.6027,-1344.7147 66.6527,-1343.8798"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M827.999,-760.7337C776.7945,-768.9446 686.902,-791.4728 642,-851.2562 570.0897,-946.999 674.0249,-1019.7149 606,-1118.2562 604.0617,-1121.064 601.7194,-1123.5963 599.1249,-1125.875"/>
<polygon fill="#000000" stroke="#000000" points="596.7679,-1123.2613 590.7372,-1131.9724 600.8839,-1128.9234 596.7679,-1123.2613"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M827.6538,-759.4548C766.9841,-762.8362 646.6592,-762.6101 558,-718.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-718.2562C499.7364,-689.5815 526.6674,-643.0184 510,-580.2562 487.6039,-495.9221 541.1191,-443.0133 474,-387.2562 370.4131,-301.2046 271.225,-297.3115 171,-387.2562 115.7694,-436.8217 164.8448,-651.3118 135,-719.2562 124.9545,-742.1258 105.602,-763.0869 90.1852,-777.3453"/>
<polygon fill="#000000" stroke="#000000" points="87.6773,-774.8924 82.552,-784.165 92.3412,-780.1124 87.6773,-774.8924"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-718.2562C499.3313,-688.9058 476.6005,-708.3424 411.5,-700.2562"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-718.2562C473.9028,-678.8043 229.9648,-804.4792 171,-876.2562 110.3894,-950.0367 77.5957,-1257.905 69.5026,-1343.8735"/>
<polygon fill="#000000" stroke="#000000" points="65.9955,-1343.7904 68.5617,-1354.0698 72.9659,-1344.4338 65.9955,-1343.7904"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M840.7344,-744.2397C812.805,-730.9562 767.6522,-709.4811 736.4838,-694.657"/>
<polygon fill="#000000" stroke="#000000" points="737.8282,-691.4208 727.2943,-690.2864 734.8217,-697.7423 737.8282,-691.4208"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M827.8156,-765.6333C817.3314,-769.5273 806.5174,-774.9085 798,-782.2562 773.2888,-803.5739 786.2395,-824.4037 762,-846.2562 756.5509,-851.1688 750.0293,-855.2579 743.324,-858.6264"/>
<polygon fill="#000000" stroke="#000000" points="741.8145,-855.4678 734.15,-862.7827 744.7032,-861.844 741.8145,-855.4678"/>
</g>
<!-- sourcefile~tagarray_driver.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~tagarray_driver.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M643.426,-677.456C617.2548,-677.514 586.0491,-678.1547 558,-680.2562"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1170.9791,-134.4711C1163.1701,-180.3951 1133.7185,-342.0299 1100,-380.2562 947.4303,-553.2231 752.9954,-422.0803 642,-624.2562 589.0295,-720.7409 665.7262,-1025.8011 606,-1118.2562 604.1487,-1121.1221 601.8688,-1123.6961 599.3175,-1126.0036"/>
<polygon fill="#000000" stroke="#000000" points="596.964,-1123.391 591.0067,-1132.1523 601.1274,-1129.0183 596.964,-1123.391"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1153.8397,-134.4122C1128.0242,-149.7375 1080.0951,-174.5428 1035,-178.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-178.2562C946.7837,-185.5204 315.8814,-53.5077 242,-102.2562"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~int2.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1172.0291,-134.4592C1167.3924,-193.104 1147.2624,-451.8715 1136,-664.2562 1130.3947,-769.9611 1143.1057,-1519.5772 1100,-1616.2562 1091.9219,-1634.374 1076.0072,-1649.9416 1061.9478,-1661.0691"/>
<polygon fill="#000000" stroke="#000000" points="1059.8353,-1658.2785 1053.9575,-1667.0934 1064.0494,-1663.8678 1059.8353,-1658.2785"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-366.2562C999.0122,-390.1926 950.3371,-399.8644 914.4676,-403.7414"/>
<polygon fill="#000000" stroke="#000000" points="913.8615,-400.2835 904.2441,-404.7282 914.5342,-407.2511 913.8615,-400.2835"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1135.8584,-118.25C1107.9415,-114.9066 1068.8484,-109.5169 1035,-102.2562"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-178.2562C757.1742,-224.845 691.3235,-259.7523 411.5,-292.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-292.2562C296.6024,-294.8039 239.5467,-295.0104 171,-387.2562 113.8072,-464.2227 144.8527,-721.8739 135,-817.2562 113.8362,-1022.1405 80.7522,-1269.0935 70.5794,-1343.7939"/>
<polygon fill="#000000" stroke="#000000" points="67.0836,-1343.5258 69.1986,-1353.9073 74.0193,-1344.4728 67.0836,-1343.5258"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1172.678,-134.5757C1170.9921,-183.1384 1160.728,-365.1635 1100,-498.2562 1061.1,-583.5101 1013.8036,-581.415 970,-664.2562 945.3615,-710.8525 972.5592,-741.3193 934,-777.2562 888.4991,-819.6627 855.1485,-785.7064 798,-810.2562 771.4042,-821.6813 743.9428,-840.2208 725.2404,-854.055"/>
<polygon fill="#000000" stroke="#000000" points="722.931,-851.4128 717.0519,-860.2268 727.1443,-857.0028 722.931,-851.4128"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~eigen.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1168.2546,-134.4396C1158.8248,-156.9951 1135.5247,-205.2341 1100,-230.2562 988.8851,-308.5211 822.6948,-326.7871 744.967,-331.0112"/>
<polygon fill="#000000" stroke="#000000" points="744.4182,-327.5338 734.6014,-331.5188 744.7606,-334.5254 744.4182,-327.5338"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1170.2879,-134.2835C1160.42,-174.9749 1122.3251,-308.174 1035,-366.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-366.2562C973.3745,-407.2449 775.8742,-367.7425 702,-372.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-372.2562C677.7131,-373.4151 620.2059,-406.5323 585.6616,-427.758"/>
<polygon fill="#000000" stroke="#000000" points="583.6468,-424.889 576.9909,-433.1322 587.3346,-430.8388 583.6468,-424.889"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M669.7749,-879.5962C659.4474,-883.4948 648.909,-889.3915 642,-898.2562 581.0936,-976.4029 663.4296,-1037.5201 606,-1118.2562 603.8404,-1121.2923 601.2121,-1124.009 598.3101,-1126.4328"/>
<polygon fill="#000000" stroke="#000000" points="596.2943,-1123.5715 590.1225,-1132.1832 600.3175,-1129.2999 596.2943,-1123.5715"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M672.5624,-860.2139C643.8885,-849.417 598.7815,-834.8815 558,-832.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-832.2562C492.5348,-828.0419 475.602,-800.314 411.5,-814.2562"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M669.9245,-881.3488C660.0881,-885.3226 649.8116,-890.8201 642,-898.2562 615.7983,-923.1984 628.2951,-942.7681 606,-971.2562 571.5945,-1015.2187 547.9291,-1011.295 510,-1052.2562 491.3952,-1072.3483 495.4549,-1085.2411 474,-1102.2562 469.5687,-1105.7706 464.5947,-1108.8824 459.4387,-1111.6189"/>
<polygon fill="#000000" stroke="#000000" points="457.5305,-1108.653 450.0392,-1116.1451 460.5676,-1114.9599 457.5305,-1108.653"/>
</g>
<!-- sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~functionals.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/functionals.f90.html" xlink:title="functionals.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="458.5,-904.2562 364.5,-904.2562 364.5,-880.2562 458.5,-880.2562 458.5,-904.2562"/>
<text text-anchor="middle" x="411.5" y="-889.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">functionals.F90</text>
</a>
</g>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-832.2562C512.2139,-829.3088 463.8468,-855.7181 435.7336,-874.4514"/>
<polygon fill="#000000" stroke="#000000" points="433.6045,-871.6677 427.3465,-880.2169 437.57,-877.4362 433.6045,-871.6677"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M669.6989,-880.289C659.6136,-884.2217 649.2448,-889.963 642,-898.2562 603.1206,-942.7617 640.7435,-978.4521 606,-1026.2562 575.8523,-1067.7369 545.5247,-1053.2762 510,-1090.2562 488.7193,-1112.4088 493.34,-1125.3905 474,-1149.2562 462.132,-1163.9015 446.7574,-1178.46 434.2271,-1189.4511"/>
<polygon fill="#000000" stroke="#000000" points="431.7684,-1186.9493 426.4691,-1196.1236 436.3329,-1192.2564 431.7684,-1186.9493"/>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1156.6985,-2524.4822C1131.9569,-2541.9653 1082.7382,-2572.6277 1035,-2578.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-2578.2562C888.0181,-2595.5858 850,-2578.2562 702,-2578.2562 702,-2578.2562 702,-2578.2562 411.5,-2578.2562 276.3741,-2578.2562 236.5541,-2510.4158 171,-2392.2562 120.5266,-2301.2791 76.3785,-1529.5715 68.6846,-1388.3881"/>
<polygon fill="#000000" stroke="#000000" points="72.1757,-1388.1273 68.1403,-1378.3311 65.186,-1388.5057 72.1757,-1388.1273"/>
</g>
<!-- sourcefile~atomic_structure.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~atomic_structure.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M402.3677,-1115.9904C385.095,-1092.839 346.3776,-1041.1718 313,-998.2562 235.1459,-898.1546 216.3745,-872.5176 135,-775.2562 118.5411,-755.584 99.1937,-733.6277 85.4418,-718.2107"/>
<polygon fill="#000000" stroke="#000000" points="87.7073,-715.4938 78.4313,-710.3745 82.4903,-720.161 87.7073,-715.4938"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M380.7265,-960.137C370.5369,-955.9436 359.1983,-951.0811 349,-946.2562 255.4584,-902.0007 148.4857,-842.4288 97.5327,-813.4821"/>
<polygon fill="#000000" stroke="#000000" points="99.1081,-810.3516 88.6864,-808.4441 95.644,-816.4343 99.1081,-810.3516"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M369.2207,-960.2128C361.7972,-956.6403 354.6517,-952.0712 349,-946.2562 317.8199,-914.1753 341.4127,-886.812 313,-852.2562 256.9314,-784.0653 162.3902,-737.0047 108.4556,-714.1437"/>
<polygon fill="#000000" stroke="#000000" points="109.774,-710.9015 99.197,-710.2883 107.0831,-717.3636 109.774,-710.9015"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M403.9787,-984.3271C390.1412,-1007.2576 360.9699,-1059.134 349,-1107.2562 331.1115,-1179.1729 357.0715,-1713.6768 313,-1773.2562 308.2246,-1779.7119 301.6775,-1784.567 294.4779,-1788.2177"/>
<polygon fill="#000000" stroke="#000000" points="292.9141,-1785.0797 285.0938,-1792.2278 295.6648,-1791.5167 292.9141,-1785.0797"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~elements.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M366.7946,-960.1488C360.0432,-956.619 353.7579,-952.0814 349,-946.2562 296.2874,-881.7195 354.0571,-834.7677 313,-762.2562 302.5422,-743.7866 284.812,-727.7973 269.6864,-716.4201"/>
<polygon fill="#000000" stroke="#000000" points="271.3149,-713.2794 261.1563,-710.2704 267.2213,-718.9576 271.3149,-713.2794"/>
</g>
<!-- sourcefile~bragg_slater.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~bragg_slater.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.8466,-1512.128C365.2347,-1508.419 356.4361,-1503.815 349,-1498.2562 288.5123,-1453.0395 317.3681,-1361.4654 242,-1366.2562"/>
</g>
<!-- sourcefile~constants.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~constants.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M198.9233,-1790.9007C188.5737,-1787.0532 178.3893,-1781.4406 171,-1773.2562 118.1447,-1714.7142 80.7026,-1464.4122 70.3744,-1388.2993"/>
<polygon fill="#000000" stroke="#000000" points="73.8423,-1387.8254 69.0487,-1378.377 66.904,-1388.7524 73.8423,-1387.8254"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M686.9554,-1514.1036C673.2721,-1502.2605 653.5095,-1483.0417 642,-1462.2562 612.9697,-1409.8293 575.0745,-1229.596 562.3671,-1166.3806"/>
<polygon fill="#000000" stroke="#000000" points="565.7473,-1165.4342 560.3579,-1156.3125 558.8826,-1166.8041 565.7473,-1165.4342"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M669.3868,-1514.1274C660.2559,-1510.2025 650.5075,-1505.4935 642,-1500.2562 624.2641,-1489.3377 623.2413,-1481.9401 606,-1470.2562 601.3907,-1467.1327 596.3691,-1464.0735 591.367,-1461.2135"/>
<polygon fill="#000000" stroke="#000000" points="592.9246,-1458.0756 582.4778,-1456.3101 589.5435,-1464.2049 592.9246,-1458.0756"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1484.2562C465.1421,-1475.4774 434.2179,-1503.1714 349,-1465.2562 289.8061,-1438.9197 306.6611,-1362.1974 242,-1366.2562"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M689.2436,-1514.1855C676.5094,-1501.7972 656.7626,-1481.6442 642,-1462.2562 555.2337,-1348.3045 564.2035,-1298.5069 474,-1187.2562 462.128,-1172.6141 446.7534,-1158.0557 434.2241,-1147.0639"/>
<polygon fill="#000000" stroke="#000000" points="436.3303,-1144.2588 426.4668,-1140.3907 431.7652,-1149.5655 436.3303,-1144.2588"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M685.6955,-1538.4395C633.6291,-1576.9343 465.8073,-1697.856 313,-1773.2562 305.3851,-1777.0137 297.0852,-1780.5323 288.9327,-1783.6929"/>
<polygon fill="#000000" stroke="#000000" points="287.6182,-1780.4477 279.48,-1787.2316 290.0724,-1787.0034 287.6182,-1780.4477"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~dft_partfunc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~dft_partfunc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M672.8579,-1514.2064C644.215,-1503.2199 598.9632,-1488.1289 558,-1484.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1484.2562C521.7239,-1480.8267 481.9183,-1469.442 452.9668,-1459.6911"/>
<polygon fill="#000000" stroke="#000000" points="453.7973,-1456.2753 443.2026,-1456.326 451.5164,-1462.8933 453.7973,-1456.2753"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~grid_storage.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~grid_storage.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1484.2562C512.066,-1479.9136 515.0073,-1524.1093 474,-1545.2562 470.4392,-1547.0925 466.6838,-1548.8192 462.8536,-1550.4319"/>
<polygon fill="#000000" stroke="#000000" points="461.276,-1547.2912 453.2468,-1554.2036 463.8342,-1553.807 461.276,-1547.2912"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1068.2562C674.5559,-1076.7243 667.1636,-1078.4113 642,-1092.2562 624.708,-1101.7703 622.7119,-1107.7565 606,-1118.2562 601.1851,-1121.2814 595.9904,-1124.3167 590.8585,-1127.1912"/>
<polygon fill="#000000" stroke="#000000" points="588.878,-1124.2851 581.7845,-1132.1549 592.2374,-1130.4264 588.878,-1124.2851"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-912.2562C684.1937,-890.6841 663.1217,-911.5945 642,-893.2562 614.0803,-869.0158 635.8894,-840.0217 606,-818.2562 457.5859,-710.1812 220.3263,-754.854 117.6053,-781.6131"/>
<polygon fill="#000000" stroke="#000000" points="116.5642,-778.2682 107.7994,-784.2204 118.363,-785.0332 116.5642,-778.2682"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M855.3976,-1042.2614C841.8165,-1057.7447 817.6815,-1085.6169 798,-1110.2562 781.3569,-1131.0918 783.1658,-1142.0352 762,-1158.2562 739.2037,-1175.7268 721.6178,-1161.2793 702,-1182.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1182.2562C666.5971,-1220.1119 667.2748,-1237.0057 642,-1282.2562 614.2588,-1331.9224 584.1062,-1391.6187 568.5739,-1422.8382"/>
<polygon fill="#000000" stroke="#000000" points="565.3748,-1421.4112 564.0663,-1431.925 571.6457,-1424.522 565.3748,-1421.4112"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.342,-1038.8002C788.1034,-1045.5935 741.7964,-1055.9767 702,-1068.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1068.2562C638.9629,-1087.7069 621.6082,-1086.7634 558,-1104.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1104.2562C494.8463,-1121.624 466.6644,-1052.9446 411.5,-1088.2562"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.2295,-1019.1873C765.1582,-1004.8928 672.7134,-979.7739 642,-962.2562 623.146,-951.5027 624.3963,-940.7752 606,-929.2562 586.5538,-917.0799 579.4738,-918.3367 558,-910.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-910.2562C529.7588,-899.8216 496.5825,-895.1735 468.9494,-893.1983"/>
<polygon fill="#000000" stroke="#000000" points="468.8479,-889.6856 458.652,-892.5657 468.4186,-896.6724 468.8479,-889.6856"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.4685,-1019.9619C813.35,-1017.1359 805.1844,-1013.6123 798,-1009.2562 794.7584,-1007.2908 704.4132,-915.1798 702,-912.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-912.2562C684.1937,-890.6841 659.6894,-914.9243 642,-893.2562 593.8116,-834.2295 625.8421,-625.8263 606,-552.2562 597.5786,-521.0315 581.1279,-487.3606 569.8542,-466.3007"/>
<polygon fill="#000000" stroke="#000000" points="572.8053,-464.402 564.9399,-457.3036 566.6619,-467.7576 572.8053,-464.402"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1104.2562C535.8775,-1110.3401 529.6266,-1111.3728 510,-1123.2562 493.5952,-1133.1889 455.6163,-1167.342 431.9011,-1189.2147"/>
<polygon fill="#000000" stroke="#000000" points="429.4157,-1186.7461 424.4571,-1196.1089 434.1722,-1191.8818 429.4157,-1186.7461"/>
</g>
<!-- sourcefile~dft_xc_libxc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~dft_xc_libxc.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/dft_xc_libxc.f90.html" xlink:title="dft_xc_libxc.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="750.5,-1040.2562 653.5,-1040.2562 653.5,-1016.2562 750.5,-1016.2562 750.5,-1040.2562"/>
<text text-anchor="middle" x="702" y="-1025.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_xc_libxc.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~dft_xc_libxc.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~dft_xc_libxc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.1863,-1029.7097C802.6112,-1029.4832 780.8064,-1029.2173 760.9609,-1028.9753"/>
<polygon fill="#000000" stroke="#000000" points="760.8311,-1025.4735 750.7891,-1028.8512 760.7456,-1032.473 760.8311,-1025.4735"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1030.108,-1000.2814C1018.0409,-1028.4864 984.1482,-1099.4369 934,-1138.2562 908.6566,-1157.8744 897.5139,-1156.4224 866,-1162.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1162.2562C793.8984,-1175.6036 775.3263,-1144.0327 702,-1144.2562"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1031.5596,-1000.3879C1018.6198,-1045.2286 971.6916,-1200.7394 934,-1234.2562 887.101,-1275.9606 857.4666,-1252.194 798,-1272.2562 727.3063,-1296.1061 701.4641,-1289.1958 642,-1334.2562 609.7077,-1358.7265 583.5127,-1398.6833 569.3924,-1423.1099"/>
<polygon fill="#000000" stroke="#000000" points="566.2753,-1421.5123 564.4215,-1431.9437 572.3758,-1424.9451 566.2753,-1421.5123"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M999.7482,-976.2363C989.8576,-972.3131 979.2777,-967.5778 970,-962.2562 952.4173,-952.1709 951.2239,-944.9428 934,-934.2562 731.5362,-808.6377 644.3245,-763.6168 411.5,-814.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-814.2562C279.8939,-842.4105 246.5405,-886.8719 171,-998.2562 93.6734,-1112.2741 73.6983,-1283.3446 68.9084,-1343.9783"/>
<polygon fill="#000000" stroke="#000000" points="65.4159,-1343.7483 68.1803,-1353.9761 72.3974,-1344.2568 65.4159,-1343.7483"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M979.5044,-976.1954C932.0768,-965.7199 870.7408,-951.7017 866,-948.2562"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~dft_gridint.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~dft_gridint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M986.5714,-1000.2917C965.9418,-1005.4186 941.7811,-1011.4231 920.5269,-1016.7051"/>
<polygon fill="#000000" stroke="#000000" points="919.5337,-1013.3454 910.6731,-1019.154 921.2221,-1020.1388 919.5337,-1013.3454"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M986.7696,-976.1026C980.3028,-972.5933 974.3966,-968.0742 970,-962.2562 877.0534,-839.2601 1023.9354,-742.471 934,-617.2562 912.8423,-587.7989 690.7583,-497.657 598.1745,-461.0033"/>
<polygon fill="#000000" stroke="#000000" points="599.4328,-457.7373 588.8463,-457.3179 596.8607,-464.2476 599.4328,-457.7373"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M975.152,-1208.4946C942.8218,-1211.8989 902.217,-1216.2297 866,-1220.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1220.2562C793.5575,-1228.3103 768.8461,-1249.3145 702,-1220.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1220.2562C690.7197,-1215.3526 628.2174,-1181.9876 589.3558,-1161.1279"/>
<polygon fill="#000000" stroke="#000000" points="590.9696,-1158.0218 580.5038,-1156.3733 587.6572,-1164.1886 590.9696,-1158.0218"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1020.3967,-1214.2606C1001.4334,-1229.3927 966.8616,-1255.4529 934,-1272.2562 876.9295,-1301.4385 856.8349,-1294.8181 798,-1320.2562 720.2336,-1353.8797 632.71,-1401.7968 587.9247,-1427.0913"/>
<polygon fill="#000000" stroke="#000000" points="586.0077,-1424.1547 579.0356,-1432.1322 589.4608,-1430.2438 586.0077,-1424.1547"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1220.2562C819.6465,-1225.4098 808.3735,-1229.2859 762,-1234.2562 578.9081,-1253.88 517.6465,-1193.3231 349,-1267.2562 289.6631,-1293.269 306.6123,-1361.4828 242,-1366.2562"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1031.3004,-1190.067C1017.8386,-1146.4511 970.3491,-999.0514 934,-967.2562 910.381,-946.5963 891.3842,-966.7044 866,-948.2562"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~dft_gridint.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~dft_gridint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1023.1162,-1190.1615C994.338,-1160.8725 920.6857,-1085.9127 885.4068,-1050.0075"/>
<polygon fill="#000000" stroke="#000000" points="887.602,-1047.2478 878.0968,-1042.5678 882.6089,-1052.1538 887.602,-1047.2478"/>
</g>
<!-- sourcefile~dft_partfunc.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dft_partfunc.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M381.4645,-1432.1758C371.1208,-1427.9061 359.5006,-1422.9871 349,-1418.2562 300.7927,-1396.5373 294.7674,-1362.902 242,-1366.2562"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.334,-2261.4336C662.4458,-2258.7162 649.5692,-2253.4438 642,-2243.2562 587.6098,-2170.0515 615.751,-1513.9323 606,-1423.2562 595.6376,-1326.894 572.7592,-1213.4444 562.7948,-1166.4061"/>
<polygon fill="#000000" stroke="#000000" points="566.1727,-1165.4645 560.6604,-1156.4165 559.3272,-1166.9272 566.1727,-1165.4645"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2342.2562C493.9847,-2354.1516 470.272,-2370.2796 411.5,-2342.2562"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.4562,-2270.8885C663.7948,-2274.2055 651.8201,-2278.8987 642,-2285.2562 622.4709,-2297.8994 625.2708,-2310.2228 606,-2323.2562 586.9948,-2336.1101 580.5577,-2338.0645 558,-2342.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2342.2562C541.4666,-2345.3285 422.4365,-2317.0307 411.5,-2304.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-2304.2562C281.9255,-2152.9054 250.3965,-1898.6412 243.6584,-1821.8712"/>
<polygon fill="#000000" stroke="#000000" points="247.1127,-1821.1698 242.8068,-1811.4895 240.1361,-1821.7422 247.1127,-1821.1698"/>
</g>
<!-- sourcefile~ecpint.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~ecpint.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/ecpint.f90.html" xlink:title="ecpint.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="592,-2314.2562 524,-2314.2562 524,-2290.2562 592,-2290.2562 592,-2314.2562"/>
<text text-anchor="middle" x="558" y="-2299.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ecpint.F90</text>
</a>
</g>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~ecpint.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~ecpint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.2354,-2271.583C653.7114,-2276.999 625.3579,-2284.4812 601.7928,-2290.6998"/>
<polygon fill="#000000" stroke="#000000" points="600.7993,-2287.3421 592.0234,-2293.2778 602.5855,-2294.1104 600.7993,-2287.3421"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-395.2562C536.1948,-407.3297 526.53,-405.6016 510,-424.2562 484.142,-453.4378 492.3746,-469.8677 474,-504.2562 449.3004,-550.4822 457.519,-579.173 411.5,-604.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-604.2562C375.2171,-624.0326 330.3753,-637.3674 295.9292,-645.578"/>
<polygon fill="#000000" stroke="#000000" points="295.0056,-642.1991 286.0505,-647.861 296.5819,-649.0194 295.0056,-642.1991"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M669.3537,-322.107C615.6259,-306.6758 505.1785,-280.3045 411.5,-292.2562"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M669.3453,-342.615C659.9154,-346.5711 650.0166,-351.74 642,-358.2562 620.4704,-375.7563 625.3337,-389.3568 606,-409.2562 599.7393,-415.7001 592.2488,-421.8883 585.0677,-427.2616"/>
<polygon fill="#000000" stroke="#000000" points="582.9429,-424.4786 576.8721,-433.1617 587.0327,-430.1596 582.9429,-424.4786"/>
</g>
<!-- sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~mathlib_types.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/mathlib_types.f90.html" xlink:title="mathlib_types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="296.5,-420.2562 187.5,-420.2562 187.5,-396.2562 296.5,-396.2562 296.5,-420.2562"/>
<text text-anchor="middle" x="242" y="-405.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mathlib_types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M671.0625,-344.2881C641.4882,-356.1387 595.9188,-375.3162 558,-395.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-395.2562C524.8073,-412.711 511.46,-389.036 474,-387.2562 418.507,-384.6197 404.2949,-381.8814 349,-387.2562 333.9205,-388.722 317.812,-391.3237 302.7916,-394.2078"/>
<polygon fill="#000000" stroke="#000000" points="301.7164,-390.8531 292.5928,-396.2392 303.0838,-397.7183 301.7164,-390.8531"/>
</g>
<!-- sourcefile~elements.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~elements.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M199.314,-692.8369C188.9614,-689.719 178.6778,-684.8482 171,-677.2562 124.9529,-631.7236 84.1338,-430.8375 71.5107,-363.4109"/>
<polygon fill="#000000" stroke="#000000" points="74.9273,-362.6382 69.6686,-353.4406 68.0438,-363.9101 74.9273,-362.6382"/>
</g>
<!-- sourcefile~elements.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~elements.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M199.3125,-698.2562C173.1244,-698.2562 139.6146,-698.2562 112.936,-698.2562"/>
<polygon fill="#000000" stroke="#000000" points="112.7061,-694.7563 102.706,-698.2562 112.706,-701.7563 112.7061,-694.7563"/>
</g>
<!-- sourcefile~functionals.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~functionals.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M366.7701,-880.1688C360.0213,-876.6368 353.7434,-872.0933 349,-866.2562 295.0725,-799.8949 370.3878,-740.649 313,-677.2562 308.2472,-672.0061 302.2517,-668.0431 295.7685,-665.0564"/>
<polygon fill="#000000" stroke="#000000" points="296.5999,-661.628 286.0089,-661.3429 294.1105,-668.1704 296.5999,-661.628"/>
</g>
<!-- sourcefile~functionals.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~functionals.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M376.7671,-904.3508C367.4439,-908.2201 357.5764,-912.9089 349,-918.2562 295.2853,-951.7471 289.3165,-970.2078 242,-1012.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-1012.2562C134.9782,-1107.3626 86.408,-1283.0563 72.1707,-1344.4199"/>
<polygon fill="#000000" stroke="#000000" points="68.752,-1343.67 69.9723,-1354.1943 75.5814,-1345.2061 68.752,-1343.67"/>
</g>
<!-- sourcefile~grid_storage.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~grid_storage.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M363.5607,-1554.1712C358.3538,-1551.7157 353.3681,-1548.7747 349,-1545.2562 276.8188,-1487.1143 334.4989,-1360.3764 242,-1366.2562"/>
</g>
<!-- sourcefile~int2_pairs.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~int2_pairs.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M658.4948,-1902.3006C652.0787,-1898.754 646.2191,-1894.1714 642,-1888.2562 581.8157,-1803.8783 618.8003,-1526.1053 606,-1423.2562 594.0303,-1327.0804 572.0208,-1213.53 562.5404,-1166.4356"/>
<polygon fill="#000000" stroke="#000000" points="565.9299,-1165.5392 560.5135,-1156.4336 559.0694,-1166.9295 565.9299,-1165.5392"/>
</g>
<!-- sourcefile~int2_pairs.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~int2_pairs.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M658.189,-1923.1914C575.3532,-1940.6816 399.5365,-1980.8267 349,-2016.2562 282.8325,-2062.6442 309.902,-2207.0659 242,-2163.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-2163.2562C211.5538,-2142.4232 191.2585,-2151.0877 171,-2120.2562 88.6634,-1994.9476 70.9699,-1499.2069 68.0149,-1388.3315"/>
<polygon fill="#000000" stroke="#000000" points="71.513,-1388.2084 67.7606,-1378.3004 64.5153,-1388.3859 71.513,-1388.2084"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M862.4592,-1784.045C850.5275,-1743.489 809.848,-1609.9174 762,-1505.2562 700.4455,-1370.6138 606.1391,-1219.3287 571.4254,-1165.03"/>
<polygon fill="#000000" stroke="#000000" points="574.184,-1162.8482 565.8371,-1156.3229 568.293,-1166.6292 574.184,-1162.8482"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.8638,-1805.9001C792.6403,-1813.918 744.2172,-1825.6845 702,-1836.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1836.2562C676.865,-1842.5504 262.0376,-1775.6843 242,-1759.2562"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1836.2562C632.001,-1853.7849 629.958,-1916.6561 558,-1911.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1911.2562C492.5277,-1906.343 476.6522,-1900.3778 411.5,-1892.2562"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M840.0416,-1808.313C827.0277,-1814.773 811.2577,-1823.2463 798,-1832.2562 769.7644,-1851.4452 740.3515,-1877.6373 721.6452,-1895.2083"/>
<polygon fill="#000000" stroke="#000000" points="719.1601,-1892.7416 714.3184,-1902.1654 723.9801,-1897.8177 719.1601,-1892.7416"/>
</g>
<!-- sourcefile~libint_f.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~libint_f.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/libint_f.f90.html" xlink:title="libint_f.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="737,-1808.2562 667,-1808.2562 667,-1784.2562 737,-1784.2562 737,-1808.2562"/>
<text text-anchor="middle" x="702" y="-1793.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint_f.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~libint_f.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~libint_f.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.8811,-1796.2562C802.1504,-1796.2562 772.0227,-1796.2562 747.4205,-1796.2562"/>
<polygon fill="#000000" stroke="#000000" points="747.2498,-1792.7563 737.2498,-1796.2562 747.2497,-1799.7563 747.2498,-1792.7563"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M820.7533,-1900.3488C762.1821,-1892.9967 664.8913,-1877.0472 642,-1850.2562 611.0704,-1814.0576 612.042,-1470.4841 606,-1423.2562 593.7012,-1327.1219 571.8696,-1213.5491 562.4883,-1166.4421"/>
<polygon fill="#000000" stroke="#000000" points="565.8801,-1165.5547 560.4834,-1156.4374 559.0165,-1166.9302 565.8801,-1165.5547"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1992.2562C594.5109,-2010.6814 332.0034,-2224.8417 242,-2163.2562"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M850.9541,-1917.5595C823.46,-1938.9982 762.3576,-1981.9101 702,-1992.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1992.2562C629.6253,-2004.6623 631.2244,-1916.7511 558,-1911.2562"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M820.7521,-1907.7393C800.6271,-1908.8438 776.7782,-1910.1525 755.7521,-1911.3064"/>
<polygon fill="#000000" stroke="#000000" points="755.4788,-1907.816 745.6856,-1911.8588 755.8624,-1914.8055 755.4788,-1907.816"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M830.9309,-2041.3128C794.9578,-2050.3306 739.1524,-2057.5915 702,-2030.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2030.2562C678.8661,-2013.2352 658.8273,-2029.5313 642,-2006.2562 603.9749,-1953.661 613.5132,-1487.721 606,-1423.2562 594.7805,-1326.99 572.3655,-1213.4885 562.6591,-1166.4213"/>
<polygon fill="#000000" stroke="#000000" points="566.0434,-1165.5041 560.582,-1156.4253 559.1898,-1166.9283 566.0434,-1165.5041"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M843.2057,-2042.4964C778.1227,-2076.4105 584.953,-2169.906 411.5,-2182.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-2182.2562C335.6974,-2181.6363 301.2319,-2210.5638 242,-2163.2562"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2030.2562C685.2576,-2017.9378 366.5932,-1917.3256 349,-1906.2562 311.1748,-1882.4571 276.373,-1843.041 257.2782,-1819.2711"/>
<polygon fill="#000000" stroke="#000000" points="259.9173,-1816.9653 250.9774,-1811.2795 254.4203,-1821.2993 259.9173,-1816.9653"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M848.7591,-2018.0614C819.7698,-1997.5568 761.1336,-1956.0824 727.4138,-1932.2319"/>
<polygon fill="#000000" stroke="#000000" points="729.1952,-1929.2048 719.0099,-1926.2876 725.1529,-1934.9198 729.1952,-1929.2048"/>
</g>
<!-- sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~rys.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/rys.f90.html" xlink:title="rys.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="729,-2234.2562 675,-2234.2562 675,-2210.2562 729,-2210.2562 729,-2234.2562"/>
<text text-anchor="middle" x="702" y="-2219.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rys.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M855.7534,-2042.393C842.3481,-2058.3209 818.1893,-2087.1973 798,-2112.2562 781.7124,-2132.4723 778.8947,-2138.5447 762,-2158.2562 748.9912,-2173.434 733.5501,-2189.8714 721.5902,-2202.2873"/>
<polygon fill="#000000" stroke="#000000" points="718.7426,-2200.1962 714.2941,-2209.8119 723.7681,-2205.0691 718.7426,-2200.1962"/>
</g>
<!-- sourcefile~lebedev.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~lebedev.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M392.2346,-1276.0715C377.5583,-1265.6126 358.3362,-1249.1051 349,-1229.2562 296.6781,-1118.0198 389.7375,-773.2899 313,-677.2562 308.4211,-671.526 302.3559,-667.3069 295.6945,-664.21"/>
<polygon fill="#000000" stroke="#000000" points="296.9158,-660.93 286.3247,-660.6461 294.4271,-667.4727 296.9158,-660.93"/>
</g>
<!-- sourcefile~lebedev.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~lebedev.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M381.4645,-1300.3366C371.1208,-1304.6064 359.5006,-1309.5254 349,-1314.2562 300.7927,-1335.9752 294.7674,-1362.902 242,-1366.2562"/>
</g>
<!-- sourcefile~libxc.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~libxc.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-870.2562C534.8401,-864.5546 530.0134,-859.2314 510,-846.2562 432.3586,-795.9195 417.1487,-776.848 349,-714.2562 332.1019,-698.7361 332.6397,-689.1181 313,-677.2562 307.6566,-674.029 301.7855,-671.2704 295.7793,-668.9189"/>
<polygon fill="#000000" stroke="#000000" points="296.8807,-665.596 286.286,-665.5498 294.5395,-672.1929 296.8807,-665.596"/>
</g>
<!-- sourcefile~libxc.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~libxc.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M835.9955,-992.1132C823.1178,-995.0436 808.6237,-1000.1969 798,-1009.2562 770.4741,-1032.7289 785.4031,-1054.6711 762,-1082.2562 719.5509,-1132.2907 693.8344,-1128.0246 642,-1168.2562 564.994,-1228.025 560.9281,-1265.1457 474,-1309.2562 379.3152,-1357.3028 347.9529,-1359.3528 242,-1366.2562"/>
</g>
<!-- sourcefile~libxc.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~libxc.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M835.8324,-981.6084C823.074,-977.6352 808.7185,-971.5028 798,-962.2562 773.2888,-940.9386 786.2395,-920.1088 762,-898.2562 756.5509,-893.3437 750.0293,-889.2545 743.324,-885.886"/>
<polygon fill="#000000" stroke="#000000" points="744.7032,-882.6685 734.15,-881.7298 741.8145,-889.0447 744.7032,-882.6685"/>
</g>
<!-- sourcefile~libxc.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~libxc.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M835.8786,-984.0752C791.4166,-977.0076 706.5228,-960.0431 642,-926.2562 623.5492,-916.5946 623.2413,-907.9401 606,-896.2562 585.9154,-882.6455 581.5272,-876.1817 558,-870.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-870.2562C523.3736,-861.7317 483.2806,-868.8946 453.8,-877.2527"/>
<polygon fill="#000000" stroke="#000000" points="452.4168,-874.0132 443.8412,-880.2351 454.425,-880.719 452.4168,-874.0132"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M816.8424,-2398.2727C799.6112,-2401.9269 780.0537,-2405.4517 762,-2407.2562 708.9311,-2412.5606 694.4297,-2417.0325 642,-2407.2562 580.1725,-2395.7275 564.7395,-2387.2262 510,-2356.2562 492.3581,-2346.2749 491.6522,-2338.2193 474,-2328.2562 448.0871,-2313.6307 430.8512,-2326.8596 411.5,-2304.2562"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_shell_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M841.0919,-2374.1059C812.9947,-2360.4 767.1437,-2338.0337 735.8231,-2322.7553"/>
<polygon fill="#000000" stroke="#000000" points="737.1273,-2319.4973 726.6051,-2318.2587 734.0583,-2325.7887 737.1273,-2319.4973"/>
</g>
<!-- sourcefile~mod_gauss_hermite.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~mod_gauss_hermite.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/mod_gauss_hermite.f90.html" xlink:title="mod_gauss_hermite.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="313,-2383.2562 171,-2383.2562 171,-2359.2562 313,-2359.2562 313,-2383.2562"/>
<text text-anchor="middle" x="242" y="-2368.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_gauss_hermite.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_gauss_hermite.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_gauss_hermite.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M846.8236,-2398.3756C826.5093,-2410.687 793.1317,-2429.4378 762,-2440.2562 655.4588,-2477.2799 621.0301,-2490.1081 510,-2470.2562 421.8834,-2454.5012 324.8173,-2411.7601 275.2105,-2387.9105"/>
<polygon fill="#000000" stroke="#000000" points="276.4628,-2384.6277 265.9386,-2383.4061 273.4039,-2390.9241 276.4628,-2384.6277"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M850.6457,-2374.1875C835.7306,-2361.8634 813.1741,-2341.5638 798,-2320.2562 776.0858,-2289.484 790.023,-2268.5914 762,-2243.2562 755.4687,-2237.3514 747.1809,-2233.0874 738.8658,-2230.015"/>
<polygon fill="#000000" stroke="#000000" points="739.7864,-2226.6349 729.1956,-2226.9288 737.658,-2233.3035 739.7864,-2226.6349"/>
</g>
<!-- sourcefile~xyzorder.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~xyzorder.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/xyzorder.f90.html" xlink:title="xyzorder.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="742.5,-2398.2562 661.5,-2398.2562 661.5,-2374.2562 742.5,-2374.2562 742.5,-2398.2562"/>
<text text-anchor="middle" x="702" y="-2383.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">xyzorder.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~xyzorder.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~xyzorder.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M797.874,-2386.2562C782.8608,-2386.2562 767.2086,-2386.2562 753.0098,-2386.2562"/>
<polygon fill="#000000" stroke="#000000" points="752.9578,-2382.7563 742.9578,-2386.2562 752.9577,-2389.7563 752.9578,-2382.7563"/>
</g>
<!-- sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M651.5516,-2294.2081C647.9013,-2291.7533 644.629,-2288.8025 642,-2285.2562 584.9113,-2208.248 616.1477,-1518.5789 606,-1423.2562 595.7404,-1326.8829 572.8065,-1213.4393 562.8111,-1166.4043"/>
<polygon fill="#000000" stroke="#000000" points="566.1882,-1165.4597 560.6698,-1156.4155 559.3437,-1166.9271 566.1882,-1165.4597"/>
</g>
<!-- sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M665.2036,-2318.2896C657.0504,-2321.9838 648.8173,-2326.605 642,-2332.2562 590.7524,-2374.738 624.5214,-2453.8248 558,-2456.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2456.2562C475.5531,-2459.2697 485.9696,-2377.7645 411.5,-2342.2562"/>
</g>
<!-- sourcefile~blas_wrap.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~blas_wrap.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/blas_wrap.f90.html" xlink:title="blas_wrap.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455.5,-462.2562 367.5,-462.2562 367.5,-438.2562 455.5,-438.2562 455.5,-462.2562"/>
<text text-anchor="middle" x="411.5" y="-447.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">blas_wrap.F90</text>
</a>
</g>
</g>
<!-- sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~blas_wrap.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~blas_wrap.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.8498,-446.7972C498.095,-447.3008 481.5474,-447.8655 466.1696,-448.3904"/>
<polygon fill="#000000" stroke="#000000" points="465.6215,-444.9069 455.7467,-448.7461 465.8603,-451.9029 465.6215,-444.9069"/>
</g>
<!-- sourcefile~lapack_wrap.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~lapack_wrap.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/lapack_wrap.f90.html" xlink:title="lapack_wrap.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462.5,-420.2562 360.5,-420.2562 360.5,-396.2562 462.5,-396.2562 462.5,-420.2562"/>
<text text-anchor="middle" x="411.5" y="-405.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lapack_wrap.F90</text>
</a>
</g>
</g>
<!-- sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~lapack_wrap.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~lapack_wrap.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.8498,-433.8531C498.983,-430.3509 483.5328,-426.4488 468.9582,-422.7678"/>
<polygon fill="#000000" stroke="#000000" points="469.5909,-419.3178 459.0383,-420.2625 467.8767,-426.1047 469.5909,-419.3178"/>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.8466,-1220.3844C365.2347,-1224.0935 356.4361,-1228.6974 349,-1234.2562 288.5123,-1279.4729 317.3681,-1361.4654 242,-1366.2562"/>
</g>
<!-- sourcefile~radial_grid_types.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~radial_grid_types.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M228.597,-1513.0438C198.3251,-1485.4608 124.4885,-1418.1827 88.2513,-1385.1643"/>
<polygon fill="#000000" stroke="#000000" points="90.4588,-1382.4407 80.7098,-1378.2926 85.7442,-1387.6149 90.4588,-1382.4407"/>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M368.7463,-462.3103C361.4526,-465.873 354.4759,-470.4358 349,-476.2562 315.4836,-511.8813 338.2453,-538.3615 313,-580.2562 299.8262,-602.1182 279.5527,-623.0095 264.0369,-637.3362"/>
<polygon fill="#000000" stroke="#000000" points="261.5056,-634.9058 256.4197,-644.2001 266.1915,-640.106 261.5056,-634.9058"/>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M377.1675,-462.3385C367.7496,-466.2347 357.7337,-470.9403 349,-476.2562 295.9185,-508.5654 284.3902,-520.8183 242,-566.2562"/>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.4083,-439.3309C346.9934,-434.2723 322.4534,-428.1916 300.5153,-422.7556"/>
<polygon fill="#000000" stroke="#000000" points="301.1911,-419.3173 290.6428,-420.3093 299.5075,-426.1118 301.1911,-419.3173"/>
</g>
<!-- sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M653.3306,-1027.552C591.9849,-1028.9276 485.613,-1039.0444 411.5,-1088.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1088.2562C387.0476,-1103.9086 370.4971,-1087.7425 349,-1107.2562 256.7802,-1190.9676 366.284,-1358.1585 242,-1366.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-1366.2562C201.0417,-1368.9249 154.5608,-1368.7688 119.8748,-1368.0305"/>
<polygon fill="#000000" stroke="#000000" points="119.5881,-1364.5228 109.5081,-1367.7851 119.4224,-1371.5209 119.5881,-1364.5228"/>
</g>
<!-- sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M663.0561,-1016.1526C655.4607,-1012.5397 648.0026,-1007.9703 642,-1002.2562 615.7983,-977.3141 632.5974,-953.776 606,-929.2562 589.1308,-913.7047 579.4738,-918.3367 558,-910.2562"/>
</g>
<!-- sourcefile~dft_xclib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~dft_xclib.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/dft_xclib.f90.html" xlink:title="dft_xclib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="597.5,-962.2562 518.5,-962.2562 518.5,-938.2562 597.5,-938.2562 597.5,-962.2562"/>
<text text-anchor="middle" x="558" y="-947.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_xclib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~dft_xclib.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~dft_xclib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M671.6899,-1016.1367C662.0594,-1012.0178 651.4576,-1007.1993 642,-1002.2562 622.1205,-991.8661 600.63,-978.5208 584.3626,-967.9513"/>
<polygon fill="#000000" stroke="#000000" points="586.1867,-964.962 575.9059,-962.4014 582.3459,-970.8143 586.1867,-964.962"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M360.2933,-420.3055C356.1041,-422.7572 352.243,-425.707 349,-429.2562 302.4619,-480.1886 345.6349,-519.4708 313,-580.2562 300.9991,-602.609 280.7833,-623.3194 264.9855,-637.4567"/>
<polygon fill="#000000" stroke="#000000" points="262.4486,-635.0243 257.1939,-644.2242 267.0389,-640.3091 262.4486,-635.0243"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M365.2687,-420.3169C359.5323,-422.7975 353.9519,-425.7513 349,-429.2562 285.9387,-473.891 294.7031,-509.764 242,-566.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-566.2562C211.9835,-598.4308 190.9346,-596.0286 171,-635.2562 154.4052,-667.9117 84.9027,-1225.2621 70.2281,-1344.0876"/>
<polygon fill="#000000" stroke="#000000" points="66.7332,-1343.8323 68.9828,-1354.1856 73.6805,-1344.6892 66.7332,-1343.8323"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M360.1844,-408.2562C343.4053,-408.2562 324.5439,-408.2562 306.8989,-408.2562"/>
<polygon fill="#000000" stroke="#000000" points="306.6753,-404.7563 296.6753,-408.2562 306.6752,-411.7563 306.6753,-404.7563"/>
</g>
<!-- sourcefile~mod_gauss_hermite.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~mod_gauss_hermite.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M236.3457,-2358.8496C222.778,-2328.5337 188.2275,-2247.9952 171,-2177.2562 96.2854,-1870.4663 73.2664,-1484.4634 68.5169,-1388.5766"/>
<polygon fill="#000000" stroke="#000000" points="72.0014,-1388.1668 68.026,-1378.3461 65.0094,-1388.5024 72.0014,-1388.1668"/>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2262.2562C535.074,-2263.1601 529.0904,-2268.5293 510,-2281.2562 490.9096,-2293.9832 493.1555,-2305.6275 474,-2318.2562 449.1576,-2334.6342 438.3584,-2355.0628 411.5,-2342.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-2342.2562C384.6416,-2329.4497 372.3853,-2336.6549 349,-2318.2562 283.2115,-2266.4964 311.0842,-2210.5276 242,-2163.2562"/>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.9754,-2231.1554C639.9593,-2242.4416 580.7108,-2260.6413 558,-2262.2562"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2262.2562C535.1139,-2263.8836 526.7863,-2258.8972 510,-2243.2562 482.9485,-2218.0505 498.0407,-2196.3481 474,-2168.2562 430.1545,-2117.0222 390.6015,-2135.3286 349,-2082.2562 283.7907,-1999.0666 254.9835,-1871.7948 245.6425,-1821.1479"/>
<polygon fill="#000000" stroke="#000000" points="249.0859,-1820.5201 243.894,-1811.2846 242.1933,-1821.742 249.0859,-1820.5201"/>
</g>
<!-- sourcefile~rys_lut.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~rys_lut.f90</title>
<g id="a_sourcefile~~tdhf_energy.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/rys_lut.f90.html" xlink:title="rys_lut.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="593,-2234.2562 523,-2234.2562 523,-2210.2562 593,-2210.2562 593,-2234.2562"/>
<text text-anchor="middle" x="558" y="-2219.8562" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rys_lut.F90</text>
</a>
</g>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~rys_lut.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~rys_lut.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.9147,-2222.2562C654.7595,-2222.2562 626.7859,-2222.2562 603.2549,-2222.2562"/>
<polygon fill="#000000" stroke="#000000" points="603.14,-2218.7563 593.14,-2222.2562 603.14,-2225.7563 603.14,-2218.7563"/>
</g>
<!-- sourcefile~dft_xclib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~dft_xclib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M520.5998,-962.3122C516.9566,-963.839 513.3667,-965.4909 510,-967.2562 492.5206,-976.4215 492.5155,-986.4219 474,-993.2562 425.4721,-1011.1685 280.6664,-977.8948 242,-1012.2562"/>
</g>
<!-- sourcefile~dft_xclib.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_energy.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~dft_xclib.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M527.6451,-938.2386C505.5467,-929.4897 475.4063,-917.557 451.3676,-908.04"/>
<polygon fill="#000000" stroke="#000000" points="452.4022,-904.6853 441.816,-904.2585 449.8255,-911.1938 452.4022,-904.6853"/>
</g>
</g>
</svg>
</div>                <script>
                  var pansourcefiletdhf_energyf90EfferentGraph = svgPanZoom('#sourcefiletdhf_energyf90EfferentGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#EfferentGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="EfferentGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a file to a file which it depends on. A file
is dependent upon another if the latter must be compiled before the former
can be.
</p>
 </div>
            </div>
          </div>
        </div>
          </div>
        </div>
<br>
      <section>
        <h2><span class="anchor" id="src"></span>Source Code</h2>
        <div class="hl codehilite"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="k">module </span><span class="n">tdhf_energy_mod</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="w">  </span><span class="k">implicit none</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">module_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tdhf_energy_mod&quot;</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="k">contains</span>
<a id="ln-7" name="ln-7" href="#ln-7"></a>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="k">  subroutine </span><span class="n">tdhf_energy_C</span><span class="p">(</span><span class="n">c_handle</span><span class="p">)</span><span class="w"> </span><span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tdhf_energy&quot;</span><span class="p">)</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="w">    </span><span class="k">use </span><span class="n">c_interop</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">oqp_handle_t</span><span class="p">,</span><span class="w"> </span><span class="n">oqp_handle_get_info</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a><span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">oqp_handle_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c_handle</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inf</span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="w">    </span><span class="n">inf</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">oqp_handle_get_info</span><span class="p">(</span><span class="n">c_handle</span><span class="p">)</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="w">    </span><span class="k">call </span><span class="n">tdhf_energy</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">tdhf_energy_C</span>
<a id="ln-16" name="ln-16" href="#ln-16"></a>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">tdhf_energy</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="w">    </span><span class="k">use </span><span class="n">io_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">iw</span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="w">    </span><span class="k">use </span><span class="n">oqp_tagarray_driver</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="w">    </span><span class="k">use </span><span class="n">strings</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">Cstring</span><span class="p">,</span><span class="w"> </span><span class="n">fstring</span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="w">    </span><span class="k">use </span><span class="n">basis_tools</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">basis_set</span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="w">    </span><span class="k">use </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">show_message</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="w">    </span><span class="k">use </span><span class="nb">precision</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="w">    </span><span class="k">use </span><span class="n">int2_compute</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int2_compute_t</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a><span class="w">    </span><span class="k">use </span><span class="n">tdhf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int2_td_data_t</span>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="w">    </span><span class="k">use </span><span class="n">tdhf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="w">      </span><span class="n">inivec</span><span class="p">,</span><span class="w"> </span><span class="n">iatogen</span><span class="p">,</span><span class="w"> </span><span class="n">mntoia</span><span class="p">,</span><span class="w"> </span><span class="n">rparedms</span><span class="p">,</span><span class="w"> </span><span class="n">rpaeig</span><span class="p">,</span><span class="w"> </span><span class="n">rpavnorm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="w">      </span><span class="n">rpaechk</span><span class="p">,</span><span class="w"> </span><span class="n">rpaprint</span><span class="p">,</span><span class="w"> </span><span class="n">rparesvec</span><span class="p">,</span><span class="w"> </span><span class="n">rpaexpndv</span><span class="p">,</span><span class="w"> </span><span class="n">rpanewb</span><span class="p">,</span><span class="w"> </span><span class="n">esum</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="w">      </span><span class="n">tdhf_unrelaxed_density</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="w">    </span><span class="k">use </span><span class="n">dft</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dft_initialize</span><span class="p">,</span><span class="w"> </span><span class="n">dftclean</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="w">    </span><span class="k">use </span><span class="n">mod_dft_gridint_fxc</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">tddft_fxc</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="w">    </span><span class="k">use </span><span class="n">util</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">measure_time</span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">symmetrize_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">orthogonal_transform</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="w">    </span><span class="k">use </span><span class="n">mod_dft_molgrid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dft_grid_t</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unpack_matrix</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="w">    </span><span class="k">use </span><span class="n">printing</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">print_module_info</span>
<a id="ln-39" name="ln-39" href="#ln-39"></a>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-41" name="ln-41" href="#ln-41"></a>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subroutine_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tdhf_energy&quot;</span>
<a id="ln-43" name="ln-43" href="#ln-43"></a>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">basis_set</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">infos</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ok</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scr2</span><span class="p">(:)</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ab1_mo</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">ab2_mo</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">abxc</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">scr3</span><span class="p">(:,:)</span>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">eex</span><span class="p">(:)</span>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">abm_l</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">abp_r</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">amb</span><span class="p">(:,:),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="w">                                  </span><span class="n">apb</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">vlo</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">vro</span><span class="p">(:,:)</span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vl</span><span class="p">(:),</span><span class="w"> </span><span class="n">vr</span><span class="p">(:)</span>
<a id="ln-55" name="ln-55" href="#ln-55"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vl_p</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">vr_p</span><span class="p">(:,:)</span>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xm</span><span class="p">(:)</span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">(:,:)</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bvec</span><span class="p">(:,:,:)</span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scr1</span><span class="p">(:,:)</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ab2</span><span class="p">(:,:,:)</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ab1</span><span class="p">(:,:,:)</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dip</span><span class="p">(:,:)</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nocc</span><span class="p">,</span><span class="w"> </span><span class="n">nvir</span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="n">lexc</span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ndsr</span><span class="p">,</span><span class="w"> </span><span class="n">mxvec</span><span class="p">,</span><span class="w"> </span><span class="n">nmax</span><span class="p">,</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="p">,</span><span class="w"> </span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="n">novec</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">istart</span><span class="p">,</span><span class="w"> </span><span class="n">nv</span><span class="p">,</span><span class="w"> </span><span class="n">iv</span><span class="p">,</span><span class="w"> </span><span class="n">ivec</span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mxiter</span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">do_apb</span><span class="p">,</span><span class="n">do_amb</span><span class="p">,</span><span class="w"> </span><span class="n">tamm_dancoff</span><span class="w">   </span><span class="c">! SWITCH FOR a-b, a+b, tANDAMM COFF</span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">imax</span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">converged</span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mxerr</span><span class="p">,</span><span class="w"> </span><span class="n">cnvtol</span><span class="p">,</span><span class="w"> </span><span class="n">scale_exch</span><span class="p">,</span><span class="w"> </span><span class="n">norm</span>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxvec</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<a id="ln-76" name="ln-76" href="#ln-76"></a>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">int2_compute_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int2_driver</span>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">int2_td_data_t</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int2_data</span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dft_grid_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">molGrid</span>
<a id="ln-80" name="ln-80" href="#ln-80"></a>
<a id="ln-81" name="ln-81" href="#ln-81"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dft</span>
<a id="ln-82" name="ln-82" href="#ln-82"></a>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">    </span><span class="c">! tagarray</span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">contiguous</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">      </span><span class="n">mo_energy_a</span><span class="p">(:),</span><span class="w"> </span><span class="n">mo_a</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">td_t</span><span class="p">(:,:),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">      </span><span class="n">xpy</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">xmy</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">td_energies</span><span class="p">(:)</span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tags_alloc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-88" name="ln-88" href="#ln-88"></a><span class="w">      </span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_xpy</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_xmy</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_energies</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tags_alpha</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">      </span><span class="n">OQP_E_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_A</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<a id="ln-91" name="ln-91" href="#ln-91"></a>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="w">    </span><span class="n">dft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">hamilton</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">20</span>
<a id="ln-93" name="ln-93" href="#ln-93"></a>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="w">  </span><span class="c">! Files open</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">  </span><span class="c">! 3. LOG: Write: Main output file</span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">    </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">IW</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">log_filename</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">)</span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">    </span><span class="k">call </span><span class="n">print_module_info</span><span class="p">(</span><span class="s1">&#39;THDF_Energy&#39;</span><span class="p">,</span><span class="s1">&#39;Computing Energy of TDDFT&#39;</span><span class="p">)</span>
<a id="ln-99" name="ln-99" href="#ln-99"></a>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">  </span><span class="c">! Readings</span>
<a id="ln-101" name="ln-101" href="#ln-101"></a>
<a id="ln-102" name="ln-102" href="#ln-102"></a><span class="w">  </span><span class="c">! Load basis set</span>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="w">    </span><span class="n">basis</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">basis</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="w">    </span><span class="n">basis</span><span class="p">%</span><span class="n">atoms</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a>
<a id="ln-106" name="ln-106" href="#ln-106"></a><span class="w">  </span><span class="c">! Allocate H, S ,T and D matrices</span>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="w">    </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">nbf</span>
<a id="ln-108" name="ln-108" href="#ln-108"></a><span class="w">    </span><span class="n">nbf2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">*</span><span class="p">(</span><span class="n">nbf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a id="ln-109" name="ln-109" href="#ln-109"></a>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="w">    </span><span class="k">call </span><span class="n">data_has_tags</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">tags_alpha</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="n">subroutine_name</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">mo_energy_a</span><span class="p">)</span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">)</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dft</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">dft_initialize</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">molGrid</span><span class="p">,</span><span class="w"> </span><span class="n">verbose</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">    </span><span class="n">nstates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">nstate</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">    </span><span class="n">maxvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">maxvec</span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="w">    </span><span class="n">cnvtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cnvtol</span>
<a id="ln-119" name="ln-119" href="#ln-119"></a>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="w">    </span><span class="n">do_apb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w">  </span><span class="c">! Always do A+B part</span>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="w">    </span><span class="n">do_amb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w">  </span><span class="c">! = isGGA ! Do A-B part if a hybrid functional.</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">    </span><span class="n">tamm_dancoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">tda</span><span class="w">  </span><span class="c">! Tamm/Dancoff approximation</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="w">    </span><span class="n">nocc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">nocc</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">    </span><span class="n">nvir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">-</span><span class="n">nocc</span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="w">    </span><span class="n">lexc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nocc</span><span class="o">*</span><span class="n">nvir</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">    </span><span class="n">mxvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">maxvec</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="n">lexc</span><span class="p">)</span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">    </span><span class="n">nvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">nstates</span><span class="p">,</span><span class="n">mxvec</span><span class="p">)</span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="w">    </span><span class="n">ndsr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nvec</span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="w">    </span><span class="n">nmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">nvec</span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">    </span><span class="c">!nvec = 2*nvec</span>
<a id="ln-133" name="ln-133" href="#ln-133"></a>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">  </span><span class="c">! Allocate TDDFT variables</span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">xm</span><span class="p">(</span><span class="n">lexc</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">             </span><span class="n">abxc</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="w">             </span><span class="n">bvec_mo</span><span class="p">(</span><span class="n">lexc</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">             </span><span class="n">ab1_mo</span><span class="p">(</span><span class="n">lexc</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">             </span><span class="n">ab2_mo</span><span class="p">(</span><span class="n">lexc</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="w">             </span><span class="n">bvec</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nmax</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">             </span><span class="n">eex</span><span class="p">(</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="w">             </span><span class="n">errors</span><span class="p">(</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">             </span><span class="n">apb</span><span class="p">(</span><span class="n">mxvec</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="w">             </span><span class="n">amb</span><span class="p">(</span><span class="n">mxvec</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">             </span><span class="n">vr</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">             </span><span class="n">vro</span><span class="p">(</span><span class="n">lexc</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">             </span><span class="n">vl</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="w">             </span><span class="n">vlo</span><span class="p">(</span><span class="n">lexc</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">             </span><span class="n">abp_r</span><span class="p">(</span><span class="n">lexc</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">             </span><span class="n">abm_l</span><span class="p">(</span><span class="n">lexc</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">             </span><span class="n">dip</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">             </span><span class="n">scr1</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="w">             </span><span class="n">scr2</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-154" name="ln-154" href="#ln-154"></a><span class="w">             </span><span class="n">scr3</span><span class="p">(</span><span class="n">lexc</span><span class="p">,</span><span class="n">nmax</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">             </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0d0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">             </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<a id="ln-157" name="ln-157" href="#ln-157"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ok</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">      </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span><span class="p">)</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a>
<a id="ln-160" name="ln-160" href="#ln-160"></a>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="w">  </span><span class="c">! Initialize ERI calculations</span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">)</span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">set_screening</span><span class="p">()</span>
<a id="ln-164" name="ln-164" href="#ln-164"></a>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="w">    </span><span class="n">scale_exch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_dp</span>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dft</span><span class="p">)</span><span class="w"> </span><span class="n">scale_exch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">HFscale</span>
<a id="ln-167" name="ln-167" href="#ln-167"></a>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="w">  </span><span class="c">! Construct TD trial vector</span>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="w">    </span><span class="k">call </span><span class="n">inivec</span><span class="p">(</span><span class="n">mo_energy_a</span><span class="p">,</span><span class="n">mo_energy_a</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">nocc</span><span class="p">,</span><span class="n">nocc</span><span class="p">,</span><span class="n">nvec</span><span class="p">)</span>
<a id="ln-170" name="ln-170" href="#ln-170"></a>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">    </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">    </span><span class="n">istart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a><span class="w">    </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nvec</span>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="w">    </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">    </span><span class="n">mxiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">maxit_dav</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">    </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="ln-177" name="ln-177" href="#ln-177"></a>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="w">    </span><span class="k">do </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">mxiter</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">      </span><span class="n">nv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="c">!$omp parallel private(iv,scr1,abxc,ivec)</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="c">!$omp do schedule(static)</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="w">      </span><span class="k">do </span><span class="n">ivec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="w">        </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivec</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">        </span><span class="k">call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="n">abxc</span><span class="p">,</span><span class="n">nocc</span><span class="p">,</span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">        </span><span class="k">call </span><span class="n">orthogonal_transform</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">abxc</span><span class="p">,</span><span class="w"> </span><span class="n">bvec</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">),</span><span class="w"> </span><span class="n">scr1</span><span class="p">)</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">      </span><span class="k">end do</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a><span class="c">!$omp end do</span>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="c">!$omp end parallel</span>
<a id="ln-190" name="ln-190" href="#ln-190"></a>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="w">      </span><span class="n">int2_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">int2_td_data_t</span><span class="p">(</span><span class="n">d2</span><span class="o">=</span><span class="n">bvec</span><span class="p">(:,:,:</span><span class="n">nv</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">              </span><span class="n">int_apb</span><span class="o">=</span><span class="n">do_apb</span><span class="p">,</span><span class="w"> </span><span class="n">int_amb</span><span class="o">=</span><span class="n">do_amb</span><span class="p">,</span><span class="w"> </span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="n">tamm_dancoff</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">              </span><span class="n">tamm_dancoff_coulomb</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="w">              </span><span class="n">scale_exchange</span><span class="o">=</span><span class="n">scale_exch</span><span class="p">)</span>
<a id="ln-195" name="ln-195" href="#ln-195"></a>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">      </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">run</span><span class="p">(</span><span class="n">int2_data</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-197" name="ln-197" href="#ln-197"></a><span class="w">                </span><span class="n">cam</span><span class="o">=</span><span class="n">dft</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_flag</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">                </span><span class="n">alpha</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="w">                </span><span class="n">beta</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,&amp;</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">                </span><span class="n">mu</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_mu</span><span class="p">)</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">      </span><span class="n">ab1</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">int2_data</span><span class="p">%</span><span class="n">apb</span><span class="p">(:,:,:,</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">      </span><span class="n">ab2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">int2_data</span><span class="p">%</span><span class="n">amb</span><span class="p">(:,:,:,</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dft</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="k">        do </span><span class="n">ivec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">          </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivec</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="w">          </span><span class="k">call </span><span class="n">symmetrize_matrix</span><span class="p">(</span><span class="n">bvec</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">),</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span>
<a id="ln-208" name="ln-208" href="#ln-208"></a><span class="w">        </span><span class="k">end do</span>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="k">        call </span><span class="n">tddft_fxc</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="w">               </span><span class="n">molGrid</span><span class="o">=</span><span class="n">molGrid</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">               </span><span class="n">isVecs</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">               </span><span class="n">wf</span><span class="o">=</span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">               </span><span class="n">fx</span><span class="o">=</span><span class="n">ab1</span><span class="p">(:,:,:</span><span class="n">iv</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="w">               </span><span class="n">dx</span><span class="o">=</span><span class="n">bvec</span><span class="p">(:,:,:</span><span class="n">iv</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">               </span><span class="n">nmtx</span><span class="o">=</span><span class="n">iv</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">               </span><span class="c">!threshold=1.0d-15, &amp;</span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">               </span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.0d0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">               </span><span class="n">infos</span><span class="o">=</span><span class="n">infos</span><span class="p">)</span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">      </span><span class="k">end if</span>
<a id="ln-220" name="ln-220" href="#ln-220"></a>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="c">!$omp parallel private(iv,ivec)</span>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="c">!$omp do schedule(static)</span>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="w">      </span><span class="k">do </span><span class="n">ivec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">        </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivec</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="w">  </span><span class="c">!     Convert AO to MO basis</span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tamm_dancoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="k">          </span><span class="n">ab1</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5_dp</span><span class="o">*</span><span class="n">ab1</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ab2</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">)</span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">        </span><span class="k">end if</span>
<a id="ln-229" name="ln-229" href="#ln-229"></a><span class="k">        call </span><span class="n">mntoia</span><span class="p">(</span><span class="n">ab1</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">),</span><span class="w"> </span><span class="n">ab1_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-230" name="ln-230" href="#ln-230"></a>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">  </span><span class="c">!     Product (A+B)*X</span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">        </span><span class="k">call </span><span class="n">esum</span><span class="p">(</span><span class="n">mo_energy_a</span><span class="p">,</span><span class="n">ab1_mo</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">nocc</span><span class="p">,</span><span class="n">ivec</span><span class="p">)</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">tamm_dancoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="c">!         Product (A-B)*X</span>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="w">          </span><span class="k">call </span><span class="n">mntoia</span><span class="p">(</span><span class="n">ab2</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">),</span><span class="n">ab2_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="n">mo_a</span><span class="p">,</span><span class="n">mo_a</span><span class="p">,</span><span class="n">nocc</span><span class="p">,</span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="w">          </span><span class="k">call </span><span class="n">esum</span><span class="p">(</span><span class="n">mo_energy_a</span><span class="p">,</span><span class="n">ab2_mo</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">nocc</span><span class="p">,</span><span class="n">ivec</span><span class="p">)</span>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="w">        </span><span class="k">end if</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="k">      end do</span>
<a id="ln-240" name="ln-240" href="#ln-240"></a><span class="c">!$omp end do</span>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="c">!$omp end parallel</span>
<a id="ln-242" name="ln-242" href="#ln-242"></a>
<a id="ln-243" name="ln-243" href="#ln-243"></a><span class="w">      </span><span class="k">call </span><span class="n">rparedms</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">ab1_mo</span><span class="p">,</span><span class="n">ab2_mo</span><span class="p">,</span><span class="n">apb</span><span class="p">,</span><span class="n">amb</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="p">)</span>
<a id="ln-244" name="ln-244" href="#ln-244"></a>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="w">      </span><span class="n">vl_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">vl</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="o">*</span><span class="n">nvec</span><span class="p">)</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="w">      </span><span class="n">vr_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">vr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="o">*</span><span class="n">nvec</span><span class="p">)</span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">      </span><span class="k">call </span><span class="n">rpaeig</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="n">vl_p</span><span class="p">,</span><span class="n">vr_p</span><span class="p">,</span><span class="n">apb</span><span class="p">,</span><span class="n">amb</span><span class="p">,</span><span class="n">scr2</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="p">)</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="w">      </span><span class="k">call </span><span class="n">rpavnorm</span><span class="p">(</span><span class="n">vr_p</span><span class="p">,</span><span class="n">vl_p</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="p">)</span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="w">      </span><span class="k">call </span><span class="n">rpaexpndv</span><span class="p">(</span><span class="n">vr_p</span><span class="p">,</span><span class="n">vl_p</span><span class="p">,</span><span class="n">vro</span><span class="p">,</span><span class="n">vlo</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">ndsr</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="p">)</span>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="w">      </span><span class="k">call </span><span class="n">rpaexpndv</span><span class="p">(</span><span class="n">vr_p</span><span class="p">,</span><span class="n">vl_p</span><span class="p">,</span><span class="n">abp_r</span><span class="p">,</span><span class="n">abm_l</span><span class="p">,</span><span class="n">ab1_mo</span><span class="p">,</span><span class="n">ab2_mo</span><span class="p">,</span><span class="n">ndsr</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="p">)</span>
<a id="ln-251" name="ln-251" href="#ln-251"></a>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="w">      </span><span class="k">call </span><span class="n">rpaechk</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">ndsr</span><span class="p">,</span><span class="n">imax</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="p">)</span>
<a id="ln-253" name="ln-253" href="#ln-253"></a><span class="c">!     Residual vectors W</span>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="c">!     Get perturbed vectors Q if required</span>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="w">      </span><span class="k">call </span><span class="n">rparesvec</span><span class="p">(</span><span class="n">scr3</span><span class="p">,</span><span class="n">abp_r</span><span class="p">,</span><span class="n">abm_l</span><span class="p">,</span><span class="n">vlo</span><span class="p">,</span><span class="n">vro</span><span class="p">,</span><span class="n">eex</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">ndsr</span><span class="p">,</span><span class="n">errors</span><span class="p">,</span><span class="n">cnvtol</span><span class="p">,</span><span class="n">imax</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="p">)</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="w">      </span><span class="n">mxerr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">errors</span><span class="p">(</span><span class="n">imax</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">ndsr</span><span class="p">))</span>
<a id="ln-258" name="ln-258" href="#ln-258"></a>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="w">      </span><span class="k">call </span><span class="n">rpaprint</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">,</span><span class="w"> </span><span class="n">cnvtol</span><span class="p">,</span><span class="w"> </span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">imax</span><span class="p">,</span><span class="w"> </span><span class="n">ndsr</span><span class="p">)</span>
<a id="ln-260" name="ln-260" href="#ln-260"></a>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="c">!     Check convergence</span>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">      </span><span class="n">converged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mxerr</span><span class="o">&lt;=</span><span class="n">cnvtol</span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">converged</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<a id="ln-264" name="ln-264" href="#ln-264"></a>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="c">!     No space left for new vectors, exit</span>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nvec</span><span class="o">==</span><span class="n">mxvec</span><span class="p">)</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="k">      call </span><span class="n">rpanewb</span><span class="p">(</span><span class="n">ndsr</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">scr3</span><span class="p">,</span><span class="n">novec</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="p">)</span>
<a id="ln-270" name="ln-270" href="#ln-270"></a>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="w">  </span><span class="c">!   ierr=1 nvec over mxvec: not converged case</span>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<a id="ln-273" name="ln-273" href="#ln-273"></a>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="k">      </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">novec</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="w">      </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nvec</span>
<a id="ln-276" name="ln-276" href="#ln-276"></a><span class="w">    </span><span class="k">end do</span>
<a id="ln-277" name="ln-277" href="#ln-277"></a>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">iter</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">mxiter</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">converged</span><span class="p">)</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<a id="ln-279" name="ln-279" href="#ln-279"></a>
<a id="ln-280" name="ln-280" href="#ln-280"></a><span class="w">    </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;TD-DFT energies NOT CONVERGED after &quot;,I4,&quot; iterations&quot;/)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">mxiter</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="c">!      call show_message(&quot;Aborting. Try to increase maxit or check your system.&quot;, WITH_ABORT)</span>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;TD-DFT energies converged in &quot;,I4,&quot; iterations&quot;/)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">iter</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;..something is wrong.. nvec = mxvec&quot;)&#39;</span><span class="p">)</span>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-292" name="ln-292" href="#ln-292"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,&quot;..something is wrong..  nvec &gt; mxvec&quot;)&#39;</span><span class="p">)</span>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(3x,&quot;nvec/mxvec =&quot;,I4,&quot;/&quot;,I4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="n">mxvec</span>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,&quot;..something is wrong.. No vectors were added&quot;)&#39;</span><span class="p">)</span>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">    </span><span class="k">end select</span>
<a id="ln-299" name="ln-299" href="#ln-299"></a>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="k">    call </span><span class="n">get_td_transition_dipole</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">vro</span><span class="p">,</span><span class="w"> </span><span class="n">vlo</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-301" name="ln-301" href="#ln-301"></a>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="w">    </span><span class="k">call </span><span class="n">td_print_results</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-303" name="ln-303" href="#ln-303"></a>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="w">    </span><span class="k">call </span><span class="n">measure_time</span><span class="p">(</span><span class="n">print_total</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">log_unit</span><span class="o">=</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-305" name="ln-305" href="#ln-305"></a>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="w">    </span><span class="c">! Bi-orthogonalize X+Y and X-Y:</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="w">    </span><span class="c">! (X+Y)_i \dot (X-Y)_j = \delta_ij</span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">    </span><span class="c">! only normalization is needed</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a><span class="w">    </span><span class="c">! RHF reference case: alpha == beta, additional factor of 1/sqrt(2)</span>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">    </span><span class="k">do </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<a id="ln-311" name="ln-311" href="#ln-311"></a><span class="w">        </span><span class="n">norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">dot_product</span><span class="p">(</span><span class="n">vlo</span><span class="p">(:,</span><span class="n">ist</span><span class="p">),</span><span class="w"> </span><span class="n">vro</span><span class="p">(:,</span><span class="n">ist</span><span class="p">)))</span>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">        </span><span class="n">vlo</span><span class="p">(:,</span><span class="n">ist</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vlo</span><span class="p">(:,</span><span class="n">ist</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">norm</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="w">        </span><span class="n">vro</span><span class="p">(:,</span><span class="n">ist</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vro</span><span class="p">(:,</span><span class="n">ist</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">norm</span>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="w">    </span><span class="k">end do</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="k">    call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">remove_records</span><span class="p">(</span><span class="n">tags_alloc</span><span class="p">)</span>
<a id="ln-317" name="ln-317" href="#ln-317"></a>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">            </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="w">            </span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="w">            </span><span class="n">comment</span><span class="o">=</span><span class="n">OQP_td_t_comment</span><span class="p">)</span>
<a id="ln-322" name="ln-322" href="#ln-322"></a>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_xpy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="w">            </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">            </span><span class="n">lexc</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">lexc</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">],</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-326" name="ln-326" href="#ln-326"></a><span class="w">            </span><span class="n">comment</span><span class="o">=</span><span class="s2">&quot;(X+Y) vector for target state in TD-DFT calculations&quot;</span><span class="p">)</span>
<a id="ln-327" name="ln-327" href="#ln-327"></a>
<a id="ln-328" name="ln-328" href="#ln-328"></a><span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_xmy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="w">            </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="w">            </span><span class="n">lexc</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">lexc</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">],</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="w">            </span><span class="n">comment</span><span class="o">=</span><span class="s2">&quot;(X-Y) vector for target state in TD-DFT calculations&quot;</span><span class="p">)</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="w">            </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">            </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">nstates</span><span class="p">],</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="w">            </span><span class="n">comment</span><span class="o">=</span><span class="n">OQP_td_energies_comment</span><span class="p">)</span>
<a id="ln-337" name="ln-337" href="#ln-337"></a>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="n">td_t</span><span class="p">)</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_xpy</span><span class="p">,</span><span class="w"> </span><span class="n">xpy</span><span class="p">)</span>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_xmy</span><span class="p">,</span><span class="w"> </span><span class="n">xmy</span><span class="p">)</span>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">    </span><span class="n">xpy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vro</span><span class="p">(:,:</span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">    </span><span class="n">xmy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vlo</span><span class="p">(:,:</span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_energies</span><span class="p">,</span><span class="w"> </span><span class="n">td_energies</span><span class="p">)</span>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">    </span><span class="n">td_energies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eex</span><span class="p">(:</span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="w">    </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">excited_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">td_energies</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">target_state</span><span class="p">)</span>
<a id="ln-347" name="ln-347" href="#ln-347"></a>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">clean</span><span class="p">()</span>
<a id="ln-349" name="ln-349" href="#ln-349"></a>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dft</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">dftclean</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="w">    </span><span class="k">close</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-353" name="ln-353" href="#ln-353"></a>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">tdhf_energy</span>
<a id="ln-355" name="ln-355" href="#ln-355"></a>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">get_td_transition_dipole</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">vr</span><span class="p">,</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="w">    </span><span class="k">use </span><span class="n">int1</span>
<a id="ln-358" name="ln-358" href="#ln-358"></a><span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">    </span><span class="k">use </span><span class="n">basis_tools</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">basis_set</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="w">    </span><span class="k">use </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">show_message</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">    </span><span class="k">use </span><span class="n">tdhf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">iatogen</span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">orthogonal_transform</span><span class="p">,</span><span class="w"> </span><span class="n">symmetrize_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">traceprod_sym_packed</span>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pack_matrix</span>
<a id="ln-364" name="ln-364" href="#ln-364"></a>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-366" name="ln-366" href="#ln-366"></a>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="k">    type</span><span class="p">(</span><span class="n">basis_set</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis</span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vl</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">vr</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">v</span><span class="p">(:,:)</span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dip</span><span class="p">(:,:)</span>
<a id="ln-370" name="ln-370" href="#ln-370"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span>
<a id="ln-371" name="ln-371" href="#ln-371"></a>
<a id="ln-372" name="ln-372" href="#ln-372"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">com</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mints</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">trden</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">trden_ao</span><span class="p">(:,:)</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tmp</span><span class="p">(:,:)</span>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tmp2</span><span class="p">(:)</span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="n">ok</span>
<a id="ln-377" name="ln-377" href="#ln-377"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span>
<a id="ln-378" name="ln-378" href="#ln-378"></a>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="w">    </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">nbf</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="w">    </span><span class="n">nbf2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">*</span><span class="p">(</span><span class="n">nbf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">mints</span><span class="p">(</span><span class="n">nbf2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-383" name="ln-383" href="#ln-383"></a><span class="w">             </span><span class="n">trden</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="w">             </span><span class="n">trden_ao</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a><span class="w">             </span><span class="n">tmp</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="w">             </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0d0</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<a id="ln-387" name="ln-387" href="#ln-387"></a>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ok</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a>
<a id="ln-390" name="ln-390" href="#ln-390"></a><span class="w">    </span><span class="c">! Compute dipole integrals at the center of mass</span>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">    </span><span class="n">com</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">atoms</span><span class="p">%</span><span class="n">center</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;mass&#39;</span><span class="p">)</span>
<a id="ln-392" name="ln-392" href="#ln-392"></a>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="w">    </span><span class="k">call </span><span class="n">multipole_integrals</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">mints</span><span class="p">,</span><span class="w"> </span><span class="n">com</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<a id="ln-394" name="ln-394" href="#ln-394"></a>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">    </span><span class="c">! Compute transition dipole between the ground state and all excited</span>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="w">    </span><span class="k">do </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">        </span><span class="c">! Compute transition density</span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">        </span><span class="c">! unpack X+Y</span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">        </span><span class="k">call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">vr</span><span class="p">(:,</span><span class="n">s1</span><span class="p">),</span><span class="w"> </span><span class="n">trden</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a><span class="w">        </span><span class="c">! unpack X-Y</span>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="w">        </span><span class="k">call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">vl</span><span class="p">(:,</span><span class="n">s1</span><span class="p">),</span><span class="w"> </span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-402" name="ln-402" href="#ln-402"></a><span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nocc</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="w">          </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span>
<a id="ln-404" name="ln-404" href="#ln-404"></a><span class="w">            </span><span class="n">trden</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trden</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tmp</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="c">! Y: vir -&gt; occ</span>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">            </span><span class="n">trden</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trden</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tmp</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="c">! X: occ -&gt; vir</span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="w">          </span><span class="k">end do</span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="k">        end do</span>
<a id="ln-408" name="ln-408" href="#ln-408"></a>
<a id="ln-409" name="ln-409" href="#ln-409"></a><span class="w">        </span><span class="c">! Convert transition density from MO to AO basis</span>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="w">        </span><span class="k">call </span><span class="n">orthogonal_transform</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">trden</span><span class="p">,</span><span class="w"> </span><span class="n">trden_ao</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">)</span>
<a id="ln-411" name="ln-411" href="#ln-411"></a>
<a id="ln-412" name="ln-412" href="#ln-412"></a><span class="w">        </span><span class="c">! Symmetrize and pack transition density to triangular format</span>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="w">        </span><span class="n">tmp2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nbf2</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">tmp</span>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="w">        </span><span class="k">call </span><span class="n">symmetrize_matrix</span><span class="p">(</span><span class="n">trden_ao</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="w">        </span><span class="k">call </span><span class="n">pack_matrix</span><span class="p">(</span><span class="n">trden_ao</span><span class="p">,</span><span class="w"> </span><span class="n">tmp2</span><span class="p">)</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a>
<a id="ln-417" name="ln-417" href="#ln-417"></a><span class="w">        </span><span class="c">! Compute dipole moment:</span>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">        </span><span class="c">! D_i = Tr(T * dipole_ints_i), i = x, y, z</span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="w">        </span><span class="n">dip</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">traceprod_sym_packed</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span><span class="w"> </span><span class="n">mints</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0d0</span><span class="p">))</span>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="w">        </span><span class="n">dip</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">traceprod_sym_packed</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span><span class="w"> </span><span class="n">mints</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0d0</span><span class="p">))</span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="w">        </span><span class="n">dip</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">traceprod_sym_packed</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span><span class="w"> </span><span class="n">mints</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0d0</span><span class="p">))</span>
<a id="ln-422" name="ln-422" href="#ln-422"></a><span class="w">    </span><span class="k">end do</span>
<a id="ln-423" name="ln-423" href="#ln-423"></a>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="k">  end subroutine</span>
<a id="ln-425" name="ln-425" href="#ln-425"></a>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="k">  subroutine </span><span class="n">td_print_results</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-427" name="ln-427" href="#ln-427"></a>
<a id="ln-428" name="ln-428" href="#ln-428"></a><span class="w">    </span><span class="k">use </span><span class="n">io_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">iw</span>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="w">    </span><span class="k">use </span><span class="n">physical_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">UNITS_EV</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-431" name="ln-431" href="#ln-431"></a>
<a id="ln-432" name="ln-432" href="#ln-432"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">energies</span><span class="p">(:)</span>
<a id="ln-433" name="ln-433" href="#ln-433"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dip</span><span class="p">(:,:)</span>
<a id="ln-434" name="ln-434" href="#ln-434"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span>
<a id="ln-435" name="ln-435" href="#ln-435"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nstates</span>
<a id="ln-436" name="ln-436" href="#ln-436"></a>
<a id="ln-437" name="ln-437" href="#ln-437"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">iw</span><span class="p">,</span><span class="s1">&#39;(/x,78(&quot;^&quot;))&#39;</span><span class="p">)</span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">iw</span><span class="p">,</span><span class="s1">&#39;(/8x,a/)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Summary of the TD-DFT calculation&quot;</span>
<a id="ln-440" name="ln-440" href="#ln-440"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">iw</span><span class="p">,</span><span class="s1">&#39;(A12,A16,3A12,a14)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Transition&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dE(eV)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DX&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DY&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DZ&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Osc.str.&#39;</span>
<a id="ln-441" name="ln-441" href="#ln-441"></a>
<a id="ln-442" name="ln-442" href="#ln-442"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<a id="ln-443" name="ln-443" href="#ln-443"></a><span class="w">      </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0d0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0d0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">dip</span><span class="p">(:,</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">dip</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a id="ln-444" name="ln-444" href="#ln-444"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="n">iw</span><span class="p">,</span><span class="s1">&#39;(3X,&quot;0 -&gt; &quot;,G0,t15,F15.6, 4F12.4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">UNITS_EV</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">f</span>
<a id="ln-445" name="ln-445" href="#ln-445"></a><span class="w">    </span><span class="k">end do</span>
<a id="ln-446" name="ln-446" href="#ln-446"></a><span class="k">    write</span><span class="p">(</span><span class="n">iw</span><span class="p">,</span><span class="s1">&#39;(x,78(&quot;=&quot;)/)&#39;</span><span class="p">)</span>
<a id="ln-447" name="ln-447" href="#ln-447"></a>
<a id="ln-448" name="ln-448" href="#ln-448"></a><span class="w">  </span><span class="k">end subroutine</span>
<a id="ln-449" name="ln-449" href="#ln-449"></a>
<a id="ln-450" name="ln-450" href="#ln-450"></a><span class="k">end module </span><span class="n">tdhf_energy_mod</span>
</pre></div>

      </section>
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              OPENQP
 was developed by OpenQP Team<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </body>
</html>