<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="">
    <meta name="author" content="OpenQP Team" >
    <link rel="icon" href="../favicon.png">

    <title>tdhf_gradient.F90 &ndash; OPENQP</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">OPENQP <small>v1.0-dev</small></a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">OPENQP</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tdhf_gradient.F90
      <small>Source File</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.5% of total for source files.">231 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tdhf_gradient.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
            <li class="breadcrumb-item active" aria-current="page">tdhf_gradient.F90</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#mods-0"
         aria-expanded="false" aria-controls="mods-0">
         <h4 class="card-header bg-primary text-white">Modules</h4>
      </a>
      <div id="mods-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tdhf_gradient_mod.html">tdhf_gradient_mod</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/tdhf_gradient.f90.html#src">tdhf_gradient.F90</a>
      </div>
    </div>


  </div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">This file depends on</h3>
          </div>
          <div class="card-body">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: sourcefile~~tdhf_gradient.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefiletdhf_gradientf90EfferentGraph" width="641pt" height="1266pt"
 viewBox="0.00 0.00 641.00 1266.09" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph" class="graph" transform="scale(.4655 .4655) rotate(0) translate(4 2715.8154)">
<title>sourcefile~~tdhf_gradient.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2715.8154 1373,-2715.8154 1373,4 -4,4"/>
<!-- sourcefile~tdhf_gradient.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~tdhf_gradient.f90</title>
<polygon fill="none" stroke="#000000" points="1369,-436.621 1263,-436.621 1263,-412.621 1369,-412.621 1369,-436.621"/>
<text text-anchor="middle" x="1316" y="-422.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">tdhf_gradient.F90</text>
</g>
<!-- sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~basis_tools.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/basis_tools.f90.html" xlink:title="basis_tools.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="604.5,-1558.621 511.5,-1558.621 511.5,-1534.621 604.5,-1534.621 604.5,-1558.621"/>
<text text-anchor="middle" x="558" y="-1544.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_tools.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-1558.621C1082.2657,-1654.1684 996.9117,-1498.6365 866,-1558.621"/>
</g>
<!-- sourcefile~c_interop.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~c_interop.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/c_interop.f90.html" xlink:title="c_interop.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1086,-1454.621 1001,-1454.621 1001,-1430.621 1086,-1430.621 1086,-1454.621"/>
<text text-anchor="middle" x="1043.5" y="-1440.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">c_interop.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~c_interop.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~c_interop.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1315.6086,-436.7889C1311.7199,-553.9386 1278.2873,-1479.2375 1190,-1558.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-1558.621C1166.4509,-1579.7951 1093.6145,-1501.2061 1060.3636,-1462.7044"/>
<polygon fill="#000000" stroke="#000000" points="1062.6948,-1460.045 1053.537,-1454.7172 1057.3735,-1464.593 1062.6948,-1460.045"/>
</g>
<!-- sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~constants.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/constants.f90.html" xlink:title="constants.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="285,-1212.621 199,-1212.621 199,-1188.621 285,-1188.621 285,-1212.621"/>
<text text-anchor="middle" x="242" y="-1198.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-384.621C1171.8166,-387.9517 1164.0388,-388.7928 1153,-403.621 1100.6338,-473.9633 1177.8404,-534.4647 1117,-597.621 1070.545,-645.8443 1016.4109,-582.3552 970,-630.621 908.6116,-694.463 994.3512,-761.7975 934,-826.621 861.4276,-904.5713 808.0403,-876.6981 702,-886.621"/>
</g>
<!-- sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~constants_io.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/constants_io.f90.html" xlink:title="constants_io.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="118,-278.621 17,-278.621 17,-254.621 118,-254.621 118,-278.621"/>
<text text-anchor="middle" x="67.5" y="-264.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants_io.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1313.8615,-412.3303C1301.0259,-342.6166 1228.4433,-1.3057 1043.5,-38.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-38.621C962.8413,-36.9275 946.5234,4.3467 866,-.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-.621C785.8173,-5.5676 781.6684,-86.9495 702,-76.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-76.621C499.2523,-50.336 432.7307,-3.0048 242,-76.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-76.621C162.1324,-112.2731 102.5709,-204.0981 78.8121,-245.6466"/>
<polygon fill="#000000" stroke="#000000" points="75.7483,-243.9546 73.9191,-254.3903 81.8568,-247.373 75.7483,-243.9546"/>
</g>
<!-- sourcefile~dft.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~dft.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/dft.f90.html" xlink:title="dft.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1217,-1629.621 1163,-1629.621 1163,-1605.621 1217,-1605.621 1217,-1629.621"/>
<text text-anchor="middle" x="1190" y="-1615.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~dft.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~dft.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1315.4956,-436.9295C1310.6595,-553.5237 1271.7027,-1461.5898 1227,-1572.621 1223.2827,-1581.8538 1216.9561,-1590.6378 1210.5754,-1597.9537"/>
<polygon fill="#000000" stroke="#000000" points="1208.0141,-1595.5683 1203.7514,-1605.2678 1213.1324,-1600.3436 1208.0141,-1595.5683"/>
</g>
<!-- sourcefile~dft_gridint_tdxc_grad.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dft_gridint_tdxc_grad.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dft_gridint_tdxc_grad.f90.html" xlink:title="dft_gridint_tdxc_grad.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1117,-1808.621 970,-1808.621 970,-1784.621 1117,-1784.621 1117,-1808.621"/>
<text text-anchor="middle" x="1043.5" y="-1794.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_gridint_tdxc_grad.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~dft_gridint_tdxc_grad.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~dft_gridint_tdxc_grad.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1315.9521,-436.7471C1315.193,-609.98 1304.0494,-2581.4291 1190,-2601.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-2601.621C1017.7036,-2632.1252 1228.7386,-1952.2724 1117,-1817.621 1116.2796,-1816.7529 1115.5261,-1815.9193 1114.7423,-1815.1189"/>
<polygon fill="#000000" stroke="#000000" points="1116.9179,-1812.3768 1106.9543,-1808.7744 1112.4968,-1817.804 1116.9179,-1812.3768"/>
</g>
<!-- sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dft_molgrid.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dft_molgrid.f90.html" xlink:title="dft_molgrid.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="606,-2212.621 510,-2212.621 510,-2188.621 606,-2188.621 606,-2212.621"/>
<text text-anchor="middle" x="558" y="-2198.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_molgrid.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-2601.621C1046.0276,-2627.1106 1010.5457,-2680.6281 866,-2658.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2658.621C799.8038,-2641.4971 821.1846,-2584.9454 798,-2520.621 774.6063,-2455.7162 808.0282,-2421.0146 762,-2369.621 724.2031,-2327.4182 686.6366,-2361.5101 642,-2326.621 605.8415,-2298.3586 579.9377,-2250.0537 567.116,-2222.1808"/>
<polygon fill="#000000" stroke="#000000" points="570.2539,-2220.6234 562.9893,-2212.9112 563.8589,-2223.4703 570.2539,-2220.6234"/>
</g>
<!-- sourcefile~grd1.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~grd1.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/grd1.f90.html" xlink:title="grd1.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1073.5,-588.621 1013.5,-588.621 1013.5,-564.621 1073.5,-564.621 1073.5,-588.621"/>
<text text-anchor="middle" x="1043.5" y="-574.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grd1.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~grd1.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~grd1.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-384.621C1171.8166,-387.9517 1164.4546,-389.1116 1153,-403.621 1111.3206,-456.4155 1162.1304,-500.7442 1117,-550.621 1108.2577,-560.2827 1095.6971,-566.3546 1083.426,-570.1702"/>
<polygon fill="#000000" stroke="#000000" points="1082.4772,-566.8009 1073.7253,-572.7721 1084.2907,-573.5619 1082.4772,-566.8009"/>
</g>
<!-- sourcefile~grd2.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~grd2.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/grd2.f90.html" xlink:title="grd2.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1220,-436.621 1160,-436.621 1160,-412.621 1220,-412.621 1220,-436.621"/>
<text text-anchor="middle" x="1190" y="-422.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grd2.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~grd2.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~grd2.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1262.9298,-424.621C1251.9335,-424.621 1240.5232,-424.621 1230.0846,-424.621"/>
<polygon fill="#000000" stroke="#000000" points="1230.0213,-421.1211 1220.0213,-424.621 1230.0213,-428.1211 1230.0213,-421.1211"/>
</g>
<!-- sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~mathlib.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/mathlib.f90.html" xlink:title="mathlib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="904,-280.621 828,-280.621 828,-256.621 904,-256.621 904,-280.621"/>
<text text-anchor="middle" x="866" y="-266.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mathlib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-38.621C992.0586,-47.6116 907.7054,-192.5354 877.3377,-247.6092"/>
<polygon fill="#000000" stroke="#000000" points="874.1981,-246.0557 872.4705,-256.5088 880.3397,-249.4146 874.1981,-246.0557"/>
</g>
<!-- sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~messages.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/messages.f90.html" xlink:title="messages.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="286,-531.621 198,-531.621 198,-507.621 286,-507.621 286,-531.621"/>
<text text-anchor="middle" x="242" y="-517.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">messages.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-38.621C785.1835,-83.7682 667.2463,-80.7656 510,-290.621 477.3758,-334.1601 503.1272,-361.6688 474,-407.621 453.8728,-439.3744 445.1995,-447.9558 411.5,-464.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-464.621C374.7227,-483.3054 330.2734,-497.4469 296.1213,-506.7091"/>
<polygon fill="#000000" stroke="#000000" points="295.0933,-503.3607 286.3258,-509.309 296.8891,-510.1264 295.0933,-503.3607"/>
</g>
<!-- sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~precision.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/precision.f90.html" xlink:title="precision.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="109.5,-1212.621 25.5,-1212.621 25.5,-1188.621 109.5,-1188.621 109.5,-1212.621"/>
<text text-anchor="middle" x="67.5" y="-1198.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2658.621C821.0937,-2646.9069 600.3064,-2620.621 558,-2620.621 558,-2620.621 558,-2620.621 411.5,-2620.621 357.889,-2620.621 208.812,-2639.6261 171,-2601.621 120.1352,-2550.4963 74.8985,-1397.5918 68.3202,-1222.7547"/>
<polygon fill="#000000" stroke="#000000" points="71.8146,-1222.5371 67.9432,-1212.675 64.8195,-1222.7988 71.8146,-1222.5371"/>
</g>
<!-- sourcefile~printing.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~printing.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/printing.f90.html" xlink:title="printing.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1081.5,-396.621 1005.5,-396.621 1005.5,-372.621 1081.5,-372.621 1081.5,-396.621"/>
<text text-anchor="middle" x="1043.5" y="-382.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">printing.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~printing.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~printing.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1297.1701,-412.4773C1272.8665,-398.2494 1229.0552,-377.4671 1190,-384.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-384.621C1157.6919,-390.5389 1120.6991,-390.4862 1091.9697,-388.9807"/>
<polygon fill="#000000" stroke="#000000" points="1091.975,-385.4748 1081.7831,-388.3687 1091.5552,-392.4622 1091.975,-385.4748"/>
</g>
<!-- sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~strings.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/strings.f90.html" xlink:title="strings.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="102.5,-2473.621 32.5,-2473.621 32.5,-2449.621 102.5,-2449.621 102.5,-2473.621"/>
<text text-anchor="middle" x="67.5" y="-2459.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">strings.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2658.621C830.649,-2649.7608 736.5213,-2646.9387 702,-2658.621"/>
</g>
<!-- sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~tagarray_driver.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/tagarray_driver.f90.html" xlink:title="tagarray_driver.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="924.5,-436.621 807.5,-436.621 807.5,-412.621 924.5,-412.621 924.5,-436.621"/>
<text text-anchor="middle" x="866" y="-422.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tagarray_driver.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-384.621C1123.6101,-396.7818 1110.8392,-420.0456 1043.5,-424.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-424.621C1007.8507,-427.0431 968.081,-427.2711 935.2368,-426.7957"/>
<polygon fill="#000000" stroke="#000000" points="934.8886,-423.2893 924.8304,-426.6185 934.7694,-430.2883 934.8886,-423.2893"/>
</g>
<!-- sourcefile~tdhf_lib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~tdhf_lib.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/tdhf_lib.f90.html" xlink:title="tdhf_lib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1227,-356.621 1153,-356.621 1153,-332.621 1227,-332.621 1227,-356.621"/>
<text text-anchor="middle" x="1190" y="-342.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tdhf_lib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~tdhf_lib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~tdhf_lib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1296.8633,-412.4707C1275.7417,-399.0601 1241.5615,-377.3584 1217.5572,-362.1176"/>
<polygon fill="#000000" stroke="#000000" points="1219.2221,-359.0288 1208.9039,-356.6235 1215.47,-364.9383 1219.2221,-359.0288"/>
</g>
<!-- sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~types.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/types.f90.html" xlink:title="types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="898,-1677.621 834,-1677.621 834,-1653.621 898,-1653.621 898,-1677.621"/>
<text text-anchor="middle" x="866" y="-1663.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-1558.621C1172.4714,-1574.3818 1167.3146,-1577.8927 1153,-1596.621 1133.8832,-1621.6321 1144.0855,-1641.5777 1117,-1657.621 1052.2919,-1695.9487 960.8229,-1686.2562 908.0379,-1675.8557"/>
<polygon fill="#000000" stroke="#000000" points="908.5181,-1672.381 898.0161,-1673.7802 907.0985,-1679.2355 908.5181,-1672.381"/>
</g>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~util.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/util.f90.html" xlink:title="util.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1070.5,-2402.621 1016.5,-2402.621 1016.5,-2378.621 1070.5,-2378.621 1070.5,-2402.621"/>
<text text-anchor="middle" x="1043.5" y="-2388.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">util.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~tdhf_gradient.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1190,-2601.621C1099.0346,-2617.726 1059.36,-2469.6113 1047.5307,-2412.4976"/>
<polygon fill="#000000" stroke="#000000" points="1050.9582,-2411.7879 1045.5842,-2402.6571 1044.0912,-2413.1462 1050.9582,-2411.7879"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M548.7978,-1534.5456C534.2095,-1515.8691 504.3085,-1479.4402 474,-1453.621 423.6065,-1410.6917 393.7044,-1421.4465 349,-1372.621 325.9075,-1347.3996 330.6682,-1333.8992 313,-1304.621 294.994,-1274.7828 271.8823,-1241.7789 257.0053,-1221.1215"/>
<polygon fill="#000000" stroke="#000000" points="259.6864,-1218.8565 250.9849,-1212.8121 254.0178,-1222.9636 259.6864,-1218.8565"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.0403,-1534.5912C548.6267,-1488.5701 522.1046,-1319.2027 510,-1178.621 505.9216,-1131.2541 505.9439,-358.8323 474,-323.621 386.9758,-227.6954 218.632,-239.2442 128.2952,-254.0143"/>
<polygon fill="#000000" stroke="#000000" points="127.4787,-250.6028 118.2073,-255.7304 128.6527,-257.5037 127.4787,-250.6028"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.8621,-1534.4C543.4754,-1504.7819 514.2265,-1427.564 474,-1372.621 428.8678,-1310.9775 381.278,-1323.8667 349,-1254.621 290.8796,-1129.9355 353.8913,-767.9691 313,-636.621 301.4653,-599.57 275.7508,-562.1742 258.6437,-539.9535"/>
<polygon fill="#000000" stroke="#000000" points="261.2744,-537.6367 252.3395,-531.943 255.7736,-541.9659 261.2744,-537.6367"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1966.621C393.2886,-1989.232 371.2733,-1966.998 349,-1985.621 268.942,-2052.5582 319.1287,-2264.9135 242,-2194.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-2194.621C92.4201,-2058.2987 70.702,-1358.5565 67.8876,-1223.2785"/>
<polygon fill="#000000" stroke="#000000" points="71.38,-1222.847 67.687,-1212.9166 64.3813,-1222.9825 71.38,-1222.847"/>
</g>
<!-- sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~atomic_structure.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/atomic_structure.f90.html" xlink:title="atomic_structure.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="474,-2368.621 349,-2368.621 349,-2344.621 474,-2344.621 474,-2368.621"/>
<text text-anchor="middle" x="411.5" y="-2354.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atomic_structure.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.4732,-1558.7515C550.3524,-1607.5093 527.0974,-1793.9656 510,-1947.621 501.3533,-2025.3295 508.5956,-2227.503 474,-2297.621 465.9843,-2313.867 451.5147,-2327.9734 438.5155,-2338.3157"/>
<polygon fill="#000000" stroke="#000000" points="436.1327,-2335.7295 430.268,-2344.5532 440.3551,-2341.3126 436.1327,-2335.7295"/>
</g>
<!-- sourcefile~basis_library.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~basis_library.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/basis_library.f90.html" xlink:title="basis_library.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="461.5,-1938.621 361.5,-1938.621 361.5,-1914.621 461.5,-1914.621 461.5,-1938.621"/>
<text text-anchor="middle" x="411.5" y="-1924.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_library.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~basis_library.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~basis_library.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M526.8375,-1558.7527C520.5432,-1562.4084 514.489,-1566.9882 510,-1572.621 467.7247,-1625.6673 427.7138,-1834.8682 415.3784,-1904.1802"/>
<polygon fill="#000000" stroke="#000000" points="411.8653,-1903.9491 413.5799,-1914.4043 418.7595,-1905.1619 411.8653,-1903.9491"/>
</g>
<!-- sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~elements.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/elements.f90.html" xlink:title="elements.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="284.5,-1958.621 199.5,-1958.621 199.5,-1934.621 284.5,-1934.621 284.5,-1958.621"/>
<text text-anchor="middle" x="242" y="-1944.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">elements.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~elements.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.0949,-1558.7913C519.2137,-1562.3866 513.7683,-1566.9321 510,-1572.621 463.769,-1642.4145 527.0099,-1882.8259 474,-1947.621 455.6161,-1970.092 429.7114,-1944.0099 411.5,-1966.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1966.621C396.8554,-1984.8035 336.0151,-1973.0232 291.3999,-1961.2781"/>
<polygon fill="#000000" stroke="#000000" points="292.1493,-1957.8551 281.5826,-1958.6268 290.3242,-1964.613 292.1493,-1957.8551"/>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="449.5,-2018.621 373.5,-2018.621 373.5,-1994.621 449.5,-1994.621 449.5,-2018.621"/>
<text text-anchor="middle" x="411.5" y="-2004.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.061,-1558.7689C519.1822,-1562.3658 513.7463,-1566.9177 510,-1572.621 460.0289,-1648.6955 527.7916,-1907.1982 474,-1980.621 469.9868,-1986.0987 464.6013,-1990.4283 458.6673,-1993.8489"/>
<polygon fill="#000000" stroke="#000000" points="457.1277,-1990.7056 449.6769,-1998.238 460.1987,-1996.9961 457.1277,-1990.7056"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1000.6496,-1451.9371C989.8017,-1455.7859 978.7569,-1461.159 970,-1468.621 944.5678,-1490.2924 959.4399,-1512.9586 934,-1534.621 909.5986,-1555.3991 895.166,-1545.3355 866,-1558.621"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1031.0799,-1430.4882C1013.755,-1412.6534 983.0001,-1377.4649 970,-1340.621 871.3657,-1061.0798 1028.8188,-955.4793 934,-674.621 916.8083,-623.6981 908.0522,-608.0919 866,-574.621"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1036.6015,-1454.7065C1021.3036,-1482.2126 984.7263,-1552.038 970,-1615.621 936.2068,-1761.5281 998.3058,-2153.3596 934,-2288.621 793.4626,-2584.2282 569.1009,-2528.8137 242,-2540.621"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1031.0298,-1430.5058C1013.6439,-1412.6923 982.8154,-1377.5295 970,-1340.621 910.3174,-1168.7339 992.15,-695.0325 934,-522.621 923.7382,-492.1953 900.9613,-462.6748 884.5942,-444.1247"/>
<polygon fill="#000000" stroke="#000000" points="887.1204,-441.7001 877.8105,-436.6427 881.9346,-446.402 887.1204,-441.7001"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1026.4905,-1454.6413C1010.5133,-1466.5333 986.6386,-1485.913 970,-1506.621 949.0716,-1532.668 951.8998,-1544.4067 934,-1572.621 917.5349,-1598.5737 896.3358,-1626.8781 882.0181,-1645.3602"/>
<polygon fill="#000000" stroke="#000000" points="879.1729,-1643.3171 875.7796,-1653.3539 884.6913,-1647.6239 879.1729,-1643.3171"/>
</g>
<!-- sourcefile~constants.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~constants.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M198.8652,-1200.621C174.9148,-1200.621 144.946,-1200.621 119.6827,-1200.621"/>
<polygon fill="#000000" stroke="#000000" points="119.5366,-1197.1211 109.5365,-1200.621 119.5365,-1204.1211 119.5366,-1197.1211"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-1714.621C966.5792,-1732.1325 944.5051,-1722.3932 866,-1714.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1714.621C761.3818,-1704.2635 722.4568,-1706.2889 642,-1638.621 616.4285,-1617.1141 629.6612,-1596.2131 606,-1572.621 602.8184,-1569.4487 599.1692,-1566.5597 595.3346,-1563.9579"/>
<polygon fill="#000000" stroke="#000000" points="597.113,-1560.9429 586.7535,-1558.7223 593.467,-1566.9185 597.113,-1560.9429"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1176.8702,-1605.533C1168.6166,-1597.1333 1158.5192,-1585.2205 1153,-1572.621 1106.1926,-1465.7652 1193.2098,-1400.9451 1117,-1312.621 1072.5308,-1261.0829 1027.1849,-1306.5475 970,-1269.621 949.3464,-1256.2841 955.7086,-1239.1614 934,-1227.621 850.2495,-1183.0985 604.0719,-1190.7399 510,-1178.621 466.1447,-1172.9712 455.5526,-1160.8033 411.5,-1164.621"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1176.0331,-1605.3515C1167.6606,-1597.0504 1157.7455,-1585.3161 1153,-1572.621 1101.7041,-1435.396 1180.6262,-386.5819 1117,-254.621 1070.8326,-158.8696 1031.8544,-142.1453 934,-100.621 838.5749,-60.1274 804.9207,-88.991 702,-76.621"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.6426,-1629.9036C1186.767,-1725.3351 1166.2313,-2346.3455 1117,-2411.621 1045.1767,-2506.851 985.1304,-2512.5627 866,-2506.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2506.621C777.7458,-2514.1264 829.6792,-2393.7582 762,-2336.621 740.0541,-2318.0935 725.3762,-2329.3076 702,-2312.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2312.621C678.6238,-2295.9344 665.7919,-2304.7092 642,-2288.621 614.1095,-2269.7612 588.3826,-2240.2672 572.9393,-2220.6957"/>
<polygon fill="#000000" stroke="#000000" points="575.6671,-2218.5015 566.7852,-2212.7254 570.1265,-2222.7796 575.6671,-2218.5015"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1176.0438,-1605.3475C1167.6755,-1597.0448 1157.7612,-1585.3102 1153,-1572.621 1105.7881,-1446.7938 1195.0181,-473.0496 1117,-363.621 1092.7838,-329.6552 979.6482,-296.7276 913.8288,-280.0027"/>
<polygon fill="#000000" stroke="#000000" points="914.6361,-276.5968 904.0849,-277.5571 912.932,-283.3862 914.6361,-276.5968"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-536.621C985.8747,-482.7435 941.9657,-557.897 866,-536.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-536.621C730.6297,-498.7072 698.5159,-468.8456 558,-464.621"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2506.621C725.5566,-2519.0777 697.4648,-2603.3352 558,-2582.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2582.621C449.9699,-2575.9687 428.5922,-2530.9684 349,-2457.621 248.964,-2365.4338 219.1095,-2335.8654 171,-2208.621 99.2878,-2018.9499 72.8006,-1353.4721 68.2401,-1222.935"/>
<polygon fill="#000000" stroke="#000000" points="71.737,-1222.7837 67.8966,-1212.9095 64.7411,-1223.0235 71.737,-1222.7837"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2506.621C766.8868,-2513.9087 799.0506,-2637.2264 702,-2658.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2658.621C471.2983,-2709.4785 373.8188,-2755.7586 171,-2634.621 113.8714,-2600.4998 84.5117,-2521.6394 73.1845,-2483.3134"/>
<polygon fill="#000000" stroke="#000000" points="76.5421,-2482.3242 70.4598,-2473.6492 69.8048,-2484.2238 76.5421,-2482.3242"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1176.068,-1605.3383C1167.7094,-1597.032 1157.7968,-1585.2968 1153,-1572.621 1112.9814,-1466.8688 1187.7994,-643.7824 1117,-555.621 1095.8734,-529.3135 1068.1461,-559.6641 1043.5,-536.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-536.621C998.2976,-494.3584 987.8407,-481.1261 934,-450.621 927.4982,-446.9372 920.3725,-443.5681 913.2579,-440.5649"/>
<polygon fill="#000000" stroke="#000000" points="914.2069,-437.1746 903.6226,-436.7011 911.6015,-443.6717 914.2069,-437.1746"/>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1180.9451,-1629.7176C1168.3066,-1645.8035 1143.8844,-1674.1193 1117,-1690.621 1087.7129,-1708.5975 1077.0067,-1706.9929 1043.5,-1714.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-1714.621C1017.4186,-1720.5586 949.5885,-1697.7955 905.7355,-1681.3171"/>
<polygon fill="#000000" stroke="#000000" points="906.8167,-1677.9838 896.2256,-1677.7013 904.3289,-1684.5268 906.8167,-1677.9838"/>
</g>
<!-- sourcefile~bragg_slater.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~bragg_slater.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/bragg_slater.f90.html" xlink:title="bragg_slater.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462,-2448.621 361,-2448.621 361,-2424.621 462,-2424.621 462,-2448.621"/>
<text text-anchor="middle" x="411.5" y="-2434.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bragg_slater.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~bragg_slater.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~bragg_slater.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2506.621C707.989,-2520.0588 663.5684,-2522.1786 510,-2482.621 485.3404,-2476.2689 459.3136,-2463.835 440.2104,-2453.4944"/>
<polygon fill="#000000" stroke="#000000" points="441.8677,-2450.4113 431.425,-2448.6221 438.4727,-2456.5329 441.8677,-2450.4113"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dft_fuzzycell.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dft_fuzzycell.f90.html" xlink:title="dft_fuzzycell.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="752,-2402.621 652,-2402.621 652,-2378.621 752,-2378.621 752,-2402.621"/>
<text text-anchor="middle" x="702" y="-2388.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_fuzzycell.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~dft_fuzzycell.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~dft_fuzzycell.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2506.621C804.949,-2503.576 813.7532,-2449.1494 762,-2416.621 756.3171,-2413.0491 750.0587,-2409.7402 743.7938,-2406.7634"/>
<polygon fill="#000000" stroke="#000000" points="745.2311,-2403.5722 734.6766,-2402.6477 742.3509,-2409.9522 745.2311,-2403.5722"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dft_gridint_energy.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dft_gridint_energy.f90.html" xlink:title="dft_gridint_energy.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1108.5,-1766.621 978.5,-1766.621 978.5,-1742.621 1108.5,-1742.621 1108.5,-1766.621"/>
<text text-anchor="middle" x="1043.5" y="-1752.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_gridint_energy.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~dft_gridint_energy.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~dft_gridint_energy.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1185.1302,-1629.8441C1175.493,-1652.5286 1151.861,-1701.3112 1117,-1728.621 1112.2901,-1732.3106 1107.0154,-1735.5013 1101.5113,-1738.2553"/>
<polygon fill="#000000" stroke="#000000" points="1099.7775,-1735.1971 1092.091,-1742.4887 1102.6469,-1741.582 1099.7775,-1735.1971"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dft_gridint_grad.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/dft_gridint_grad.f90.html" xlink:title="dft_gridint_grad.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1103,-1850.621 984,-1850.621 984,-1826.621 1103,-1826.621 1103,-1850.621"/>
<text text-anchor="middle" x="1043.5" y="-1836.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_gridint_grad.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~dft_gridint_grad.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~dft_gridint_grad.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.2399,-1630.0473C1186.4196,-1664.9908 1173.5478,-1764.9876 1117,-1817.621 1115.3425,-1819.1637 1113.5795,-1820.5941 1111.7323,-1821.9203"/>
<polygon fill="#000000" stroke="#000000" points="1109.9147,-1818.9291 1103.1609,-1827.0923 1113.5312,-1824.9226 1109.9147,-1818.9291"/>
</g>
<!-- sourcefile~grid_storage.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~grid_storage.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/grid_storage.f90.html" xlink:title="grid_storage.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462.5,-2246.621 360.5,-2246.621 360.5,-2222.621 462.5,-2222.621 462.5,-2246.621"/>
<text text-anchor="middle" x="411.5" y="-2232.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_storage.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~grid_storage.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~grid_storage.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2312.621C633.2538,-2263.548 535.4117,-2245.3483 472.6836,-2238.5989"/>
<polygon fill="#000000" stroke="#000000" points="472.846,-2235.0976 462.5449,-2237.5748 472.1425,-2242.0621 472.846,-2235.0976"/>
</g>
<!-- sourcefile~libxc.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~libxc.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/libxc.f90.html" xlink:title="libxc.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1073.5,-1648.621 1013.5,-1648.621 1013.5,-1624.621 1073.5,-1624.621 1073.5,-1648.621"/>
<text text-anchor="middle" x="1043.5" y="-1634.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libxc.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~libxc.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~libxc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1162.7878,-1621.1502C1140.5333,-1624.0364 1108.7444,-1628.1592 1083.5781,-1631.4231"/>
<polygon fill="#000000" stroke="#000000" points="1083.0623,-1627.9606 1073.5955,-1632.7178 1083.9626,-1634.9025 1083.0623,-1627.9606"/>
</g>
<!-- sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~physical_constants.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/physical_constants.f90.html" xlink:title="physical_constants.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="135,-624.621 0,-624.621 0,-600.621 135,-600.621 135,-624.621"/>
<text text-anchor="middle" x="67.5" y="-610.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">physical_constants.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-536.621C1018.8539,-513.5778 999.6511,-539.5203 970,-555.621 950.9256,-565.9785 953.7964,-579.7207 934,-588.621 839.4545,-631.1278 805.6614,-612.621 702,-612.621 702,-612.621 702,-612.621 411.5,-612.621 319.9967,-612.621 214.8023,-612.621 145.0811,-612.621"/>
<polygon fill="#000000" stroke="#000000" points="145.0577,-609.1211 135.0576,-612.621 145.0576,-616.1211 145.0577,-609.1211"/>
</g>
<!-- sourcefile~radial_grid_types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~radial_grid_types.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/radial_grid_types.f90.html" xlink:title="radial_grid_types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="305,-2592.621 179,-2592.621 179,-2568.621 305,-2568.621 305,-2592.621"/>
<text text-anchor="middle" x="242" y="-2578.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">radial_grid_types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft.f90&#45;&gt;sourcefile~radial_grid_types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dft.f90&#45;&gt;sourcefile~radial_grid_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2582.621C475.4169,-2571.5494 379.6014,-2572.9106 315.3199,-2575.8495"/>
<polygon fill="#000000" stroke="#000000" points="315.1008,-2572.3559 305.2808,-2576.3331 315.4376,-2579.3478 315.1008,-2572.3559"/>
</g>
<!-- sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M969.8948,-1805.9996C937.8842,-1808.6222 899.9982,-1809.764 866,-1805.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1805.621C759.3318,-1792.6224 712.5807,-1795.6483 642,-1714.621 599.2356,-1665.527 645.9871,-1624.0023 606,-1572.621 603.6499,-1569.6012 600.8471,-1566.8872 597.793,-1564.4577"/>
<polygon fill="#000000" stroke="#000000" points="599.5015,-1561.3876 589.2594,-1558.6764 595.5753,-1567.1829 599.5015,-1561.3876"/>
</g>
<!-- sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2122.621C801.2952,-2156.1781 768.6882,-2093.2021 702,-2122.621"/>
</g>
<!-- sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M981.0355,-1808.6266C976.9488,-1811.1041 973.1973,-1814.0709 970,-1817.621 908.093,-1886.3578 968.7847,-1936.9048 934,-2022.621 913.7897,-2072.4229 913.7118,-2097.8767 866,-2122.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2122.621C824.5976,-2144.093 808.5348,-2111.739 762,-2108.621 708.786,-2105.0553 693.298,-2094.0279 642,-2108.621 599.7677,-2120.635 601.6228,-2155.6253 558,-2160.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2160.621C491.4343,-2166.6879 478.2658,-2191.438 411.5,-2194.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-2194.621C336.2521,-2198.2083 297.7946,-2245.2379 242,-2194.621"/>
</g>
<!-- sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.8521,-1784.4885C978.8708,-1782.0529 974.1588,-1779.1295 970,-1775.621 941.7391,-1751.7791 959.7787,-1727.127 934,-1700.621 926.4938,-1692.9029 916.9205,-1686.5627 907.3426,-1681.5019"/>
<polygon fill="#000000" stroke="#000000" points="908.7461,-1678.2921 898.2257,-1677.0385 905.6682,-1684.5791 908.7461,-1678.2921"/>
</g>
<!-- sourcefile~dft_gridint.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~dft_gridint.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/dft_gridint.f90.html" xlink:title="dft_gridint.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="910.5,-1857.621 821.5,-1857.621 821.5,-1833.621 910.5,-1833.621 910.5,-1857.621"/>
<text text-anchor="middle" x="866" y="-1843.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_gridint.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~dft_gridint.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dft_gridint_tdxc_grad.f90&#45;&gt;sourcefile~dft_gridint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M999.6236,-1808.7333C975.4251,-1815.4135 945.1866,-1823.761 919.5982,-1830.8248"/>
<polygon fill="#000000" stroke="#000000" points="918.387,-1827.5282 909.6789,-1833.5631 920.2498,-1834.2758 918.387,-1827.5282"/>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.6256,-2188.543C486.4371,-2165.002 389.6547,-2108.1414 349,-2027.621 284.2979,-1899.4723 343.4666,-1522.9072 313,-1382.621 299.8884,-1322.2474 269.4885,-1255.6445 253.0417,-1222.2444"/>
<polygon fill="#000000" stroke="#000000" points="256.0187,-1220.3716 248.42,-1212.9885 249.756,-1223.4988 256.0187,-1220.3716"/>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M509.8256,-2196.5016C481.2434,-2194.593 444.3001,-2193.0573 411.5,-2194.621"/>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~bragg_slater.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~bragg_slater.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.9107,-2213.0581C543.6318,-2243.1989 514.6042,-2321.773 474,-2377.621 463.059,-2392.6695 447.9491,-2407.0554 435.3268,-2417.8542"/>
<polygon fill="#000000" stroke="#000000" points="432.9061,-2415.3154 427.4602,-2424.4035 437.3849,-2420.695 432.9061,-2415.3154"/>
</g>
<!-- sourcefile~dft_partfunc.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dft_partfunc.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dft_partfunc.f90.html" xlink:title="dft_partfunc.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="461.5,-2288.621 361.5,-2288.621 361.5,-2264.621 461.5,-2264.621 461.5,-2288.621"/>
<text text-anchor="middle" x="411.5" y="-2274.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_partfunc.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~dft_partfunc.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~dft_partfunc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M542.3126,-2212.6585C525.9618,-2224.7711 499.2468,-2243.3651 474,-2255.621 470.177,-2257.4768 466.1484,-2259.236 462.0543,-2260.8876"/>
<polygon fill="#000000" stroke="#000000" points="460.5509,-2257.7147 452.4481,-2264.5408 463.0392,-2264.2575 460.5509,-2257.7147"/>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~grid_storage.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~grid_storage.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M509.6244,-2211.8481C497.7212,-2214.6106 484.8235,-2217.6039 472.4124,-2220.4843"/>
<polygon fill="#000000" stroke="#000000" points="471.5414,-2217.0933 462.5916,-2222.7635 473.1239,-2223.9121 471.5414,-2217.0933"/>
</g>
<!-- sourcefile~lebedev.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~lebedev.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/lebedev.f90.html" xlink:title="lebedev.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="450,-1528.621 373,-1528.621 373,-1504.621 450,-1504.621 450,-1528.621"/>
<text text-anchor="middle" x="411.5" y="-1514.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lebedev.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~lebedev.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dft_molgrid.f90&#45;&gt;sourcefile~lebedev.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.1275,-2188.4518C543.6491,-2164.3859 522.5598,-2108.8599 510,-2060.621 503.2324,-2034.6285 432.9734,-1638.0725 415.445,-1538.9465"/>
<polygon fill="#000000" stroke="#000000" points="418.8475,-1538.0873 413.66,-1528.8493 411.9543,-1539.3059 418.8475,-1538.0873"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1042.2367,-588.8352C1031.9514,-687.824 961.6353,-1355.8741 934,-1387.621 913.3968,-1411.2895 886.7757,-1383.1037 866,-1406.621"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.3883,-573.4669C998.0539,-570.2388 980.4819,-563.7291 970,-550.621 885.3056,-444.706 1014.3024,-356.9034 934,-247.621 894.7731,-194.2375 849.741,-227.9902 798,-186.621 747.319,-146.0993 766.3563,-84.9177 702,-76.621"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.4268,-573.0469C998.297,-569.6955 980.9036,-563.2019 970,-550.621 916.5677,-488.9688 965.221,-445.995 934,-370.621 921.2296,-339.7904 898.593,-308.4621 882.9668,-288.8116"/>
<polygon fill="#000000" stroke="#000000" points="885.5627,-286.4559 876.5448,-280.8945 880.1263,-290.8657 885.5627,-286.4559"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.4295,-570.8275C977.936,-563.7633 917.2547,-550.9761 866,-536.621"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.4815,-585.3712C999.8833,-589.8043 983.7987,-595.7155 970,-602.621 952.8036,-611.2268 952.2718,-620.6276 934,-626.621 713.1121,-699.0743 641.7056,-618.2737 411.5,-650.621"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.4267,-572.1903C998.6681,-568.6096 981.6129,-562.1695 970,-550.621 936.506,-517.3124 967.0717,-484.3489 934,-450.621 930.5849,-447.1381 926.6539,-444.1144 922.4404,-441.4906"/>
<polygon fill="#000000" stroke="#000000" points="923.9316,-438.3182 913.4693,-436.6477 920.6063,-444.478 923.9316,-438.3182"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1042.0596,-589.0285C1034.427,-654.8438 998.004,-969.8128 970,-1227.621 953.3519,-1380.8853 989.4123,-1428.7579 934,-1572.621 923.0898,-1600.9462 901.2185,-1628.3706 885.2157,-1646.0082"/>
<polygon fill="#000000" stroke="#000000" points="882.5927,-1643.689 878.3365,-1653.3913 887.7142,-1648.4609 882.5927,-1643.689"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1041.7612,-589.0009C1032.6086,-654.6759 989.6911,-969.0449 970,-1227.621 954.6497,-1429.1957 983.7618,-1940.6828 934,-2136.621 917.1693,-2202.8923 896.9657,-2213.6596 866,-2274.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2274.621C851.4855,-2303.1952 820.3098,-2275.6115 798,-2298.621 761.3087,-2336.463 799.3036,-2374.3823 762,-2411.621 742.2038,-2431.3828 726.2513,-2416.6821 702,-2430.621"/>
</g>
<!-- sourcefile~ecp.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~ecp.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/ecp.f90.html" xlink:title="ecp.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="729.5,-858.621 674.5,-858.621 674.5,-834.621 729.5,-834.621 729.5,-858.621"/>
<text text-anchor="middle" x="702" y="-844.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ecp.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~ecp.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~ecp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.1696,-582.2531C998.8705,-586.1047 982.2939,-592.4253 970,-602.621 945.4732,-622.9616 954.9104,-640.578 934,-664.621 871.6397,-736.3231 777.7362,-799.7326 730.8202,-829.1769"/>
<polygon fill="#000000" stroke="#000000" points="728.7322,-826.3537 722.0868,-834.6053 732.4275,-832.2988 728.7322,-826.3537"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~mod_1e_primitives.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/mod_1e_primitives.f90.html" xlink:title="mod_1e_primitives.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="934,-817.621 798,-817.621 798,-793.621 934,-793.621 934,-817.621"/>
<text text-anchor="middle" x="866" y="-803.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_1e_primitives.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~mod_1e_primitives.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~mod_1e_primitives.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.35,-580.5385C998.3873,-583.985 981.1709,-590.4599 970,-602.621 927.12,-649.3016 966.1293,-685.9814 934,-740.621 923.274,-758.8618 905.9859,-775.2892 891.526,-787.066"/>
<polygon fill="#000000" stroke="#000000" points="889.112,-784.5115 883.4101,-793.4412 893.4361,-790.0163 889.112,-784.5115"/>
</g>
<!-- sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~mod_shell_tools.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/mod_shell_tools.f90.html" xlink:title="mod_shell_tools.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="762,-1060.621 642,-1060.621 642,-1036.621 762,-1036.621 762,-1060.621"/>
<text text-anchor="middle" x="702" y="-1046.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_shell_tools.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~mod_shell_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1040.1303,-588.7053C1029.2256,-626.4385 992.194,-744.4509 934,-826.621 886.2026,-894.111 847.1359,-887.099 798,-953.621 776.2699,-983.04 789.3189,-1003.3031 762,-1027.621 760.5162,-1028.9418 758.9444,-1030.1807 757.3043,-1031.3427"/>
<polygon fill="#000000" stroke="#000000" points="755.4109,-1028.3968 748.6265,-1036.5345 759.0049,-1034.4038 755.4109,-1028.3968"/>
</g>
<!-- sourcefile~grd1.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~grd1.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1042.129,-588.6243C1030.4934,-690.3011 948.3725,-1404.0234 934,-1420.621 892.9165,-1468.0647 854.0464,-1430.3798 798,-1458.621 779.8984,-1467.7421 779.9429,-1477.1915 762,-1486.621 712.4784,-1512.6459 688.4787,-1493.4857 642,-1524.621 621.2923,-1538.4927 626.2079,-1553.0307 606,-1567.621 587.398,-1581.0517 573.712,-1569.9011 558,-1586.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1586.621C491.772,-1658.1408 530.2262,-1705.2683 510,-1800.621 493.071,-1880.4295 525.7415,-1917.5431 474,-1980.621 469.8914,-1985.6298 464.6542,-1989.6871 458.965,-1992.9703"/>
<polygon fill="#000000" stroke="#000000" points="457.1684,-1989.9539 449.75,-1997.5182 460.2663,-1996.2311 457.1684,-1989.9539"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.8945,-436.6356C1188.8688,-541.6705 1179.3116,-1301.7695 1117,-1378.621 1074.1288,-1431.4957 1021.5567,-1377.1734 970,-1421.621 941.082,-1446.5514 956.9322,-1469.0941 934,-1499.621 909.9678,-1531.6122 902.4126,-1542.0346 866,-1558.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1558.621C848.1428,-1566.8032 721.2102,-1628.719 702,-1624.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1624.621C701.9026,-1624.6002 631.2707,-1586.3284 588.978,-1563.4093"/>
<polygon fill="#000000" stroke="#000000" points="590.6247,-1560.3208 580.1651,-1558.6334 587.2895,-1566.4752 590.6247,-1560.3208"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1186.8954,-436.6693C1178.2953,-469.1008 1152.4381,-560.5281 1117,-630.621 1003.7839,-854.5502 983.9693,-952.6089 762,-1069.621 679.2655,-1113.2348 437.9127,-1121.6091 349,-1150.621 322.4605,-1159.2807 293.8858,-1172.8715 272.9472,-1183.6992"/>
<polygon fill="#000000" stroke="#000000" points="271.1243,-1180.7032 263.8988,-1188.4519 274.3794,-1186.9003 271.1243,-1180.7032"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1166.6044,-412.531C1161.3549,-408.7588 1156.3536,-404.1163 1153,-398.621 1092.2311,-299.0407 1173.3201,-240.7832 1117,-138.621 1096.3676,-101.1947 1074.3092,-106.2388 1043.5,-76.621"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-2274.621C979.66,-2333.6054 709.5579,-2251.6986 602.2319,-2215.9059"/>
<polygon fill="#000000" stroke="#000000" points="603.2614,-2212.5596 592.6674,-2212.6943 601.0331,-2219.1955 603.2614,-2212.5596"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1171.5081,-412.4828C1165.4576,-408.2881 1158.8036,-403.4297 1153,-398.621 1135.8168,-384.3833 1137.6763,-372.0153 1117,-363.621 945.8841,-294.15 878.9652,-331.7989 702,-384.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-384.621C674.2343,-391.9665 666.4314,-393.5215 642,-408.621 603.8321,-432.21 602.8488,-465.9694 558,-464.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-464.621C492.9183,-462.6643 469.8645,-435.7585 411.5,-464.621"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.9586,-436.7972C1189.4909,-539.4479 1183.8396,-1270.9499 1117,-1859.621 1095.8675,-2045.74 1192.4757,-2161.0731 1043.5,-2274.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-2274.621C999.5334,-2308.1319 985.6574,-2235.3077 934,-2215.621 776.1827,-2155.4765 725.195,-2136.7573 558,-2160.621"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1159.9379,-423.4318C1130.2951,-422.5394 1083.7202,-421.8882 1043.5,-424.621"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.9163,-436.6528C1189.0334,-550.609 1180.1494,-1437.7539 1117,-1534.621 1110.4277,-1544.7025 966.9801,-1616.0429 899.9529,-1649.0015"/>
<polygon fill="#000000" stroke="#000000" points="898.0763,-1646.0238 890.6435,-1653.5739 901.1623,-1652.3068 898.0763,-1646.0238"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.6249,-436.6965C1184.7188,-594.2792 1133.0705,-2241.9737 1117,-2288.621 1105.8647,-2320.943 1080.8424,-2351.8953 1063.0939,-2371.0551"/>
<polygon fill="#000000" stroke="#000000" points="1060.3536,-2368.8576 1055.9945,-2378.5141 1065.4241,-2373.6837 1060.3536,-2368.8576"/>
</g>
<!-- sourcefile~grd2_rys.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~grd2_rys.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/grd2_rys.f90.html" xlink:title="grd2_rys.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="906.5,-1378.621 825.5,-1378.621 825.5,-1354.621 906.5,-1354.621 906.5,-1378.621"/>
<text text-anchor="middle" x="866" y="-1364.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grd2_rys.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~grd2_rys.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~grd2_rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-1326.621C1034.2442,-1335.4357 965.7437,-1349.093 916.61,-1357.9463"/>
<polygon fill="#000000" stroke="#000000" points="915.9861,-1354.5023 906.7565,-1359.7046 917.2158,-1361.3934 915.9861,-1354.5023"/>
</g>
<!-- sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~int2.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/int2.f90.html" xlink:title="int2.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1071,-1260.621 1016,-1260.621 1016,-1236.621 1071,-1236.621 1071,-1260.621"/>
<text text-anchor="middle" x="1043.5" y="-1246.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~int2.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.0268,-436.8751C1184.1296,-496.8834 1160.6754,-765.5774 1117,-981.621 1098.3021,-1074.1114 1065.073,-1181.7189 1050.5838,-1226.9009"/>
<polygon fill="#000000" stroke="#000000" points="1047.2187,-1225.9321 1047.4775,-1236.5238 1053.8802,-1228.0825 1047.2187,-1225.9321"/>
</g>
<!-- sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~int2_pairs.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/int2_pairs.f90.html" xlink:title="int2_pairs.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="745.5,-1330.621 658.5,-1330.621 658.5,-1306.621 745.5,-1306.621 745.5,-1330.621"/>
<text text-anchor="middle" x="702" y="-1316.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_pairs.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.5429,-436.6277C1185.7598,-534.0228 1158.7255,-1193.0014 1117,-1269.621 1097.2294,-1305.9254 1073.4355,-1298.1121 1043.5,-1326.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-1326.621C1023.2118,-1345.9423 846.8019,-1332.3805 755.8083,-1323.9535"/>
<polygon fill="#000000" stroke="#000000" points="755.9653,-1320.4529 745.6822,-1323.0042 755.3119,-1327.4224 755.9653,-1320.4529"/>
</g>
<!-- sourcefile~grd2.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~grd2.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.8885,-436.9299C1188.7861,-547.9749 1178.5329,-1374.9486 1117,-1463.621 1076.0661,-1522.6089 1027.3788,-1487.4603 970,-1530.621 950.3525,-1545.3999 953.7964,-1558.042 934,-1572.621 820.1882,-1656.4371 752.2858,-1610.2167 642,-1698.621 592.3337,-1738.4331 602.1745,-1768.7912 558,-1814.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1814.621C526.6087,-1846.7821 530.192,-1863.4708 510,-1903.621 493.0267,-1937.371 501.2825,-1954.4901 474,-1980.621 469.5959,-1984.8391 464.4094,-1988.4155 458.9384,-1991.437"/>
<polygon fill="#000000" stroke="#000000" points="457.0059,-1988.4853 449.5508,-1996.0134 460.0733,-1994.7774 457.0059,-1988.4853"/>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-426.621C494.1075,-447.6551 471.7959,-434.8033 411.5,-464.621"/>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-346.621C675.0945,-356.6699 667.4186,-357.25 642,-370.621 602.2899,-391.5097 600.619,-412.5903 558,-426.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-426.621C491.2993,-448.5795 291.3127,-376.6267 242,-426.621"/>
</g>
<!-- sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~eigen.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/eigen.f90.html" xlink:title="eigen.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="734.5,-280.621 669.5,-280.621 669.5,-256.621 734.5,-256.621 734.5,-280.621"/>
<text text-anchor="middle" x="702" y="-266.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">eigen.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~eigen.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M827.9629,-268.621C803.0965,-268.621 770.5722,-268.621 744.802,-268.621"/>
<polygon fill="#000000" stroke="#000000" points="744.5727,-265.1211 734.5727,-268.621 744.5726,-272.1211 744.5727,-265.1211"/>
</g>
<!-- sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~oqp_linalg.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/oqp_linalg.f90.html" xlink:title="oqp_linalg.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="603,-358.621 513,-358.621 513,-334.621 603,-334.621 603,-358.621"/>
<text text-anchor="middle" x="558" y="-344.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_linalg.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M828.3941,-280.7307C818.2511,-284.6 807.4698,-289.2851 798,-294.621 780.3406,-304.5714 779.5827,-312.5357 762,-322.621 737.0865,-336.9111 728.9055,-336.572 702,-346.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-346.621C674.0686,-357.053 640.9087,-357.7651 613.4541,-355.5495"/>
<polygon fill="#000000" stroke="#000000" points="613.5221,-352.0401 603.234,-354.5712 612.855,-359.0082 613.5221,-352.0401"/>
</g>
<!-- sourcefile~messages.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~messages.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M233.5835,-507.4182C205.768,-467.0897 116.5857,-337.7882 81.6892,-287.1933"/>
<polygon fill="#000000" stroke="#000000" points="84.391,-284.9459 75.832,-278.7012 78.6286,-288.9203 84.391,-284.9459"/>
</g>
<!-- sourcefile~messages.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~messages.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232.5016,-531.8153C217.0726,-552.268 186.7113,-595.3145 171,-636.621 94.5951,-837.496 73.4504,-1100.6623 68.6995,-1178.2097"/>
<polygon fill="#000000" stroke="#000000" points="65.2008,-1178.0881 68.1129,-1188.2748 72.1889,-1178.4954 65.2008,-1178.0881"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1034.5797,-396.7538C1018.1812,-419.8502 983.6749,-472.3293 970,-522.621 944.76,-615.4449 993.7326,-1312.2196 934,-1387.621 914.5145,-1412.2178 886.7757,-1383.1037 866,-1406.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1406.621C844.781,-1430.64 827.501,-1418.097 798,-1430.621 781.5338,-1437.6113 778.3186,-1441.2928 762,-1448.621 735.7997,-1460.3866 726.0835,-1456.9726 702,-1472.621"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1033.879,-372.4395C1019.2638,-353.6859 990.9549,-316.3695 970,-282.621 951.9615,-253.5694 957.572,-239.3948 934,-214.621 923.6625,-203.7564 716.8996,-78.3246 702,-76.621"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1005.2452,-379.9158C968.9456,-376.5504 913.0962,-374.2387 866,-384.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-384.621C794.8202,-400.3123 771.8439,-363.7734 702,-384.621"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-384.621C835.356,-391.3763 825.4292,-388.3787 798,-403.621 779.0275,-414.1639 779.3439,-423.5711 762,-436.621 616.155,-546.3573 591.9531,-623.2434 411.5,-650.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-650.621C336.5505,-658.2162 295.3084,-597.3919 242,-650.621"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1005.4218,-393.202C983.2994,-398.1873 954.86,-404.5962 929.4426,-410.324"/>
<polygon fill="#000000" stroke="#000000" points="928.4881,-406.9513 919.5022,-412.5641 930.027,-413.78 928.4881,-406.9513"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1034.5451,-396.7445C1018.0891,-419.8253 983.4907,-472.2796 970,-522.621 909.5659,-748.1341 1010.275,-1351.9615 934,-1572.621 924.0834,-1601.3092 902.0277,-1628.6662 885.7099,-1646.1887"/>
<polygon fill="#000000" stroke="#000000" points="883.0771,-1643.8774 878.6806,-1653.517 888.1288,-1648.7231 883.0771,-1643.8774"/>
</g>
<!-- sourcefile~tagarray_driver.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~tagarray_driver.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M833.4713,-412.5703C793.0309,-398.3071 726.3616,-377.3493 702,-384.621"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1165.8331,-356.7651C1160.736,-360.4934 1155.9984,-365.1021 1153,-370.621 1101.513,-465.3898 1184.6036,-1256.5865 1117,-1340.621 1074.7017,-1393.1998 1027.2606,-1342.9152 970,-1378.621 949.1381,-1391.6297 954.0909,-1406.4506 934,-1420.621 867.0894,-1467.8138 839.5608,-1460.3814 762,-1486.621 711.9256,-1503.5616 654.0436,-1520.3231 612.7552,-1531.8056"/>
<polygon fill="#000000" stroke="#000000" points="611.598,-1528.4942 602.8943,-1534.5353 613.4656,-1535.2405 611.598,-1528.4942"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1187.8766,-332.3689C1179.9272,-287.8023 1150.6525,-135.1224 1117,-100.621 1093.0055,-76.0211 1068.2733,-100.4363 1043.5,-76.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-76.621C1018.7267,-52.8056 1001.7884,-65.6741 970,-52.621 922.1953,-32.9912 917.58,2.5611 866,-.621"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-268.621C1000.7202,-258.1849 950.3951,-259.3992 914.2767,-262.5095"/>
<polygon fill="#000000" stroke="#000000" points="913.6444,-259.0535 904.017,-263.4766 914.3013,-266.0226 913.6444,-259.0535"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-268.621C985.5564,-257.1048 849.0492,-340.8877 798,-370.621 780.4846,-380.8227 779.9429,-389.1915 762,-398.621 712.4784,-424.6459 688.6586,-405.7559 642,-436.621 621.495,-450.1852 625.5453,-463.707 606,-478.621 463.7521,-587.1629 368.6165,-524.1929 242,-650.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-650.621C161.5271,-727.342 89.4109,-1084.5345 71.6632,-1178.124"/>
<polygon fill="#000000" stroke="#000000" points="68.178,-1177.7197 69.7715,-1188.194 75.0577,-1179.0122 68.178,-1177.7197"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1165.8168,-356.7562C1160.7202,-360.4848 1155.9868,-365.0958 1153,-370.621 1095.2155,-477.512 1183.2737,-1361.7752 1117,-1463.621 1077.4274,-1524.4339 1026.6499,-1489.289 970,-1534.621 948.9645,-1551.4538 903.7847,-1612.7083 880.5127,-1645.1452"/>
<polygon fill="#000000" stroke="#000000" points="877.5316,-1643.2972 874.568,-1653.4691 883.2281,-1647.3655 877.5316,-1643.2972"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~eigen.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-114.621C847.1482,-118.8263 759.5102,-208.4819 720.6448,-249.0212"/>
<polygon fill="#000000" stroke="#000000" points="717.9379,-246.7877 713.5568,-256.4343 722.9974,-251.6253 717.9379,-246.7877"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~int2.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1166.5529,-356.6797C1161.3044,-360.4525 1156.3163,-365.1031 1153,-370.621 1141.5511,-389.6701 1061.27,-1092.2068 1046.0037,-1226.545"/>
<polygon fill="#000000" stroke="#000000" points="1042.5241,-1226.1687 1044.8733,-1236.4997 1049.4794,-1226.9585 1042.5241,-1226.1687"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1175.7469,-332.4631C1161.6123,-320.9079 1138.9495,-303.6957 1117,-292.621 1086.3199,-277.1412 1076.885,-276.7652 1043.5,-268.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.5,-268.621C937.1104,-242.6673 897.4909,-201.8616 798,-247.621 775.6638,-257.8942 782.734,-276.4095 762,-289.621 737.3596,-305.3216 664.7074,-323.4928 613.1419,-335.0181"/>
<polygon fill="#000000" stroke="#000000" points="612.1389,-331.6552 603.1304,-337.2318 613.6503,-338.4901 612.1389,-331.6552"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1182.721,-332.4711C1150.5604,-280.5112 1016.1395,-81.1287 866,-114.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-114.621C729.1907,-119.2884 694.8889,-114.621 558,-114.621 558,-114.621 558,-114.621 411.5,-114.621 284.3351,-114.621 247.5207,-168.0557 171,-269.621 93.8181,-372.0639 73.8222,-532.0227 68.9637,-590.3691"/>
<polygon fill="#000000" stroke="#000000" points="65.4739,-590.1038 68.2017,-600.3414 72.4535,-590.6372 65.4739,-590.1038"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M833.7923,-1656.8637C800.8344,-1648.069 748.0678,-1634.4484 702,-1624.621"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M861.1123,-1677.8838C845.2058,-1717.2544 794.0959,-1839.4684 762,-1866.621 672.1849,-1942.6029 597.7065,-1869.2145 510,-1947.621 480.9321,-1973.6066 503.2733,-2001.8669 474,-2027.621 452.2022,-2046.7983 436.7356,-2032.2656 411.5,-2046.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-2046.621C323.4508,-2094.0463 316.0704,-2261.8178 242,-2194.621"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M859.0025,-1677.8939C844.5547,-1703.9373 811.6386,-1767.0703 798,-1824.621 782.9316,-1888.2046 802.2025,-2360.1069 762,-2411.621 744.7907,-2433.6723 724.8573,-2414.4976 702,-2430.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2430.621C681.8783,-2444.8146 532.7435,-2397.58 456.3434,-2371.9841"/>
<polygon fill="#000000" stroke="#000000" points="457.1049,-2368.5475 446.5109,-2368.6748 454.872,-2375.1819 457.1049,-2368.5475"/>
</g>
<!-- sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~functionals.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/functionals.f90.html" xlink:title="functionals.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="458.5,-1486.621 364.5,-1486.621 364.5,-1462.621 458.5,-1462.621 458.5,-1486.621"/>
<text text-anchor="middle" x="411.5" y="-1472.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">functionals.F90</text>
</a>
</g>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M833.6785,-1665.466C789.4131,-1664.4204 707.909,-1659.4956 642,-1638.621 578.4942,-1618.5075 556.3957,-1615.4223 510,-1567.621 485.0821,-1541.9481 500.9998,-1519.0946 474,-1495.621 472.0347,-1493.9124 469.9252,-1492.3416 467.7125,-1490.8976"/>
<polygon fill="#000000" stroke="#000000" points="469.1973,-1487.719 458.7539,-1485.9337 465.8046,-1493.8419 469.1973,-1487.719"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M833.7329,-1675.2363C774.1042,-1694.216 644.8324,-1741.1383 558,-1814.621"/>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1036.7821,-2378.4458C1021.8589,-2352.5709 983.336,-2291.9219 934,-2260.621 915.7484,-2249.0413 579.5258,-2158.6591 558,-2160.621"/>
</g>
<!-- sourcefile~atomic_structure.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~atomic_structure.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M397.6897,-2368.8799C384.7515,-2380.5438 365.0549,-2398.7657 349,-2415.621 298.5621,-2468.5734 315.0821,-2537.9829 242,-2540.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-2540.621C183.0677,-2542.7482 122.0508,-2504.0229 90.1139,-2480.0205"/>
<polygon fill="#000000" stroke="#000000" points="91.959,-2477.0235 81.9031,-2473.6872 87.6836,-2482.5662 91.959,-2477.0235"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M365.1894,-1914.5132C358.8805,-1910.9956 353.1563,-1906.4619 349,-1900.621 272.0722,-1792.5116 355.9548,-1430.1615 313,-1304.621 301.8531,-1272.0427 277.5476,-1240.1856 260.4941,-1220.4936"/>
<polygon fill="#000000" stroke="#000000" points="262.9467,-1217.9844 253.6889,-1212.8323 257.7132,-1222.6331 262.9467,-1217.9844"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M365.2353,-1914.4803C358.9207,-1910.9668 353.1827,-1906.4431 349,-1900.621 281.6755,-1806.9087 357.5176,-1489.0764 313,-1382.621 276.1901,-1294.5969 207.2676,-1309.8699 171,-1221.621 117.6962,-1091.9186 153.3078,-730.6491 135,-591.621 119.828,-476.4057 86.6746,-341.0419 73.2827,-288.7636"/>
<polygon fill="#000000" stroke="#000000" points="76.6267,-287.7143 70.7386,-278.9063 69.8488,-289.4637 76.6267,-287.7143"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M366.2141,-1938.6845C359.6133,-1942.2145 353.5285,-1946.7636 349,-1952.621 278.7234,-2043.5197 363.4963,-2105.4148 313,-2208.621 260.6196,-2315.678 145.8737,-2406.2574 93.952,-2443.4805"/>
<polygon fill="#000000" stroke="#000000" points="91.7341,-2440.7624 85.5958,-2449.3979 95.7795,-2446.4751 91.7341,-2440.7624"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~elements.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.1033,-1932.5675C340.2215,-1935.0314 315.9902,-1937.8906 294.8567,-1940.3842"/>
<polygon fill="#000000" stroke="#000000" points="294.2801,-1936.9278 284.7592,-1941.5756 295.1004,-1943.8796 294.2801,-1936.9278"/>
</g>
<!-- sourcefile~bragg_slater.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~bragg_slater.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M370.6231,-2424.5972C362.8226,-2420.9913 355.1765,-2416.4044 349,-2410.621 270.7976,-2337.3958 321.1824,-2266.7852 242,-2194.621"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M685.3693,-2378.5237C670.9985,-2366.9931 651.143,-2348.2203 642,-2326.621 576.61,-2172.1444 695.2525,-1714.6521 606,-1572.621 604.1847,-1569.7322 601.9307,-1567.1417 599.3973,-1564.8227"/>
<polygon fill="#000000" stroke="#000000" points="601.2283,-1561.8222 591.1183,-1558.6537 597.0457,-1567.4353 601.2283,-1561.8222"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M651.7349,-2382.788C622.9799,-2376.8437 586.9799,-2366.8437 558,-2350.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2350.621C504.6208,-2320.7398 524.2336,-2281.1157 510,-2221.621 477.1107,-2084.1476 504.9082,-2043.5533 474,-1905.621 436.2302,-1737.0675 386.6513,-1706.201 349,-1537.621 333.4019,-1467.7819 360.3952,-1271.2352 313,-1217.621 308.0943,-1212.0716 301.7286,-1208.1699 294.8251,-1205.4528"/>
<polygon fill="#000000" stroke="#000000" points="295.7531,-1202.076 285.1645,-1202.4385 293.6681,-1208.7583 295.7531,-1202.076"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M663.4348,-2378.5949C655.7276,-2374.9634 648.1287,-2370.3669 642,-2364.621 599.0414,-2324.3454 574.4306,-2257.1959 563.9928,-2222.6443"/>
<polygon fill="#000000" stroke="#000000" points="567.241,-2221.2782 561.0966,-2212.647 560.5175,-2223.226 567.241,-2221.2782"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2350.621C477.0308,-2299.3648 432.7578,-2344.181 349,-2297.621 291.3063,-2265.5497 290.7871,-2239.0839 242,-2194.621"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2350.621C528.3653,-2334.0317 489.8285,-2336.3636 459.7177,-2342.4004"/>
<polygon fill="#000000" stroke="#000000" points="458.8701,-2339.003 449.8543,-2344.5677 460.3724,-2345.8399 458.8701,-2339.003"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~dft_partfunc.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~dft_partfunc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2350.621C537.1877,-2338.9704 530.6293,-2338.5926 510,-2326.621 493.3681,-2316.9691 490.9568,-2311.6898 474,-2302.621 467.4453,-2299.1154 460.3143,-2295.7549 453.2919,-2292.6819"/>
<polygon fill="#000000" stroke="#000000" points="454.4208,-2289.3591 443.8476,-2288.6828 451.6914,-2295.805 454.4208,-2289.3591"/>
</g>
<!-- sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~grid_storage.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dft_fuzzycell.f90&#45;&gt;sourcefile~grid_storage.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2350.621C537.1877,-2338.9704 526.9128,-2343.439 510,-2326.621 484.9123,-2301.6738 500.7653,-2278.759 474,-2255.621 472.4737,-2254.3015 470.8614,-2253.0643 469.182,-2251.9041"/>
<polygon fill="#000000" stroke="#000000" points="470.715,-2248.7461 460.3153,-2246.722 467.1829,-2254.7897 470.715,-2248.7461"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.4743,-1857.2823C787.4768,-1863.913 740.1419,-1868.1443 702,-1852.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1852.621C580.1496,-1803.0291 682.3331,-1679.7663 606,-1572.621 603.8382,-1569.5865 601.2084,-1566.8709 598.3053,-1564.4477"/>
<polygon fill="#000000" stroke="#000000" points="600.3117,-1561.5799 590.1162,-1558.6985 596.2895,-1567.309 600.3117,-1561.5799"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M858.836,-1833.3859C844.073,-1807.4141 810.5937,-1744.4093 798,-1686.621 780.9721,-1608.4854 819.2497,-303.4563 762,-247.621 673.422,-161.2312 280.7702,-225.5116 128.3103,-254.4495"/>
<polygon fill="#000000" stroke="#000000" points="127.3523,-251.0692 118.1881,-256.386 128.6677,-257.9446 127.3523,-251.0692"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M860.9392,-1857.9177C847.96,-1888.4137 811.0314,-1968.9335 762,-2022.621 717.7514,-2071.0714 685.4706,-2059.4713 642,-2108.621 619.8635,-2133.6494 629.6612,-2151.0288 606,-2174.621 602.8184,-2177.7932 599.1692,-2180.6822 595.3346,-2183.284"/>
<polygon fill="#000000" stroke="#000000" points="593.467,-2180.3234 586.7535,-2188.5196 597.113,-2186.299 593.467,-2180.3234"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2046.621C493.8221,-2057.6051 468.8246,-2015.7446 411.5,-2046.621"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1852.621C574.8334,-1800.8655 574.2556,-1731.9519 510,-1610.621 484.9348,-1563.2915 511.4752,-1533.8826 474,-1495.621 472.1077,-1493.689 470.0324,-1491.9347 467.824,-1490.3419"/>
<polygon fill="#000000" stroke="#000000" points="469.1385,-1487.0524 458.7516,-1484.9636 465.5688,-1493.0738 469.1385,-1487.0524"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M858.9132,-1833.3688C844.2962,-1807.3645 811.0779,-1744.3016 798,-1686.621 755.6559,-1499.8606 841.2056,-999.9738 762,-825.621 731.5738,-758.6448 675.0157,-777.3592 642,-711.621 581.9279,-592.0099 654.9392,-537.2019 606,-412.621 599.3498,-395.6919 587.2988,-379.1447 576.936,-366.8534"/>
<polygon fill="#000000" stroke="#000000" points="579.3409,-364.2871 570.1186,-359.0717 574.0757,-368.8998 579.3409,-364.2871"/>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M857.0524,-1857.8579C840.5587,-1879.6126 803.253,-1925.2082 762,-1951.621 714.2877,-1982.1695 691.6489,-1967.3323 642,-1994.621 624.2365,-2004.3843 623.1484,-2011.8137 606,-2022.621 585.8216,-2035.3379 581.4872,-2042.4689 558,-2046.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-2046.621C537.928,-2050.0563 488.7362,-2034.7809 452.8764,-2022.1249"/>
<polygon fill="#000000" stroke="#000000" points="453.7454,-2018.7185 443.1509,-2018.6424 451.3856,-2025.3088 453.7454,-2018.7185"/>
</g>
<!-- sourcefile~dft_xc_libxc.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~dft_xc_libxc.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/dft_xc_libxc.f90.html" xlink:title="dft_xc_libxc.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="750.5,-1942.621 653.5,-1942.621 653.5,-1918.621 750.5,-1918.621 750.5,-1942.621"/>
<text text-anchor="middle" x="702" y="-1928.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_xc_libxc.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_gridint.f90&#45;&gt;sourcefile~dft_xc_libxc.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dft_gridint.f90&#45;&gt;sourcefile~dft_xc_libxc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M846.0209,-1857.8052C825.3337,-1870.2181 791.9107,-1889.7096 762,-1904.621 755.2944,-1907.9639 748.0583,-1911.3113 741.011,-1914.4387"/>
<polygon fill="#000000" stroke="#000000" points="739.3549,-1911.3424 731.5856,-1918.5458 742.1512,-1917.7596 739.3549,-1911.3424"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1003.4273,-1742.6203C967.7508,-1732.6531 913.9385,-1719.367 866,-1714.621"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2008.621C795.2082,-2062.1787 783.2173,-2086.7928 702,-2122.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2122.621C701.6365,-2122.7813 631.4767,-2160.7991 589.2356,-2183.6917"/>
<polygon fill="#000000" stroke="#000000" points="587.551,-2180.6237 580.4268,-2188.4657 590.8864,-2186.778 587.551,-2180.6237"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M981.2202,-1766.7969C977.0921,-1769.2362 973.2806,-1772.1478 970,-1775.621 919.949,-1828.6086 968.0222,-1871.1595 934,-1935.621 913.3035,-1974.8342 901.3604,-1981.869 866,-2008.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-2008.621C807.8722,-2052.5977 771.3006,-1986.0331 702,-2008.621"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1002.0557,-1742.5708C991.3173,-1738.7519 979.9749,-1734.0771 970,-1728.621 952.2167,-1718.8938 951.0849,-1711.5283 934,-1700.621 923.6996,-1694.045 912.0161,-1687.6734 901.2754,-1682.2092"/>
<polygon fill="#000000" stroke="#000000" points="902.6495,-1678.9835 892.1378,-1677.6586 899.529,-1685.2495 902.6495,-1678.9835"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~dft_gridint.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~dft_gridint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M987.3239,-1766.7515C981.233,-1769.1953 975.3225,-1772.121 970,-1775.621 948.8885,-1789.5034 954.4886,-1804.8346 934,-1819.621 928.8211,-1823.3585 923.0373,-1826.6335 917.0892,-1829.4831"/>
<polygon fill="#000000" stroke="#000000" points="915.4212,-1826.3928 907.6702,-1833.616 918.2338,-1832.8029 915.4212,-1826.3928"/>
</g>
<!-- sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dft_gridint_energy.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M986.5236,-1742.599C980.1073,-1739.0677 974.3324,-1734.5076 970,-1728.621 907.7831,-1644.0826 969.6445,-883.3486 934,-784.621 862.5443,-586.7038 655.3706,-418.8031 583.1712,-364.8177"/>
<polygon fill="#000000" stroke="#000000" points="585.1726,-361.9445 575.0538,-358.8045 581.0058,-367.5694 585.1726,-361.9445"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.8935,-1827.7304C949.4264,-1821.3852 905.2441,-1813.17 866,-1805.621"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~dft_molgrid.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~dft_molgrid.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.1157,-1850.6603C1040.9649,-1896.2287 1026.8168,-2059.4479 934,-2136.621 843.3026,-2212.0318 696.7752,-2213.4842 616.0269,-2207.3905"/>
<polygon fill="#000000" stroke="#000000" points="616.289,-2203.9004 606.0367,-2206.5724 615.7176,-2210.877 616.289,-2203.9004"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.1095,-1850.7002C1040.8472,-1905.3873 1026.0452,-2133.8113 934,-2288.621 881.2571,-2377.3286 858.2813,-2407.4621 762,-2444.621 712.2437,-2463.824 695.0622,-2449.9922 642,-2444.621 608.7739,-2441.2577 375.7345,-2397.6347 349,-2377.621 273.5769,-2321.1586 311.7797,-2257.9253 242,-2194.621"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.9889,-1827.4946C978.8559,-1824.86 974.0757,-1821.6151 970,-1817.621 931.1427,-1779.5407 968.9232,-1742.3387 934,-1700.621 926.96,-1692.2112 917.3835,-1685.5846 907.6403,-1680.466"/>
<polygon fill="#000000" stroke="#000000" points="908.8568,-1677.1682 898.3253,-1676.0115 905.8369,-1683.4832 908.8568,-1677.1682"/>
</g>
<!-- sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~dft_gridint.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dft_gridint_grad.f90&#45;&gt;sourcefile~dft_gridint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.9013,-1840.9713C963.4894,-1841.7763 940.7631,-1842.6726 920.7531,-1843.4617"/>
<polygon fill="#000000" stroke="#000000" points="920.4177,-1839.9721 910.5634,-1843.8635 920.6936,-1846.9667 920.4177,-1839.9721"/>
</g>
<!-- sourcefile~dft_partfunc.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dft_partfunc.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M371.3687,-2264.584C334.3881,-2251.9071 279.6913,-2228.9716 242,-2194.621"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M692.0148,-858.9144C678.2954,-876.5211 653.9596,-910.4652 642,-943.621 631.8893,-971.6512 574.398,-1418.3024 560.8566,-1524.2215"/>
<polygon fill="#000000" stroke="#000000" points="557.3511,-1524.043 559.5558,-1534.4059 564.2947,-1524.9299 557.3511,-1524.043"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-856.621C524.5323,-859.9503 441.8943,-880.221 411.5,-894.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-894.621C404.1439,-898.1061 290.165,-1110.4889 253.363,-1179.3333"/>
<polygon fill="#000000" stroke="#000000" points="250.1404,-1177.9378 248.515,-1188.4073 256.3144,-1181.2365 250.1404,-1177.9378"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.353,-848.0501C645.3324,-849.6652 598.3981,-852.6022 558,-856.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-856.621C493.2087,-863.0664 472.8679,-834.8622 411.5,-856.621"/>
</g>
<!-- sourcefile~ecpint.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~ecpint.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/ecpint.f90.html" xlink:title="ecpint.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="592,-828.621 524,-828.621 524,-804.621 592,-804.621 592,-828.621"/>
<text text-anchor="middle" x="558" y="-814.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ecpint.F90</text>
</a>
</g>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~ecpint.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~ecpint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.2354,-840.8367C653.803,-836.5799 625.6109,-830.7066 602.1087,-825.8103"/>
<polygon fill="#000000" stroke="#000000" points="602.5271,-822.3224 592.0234,-823.7092 601.0993,-829.1752 602.5271,-822.3224"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-304.621C535.345,-310.0036 526.476,-309.166 510,-325.621 481.8378,-353.7472 497.2086,-375.2858 474,-407.621 452.0783,-438.1631 445.1995,-447.9558 411.5,-464.621"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M669.4544,-276.9885C640.3031,-284.4281 596.3594,-295.507 558,-304.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-304.621C390.4569,-344.4281 295.6736,-204.8279 171,-323.621 120.791,-371.4617 143.0991,-564.7437 135,-633.621 110.1134,-845.263 79.427,-1101.2663 70.2287,-1177.8997"/>
<polygon fill="#000000" stroke="#000000" points="66.7028,-1177.9073 68.9857,-1188.2532 73.6528,-1178.7418 66.7028,-1177.9073"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M671.2804,-280.6813C661.7273,-284.7621 651.2733,-289.5735 642,-294.621 625.1102,-303.814 622.3124,-308.4384 606,-318.621 600.4145,-322.1076 594.3955,-325.7253 588.5712,-329.1563"/>
<polygon fill="#000000" stroke="#000000" points="586.5437,-326.2869 579.6692,-334.3487 590.0706,-332.3335 586.5437,-326.2869"/>
</g>
<!-- sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~mathlib_types.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/mathlib_types.f90.html" xlink:title="mathlib_types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="296.5,-356.621 187.5,-356.621 187.5,-332.621 296.5,-332.621 296.5,-356.621"/>
<text text-anchor="middle" x="242" y="-342.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mathlib_types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-304.621C466.9138,-324.6946 441.3301,-310.3997 349,-323.621 335.2022,-325.5967 320.4901,-328.1732 306.531,-330.8413"/>
<polygon fill="#000000" stroke="#000000" points="305.6686,-327.4434 296.5235,-332.793 307.0086,-334.314 305.6686,-327.4434"/>
</g>
<!-- sourcefile~elements.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~elements.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M237.8586,-1958.8434C215.0446,-2026.1743 104.6447,-2351.9962 74.8968,-2439.7909"/>
<polygon fill="#000000" stroke="#000000" points="71.5744,-2438.69 71.6801,-2449.2843 78.2042,-2440.9364 71.5744,-2438.69"/>
</g>
<!-- sourcefile~elements.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~elements.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M240.3839,-1934.2667C224.2279,-1810.7589 91.9302,-799.3822 70.4437,-635.1246"/>
<polygon fill="#000000" stroke="#000000" points="73.8588,-634.2474 69.0913,-624.7858 66.918,-635.1554 73.8588,-634.2474"/>
</g>
<!-- sourcefile~functionals.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~functionals.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M401.1598,-1462.4342C386.4437,-1444.2575 360.0226,-1408.3419 349,-1372.621 252.4336,-1059.6791 408.8924,-949.77 313,-636.621 301.638,-599.5167 275.8758,-562.1356 258.7116,-539.9325"/>
<polygon fill="#000000" stroke="#000000" points="261.3319,-537.6033 252.3846,-531.9291 255.8405,-541.9444 261.3319,-537.6033"/>
</g>
<!-- sourcefile~functionals.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~functionals.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M377.7785,-1462.5915C342.4109,-1449.1952 285.9645,-1425.5693 242,-1396.621"/>
</g>
<!-- sourcefile~grd2_rys.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~grd2_rys.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.2539,-1377.4088C815.6707,-1381.1916 805.9455,-1386.1651 798,-1392.621 775.0365,-1411.2793 784.82,-1429.7874 762,-1448.621 739.8488,-1466.9025 726.0835,-1456.9726 702,-1472.621"/>
</g>
<!-- sourcefile~grd2_rys.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~grd2_rys.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.2117,-1366.4606C733.4465,-1364.3457 506.4738,-1349.1704 349,-1254.621 329.3294,-1242.8105 332.9446,-1228.9626 313,-1217.621 307.4325,-1214.455 301.2966,-1211.8765 295.0336,-1209.7769"/>
<polygon fill="#000000" stroke="#000000" points="295.7326,-1206.3339 285.1507,-1206.8562 293.7487,-1213.0469 295.7326,-1206.3339"/>
</g>
<!-- sourcefile~grd2_rys.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~grd2_rys.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M832.5309,-1378.6689C821.4455,-1382.8576 809.1064,-1387.7352 798,-1392.621 781.6258,-1399.824 778.3186,-1403.2928 762,-1410.621 709.5993,-1434.1523 694.6803,-1435.7225 642,-1458.621 604.1647,-1475.0668 514.2627,-1528.6268 474,-1537.621 419.7808,-1549.7328 398.7604,-1562.3257 349,-1537.621 278.5382,-1502.6385 306.5306,-1441.6147 242,-1396.621"/>
</g>
<!-- sourcefile~grd2_rys.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~grd2_rys.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.4607,-1354.7558C803.5495,-1348.3428 776.2785,-1340.361 752.9443,-1333.5315"/>
<polygon fill="#000000" stroke="#000000" points="753.7927,-1330.133 743.2121,-1330.683 751.8263,-1336.8512 753.7927,-1330.133"/>
</g>
<!-- sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~rys.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/rys.f90.html" xlink:title="rys.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="729,-1018.621 675,-1018.621 675,-994.621 729,-994.621 729,-1018.621"/>
<text text-anchor="middle" x="702" y="-1004.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rys.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grd2_rys.f90&#45;&gt;sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~grd2_rys.f90&#45;&gt;sourcefile~rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M847.3212,-1354.6006C831.3807,-1343.2502 809.2983,-1324.7027 798,-1302.621 741.8531,-1192.8858 839.7136,-1123.302 762,-1027.621 756.1863,-1020.4632 747.776,-1015.7407 739.0834,-1012.6264"/>
<polygon fill="#000000" stroke="#000000" points="739.8533,-1009.2048 729.2725,-1009.7493 737.8835,-1015.922 739.8533,-1009.2048"/>
</g>
<!-- sourcefile~grid_storage.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~grid_storage.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M360.2583,-2235.1439C323.1,-2232.813 273.9563,-2223.7449 242,-2194.621"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1025.9377,-1260.6765C1009.7886,-1272.451 985.9939,-1291.6234 970,-1312.621 947.5956,-1342.0345 962.3303,-1363.8617 934,-1387.621 909.9564,-1407.7852 886.7757,-1383.1037 866,-1406.621"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1038.6818,-1236.3848C1026.4202,-1207.1758 990.9157,-1133.7242 934,-1105.621 841.1674,-1059.7831 805.3421,-1120.3429 702,-1126.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1126.621C616.092,-1130.5415 595.2405,-1139.2365 510,-1150.621 466.1714,-1156.4745 455.4759,-1160.0025 411.5,-1164.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1164.621C371.7086,-1168.0693 327.601,-1177.6236 294.3565,-1186.023"/>
<polygon fill="#000000" stroke="#000000" points="293.2166,-1182.7023 284.4048,-1188.5846 294.9616,-1189.4813 293.2166,-1182.7023"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1043.0957,-1236.4533C1040.0638,-1151.3977 1018.6261,-645.6157 934,-522.621 894.6277,-465.3976 837.3145,-502.8841 798,-445.621 736.4535,-355.976 835.2786,-283.9605 762,-203.621 741.9598,-181.6497 270.3773,-67.7284 242,-76.621"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1042.9968,-1236.3824C1040.07,-1174.141 1022.1584,-887.3699 934,-674.621 913.4251,-624.9685 908.0522,-608.0919 866,-574.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-574.621C808.9705,-529.229 766.1947,-609.1438 702,-574.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-574.621C631.0699,-536.4759 638.5001,-467.0412 558,-464.621"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1288.621C816.9723,-1304.3232 811.1499,-1324.3057 762,-1339.621 651.0156,-1374.2041 337.7649,-1462.5194 242,-1396.621"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1042.1721,-1236.3129C1031.521,-1137.9959 959.7306,-483.0333 934,-450.621 931.4644,-447.427 928.4878,-444.6251 925.2216,-442.1672"/>
<polygon fill="#000000" stroke="#000000" points="926.9205,-439.101 916.5924,-436.7387 923.1931,-445.0261 926.9205,-439.101"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1022.685,-1260.7483C1005.5458,-1271.9215 982.1587,-1290.1505 970,-1312.621 914.4829,-1415.2218 977.7544,-1464.4792 934,-1572.621 922.5503,-1600.9197 900.5828,-1628.5318 884.7085,-1646.2174"/>
<polygon fill="#000000" stroke="#000000" points="882.1,-1643.8833 877.9033,-1653.6115 887.2506,-1648.6236 882.1,-1643.8833"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1021.7978,-1260.6922C1004.3577,-1271.714 981.017,-1289.7569 970,-1312.621 890.4387,-1477.7381 979.4784,-1959.067 934,-2136.621 917.0342,-2202.8578 896.9657,-2213.6596 866,-2274.621"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1015.7299,-1253.3069C980.4456,-1259.6171 917.8941,-1272.0007 866,-1288.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866,-1288.621C830.0578,-1300.1322 788.184,-1307.7 755.745,-1312.355"/>
<polygon fill="#000000" stroke="#000000" points="754.9889,-1308.9263 745.5638,-1313.7654 755.9495,-1315.86 754.9889,-1308.9263"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1023.9302,-1260.6345C1007.1076,-1271.9803 983.4884,-1290.5251 970,-1312.621 935.1778,-1369.6647 978.2227,-1408.5118 934,-1458.621 879.821,-1520.0117 839.442,-1498.0326 762,-1524.621 750.7967,-1528.4674 566.6944,-1578.5764 558,-1586.621"/>
</g>
<!-- sourcefile~int_libint.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~int_libint.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/int_libint.f90.html" xlink:title="int_libint.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="906,-1138.621 826,-1138.621 826,-1114.621 906,-1114.621 906,-1138.621"/>
<text text-anchor="middle" x="866" y="-1124.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_libint.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_libint.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_libint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1033.6301,-1236.4984C1015.8585,-1215.4356 976.3633,-1172.0053 934,-1147.621 928.3781,-1144.385 922.2021,-1141.593 915.9358,-1139.1991"/>
<polygon fill="#000000" stroke="#000000" points="916.676,-1135.7504 906.0811,-1135.7583 914.3684,-1142.3591 916.676,-1135.7504"/>
</g>
<!-- sourcefile~int_rotaxis.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~int_rotaxis.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/int_rotaxis.f90.html" xlink:title="int_rotaxis.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="911,-1260.621 821,-1260.621 821,-1236.621 911,-1236.621 911,-1260.621"/>
<text text-anchor="middle" x="866" y="-1246.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_rotaxis.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_rotaxis.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_rotaxis.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1015.7656,-1248.621C990.6242,-1248.621 952.821,-1248.621 921.4861,-1248.621"/>
<polygon fill="#000000" stroke="#000000" points="921.1351,-1245.1211 911.1351,-1248.621 921.135,-1252.1211 921.1351,-1245.1211"/>
</g>
<!-- sourcefile~int_rys.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~int_rys.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/int_rys.f90.html" xlink:title="int_rys.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="901,-1180.621 831,-1180.621 831,-1156.621 901,-1156.621 901,-1180.621"/>
<text text-anchor="middle" x="866" y="-1166.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_rys.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_rys.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1020.7211,-1236.6141C998.7727,-1225.2304 964.4979,-1207.9372 934,-1194.621 926.0077,-1191.1313 917.3837,-1187.6339 909.0492,-1184.3866"/>
<polygon fill="#000000" stroke="#000000" points="910.0436,-1181.0194 899.4534,-1180.7047 907.5359,-1187.5548 910.0436,-1181.0194"/>
</g>
<!-- sourcefile~int2_pairs.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~int2_pairs.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M694.2579,-1330.8792C670.8117,-1368.0025 600.3964,-1479.4933 571.056,-1525.9489"/>
<polygon fill="#000000" stroke="#000000" points="567.9863,-1524.2549 565.6056,-1534.5788 573.9048,-1527.9929 567.9863,-1524.2549"/>
</g>
<!-- sourcefile~int2_pairs.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~int2_pairs.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M658.446,-1326.8099C545.3965,-1347.9606 250.742,-1402.3771 242,-1396.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-1396.621C170.0351,-1346.4437 107.6016,-1260.8559 81.0783,-1221.5193"/>
<polygon fill="#000000" stroke="#000000" points="83.8585,-1219.3794 75.4052,-1212.9925 78.0305,-1223.2569 83.8585,-1219.3794"/>
</g>
<!-- sourcefile~lebedev.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~lebedev.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M372.9175,-1511.442C363.6973,-1508.3288 354.8438,-1503.4003 349,-1495.621 291.6246,-1419.2423 340.6512,-728.0598 313,-636.621 301.7677,-599.4772 275.9697,-562.107 258.7626,-539.917"/>
<polygon fill="#000000" stroke="#000000" points="261.3751,-537.5784 252.4185,-531.9188 255.8908,-541.9285 261.3751,-537.5784"/>
</g>
<!-- sourcefile~lebedev.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~lebedev.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M372.6947,-1506.4231C364.5813,-1503.5201 356.2855,-1499.9423 349,-1495.621 293.2767,-1462.5688 296.1115,-1432.2506 242,-1396.621"/>
</g>
<!-- sourcefile~libxc.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~libxc.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1036.5993,-1624.5359C1021.297,-1597.0308 984.7113,-1527.2073 970,-1463.621 935.9411,-1316.4087 998.913,-921.0679 934,-784.621 874.2515,-659.0298 824.4898,-640.494 702,-574.621"/>
</g>
<!-- sourcefile~libxc.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~libxc.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1023.4456,-1648.7654C1006.5468,-1660.0712 983.0895,-1678.4828 970,-1700.621 931.5776,-1765.6046 975.8504,-1803.7902 934,-1866.621 866.9819,-1967.2365 817.4755,-1972.8394 702,-2008.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-2008.621C676.4944,-2018.5855 665.7522,-2008.9953 642,-2022.621 621.8202,-2034.1973 627.3713,-2051.4285 606,-2060.621 566.8053,-2077.4798 552.5604,-2063.6304 510,-2060.621 465.8924,-2057.5021 450.4298,-2025.6525 411.5,-2046.621"/>
</g>
<!-- sourcefile~libxc.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~libxc.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.3895,-1641.5404C984.4725,-1646.2649 940.5221,-1653.4455 908.1355,-1658.7369"/>
<polygon fill="#000000" stroke="#000000" points="907.3652,-1655.3162 898.0604,-1660.3829 908.4939,-1662.2246 907.3652,-1655.3162"/>
</g>
<!-- sourcefile~libxc.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~libxc.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1036.8144,-1624.4835C1021.9524,-1596.871 986.2093,-1526.8421 970,-1463.621 930.2842,-1308.7178 1004.6744,-1249.0695 934,-1105.621 887.5891,-1011.4202 859.61,-982.3513 762,-943.621 709.9216,-922.9569 550.7448,-913.1629 510,-951.621 460.6896,-998.164 487.3068,-1188.1326 474,-1254.621 459.225,-1328.4453 432.0489,-1413.6035 418.948,-1452.8049"/>
<polygon fill="#000000" stroke="#000000" points="415.5967,-1451.7902 415.72,-1462.3843 422.2302,-1454.0256 415.5967,-1451.7902"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M807.0864,-817.6764C803.9215,-819.1398 800.8676,-820.7808 798,-822.621 776.444,-836.4534 783.1191,-853.1302 762,-867.621 738.9355,-883.4465 729.6627,-882.474 702,-886.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-886.621C574.2673,-905.7695 528.2228,-839.3208 411.5,-894.621"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_shell_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M819.0441,-817.6664C811.0509,-821.5944 803.5518,-826.7812 798,-833.621 742.7335,-901.7083 819.0822,-961.0485 762,-1027.621 761.2457,-1028.5007 760.4523,-1029.3435 759.6244,-1030.1511"/>
<polygon fill="#000000" stroke="#000000" points="757.1524,-1027.6369 751.3598,-1036.508 761.4202,-1033.1854 757.1524,-1027.6369"/>
</g>
<!-- sourcefile~mod_gauss_hermite.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~mod_gauss_hermite.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/mod_gauss_hermite.f90.html" xlink:title="mod_gauss_hermite.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="313,-886.621 171,-886.621 171,-862.621 313,-862.621 313,-886.621"/>
<text text-anchor="middle" x="242" y="-872.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_gauss_hermite.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_gauss_hermite.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_gauss_hermite.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M829.3157,-793.5723C764.4271,-773.948 625.3644,-739.4845 510,-762.621 418.917,-780.8877 320.1428,-830.8618 271.9123,-857.4507"/>
<polygon fill="#000000" stroke="#000000" points="269.9893,-854.5155 262.9574,-862.4403 273.3965,-860.6303 269.9893,-854.5155"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M819.6589,-817.7185C811.5136,-821.6482 803.8008,-826.8224 798,-833.621 752.9381,-886.4336 808.4695,-934.0425 762,-985.621 755.8813,-992.4123 747.4411,-997.0073 738.822,-1000.1164"/>
<polygon fill="#000000" stroke="#000000" points="737.6964,-996.8 729.129,-1003.033 739.7134,-1003.5031 737.6964,-996.8"/>
</g>
<!-- sourcefile~xyzorder.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~xyzorder.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/xyzorder.f90.html" xlink:title="xyzorder.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="742.5,-702.621 661.5,-702.621 661.5,-678.621 742.5,-678.621 742.5,-702.621"/>
<text text-anchor="middle" x="702" y="-688.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">xyzorder.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~xyzorder.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~xyzorder.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M822.9117,-793.5426C814.0407,-789.7331 805.2162,-784.8405 798,-778.621 773.8637,-757.8184 785.8116,-737.7944 762,-716.621 758.1227,-713.1732 753.7174,-710.1278 749.0964,-707.451"/>
<polygon fill="#000000" stroke="#000000" points="750.5146,-704.244 740.0258,-702.7488 747.2929,-710.4585 750.5146,-704.244"/>
</g>
<!-- sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M698.4404,-1060.9311C679.3764,-1126.8608 589.2908,-1438.4068 564.3906,-1524.5201"/>
<polygon fill="#000000" stroke="#000000" points="560.9796,-1523.7166 561.5641,-1534.2953 567.7042,-1525.6611 560.9796,-1523.7166"/>
</g>
<!-- sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M641.6767,-1042.315C533.192,-1032.0425 310.1207,-1016.1011 242,-1050.621"/>
</g>
<!-- sourcefile~blas_wrap.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~blas_wrap.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/blas_wrap.f90.html" xlink:title="blas_wrap.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455.5,-356.621 367.5,-356.621 367.5,-332.621 455.5,-332.621 455.5,-356.621"/>
<text text-anchor="middle" x="411.5" y="-342.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">blas_wrap.F90</text>
</a>
</g>
</g>
<!-- sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~blas_wrap.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~blas_wrap.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.8498,-346.0046C498.095,-345.8031 481.5474,-345.5772 466.1696,-345.3673"/>
<polygon fill="#000000" stroke="#000000" points="465.7936,-341.8619 455.7467,-345.225 465.698,-348.8613 465.7936,-341.8619"/>
</g>
<!-- sourcefile~lapack_wrap.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~lapack_wrap.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/lapack_wrap.f90.html" xlink:title="lapack_wrap.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462.5,-398.621 360.5,-398.621 360.5,-374.621 462.5,-374.621 462.5,-398.621"/>
<text text-anchor="middle" x="411.5" y="-384.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lapack_wrap.F90</text>
</a>
</g>
</g>
<!-- sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~lapack_wrap.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~lapack_wrap.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M514.0452,-358.6223C498.7598,-362.7958 481.4368,-367.5256 465.4375,-371.894"/>
<polygon fill="#000000" stroke="#000000" points="464.4018,-368.5486 455.6768,-374.559 466.2456,-375.3014 464.4018,-368.5486"/>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.4456,-2018.2392C364.848,-2021.9665 356.1565,-2026.7066 349,-2032.621 282.4869,-2087.5895 305.7753,-2252.7437 242,-2194.621"/>
</g>
<!-- sourcefile~radial_grid_types.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~radial_grid_types.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M221.5554,-2568.4973C204.788,-2557.3263 182.0763,-2539.0987 171,-2516.621 111.4589,-2395.791 73.9858,-1386.9354 68.2658,-1223.0714"/>
<polygon fill="#000000" stroke="#000000" points="71.7528,-1222.6303 67.909,-1212.7573 64.757,-1222.8724 71.7528,-1222.6303"/>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.3845,-354.4259C360.7263,-357.2666 354.3182,-360.9215 349,-365.621 321.2931,-390.1044 333.5655,-409.8936 313,-440.621 298.2391,-462.6754 277.6363,-484.8997 262.4246,-500.133"/>
<polygon fill="#000000" stroke="#000000" points="259.6903,-497.9135 255.0208,-507.4239 264.6019,-502.9012 259.6903,-497.9135"/>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.5828,-356.7099C330.106,-368.9703 276.8931,-391.2456 242,-426.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-426.621C210.4403,-458.6169 191.0481,-458.3987 171,-498.621 139.7859,-561.2455 82.4557,-1065.6342 69.9503,-1178.3397"/>
<polygon fill="#000000" stroke="#000000" points="66.4436,-1178.208 68.8234,-1188.5321 73.4012,-1178.9773 66.4436,-1178.208"/>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.4083,-344.621C348.9475,-344.621 327.1135,-344.621 306.8807,-344.621"/>
<polygon fill="#000000" stroke="#000000" points="306.7868,-341.1211 296.7867,-344.621 306.7867,-348.1211 306.7868,-341.1211"/>
</g>
<!-- sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M653.4202,-1941.6526C649.4225,-1943.3688 645.5568,-1945.3455 642,-1947.621 621.29,-1960.8701 626.6503,-1976.2789 606,-1989.621 587.0845,-2001.8421 431.1157,-2035.5586 411.5,-2046.621"/>
</g>
<!-- sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M653.4919,-1928.6647C608.8054,-1924.0581 544.381,-1909.7607 510,-1866.621 406.7507,-1737.0682 577.0939,-1625.2974 474,-1495.621 472.0967,-1493.2269 469.9099,-1491.1038 467.5194,-1489.2212"/>
<polygon fill="#000000" stroke="#000000" points="469.0547,-1486.0526 458.7237,-1483.7028 465.3344,-1491.9822 469.0547,-1486.0526"/>
</g>
<!-- sourcefile~dft_xclib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~dft_xclib.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/dft_xclib.f90.html" xlink:title="dft_xclib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="597.5,-1980.621 518.5,-1980.621 518.5,-1956.621 597.5,-1956.621 597.5,-1980.621"/>
<text text-anchor="middle" x="558" y="-1966.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dft_xclib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~dft_xclib.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dft_xc_libxc.f90&#45;&gt;sourcefile~dft_xclib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M656.4375,-1942.6444C641.0266,-1946.7112 623.7392,-1951.2731 608.0027,-1955.4258"/>
<polygon fill="#000000" stroke="#000000" points="606.6967,-1952.1505 597.9208,-1958.0863 608.4829,-1958.9188 606.6967,-1952.1505"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.8977,-1134.3906C816.1945,-1137.4756 806.2521,-1141.7427 798,-1147.621 739.2087,-1189.5 748.2203,-1223.1777 702,-1278.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1278.621C684.0889,-1300.1061 661.9629,-1278.0276 642,-1297.621 577.3421,-1361.0819 562.4508,-1475.9163 559.0235,-1524.2376"/>
<polygon fill="#000000" stroke="#000000" points="555.512,-1524.3226 558.4005,-1534.516 562.4992,-1524.7461 555.512,-1524.3226"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.8565,-1125.2647C792.6288,-1124.4677 744.2034,-1124.0571 702,-1126.621"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M863.5113,-1114.5762C852.7275,-1063.5405 808.4825,-865.9029 762,-825.621 719.3813,-788.6874 564.2419,-780.1854 510,-795.621 460.4735,-809.7147 460.0325,-839.4132 411.5,-856.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-856.621C383.2953,-866.1014 371.9897,-861.7303 349,-880.621 280.0235,-937.2991 319.4421,-1006.2037 242,-1050.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-1050.621C177.787,-1087.4506 115.1086,-1149.5509 85.385,-1181.0439"/>
<polygon fill="#000000" stroke="#000000" points="82.8233,-1178.659 78.5573,-1188.3571 87.94,-1183.436 82.8233,-1178.659"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.8774,-1131.7805C815.6035,-1134.882 805.3845,-1139.8095 798,-1147.621 752.3846,-1195.8736 804.9097,-1241.947 762,-1292.621 759.2351,-1295.8861 755.984,-1298.7534 752.4496,-1301.2692"/>
<polygon fill="#000000" stroke="#000000" points="750.5206,-1298.3456 743.7844,-1306.5233 754.15,-1304.3313 750.5206,-1298.3456"/>
</g>
<!-- sourcefile~libint_f.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~libint_f.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/libint_f.f90.html" xlink:title="libint_f.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="737,-976.621 667,-976.621 667,-952.621 737,-952.621 737,-976.621"/>
<text text-anchor="middle" x="702" y="-962.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint_f.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~libint_f.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~libint_f.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M858.2483,-1114.2675C838.6839,-1083.4159 787.0824,-1004.1397 762,-985.621 757.2791,-982.1355 751.9309,-979.1919 746.4196,-976.7155"/>
<polygon fill="#000000" stroke="#000000" points="747.6571,-973.441 737.0724,-972.9758 745.0568,-979.9401 747.6571,-973.441"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M820.7977,-1260.381C812.5585,-1263.9866 804.5199,-1268.6405 798,-1274.621 761.9647,-1307.6749 743.0036,-1445.9787 702,-1472.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M702,-1472.621C677.9165,-1488.2693 667.7519,-1483.9036 642,-1496.621 622.5378,-1506.2322 601.5557,-1518.72 585.4302,-1528.8111"/>
<polygon fill="#000000" stroke="#000000" points="583.1223,-1526.1296 576.5451,-1534.4357 586.8665,-1532.0441 583.1223,-1526.1296"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M820.7964,-1249.0548C739.04,-1249.5655 561.1866,-1249.4215 411.5,-1240.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1240.621C368.8309,-1237.3811 321.5346,-1225.4979 287.7689,-1215.5185"/>
<polygon fill="#000000" stroke="#000000" points="288.7672,-1212.1639 278.1826,-1212.629 286.747,-1218.8661 288.7672,-1212.1639"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1240.621C304.5858,-1232.5031 277.1802,-1236.531 171,-1221.621 154.1596,-1219.2562 135.936,-1215.8484 119.5421,-1212.4638"/>
<polygon fill="#000000" stroke="#000000" points="120.1065,-1209.0059 109.5997,-1210.3689 118.6632,-1215.8555 120.1065,-1209.0059"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M832.5309,-1260.6689C821.4455,-1264.8576 809.1064,-1269.7352 798,-1274.621 781.6258,-1281.824 778.2129,-1285.0618 762,-1292.621 755.0676,-1295.8531 747.6283,-1299.1849 740.429,-1302.3399"/>
<polygon fill="#000000" stroke="#000000" points="738.6099,-1299.314 730.8308,-1306.5068 741.3975,-1305.7351 738.6099,-1299.314"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M838.9781,-1180.7017C803.3058,-1197.8588 740.5272,-1232.4059 702,-1278.621"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1164.621C493.0242,-1160.4251 476.255,-1157.8202 411.5,-1164.621"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M830.8495,-1169.3398C773.6097,-1170.2462 656.7263,-1170.9963 558,-1164.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1164.621C409.1541,-1152.9317 373.8457,-980.5605 242,-1050.621"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M848.8556,-1180.7822C834.1247,-1191.8236 812.9563,-1209.1624 798,-1227.621 777.21,-1253.2792 786.4547,-1270.4278 762,-1292.621 758.1578,-1296.1078 753.7752,-1299.1784 749.1675,-1301.8701"/>
<polygon fill="#000000" stroke="#000000" points="747.3626,-1298.8639 740.1123,-1306.5894 750.5979,-1305.0714 747.3626,-1298.8639"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M830.7152,-1164.5027C818.9809,-1161.5162 806.7015,-1156.393 798,-1147.621 758.7864,-1108.0894 800.4727,-1067.8739 762,-1027.621 755.7394,-1021.0707 747.3232,-1016.562 738.778,-1013.459"/>
<polygon fill="#000000" stroke="#000000" points="739.77,-1010.1024 729.1834,-1010.5191 737.7192,-1016.7952 739.77,-1010.1024"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M396.1591,-398.6584C366.5596,-421.8839 301.3737,-473.0327 265.9886,-500.798"/>
<polygon fill="#000000" stroke="#000000" points="263.3809,-498.3953 257.6743,-507.322 267.7021,-503.9024 263.3809,-498.3953"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M360.1144,-385.0913C322.3837,-386.8421 272.5747,-395.6237 242,-426.621"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M362.9281,-374.5854C343.424,-369.7526 320.7729,-364.1399 300.3831,-359.0876"/>
<polygon fill="#000000" stroke="#000000" points="301.1273,-355.6662 290.579,-356.6582 299.4436,-362.4607 301.1273,-355.6662"/>
</g>
<!-- sourcefile~mod_gauss_hermite.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~mod_gauss_hermite.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M235.3725,-887.0025C209.0759,-936.1297 111.9094,-1117.6555 78.7074,-1179.6834"/>
<polygon fill="#000000" stroke="#000000" points="75.582,-1178.1058 73.9485,-1188.5739 81.7535,-1181.4093 75.582,-1178.1058"/>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1012.621C536.4878,-1004.6431 529.1612,-1006.2411 510,-993.621 458.1645,-959.4804 467.5917,-868.0462 411.5,-894.621"/>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.7527,-1013.8576C645.046,-1020.3744 596.5923,-1026.933 558,-1012.621"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558,-1012.621C536.4878,-1004.6431 525.6587,-1010.3907 510,-993.621 474.0269,-955.0956 510.1705,-918.9611 474,-880.621 453.5811,-858.9773 439.5447,-846.6774 411.5,-856.621"/>
</g>
<!-- sourcefile~rys_lut.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~rys_lut.f90</title>
<g id="a_sourcefile~~tdhf_gradient.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/rys_lut.f90.html" xlink:title="rys_lut.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="593,-984.621 523,-984.621 523,-960.621 593,-960.621 593,-984.621"/>
<text text-anchor="middle" x="558" y="-970.221" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rys_lut.F90</text>
</a>
</g>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~rys_lut.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~rys_lut.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.9147,-1000.2258C654.6691,-995.4456 626.5348,-988.8028 602.9386,-983.2315"/>
<polygon fill="#000000" stroke="#000000" points="603.6767,-979.8096 593.14,-980.9179 602.0681,-986.6223 603.6767,-979.8096"/>
</g>
<!-- sourcefile~dft_xclib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dft_xclib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.884,-1980.7304C525.2967,-1984.7795 517.1004,-1989.5606 510,-1994.621 492.3244,-2007.218 492.8519,-2016.8637 474,-2027.621 448.7835,-2042.0099 436.7887,-2032.3592 411.5,-2046.621"/>
</g>
<!-- sourcefile~dft_xclib.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_gradient.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~dft_xclib.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.0271,-1956.4951C519.1508,-1952.8966 513.7245,-1948.3385 510,-1942.621 455.6062,-1859.1199 535.3757,-1574.1329 474,-1495.621 472.1164,-1493.2114 469.9451,-1491.0761 467.5667,-1489.1839"/>
<polygon fill="#000000" stroke="#000000" points="469.1229,-1486.027 458.7997,-1483.6428 465.3829,-1491.9442 469.1229,-1486.027"/>
</g>
</g>
</svg>
</div>                <script>
                  var pansourcefiletdhf_gradientf90EfferentGraph = svgPanZoom('#sourcefiletdhf_gradientf90EfferentGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#EfferentGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="EfferentGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a file to a file which it depends on. A file
is dependent upon another if the latter must be compiled before the former
can be.
</p>
 </div>
            </div>
          </div>
        </div>
          </div>
        </div>
<br>
      <section>
        <h2><span class="anchor" id="src"></span>Source Code</h2>
        <div class="hl codehilite"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="k">module </span><span class="n">tdhf_gradient_mod</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="w">  </span><span class="k">use </span><span class="nb">precision</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp</span>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="w">  </span><span class="k">use </span><span class="n">grd2</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">grd2_driver</span><span class="p">,</span><span class="w"> </span><span class="n">grd2_compute_data_t</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="w">  </span><span class="k">use </span><span class="n">basis_tools</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">basis_set</span>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="w">  </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="w">  </span><span class="k">use </span><span class="n">io_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">iw</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="c">!###############################################################################</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="w">  </span><span class="k">implicit none</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="c">!###############################################################################</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="w">  </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">module_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tdhf_gradient_mod&quot;</span>
<a id="ln-16" name="ln-16" href="#ln-16"></a>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="c">!###############################################################################</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="w">  </span><span class="k">public </span><span class="n">tdhf_gradient</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="c">!###############################################################################</span>
<a id="ln-22" name="ln-22" href="#ln-22"></a>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="w">  </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="k">extends</span><span class="p">(</span><span class="n">grd2_compute_data_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grd2_tdhf_compute_data_t</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">d2</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p2</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xpy2</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xmy2</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="w">  </span><span class="k">contains</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="k">    procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">grd2_tdhf_compute_data_t_init</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="w">    </span><span class="k">procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">clean</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">grd2_tdhf_compute_data_t_clean</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="w">    </span><span class="k">procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">get_density</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">grd2_tdhf_compute_data_t_get_density</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="w">  </span><span class="k">end type</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="k">contains</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="c">!###############################################################################</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">tdhf_gradient_C</span><span class="p">(</span><span class="n">c_handle</span><span class="p">)</span><span class="w"> </span><span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tdhf_gradient&quot;</span><span class="p">)</span>
<a id="ln-40" name="ln-40" href="#ln-40"></a>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="w">    </span><span class="k">use </span><span class="n">c_interop</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">oqp_handle_t</span><span class="p">,</span><span class="w"> </span><span class="n">oqp_handle_get_info</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="w">    </span><span class="k">use </span><span class="n">strings</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">Cstring</span>
<a id="ln-43" name="ln-43" href="#ln-43"></a>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="k">    type</span><span class="p">(</span><span class="n">oqp_handle_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c_handle</span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inf</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="w">    </span><span class="n">inf</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">oqp_handle_get_info</span><span class="p">(</span><span class="n">c_handle</span><span class="p">)</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="w">    </span><span class="k">call </span><span class="n">tdhf_gradient</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
<a id="ln-51" name="ln-51" href="#ln-51"></a>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">tdhf_gradient_c</span>
<a id="ln-53" name="ln-53" href="#ln-53"></a>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="c">!###############################################################################</span>
<a id="ln-55" name="ln-55" href="#ln-55"></a>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">tdhf_gradient</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="w">    </span><span class="k">use </span><span class="n">io_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">iw</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="w">    </span><span class="k">use </span><span class="n">oqp_tagarray_driver</span>
<a id="ln-59" name="ln-59" href="#ln-59"></a>
<a id="ln-60" name="ln-60" href="#ln-60"></a><span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="w">    </span><span class="k">use </span><span class="n">strings</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">Cstring</span><span class="p">,</span><span class="w"> </span><span class="n">fstring</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="w">    </span><span class="k">use </span><span class="n">basis_tools</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">basis_set</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="w">    </span><span class="k">use </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">show_message</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">    </span><span class="k">use </span><span class="n">grd1</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">eijden</span><span class="p">,</span><span class="w"> </span><span class="n">print_gradient</span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="w">    </span><span class="k">use </span><span class="n">util</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">measure_time</span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">    </span><span class="k">use </span><span class="n">tdhf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="w">      </span><span class="n">iatogen</span><span class="p">,</span><span class="w"> </span><span class="n">mntoia</span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">    </span><span class="k">use </span><span class="n">dft</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dft_initialize</span><span class="p">,</span><span class="w"> </span><span class="n">dftclean</span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">symmetrize_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">orthogonal_transform</span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">    </span><span class="k">use </span><span class="n">mod_dft_molgrid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dft_grid_t</span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">    </span><span class="k">use </span><span class="n">mod_dft_gridint_tdxc_grad</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">tddft_xc_gradient</span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unpack_matrix</span>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="w">    </span><span class="k">use </span><span class="n">printing</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">print_module_info</span>
<a id="ln-75" name="ln-75" href="#ln-75"></a>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-77" name="ln-77" href="#ln-77"></a>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subroutine_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tdhf_gradient&quot;</span>
<a id="ln-79" name="ln-79" href="#ln-79"></a>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">basis_set</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis</span>
<a id="ln-81" name="ln-81" href="#ln-81"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">infos</span>
<a id="ln-82" name="ln-82" href="#ln-82"></a>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span>
<a id="ln-84" name="ln-84" href="#ln-84"></a>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dft_grid_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">molGrid</span>
<a id="ln-86" name="ln-86" href="#ln-86"></a>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">  </span><span class="c">! General data</span>
<a id="ln-88" name="ln-88" href="#ln-88"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dft</span>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scf_type</span><span class="p">,</span><span class="w"> </span><span class="n">mol_mult</span>
<a id="ln-90" name="ln-90" href="#ln-90"></a>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">d</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">xpy2</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">xmy2</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">wrk1</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">wrk2</span><span class="p">(:,:)</span>
<a id="ln-92" name="ln-92" href="#ln-92"></a>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="w">    </span><span class="c">! tagarray</span>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">contiguous</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">      </span><span class="n">dmat_a</span><span class="p">(:),</span><span class="w"> </span><span class="n">mo_a</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">td_p</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">xpy</span><span class="p">(:),</span><span class="w"> </span><span class="n">xmy</span><span class="p">(:)</span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tags_general</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">      </span><span class="n">OQP_TD_XPY</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_TD_XMY</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_TD_P</span><span class="w"> </span><span class="p">]</span>
<a id="ln-98" name="ln-98" href="#ln-98"></a>
<a id="ln-99" name="ln-99" href="#ln-99"></a><span class="w">    </span><span class="n">mol_mult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">mult</span>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mol_mult</span><span class="o">/=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(&amp;</span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="w">            </span><span class="s1">&#39;RPA-TDDFT are only available for RHF reference&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span><span class="p">)</span>
<a id="ln-102" name="ln-102" href="#ln-102"></a>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="w">    </span><span class="n">scf_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">scftype</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scf_type</span><span class="o">/=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">error stop</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a>
<a id="ln-106" name="ln-106" href="#ln-106"></a><span class="k">    </span><span class="n">dft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">hamilton</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">20</span>
<a id="ln-107" name="ln-107" href="#ln-107"></a>
<a id="ln-108" name="ln-108" href="#ln-108"></a><span class="w">  </span><span class="c">! Files open</span>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">    </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">IW</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">log_filename</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">)</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="w">    </span><span class="k">call </span><span class="n">print_module_info</span><span class="p">(</span><span class="s1">&#39;TDHF_Grad&#39;</span><span class="p">,</span><span class="s1">&#39;Computing Grdient of TDDFT&#39;</span><span class="p">)</span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="c">!</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">iw</span><span class="p">,</span><span class="s1">&#39;(/5X,&quot;Gradient options&quot;/&amp;</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="s1">                &amp;5X,18(&quot;-&quot;)/&amp;</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="s1">                &amp;5X,&quot;Target State: &quot;,I8/)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">target_state</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">   </span><span class="c">! Load basis set</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">    </span><span class="n">basis</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">basis</span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="w">    </span><span class="n">basis</span><span class="p">%</span><span class="n">atoms</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span>
<a id="ln-119" name="ln-119" href="#ln-119"></a>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="w">    </span><span class="k">call </span><span class="n">data_has_tags</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">tags_general</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="n">subroutine_name</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_A</span><span class="p">,</span><span class="w"> </span><span class="n">dmat_a</span><span class="p">)</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">)</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_p</span><span class="p">,</span><span class="w"> </span><span class="n">td_p</span><span class="p">)</span>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_xpy</span><span class="p">,</span><span class="w"> </span><span class="n">xpy</span><span class="p">)</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_xmy</span><span class="p">,</span><span class="w"> </span><span class="n">xmy</span><span class="p">)</span>
<a id="ln-126" name="ln-126" href="#ln-126"></a>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">  </span><span class="c">! Allocate H, S ,T and D matrices</span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">    </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">nbf</span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">    </span><span class="n">nocc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">nocc</span>
<a id="ln-130" name="ln-130" href="#ln-130"></a>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="c">!   Compute 1e gradient</span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">    </span><span class="k">call </span><span class="nb">flush</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-133" name="ln-133" href="#ln-133"></a>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">    </span><span class="k">call </span><span class="n">tdhf_1e_grad</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">basis</span><span class="p">)</span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">    </span><span class="c">!call print_gradient(infos)</span>
<a id="ln-136" name="ln-136" href="#ln-136"></a>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="n">iw</span><span class="p">,</span><span class="s2">&quot;(&#39; ..... End Of 1-Eelectron Gradient ......&#39;)&quot;</span><span class="p">)</span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">    </span><span class="k">call </span><span class="n">measure_time</span><span class="p">(</span><span class="n">print_total</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">log_unit</span><span class="o">=</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">    </span><span class="k">call </span><span class="nb">flush</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-140" name="ln-140" href="#ln-140"></a>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="w">             </span><span class="n">p</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">             </span><span class="n">xpy2</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="w">             </span><span class="n">xmy2</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">             </span><span class="n">wrk1</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">             </span><span class="n">wrk2</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">             </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0d0</span><span class="p">)</span>
<a id="ln-148" name="ln-148" href="#ln-148"></a>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">    </span><span class="k">call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">xpy</span><span class="p">,</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">    </span><span class="k">call </span><span class="n">symmetrize_matrix</span><span class="p">(</span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">    </span><span class="n">wrk1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrk1</span><span class="o">*</span><span class="mf">0.5</span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">    </span><span class="k">call </span><span class="n">orthogonal_transform</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">xpy2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">wrk2</span><span class="p">)</span>
<a id="ln-153" name="ln-153" href="#ln-153"></a>
<a id="ln-154" name="ln-154" href="#ln-154"></a><span class="w">    </span><span class="k">call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">xmy</span><span class="p">,</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">,</span><span class="w"> </span><span class="n">nocc</span><span class="p">)</span>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">    </span><span class="k">call </span><span class="n">orthogonal_transform</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">xmy2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">wrk2</span><span class="p">)</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a>
<a id="ln-157" name="ln-157" href="#ln-157"></a>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">    </span><span class="k">call </span><span class="n">unpack_matrix</span><span class="p">(</span><span class="n">td_p</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">p</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">))</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="w">    </span><span class="k">call </span><span class="n">unpack_matrix</span><span class="p">(</span><span class="n">dmat_a</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">))</span>
<a id="ln-160" name="ln-160" href="#ln-160"></a>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="c">!   Compute xc gradient</span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dft</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="k">      call </span><span class="n">dft_initialize</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">molGrid</span><span class="p">)</span>
<a id="ln-164" name="ln-164" href="#ln-164"></a>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="w">      </span><span class="n">d</span><span class="p">(:,:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="w">      </span><span class="n">p</span><span class="p">(:,:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="w">      </span><span class="n">xpy2</span><span class="p">(:,:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xpy2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="w">      </span><span class="k">call </span><span class="n">tddft_xc_gradient</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="w">             </span><span class="n">molGrid</span><span class="o">=</span><span class="n">molGrid</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-170" name="ln-170" href="#ln-170"></a><span class="w">             </span><span class="n">dedft</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span><span class="p">%</span><span class="n">grad</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">             </span><span class="n">da</span><span class="o">=</span><span class="n">d</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">             </span><span class="n">pa</span><span class="o">=</span><span class="n">p</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a><span class="w">             </span><span class="n">xa</span><span class="o">=</span><span class="n">xpy2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="w">             </span><span class="n">nmtx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">             </span><span class="n">threshold</span><span class="o">=</span><span class="mf">1.0d-14</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">             </span><span class="n">infos</span><span class="o">=</span><span class="n">infos</span><span class="p">)</span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">      </span><span class="k">call </span><span class="n">dftclean</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="w">      </span><span class="k">call </span><span class="n">measure_time</span><span class="p">(</span><span class="n">print_total</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">log_unit</span><span class="o">=</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">      </span><span class="k">call </span><span class="nb">flush</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">    </span><span class="k">end if</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="c">!   Compute 2e gradient</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="w">    </span><span class="k">call </span><span class="n">tdhf_2e_grad</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">p</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">xpy2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">xmy2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">))</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">    </span><span class="k">call </span><span class="n">print_gradient</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="c">!   Print timings</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a><span class="w">    </span><span class="k">call </span><span class="n">measure_time</span><span class="p">(</span><span class="n">print_total</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">log_unit</span><span class="o">=</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-189" name="ln-189" href="#ln-189"></a>
<a id="ln-190" name="ln-190" href="#ln-190"></a><span class="w">    </span><span class="k">close</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-191" name="ln-191" href="#ln-191"></a>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">tdhf_gradient</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="c">!###############################################################################</span>
<a id="ln-195" name="ln-195" href="#ln-195"></a>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">tdhf_1e_grad</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">basis</span><span class="p">)</span>
<a id="ln-197" name="ln-197" href="#ln-197"></a>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">    </span><span class="k">use </span><span class="n">oqp_tagarray_driver</span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">    </span><span class="k">use </span><span class="n">basis_tools</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">basis_set</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">    </span><span class="k">use </span><span class="n">util</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">measure_time</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">    </span><span class="k">use </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">show_message</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="w">    </span><span class="k">use </span><span class="nb">precision</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="w">    </span><span class="k">use </span><span class="n">constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">tol_int</span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="w">    </span><span class="k">use </span><span class="n">grd1</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">eijden</span><span class="p">,</span><span class="w"> </span><span class="n">print_gradient</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">            </span><span class="n">grad_nn</span><span class="p">,</span><span class="w"> </span><span class="n">grad_ee_overlap</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="w">            </span><span class="n">grad_ee_kinetic</span><span class="p">,</span><span class="w"> </span><span class="n">grad_en_hellman_feynman</span><span class="p">,</span><span class="w"> </span><span class="n">grad_en_pulay</span><span class="p">,</span><span class="w"> </span><span class="n">grad_1e_ecp</span>
<a id="ln-208" name="ln-208" href="#ln-208"></a>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">symmetrize_matrix</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subroutine_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tdhf_1e_grad&quot;</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">infos</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">basis_set</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis</span>
<a id="ln-217" name="ln-217" href="#ln-217"></a>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dens</span><span class="p">(:)</span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tol</span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="n">ok</span>
<a id="ln-221" name="ln-221" href="#ln-221"></a>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="w">    </span><span class="c">! tagarray</span>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dmat_a</span><span class="p">(:),</span><span class="w"> </span><span class="n">wao</span><span class="p">(:),</span><span class="w"> </span><span class="n">td_p</span><span class="p">(:,:)</span>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tags_general</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="w">      </span><span class="n">OQP_DM_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_WAO</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_TD_P</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<a id="ln-226" name="ln-226" href="#ln-226"></a>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="w">    </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">nbf</span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">    </span><span class="n">nbf2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">*</span><span class="p">(</span><span class="n">nbf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a id="ln-229" name="ln-229" href="#ln-229"></a>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">    </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tol_int</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span><span class="mf">0.0_dp</span><span class="p">)</span>
<a id="ln-231" name="ln-231" href="#ln-231"></a>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="c">!   initial memory allocation</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">dens</span><span class="p">(</span><span class="n">nbf2</span><span class="p">),</span><span class="w"> </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0_dp</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ok</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="w">    </span><span class="k">call </span><span class="n">data_has_tags</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">tags_general</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="n">subroutine_name</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_A</span><span class="p">,</span><span class="w"> </span><span class="n">dmat_a</span><span class="p">)</span>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_WAO</span><span class="p">,</span><span class="w"> </span><span class="n">wao</span><span class="p">)</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_p</span><span class="p">,</span><span class="w"> </span><span class="n">td_p</span><span class="p">)</span>
<a id="ln-240" name="ln-240" href="#ln-240"></a>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="w">    </span><span class="k">associate</span><span class="p">(</span><span class="w"> </span><span class="n">grad</span><span class="w">   </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span><span class="p">%</span><span class="n">grad</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">xyz</span><span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span><span class="p">%</span><span class="n">xyz</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-243" name="ln-243" href="#ln-243"></a><span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">zn</span><span class="w">     </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span><span class="p">%</span><span class="n">zn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">basis</span><span class="p">%</span><span class="n">ecp_zn_num</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w">      </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">td_p</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="w">      </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">wao</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">urohf</span><span class="w">  </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">scftype</span><span class="o">&gt;=</span><span class="mi">2</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">        </span><span class="p">)</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="c">!     Zero out gradient</span>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="w">      </span><span class="n">grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0d0</span>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="c">!     Nuclear repulsion force</span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="w">      </span><span class="k">call </span><span class="n">grad_nn</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">basis</span><span class="p">%</span><span class="n">ecp_zn_num</span><span class="p">)</span>
<a id="ln-253" name="ln-253" href="#ln-253"></a>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="c">!     Obtain Lagrangian matrix (`dens`)</span>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="w">      </span><span class="k">call </span><span class="n">eijden</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">)</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="c">!     Add W matrix:</span>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">      </span><span class="n">dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dens</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">w</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="c">!     Overlap gradient</span>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="w">      </span><span class="k">call </span><span class="n">grad_ee_overlap</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="p">,</span><span class="w"> </span><span class="n">logtol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
<a id="ln-262" name="ln-262" href="#ln-262"></a>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="c">!     Compute total density matrix, discard Lagrangian</span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="w">      </span><span class="n">dens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dmat_a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-265" name="ln-265" href="#ln-265"></a>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="c">!     Hellmann-Feynman force</span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">      </span><span class="k">call </span><span class="n">grad_en_hellman_feynman</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">zn</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="p">,</span><span class="w"> </span><span class="n">logtol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="c">!     KE gradient</span>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="w">      </span><span class="k">call </span><span class="n">grad_ee_kinetic</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="p">,</span><span class="w"> </span><span class="n">logtol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
<a id="ln-271" name="ln-271" href="#ln-271"></a>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="c">!     Pulay force</span>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="w">      </span><span class="k">call </span><span class="n">grad_en_pulay</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">zn</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="p">,</span><span class="w"> </span><span class="n">logtol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="c">!     Effective core potential gradient</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="w">      </span><span class="k">call </span><span class="n">grad_1e_ecp</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">xyz</span><span class="p">,</span><span class="w"> </span><span class="n">dens</span><span class="p">,</span><span class="w"> </span><span class="n">grad</span><span class="p">,</span><span class="w"> </span><span class="n">logtol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
<a id="ln-276" name="ln-276" href="#ln-276"></a>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">    </span><span class="k">end associate</span>
<a id="ln-278" name="ln-278" href="#ln-278"></a>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="k">   end subroutine</span>
<a id="ln-280" name="ln-280" href="#ln-280"></a>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="c">!###############################################################################</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="c">!&gt; @brief The driver for the two electron gradient</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">tdhf_2e_grad</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">xpy</span><span class="p">,</span><span class="w"> </span><span class="n">xmy</span><span class="p">)</span>
<a id="ln-285" name="ln-285" href="#ln-285"></a>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="w">    </span><span class="k">use </span><span class="n">basis_tools</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">basis_set</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">    </span><span class="k">use </span><span class="nb">precision</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp</span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">    </span><span class="k">use </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">show_message</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-290" name="ln-290" href="#ln-290"></a>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-292" name="ln-292" href="#ln-292"></a>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="k">    type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">infos</span>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">basis_set</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis</span>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">contiguous</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">d</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">xpy</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">xmy</span><span class="p">(:,:,:)</span>
<a id="ln-296" name="ln-296" href="#ln-296"></a>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">urohf</span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">hfscale</span>
<a id="ln-299" name="ln-299" href="#ln-299"></a>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ok</span>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">de</span><span class="p">(:,:)</span>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">grd2_compute_data_t</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gcomp</span>
<a id="ln-303" name="ln-303" href="#ln-303"></a>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="w">    </span><span class="n">urohf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">scftype</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span>
<a id="ln-305" name="ln-305" href="#ln-305"></a><span class="w">    </span><span class="n">hfscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0d0</span>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">hamilton</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="n">hfscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">hfscale</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">de</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">ubound</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span><span class="p">%</span><span class="n">zn</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a><span class="w">            </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0d0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">            </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<a id="ln-311" name="ln-311" href="#ln-311"></a>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ok</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;cannot allocate memory&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="w">    </span><span class="n">gcomp</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">grd2_tdhf_compute_data_t</span><span class="p">(</span><span class="w"> </span><span class="n">d2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">                                     </span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="w">                                     </span><span class="p">,</span><span class="w"> </span><span class="n">xpy2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xpy</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="w">                                     </span><span class="p">,</span><span class="w"> </span><span class="n">xmy2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xmy</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">                                     </span><span class="p">,</span><span class="w"> </span><span class="n">hfscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hfscale</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">                                     </span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">nbf</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="w">      </span><span class="p">)</span>
<a id="ln-321" name="ln-321" href="#ln-321"></a>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="w">    </span><span class="k">call </span><span class="n">gcomp</span><span class="p">%</span><span class="n">init</span><span class="p">()</span>
<a id="ln-323" name="ln-323" href="#ln-323"></a>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="w">    </span><span class="k">call </span><span class="n">grd2_driver</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">de</span><span class="p">,</span><span class="w"> </span><span class="n">gcomp</span><span class="p">)</span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">    </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span><span class="p">%</span><span class="n">grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span><span class="p">%</span><span class="n">grad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">de</span>
<a id="ln-326" name="ln-326" href="#ln-326"></a>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">    </span><span class="k">call </span><span class="n">gcomp</span><span class="p">%</span><span class="n">clean</span><span class="p">()</span>
<a id="ln-328" name="ln-328" href="#ln-328"></a>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="w">  </span><span class="k">end subroutine</span>
<a id="ln-330" name="ln-330" href="#ln-330"></a>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="c">!###############################################################################</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">grd2_tdhf_compute_data_t_init</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="w">    </span><span class="c">!use messages, only: show_message, WITH_ABORT</span>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="k">    class</span><span class="p">(</span><span class="n">grd2_tdhf_compute_data_t</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">this</span>
<a id="ln-337" name="ln-337" href="#ln-337"></a>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">    </span><span class="k">call </span><span class="n">this</span><span class="p">%</span><span class="n">clean</span><span class="p">()</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a>
<a id="ln-340" name="ln-340" href="#ln-340"></a>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">  </span><span class="k">end subroutine</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="c">!###############################################################################</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">grd2_tdhf_compute_data_t_clean</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="k">    class</span><span class="p">(</span><span class="n">grd2_tdhf_compute_data_t</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">this</span>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">  </span><span class="k">end subroutine</span>
<a id="ln-349" name="ln-349" href="#ln-349"></a>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="c">!###############################################################################</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="c">!&gt; @brief Compute density factors for \Gamma term of 2-electron contribution</span>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="c">!&gt;        to TD-DFT gradients</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">grd2_tdhf_compute_data_t_get_density</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">dab</span><span class="p">,</span><span class="w"> </span><span class="n">dabmax</span><span class="p">)</span>
<a id="ln-355" name="ln-355" href="#ln-355"></a>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-357" name="ln-357" href="#ln-357"></a>
<a id="ln-358" name="ln-358" href="#ln-358"></a><span class="k">    class</span><span class="p">(</span><span class="n">grd2_tdhf_compute_data_t</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">this</span>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">basis_set</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dab</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dabmax</span>
<a id="ln-363" name="ln-363" href="#ln-363"></a>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coul</span><span class="p">,</span><span class="w"> </span><span class="n">coul2</span><span class="p">,</span><span class="w"> </span><span class="n">coul3</span><span class="p">,</span><span class="w"> </span><span class="n">exch</span><span class="p">,</span><span class="w"> </span><span class="n">exch2</span><span class="p">,</span><span class="w"> </span><span class="n">exch3</span><span class="p">,</span><span class="w"> </span><span class="n">exch4</span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">df1</span>
<a id="ln-366" name="ln-366" href="#ln-366"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coulfact</span><span class="p">,</span><span class="w"> </span><span class="n">xcfact</span>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i_</span><span class="p">,</span><span class="w"> </span><span class="n">j_</span><span class="p">,</span><span class="w"> </span><span class="n">k_</span><span class="p">,</span><span class="w"> </span><span class="n">l_</span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">l</span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">loc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="ln-370" name="ln-370" href="#ln-370"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbf</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="ln-371" name="ln-371" href="#ln-371"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ab</span><span class="p">(:,:,:,:)</span>
<a id="ln-372" name="ln-372" href="#ln-372"></a>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">    </span><span class="n">coulfact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">coulscale</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a><span class="w">    </span><span class="n">xcfact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">hfscale</span>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="w">    </span><span class="n">dabmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="w">    </span><span class="nb">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">ao_offset</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a id="ln-377" name="ln-377" href="#ln-377"></a>
<a id="ln-378" name="ln-378" href="#ln-378"></a><span class="w">    </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">naos</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a id="ln-379" name="ln-379" href="#ln-379"></a>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="w">    </span><span class="n">ab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nbf</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">1</span><span class="p">:</span><span class="n">nbf</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">:</span><span class="n">nbf</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">:</span><span class="n">nbf</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">dab</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">product</span><span class="p">(</span><span class="n">nbf</span><span class="p">))</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">    </span><span class="k">associate</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">p2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-383" name="ln-383" href="#ln-383"></a><span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">d2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">xpy</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">xpy2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a><span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">xmy</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="p">%</span><span class="n">xmy2</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="w">             </span><span class="p">)</span>
<a id="ln-387" name="ln-387" href="#ln-387"></a>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">    </span><span class="k">do </span><span class="n">i_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a><span class="w">      </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">loc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i_</span>
<a id="ln-390" name="ln-390" href="#ln-390"></a>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">      </span><span class="k">do </span><span class="n">j_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">loc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j_</span>
<a id="ln-393" name="ln-393" href="#ln-393"></a>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="w">        </span><span class="k">do </span><span class="n">k_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">          </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">loc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k_</span>
<a id="ln-396" name="ln-396" href="#ln-396"></a>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">          </span><span class="k">do </span><span class="n">l_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">            </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">loc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l_</span>
<a id="ln-399" name="ln-399" href="#ln-399"></a>
<a id="ln-400" name="ln-400" href="#ln-400"></a><span class="w">            </span><span class="n">coul</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="w">            </span><span class="o">+</span><span class="w">   </span><span class="n">p</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-402" name="ln-402" href="#ln-402"></a><span class="w">            </span><span class="o">+</span><span class="w">   </span><span class="n">p</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a id="ln-403" name="ln-403" href="#ln-403"></a>
<a id="ln-404" name="ln-404" href="#ln-404"></a><span class="w">            </span><span class="n">coul2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="n">xpy</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xpy</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
<a id="ln-406" name="ln-406" href="#ln-406"></a>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="w">            </span><span class="n">coul3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">d</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
<a id="ln-408" name="ln-408" href="#ln-408"></a>
<a id="ln-409" name="ln-409" href="#ln-409"></a><span class="w">            </span><span class="n">coul</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">coul</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="n">coul2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">coul3</span>
<a id="ln-410" name="ln-410" href="#ln-410"></a>
<a id="ln-411" name="ln-411" href="#ln-411"></a><span class="w">            </span><span class="n">df1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coulfact</span><span class="o">*</span><span class="n">coul</span>
<a id="ln-412" name="ln-412" href="#ln-412"></a>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xcfact</span><span class="o">/=</span><span class="mf">0.0_dp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="k">              </span><span class="n">exch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="w">              </span><span class="o">+</span><span class="w">   </span><span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">d</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a><span class="w">              </span><span class="o">+</span><span class="w">   </span><span class="n">p</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">d</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-417" name="ln-417" href="#ln-417"></a><span class="w">              </span><span class="o">+</span><span class="w">   </span><span class="n">p</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">d</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">              </span><span class="o">+</span><span class="w">   </span><span class="n">p</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">d</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a id="ln-419" name="ln-419" href="#ln-419"></a>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="w">              </span><span class="n">exch2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">xpy</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xpy</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-422" name="ln-422" href="#ln-422"></a><span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">xpy</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xpy</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a id="ln-423" name="ln-423" href="#ln-423"></a>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="w">              </span><span class="n">exch3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-425" name="ln-425" href="#ln-425"></a><span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">xmy</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="o">-</span><span class="n">xmy</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">xmy</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">-</span><span class="n">xmy</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">xmy</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="o">-</span><span class="n">xmy</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">xmy</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">-</span><span class="n">xmy</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
<a id="ln-427" name="ln-427" href="#ln-427"></a>
<a id="ln-428" name="ln-428" href="#ln-428"></a><span class="w">              </span><span class="n">exch4</span><span class="w"> </span><span class="o">=</span><span class="w">    </span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">d</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="w">                     </span><span class="o">+</span><span class="w">   </span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">d</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a>
<a id="ln-431" name="ln-431" href="#ln-431"></a><span class="w">              </span><span class="n">exch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">exch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="n">exch2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">exch3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exch4</span>
<a id="ln-432" name="ln-432" href="#ln-432"></a>
<a id="ln-433" name="ln-433" href="#ln-433"></a><span class="w">              </span><span class="n">df1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xcfact</span><span class="o">*</span><span class="n">exch</span>
<a id="ln-434" name="ln-434" href="#ln-434"></a><span class="w">            </span><span class="k">end if</span>
<a id="ln-435" name="ln-435" href="#ln-435"></a><span class="k">            </span><span class="n">dabmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">dabmax</span><span class="p">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">df1</span><span class="p">))</span>
<a id="ln-436" name="ln-436" href="#ln-436"></a><span class="w">            </span><span class="n">ab</span><span class="p">(</span><span class="n">l_</span><span class="p">,</span><span class="n">k_</span><span class="p">,</span><span class="n">j_</span><span class="p">,</span><span class="n">i_</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df1</span><span class="o">*</span><span class="nb">product</span><span class="p">(</span><span class="n">basis</span><span class="p">%</span><span class="n">bfnrm</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">]))</span>
<a id="ln-437" name="ln-437" href="#ln-437"></a><span class="w">          </span><span class="k">end do</span>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="k">        end do</span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="k">      end do</span>
<a id="ln-440" name="ln-440" href="#ln-440"></a><span class="k">    end do</span>
<a id="ln-441" name="ln-441" href="#ln-441"></a>
<a id="ln-442" name="ln-442" href="#ln-442"></a><span class="k">    end associate</span>
<a id="ln-443" name="ln-443" href="#ln-443"></a>
<a id="ln-444" name="ln-444" href="#ln-444"></a><span class="k">  end subroutine </span><span class="n">grd2_tdhf_compute_data_t_get_density</span>
<a id="ln-445" name="ln-445" href="#ln-445"></a>
<a id="ln-446" name="ln-446" href="#ln-446"></a><span class="c">!###############################################################################</span>
<a id="ln-447" name="ln-447" href="#ln-447"></a>
<a id="ln-448" name="ln-448" href="#ln-448"></a><span class="k">end module </span><span class="n">tdhf_gradient_mod</span>
</pre></div>

      </section>
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              OPENQP
 was developed by OpenQP Team<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </body>
</html>