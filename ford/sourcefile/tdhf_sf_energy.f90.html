<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="">
    <meta name="author" content="OpenQP Team" >
    <link rel="icon" href="../favicon.png">

    <title>tdhf_sf_energy.F90 &ndash; OPENQP</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">OPENQP <small>v1.0-dev</small></a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">OPENQP</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tdhf_sf_energy.F90
      <small>Source File</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.6% of total for source files.">255 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tdhf_sf_energy.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
            <li class="breadcrumb-item active" aria-current="page">tdhf_sf_energy.F90</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#mods-0"
         aria-expanded="false" aria-controls="mods-0">
         <h4 class="card-header bg-primary text-white">Modules</h4>
      </a>
      <div id="mods-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/tdhf_sf_energy_mod.html">tdhf_sf_energy_mod</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/tdhf_sf_energy.f90.html#src">tdhf_sf_energy.F90</a>
      </div>
    </div>


  </div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">This file depends on</h3>
          </div>
          <div class="card-body">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: sourcefile~~tdhf_sf_energy.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefiletdhf_sf_energyf90EfferentGraph" width="641pt" height="801pt"
 viewBox="0.00 0.00 641.00 801.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph" class="graph" transform="scale(.4445 .4445) rotate(0) translate(4 1799.0099)">
<title>sourcefile~~tdhf_sf_energy.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1799.0099 1438,-1799.0099 1438,4 -4,4"/>
<!-- sourcefile~tdhf_sf_energy.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~tdhf_sf_energy.f90</title>
<polygon fill="none" stroke="#000000" points="1434,-1025 1322,-1025 1322,-1001 1434,-1001 1434,-1025"/>
<text text-anchor="middle" x="1378" y="-1010.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">tdhf_sf_energy.F90</text>
</g>
<!-- sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~basis_tools.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/basis_tools.f90.html" xlink:title="basis_tools.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="607.5,-1152 514.5,-1152 514.5,-1128 607.5,-1128 607.5,-1152"/>
<text text-anchor="middle" x="561" y="-1137.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_tools.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1100C670.778,-1102.5205 629.9457,-1114.4072 600.7821,-1124.5735"/>
<polygon fill="#000000" stroke="#000000" points="599.6008,-1121.2788 591.3613,-1127.9392 601.9559,-1127.8708 599.6008,-1121.2788"/>
</g>
<!-- sourcefile~c_interop.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~c_interop.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/c_interop.f90.html" xlink:title="c_interop.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="914.5,-920 829.5,-920 829.5,-896 914.5,-896 914.5,-920"/>
<text text-anchor="middle" x="872" y="-905.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">c_interop.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~c_interop.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~c_interop.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1242,-1100C1200.1188,-1130.8215 1176.9246,-1102.7986 1125,-1100"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-1100C1065.2977,-1096.7822 1066.6387,-1052.3528 1014,-1024"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-1024C996.4136,-1014.5274 991.9769,-1011.9897 976,-1000 945.0209,-976.752 911.9614,-946.4461 891.6359,-927.0994"/>
<polygon fill="#000000" stroke="#000000" points="893.8898,-924.4115 884.2495,-920.0164 889.0449,-929.4639 893.8898,-924.4115"/>
</g>
<!-- sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~constants_io.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/constants_io.f90.html" xlink:title="constants_io.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="292.5,-1054 191.5,-1054 191.5,-1030 292.5,-1030 292.5,-1054"/>
<text text-anchor="middle" x="242" y="-1039.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants_io.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-1100C939.9353,-1090.0256 892.9099,-1087.4788 708,-1100"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1100C572.5372,-1112.4955 547.3019,-1032.0096 411.5,-1024"/>
</g>
<!-- sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~int2.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/int2.f90.html" xlink:title="int2.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1041.5,-1152 986.5,-1152 986.5,-1128 1041.5,-1128 1041.5,-1152"/>
<text text-anchor="middle" x="1014" y="-1137.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~int2.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-1100C1095.4229,-1098.4059 1063.8439,-1111.3749 1041.9613,-1122.9636"/>
<polygon fill="#000000" stroke="#000000" points="1039.9765,-1120.0617 1032.9215,-1127.966 1043.3658,-1126.1865 1039.9765,-1120.0617"/>
</g>
<!-- sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~mathlib.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/mathlib.f90.html" xlink:title="mathlib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052,-102 976,-102 976,-78 1052,-78 1052,-102"/>
<text text-anchor="middle" x="1014" y="-87.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mathlib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-52C1110.5264,-46.75 1074.4384,-60.9521 1047.3112,-73.4631"/>
<polygon fill="#000000" stroke="#000000" points="1045.695,-70.3555 1038.1399,-77.7832 1048.678,-76.6881 1045.695,-70.3555"/>
</g>
<!-- sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~messages.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/messages.f90.html" xlink:title="messages.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455.5,-521 367.5,-521 367.5,-497 455.5,-497 455.5,-521"/>
<text text-anchor="middle" x="411.5" y="-506.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">messages.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1242,-187C1208.0141,-134.5525 1185.8004,-250.5401 1125,-265"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-265C1090.3606,-273.2381 1086.8063,-239.5017 1052,-232 1018.9804,-224.8834 1009.7171,-229.9762 976,-232 883.2777,-237.5656 637.7631,-229.6949 561,-282"/>
</g>
<!-- sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~oqp_linalg.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/oqp_linalg.f90.html" xlink:title="oqp_linalg.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="753,-102 663,-102 663,-78 753,-78 753,-102"/>
<text text-anchor="middle" x="708" y="-87.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_linalg.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1242,-187C1198.823,-120.3686 1199.6391,-79.074 1125,-52"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-52C1078.6159,-35.175 1063.294,-47.8396 1014,-50"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-50C948.4956,-52.8708 936.3514,-102.5682 872,-90"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-90C836.3203,-83.0315 795.4353,-83.0142 763.4129,-84.7476"/>
<polygon fill="#000000" stroke="#000000" points="763.1121,-81.2594 753.3453,-85.3653 763.5409,-88.2463 763.1121,-81.2594"/>
</g>
<!-- sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~precision.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/precision.f90.html" xlink:title="precision.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="109.5,-1150 25.5,-1150 25.5,-1126 109.5,-1126 109.5,-1150"/>
<text text-anchor="middle" x="67.5" y="-1135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1242,-1100C980.9163,-1283.9335 1189.3011,-1752.2799 872,-1716"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-1716C819.445,-1720.0556 463.3012,-1611.7525 411.5,-1602"/>
</g>
<!-- sourcefile~printing.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~printing.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/printing.f90.html" xlink:title="printing.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="910,-608 834,-608 834,-584 910,-584 910,-608"/>
<text text-anchor="middle" x="872" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">printing.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~printing.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~printing.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1357.1686,-1025.1626C1329.9924,-1041.2895 1281.28,-1071.0928 1242,-1100"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1242,-1100C1236.0302,-1104.3933 944.8236,-665.6278 940,-660 925.9771,-643.6392 908.1851,-627.0152 894.3179,-614.8116"/>
<polygon fill="#000000" stroke="#000000" points="896.5121,-612.0816 886.6648,-608.1725 891.925,-617.3693 896.5121,-612.0816"/>
</g>
<!-- sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~strings.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/strings.f90.html" xlink:title="strings.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="102.5,-1498 32.5,-1498 32.5,-1474 102.5,-1474 102.5,-1498"/>
<text text-anchor="middle" x="67.5" y="-1483.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">strings.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-1716C735.0863,-1734.9741 699.2222,-1716 561,-1716 561,-1716 561,-1716 411.5,-1716 261.1339,-1716 126.6958,-1562.2562 82.653,-1506.167"/>
<polygon fill="#000000" stroke="#000000" points="85.2571,-1503.813 76.372,-1498.042 79.719,-1508.0942 85.2571,-1503.813"/>
</g>
<!-- sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~tagarray_driver.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/tagarray_driver.f90.html" xlink:title="tagarray_driver.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="766.5,-608 649.5,-608 649.5,-584 766.5,-584 766.5,-608"/>
<text text-anchor="middle" x="708" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tagarray_driver.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-265C972.9979,-311.0225 908.2545,-302.193 804,-422 770.2321,-460.8053 794.214,-487.74 768,-532 757.909,-549.0377 742.5918,-565.2773 729.9597,-577.1348"/>
<polygon fill="#000000" stroke="#000000" points="727.5475,-574.5977 722.5121,-583.9195 732.2616,-579.7724 727.5475,-574.5977"/>
</g>
<!-- sourcefile~tdhf_lib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~tdhf_lib.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/tdhf_lib.f90.html" xlink:title="tdhf_lib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1162,-1025 1088,-1025 1088,-1001 1162,-1001 1162,-1025"/>
<text text-anchor="middle" x="1125" y="-1010.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tdhf_lib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~tdhf_lib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~tdhf_lib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1242,-1100C1203.6118,-1128.2509 1158.397,-1067.8748 1137.1664,-1033.9641"/>
<polygon fill="#000000" stroke="#000000" points="1140.0235,-1031.926 1131.8399,-1025.197 1134.0411,-1035.5606 1140.0235,-1031.926"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~tdhf_sf_lib.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/tdhf_sf_lib.f90.html" xlink:title="tdhf_sf_lib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1286,-1025 1198,-1025 1198,-1001 1286,-1001 1286,-1025"/>
<text text-anchor="middle" x="1242" y="-1010.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tdhf_sf_lib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~tdhf_sf_lib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~tdhf_sf_lib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1321.8984,-1013C1313.4713,-1013 1304.7927,-1013 1296.402,-1013"/>
<polygon fill="#000000" stroke="#000000" points="1296.3463,-1009.5001 1286.3462,-1013 1296.3462,-1016.5001 1296.3463,-1009.5001"/>
</g>
<!-- sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~types.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/types.f90.html" xlink:title="types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="740,-924 676,-924 676,-900 740,-900 740,-924"/>
<text text-anchor="middle" x="708" y="-909.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-1024C924.7788,-975.9428 810.589,-940.3007 750.0619,-923.2301"/>
<polygon fill="#000000" stroke="#000000" points="750.6839,-919.77 740.1112,-920.455 748.8034,-926.5127 750.6839,-919.77"/>
</g>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~util.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/util.f90.html" xlink:title="util.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1152,-24 1098,-24 1098,0 1152,0 1152,-24"/>
<text text-anchor="middle" x="1125" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">util.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~tdhf_sf_energy.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1377.3136,-1000.7209C1371.9953,-909.0084 1335.0618,-330.6143 1242,-187"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1242,-187C1201.1255,-123.9219 1211.8718,-94.2351 1162,-38 1159.6363,-35.3347 1156.9482,-32.7975 1154.1248,-30.4266"/>
<polygon fill="#000000" stroke="#000000" points="1156.044,-27.4888 1145.967,-24.2171 1151.8043,-33.0589 1156.044,-27.4888"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M520.0028,-1127.9393C490.1015,-1119.4106 448.5078,-1108.0988 411.5,-1100"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1100C365.1805,-1089.8635 313.918,-1071.231 280.0263,-1057.8162"/>
<polygon fill="#000000" stroke="#000000" points="281.1035,-1054.4774 270.519,-1054.0093 278.5013,-1060.9758 281.1035,-1054.4774"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M559.3167,-1127.9612C547.5821,-1044.1003 478.3388,-550.3064 474,-544 469.0349,-536.7833 462.0704,-530.8882 454.5827,-526.1337"/>
<polygon fill="#000000" stroke="#000000" points="456.0666,-522.9517 445.641,-521.0656 452.6149,-529.0415 456.0666,-522.9517"/>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1100C307.0972,-1077.1526 181.7072,-1104.3984 114.8942,-1123.1574"/>
<polygon fill="#000000" stroke="#000000" points="113.7268,-1119.851 105.0786,-1125.9713 115.6559,-1126.58 113.7268,-1119.851"/>
</g>
<!-- sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~atomic_structure.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/atomic_structure.f90.html" xlink:title="atomic_structure.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="474,-1498 349,-1498 349,-1474 474,-1474 474,-1498"/>
<text text-anchor="middle" x="411.5" y="-1483.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atomic_structure.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M555.8695,-1152.2087C546.072,-1175.8189 524.3946,-1229.5093 510,-1276 490.233,-1339.8422 506.4887,-1363.5958 474,-1422 464.3093,-1439.4208 448.6236,-1455.4619 435.3911,-1467.1271"/>
<polygon fill="#000000" stroke="#000000" points="432.8962,-1464.6542 427.5445,-1473.7981 437.4303,-1469.9874 432.8962,-1464.6542"/>
</g>
<!-- sourcefile~basis_library.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~basis_library.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/basis_library.f90.html" xlink:title="basis_library.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="461.5,-1228 361.5,-1228 361.5,-1204 461.5,-1204 461.5,-1228"/>
<text text-anchor="middle" x="411.5" y="-1213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_library.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~basis_library.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~basis_library.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M541.6928,-1152.0465C524.3142,-1162.6585 497.9079,-1178.2167 474,-1190 466.9587,-1193.4704 459.3368,-1196.8999 451.9166,-1200.0736"/>
<polygon fill="#000000" stroke="#000000" points="450.5559,-1196.8488 442.6846,-1203.9405 453.2603,-1203.3053 450.5559,-1196.8488"/>
</g>
<!-- sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~constants.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/constants.f90.html" xlink:title="constants.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="285,-1208 199,-1208 199,-1184 285,-1184 285,-1208"/>
<text text-anchor="middle" x="242" y="-1193.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M514.273,-1148.2029C455.9521,-1158.441 356.4461,-1175.9091 295.239,-1186.654"/>
<polygon fill="#000000" stroke="#000000" points="294.2604,-1183.2721 285.0163,-1188.4486 295.4708,-1190.1667 294.2604,-1183.2721"/>
</g>
<!-- sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~elements.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/elements.f90.html" xlink:title="elements.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="284.5,-1435 199.5,-1435 199.5,-1411 284.5,-1411 284.5,-1435"/>
<text text-anchor="middle" x="242" y="-1420.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">elements.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~elements.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M551.109,-1152.1835C535.5176,-1171.1128 503.9143,-1208.3841 474,-1237 407.1357,-1300.962 385.6147,-1311.6495 313,-1369 297.6015,-1381.1616 280.0534,-1394.5126 266.2555,-1404.8966"/>
<polygon fill="#000000" stroke="#000000" points="264.0985,-1402.1394 258.2017,-1410.9415 268.3005,-1407.7378 264.0985,-1402.1394"/>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="449.5,-904 373.5,-904 373.5,-880 449.5,-880 449.5,-904"/>
<text text-anchor="middle" x="411.5" y="-889.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~basis_tools.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~basis_tools.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.5863,-1127.7016C529.6194,-1087.9439 454.047,-962.5797 423.9987,-912.7336"/>
<polygon fill="#000000" stroke="#000000" points="426.9424,-910.8374 418.7822,-904.0801 420.9475,-914.4514 426.9424,-910.8374"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M859.1825,-920.0585C820.6687,-956.289 708.5789,-1061.7113 708,-1062"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1062C682.2974,-1074.8166 673.6326,-1073.0439 648,-1086 626.8492,-1096.6907 604.1341,-1110.8909 587.2197,-1122.0462"/>
<polygon fill="#000000" stroke="#000000" points="584.8408,-1119.426 578.4664,-1127.8888 588.7269,-1125.2483 584.8408,-1119.426"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M870.6339,-895.9297C865.4242,-855.5929 843.1426,-724.1278 768,-655 747.4142,-636.062 727.7643,-655.7937 708,-636"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M868.2592,-920.0161C856.6059,-956.5419 818.6813,-1068.8331 768,-1152 741.3487,-1195.7342 520.3465,-1485.2061 474,-1507 352.9738,-1563.9113 188.7295,-1525.2001 111.3099,-1501.1449"/>
<polygon fill="#000000" stroke="#000000" points="112.0091,-1497.6948 101.4188,-1498.0034 109.8901,-1504.3663 112.0091,-1497.6948"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M868.1583,-895.6884C851.835,-843.6458 788.1468,-643.3964 768,-622 764.8505,-618.6552 761.1974,-615.7181 757.2786,-613.1435"/>
<polygon fill="#000000" stroke="#000000" points="758.7892,-609.9761 748.3675,-608.0686 755.325,-616.0588 758.7892,-609.9761"/>
</g>
<!-- sourcefile~c_interop.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~c_interop.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M829.3391,-909.0405C804.9242,-909.636 774.4117,-910.3802 750.0924,-910.9734"/>
<polygon fill="#000000" stroke="#000000" points="749.9965,-907.4746 740.0849,-911.2174 750.1673,-914.4725 749.9965,-907.4746"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-1138C800.5402,-1123.6374 780.6879,-1132.5909 708,-1138"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1138C678.3211,-1140.2086 645.1814,-1140.8201 617.8909,-1140.8313"/>
<polygon fill="#000000" stroke="#000000" points="617.7453,-1137.3311 607.7373,-1140.8083 617.7293,-1144.3311 617.7453,-1137.3311"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1138C664.2469,-1141.2559 655.5712,-1155.8534 612,-1161 494.0791,-1174.9289 456.5233,-1164.3795 349,-1114 317.8149,-1099.3884 285.4781,-1076.3441 264.6306,-1060.2745"/>
<polygon fill="#000000" stroke="#000000" points="266.7335,-1057.4759 256.701,-1054.0699 262.4198,-1062.9888 266.7335,-1057.4759"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-674C846.1375,-646.9697 734.4332,-662.4725 708,-636"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-636C688.2357,-616.2063 667.7962,-636.7618 648,-617 610.6964,-579.7614 646.7433,-543.6381 612,-504 595.4876,-485.1613 585.9548,-482.1935 561,-480"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561,-1602C496.0941,-1587.7843 476.7973,-1614.2934 411.5,-1602"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008.7825,-1127.9673C1000.7721,-1109.1041 985.3879,-1071.2835 976,-1038 930.3255,-876.0667 988.3168,-795.5687 872,-674"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-674C842.6131,-643.2862 798.6915,-623.289 763.6958,-611.2395"/>
<polygon fill="#000000" stroke="#000000" points="764.6749,-607.8767 754.0814,-608.0493 762.4704,-614.5206 764.6749,-607.8767"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M986.4625,-1142.5725C957.6211,-1144.5807 911.1584,-1145.8704 872,-1138"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-1138C847.3454,-1133.0447 754.9158,-987.649 720.7759,-932.7311"/>
<polygon fill="#000000" stroke="#000000" points="723.7029,-930.8098 715.4604,-924.153 717.7526,-934.4969 723.7029,-930.8098"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1012.4549,-1152.23C1005.5991,-1205.0614 976.6453,-1413.4356 940,-1467 839.0357,-1614.5796 736.7589,-1634.8991 561,-1602"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561,-1602C502.5845,-1589.2058 451.6547,-1535.9562 427.1003,-1506.2524"/>
<polygon fill="#000000" stroke="#000000" points="429.6172,-1503.7976 420.618,-1498.2059 424.166,-1508.189 429.6172,-1503.7976"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-1138C799.9024,-1123.1658 634.5126,-1255.7446 561,-1252"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561,-1252C466.5562,-1250.3755 441.2164,-1257.4548 349,-1237 324.0185,-1231.4588 297.1277,-1221.135 276.5532,-1212.2337"/>
<polygon fill="#000000" stroke="#000000" points="277.8472,-1208.9791 267.286,-1208.1363 275.0165,-1215.3812 277.8472,-1208.9791"/>
</g>
<!-- sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~int2_pairs.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/int2_pairs.f90.html" xlink:title="int2_pairs.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="751.5,-1380 664.5,-1380 664.5,-1356 751.5,-1356 751.5,-1380"/>
<text text-anchor="middle" x="708" y="-1365.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_pairs.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1001.6444,-1152.3236C967.1863,-1186.1845 866.1009,-1282.0961 768,-1342 762.2063,-1345.5379 755.8455,-1348.8415 749.4988,-1351.8274"/>
<polygon fill="#000000" stroke="#000000" points="747.9685,-1348.6778 740.2777,-1355.9649 750.8342,-1355.0643 747.9685,-1348.6778"/>
</g>
<!-- sourcefile~int_libint.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~int_libint.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/int_libint.f90.html" xlink:title="int_libint.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="912,-1458 832,-1458 832,-1434 912,-1434 912,-1458"/>
<text text-anchor="middle" x="872" y="-1443.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_libint.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_libint.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_libint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1012.8725,-1152.1863C1008.8642,-1190.2078 992.6007,-1308.8932 940,-1389 929.7771,-1404.5687 914.0426,-1418.1458 900.283,-1428.1398"/>
<polygon fill="#000000" stroke="#000000" points="898.2413,-1425.2965 892.0378,-1433.8852 902.2434,-1431.0397 898.2413,-1425.2965"/>
</g>
<!-- sourcefile~int_rotaxis.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~int_rotaxis.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/int_rotaxis.f90.html" xlink:title="int_rotaxis.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="917,-1380 827,-1380 827,-1356 917,-1356 917,-1380"/>
<text text-anchor="middle" x="872" y="-1365.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_rotaxis.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_rotaxis.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_rotaxis.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008.9531,-1152.3343C998.0909,-1178.2817 970.958,-1239.9912 940,-1287 925.2947,-1309.3295 905.3171,-1332.464 890.823,-1348.2629"/>
<polygon fill="#000000" stroke="#000000" points="888.0483,-1346.107 883.8004,-1355.8129 893.1739,-1350.8745 888.0483,-1346.107"/>
</g>
<!-- sourcefile~int_rys.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~int_rys.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/int_rys.f90.html" xlink:title="int_rys.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="907,-1190 837,-1190 837,-1166 907,-1166 907,-1190"/>
<text text-anchor="middle" x="872" y="-1175.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int_rys.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~int_rys.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~int_rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M986.2839,-1147.417C966.5977,-1152.6851 939.7324,-1159.8744 916.9955,-1165.9589"/>
<polygon fill="#000000" stroke="#000000" points="915.9647,-1162.6116 907.2094,-1168.5778 917.7743,-1169.3736 915.9647,-1162.6116"/>
</g>
<!-- sourcefile~int2.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~int2.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-1138C812.0716,-1125.9551 819.695,-1080.6209 768,-1048 664.3971,-982.6239 528.6976,-931.5936 458.3519,-907.3871"/>
<polygon fill="#000000" stroke="#000000" points="459.0533,-903.9283 448.4588,-904.0117 456.7929,-910.5533 459.0533,-903.9283"/>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1002.245,-102.1778C988.4773,-115.8097 964.4299,-137.7231 940,-151 884.3005,-181.2709 864.0378,-173.6473 804,-194 695.217,-230.8772 654.4393,-215.196 561,-282"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561,-282C483.7591,-334.6307 436.5471,-441.7095 419.1355,-487.4749"/>
<polygon fill="#000000" stroke="#000000" points="415.7993,-486.4057 415.6091,-496.9988 422.3637,-488.8364 415.7993,-486.4057"/>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M975.7205,-93.5561C946.9631,-95.3709 906.7245,-96.0838 872,-90"/>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.0118,-77.9466C954.6362,-67.8214 911.2152,-54.5977 872,-52"/>
</g>
<!-- sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~eigen.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/eigen.f90.html" xlink:title="eigen.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="904.5,-142 839.5,-142 839.5,-118 904.5,-118 904.5,-142"/>
<text text-anchor="middle" x="872" y="-127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">eigen.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mathlib.f90&#45;&gt;sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~mathlib.f90&#45;&gt;sourcefile~eigen.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M975.9466,-100.7193C957.0579,-106.04 934.1719,-112.4868 914.6877,-117.9753"/>
<polygon fill="#000000" stroke="#000000" points="913.5244,-114.6667 904.848,-120.747 915.4224,-121.4045 913.5244,-114.6667"/>
</g>
<!-- sourcefile~messages.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~messages.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.6413,-521.1339C385.8117,-589.778 277.7571,-929.5602 249.0263,-1019.9055"/>
<polygon fill="#000000" stroke="#000000" points="245.6221,-1019.0613 245.9269,-1029.6518 252.2929,-1021.1827 245.6221,-1019.0613"/>
</g>
<!-- sourcefile~messages.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~messages.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.206,-516.0392C331.678,-523.0064 281.4126,-535.9075 242,-558"/>
</g>
<!-- sourcefile~blas_wrap.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~blas_wrap.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/blas_wrap.f90.html" xlink:title="blas_wrap.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="605,-60 517,-60 517,-36 605,-36 605,-60"/>
<text text-anchor="middle" x="561" y="-45.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">blas_wrap.F90</text>
</a>
</g>
</g>
<!-- sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~blas_wrap.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~blas_wrap.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M665.8757,-77.9645C649.422,-73.2634 630.3858,-67.8245 613.0843,-62.8812"/>
<polygon fill="#000000" stroke="#000000" points="613.7072,-59.4192 603.1305,-60.0373 611.7841,-66.1499 613.7072,-59.4192"/>
</g>
<!-- sourcefile~lapack_wrap.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~lapack_wrap.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/lapack_wrap.f90.html" xlink:title="lapack_wrap.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="612,-140 510,-140 510,-116 612,-116 612,-140"/>
<text text-anchor="middle" x="561" y="-125.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lapack_wrap.F90</text>
</a>
</g>
</g>
<!-- sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~lapack_wrap.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~oqp_linalg.f90&#45;&gt;sourcefile~lapack_wrap.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M662.6957,-101.7113C648.3018,-105.4322 632.2075,-109.5926 617.1447,-113.4864"/>
<polygon fill="#000000" stroke="#000000" points="616.2292,-110.1079 607.4234,-115.9994 617.9812,-116.8852 616.2292,-110.1079"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M854.1829,-608.0987C838.59,-619.6303 816.5269,-638.4037 804,-660 769.6003,-719.3052 807.0672,-753.66 768,-810 731.3337,-862.8775 687.2783,-840.0328 648,-891 619.4957,-927.9869 581.1905,-1064.0793 566.7922,-1117.8918"/>
<polygon fill="#000000" stroke="#000000" points="563.3494,-1117.2197 564.1677,-1127.7829 570.1153,-1119.015 563.3494,-1117.2197"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M833.8219,-599.2167C823.2179,-601.6898 812.338,-605.8991 804,-613 773.0769,-639.3351 800.1851,-672.223 768,-697 676.1584,-767.7021 618.8626,-695.2178 510,-735 461.6354,-752.6741 456.9234,-771.7468 411.5,-796"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-796C384.9759,-809.4854 370.8899,-799.8452 349,-820 287.6307,-876.5047 257.6743,-975.7152 246.8799,-1019.8027"/>
<polygon fill="#000000" stroke="#000000" points="243.4195,-1019.2289 244.5409,-1029.7642 250.2342,-1020.829 243.4195,-1019.2289"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-518C692.5074,-511.323 577.8054,-481.4772 561,-480"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M848.0803,-583.938C816.3699,-568.1061 758.5246,-539.7751 708,-518"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-518C682.3124,-506.9291 672.2143,-513.0032 648,-499 629.2106,-488.1341 630.0248,-478.092 612,-466 591.1965,-452.0439 586.0305,-443.0155 561,-442"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~tagarray_driver.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~tagarray_driver.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M833.9629,-596C816.961,-596 796.3791,-596 776.8238,-596"/>
<polygon fill="#000000" stroke="#000000" points="776.7156,-592.5001 766.7156,-596 776.7156,-599.5001 776.7156,-592.5001"/>
</g>
<!-- sourcefile~printing.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~printing.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M853.6353,-608.187C837.9011,-619.6468 815.945,-638.2613 804,-660 763.0311,-734.5592 806.6178,-772.1963 768,-848 759.1258,-865.4194 744.0664,-881.4604 731.2553,-893.126"/>
<polygon fill="#000000" stroke="#000000" points="728.8575,-890.5736 723.6446,-899.7973 733.4717,-895.8376 728.8575,-890.5736"/>
</g>
<!-- sourcefile~tagarray_driver.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~tagarray_driver.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M697.798,-583.9693C681.2862,-565.0571 647.0087,-528.0529 612,-504 591.3526,-489.8141 585.9548,-482.1935 561,-480"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-986C953.6119,-967.6619 920.7676,-945.9409 872,-986"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-986C757.2665,-908.0378 679.1232,-1043.1827 411.5,-1024"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1024C375.3807,-1021.8697 335.0986,-1025.8803 302.8692,-1030.6518"/>
<polygon fill="#000000" stroke="#000000" points="302.0526,-1027.2363 292.7036,-1032.2209 303.1205,-1034.1544 302.0526,-1027.2363"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~int2.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~int2.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1114.3569,-1025.1773C1095.1784,-1047.1202 1054.6555,-1093.4842 1031.3956,-1120.0969"/>
<polygon fill="#000000" stroke="#000000" points="1028.7196,-1117.8402 1024.774,-1127.673 1033.9902,-1122.4468 1028.7196,-1117.8402"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1123.7907,-1000.7663C1119.0951,-953.2022 1101.6546,-775.9946 1088,-630 1071.4606,-453.1607 1083.0709,-406.8722 1052,-232 1044.3539,-188.9666 1029.9307,-139.9576 1021.2205,-112.2288"/>
<polygon fill="#000000" stroke="#000000" points="1024.4521,-110.8418 1018.083,-102.3751 1017.782,-112.9656 1024.4521,-110.8418"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1123.8863,-1000.9032C1115.7853,-913.193 1065.8399,-377.2953 1052,-346 1031.3695,-299.3496 999.5047,-305.2704 976,-260 944.2086,-198.7692 987.8386,-158.7129 940,-109 918.2415,-86.389 902.909,-95.4153 872,-90"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-360C983.8412,-298.8598 479.0923,-235.1138 411.5,-244"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1087.9717,-1005.0897C1066.2575,-1000.1791 1038.3855,-993.4051 1014,-986"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-986C994.8866,-980.1958 989.2837,-976.9183 976,-962 951.4118,-934.386 968.3303,-910.7593 940,-887 915.9564,-866.8358 901.7678,-858.0718 872,-868"/>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~eigen.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~eigen.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1123.8845,-1000.7897C1116.5068,-921.5749 1073.2014,-480.0176 1014,-360"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-360C1012.6508,-357.2648 919.7797,-207.1833 884.9779,-150.9624"/>
<polygon fill="#000000" stroke="#000000" points="887.7894,-148.8545 879.5499,-142.1941 881.8375,-152.5391 887.7894,-148.8545"/>
</g>
<!-- sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~physical_constants.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/physical_constants.f90.html" xlink:title="physical_constants.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="135,-1653 0,-1653 0,-1629 135,-1629 135,-1653"/>
<text text-anchor="middle" x="67.5" y="-1638.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">physical_constants.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~tdhf_lib.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1118.1182,-1025.1259C1110.1962,-1039.3922 1097.1078,-1063.9355 1088,-1086 1006.7014,-1282.9544 1080.0995,-1381.4615 940,-1542 871.411,-1620.5953 476.7063,-1745.8426 411.5,-1754"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1754C304.3295,-1761.3136 269.7366,-1772.3095 171,-1730 135.0395,-1714.5906 102.4176,-1682.0443 83.7828,-1660.8711"/>
<polygon fill="#000000" stroke="#000000" points="86.2922,-1658.4208 77.1261,-1653.1073 80.9781,-1662.9771 86.2922,-1658.4208"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1202.4481,-1025.0153C1189.6535,-1028.4613 1175.3273,-1031.8608 1162,-1034 1112.0984,-1042.0097 753.229,-1039.4466 708,-1062"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~mathlib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~mathlib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-90C1108.8212,-72.9542 1082.8668,-72.1489 1060.1222,-75.9792"/>
<polygon fill="#000000" stroke="#000000" points="1059.398,-72.5546 1050.2778,-77.9466 1060.7699,-79.4189 1059.398,-72.5546"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-246C980.9336,-227.5504 744.0463,-384.405 708,-396"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-396C681.5851,-405.2018 671.4209,-399.7069 648,-415 627.6956,-428.2582 631.3773,-441.4203 612,-456 591.9823,-471.0615 585.9548,-482.1935 561,-480"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561,-480C524.7967,-476.8178 484.3684,-485.4144 454.6906,-494.0578"/>
<polygon fill="#000000" stroke="#000000" points="453.6163,-490.7261 445.0597,-496.9739 455.6449,-497.4257 453.6163,-490.7261"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1241.3273,-1000.9861C1235.4294,-897.569 1191.1624,-159.708 1125,-90"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-90C1106.95,-70.9828 1040.1943,-48.852 1014,-50"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1240.9829,-1000.9126C1236.2064,-949.9919 1212.4192,-749.4298 1125,-616"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-616C1036.4861,-480.8993 1157.2841,-382.4833 1052,-260 1040.2675,-246.3509 1029.4785,-255.1852 1014,-246"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1014,-246C926.1548,-193.8709 658.603,-137.8691 561,-168"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~tdhf_lib.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~tdhf_lib.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1197.7673,-1013C1189.3942,-1013 1180.6059,-1013 1172.1469,-1013"/>
<polygon fill="#000000" stroke="#000000" points="1172.0422,-1009.5001 1162.0421,-1013 1172.0421,-1016.5001 1172.0422,-1009.5001"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-616C1061.3288,-502.0925 1046.6438,-768.7933 940,-844 913.8085,-862.4706 902.403,-857.86 872,-868"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-868C829.8821,-875.2934 782.862,-888.4406 750.0051,-898.4706"/>
<polygon fill="#000000" stroke="#000000" points="748.8056,-895.1779 740.284,-901.4733 750.8715,-901.8661 748.8056,-895.1779"/>
</g>
<!-- sourcefile~int1.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~int1.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/int1.f90.html" xlink:title="int1.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1041.5,-608 986.5,-608 986.5,-584 1041.5,-584 1041.5,-608"/>
<text text-anchor="middle" x="1014" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int1.F90</text>
</a>
</g>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~int1.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~int1.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1125,-616C1111.3362,-591.5556 1078.2966,-588.1812 1051.7943,-589.9642"/>
<polygon fill="#000000" stroke="#000000" points="1051.2786,-586.4969 1041.6464,-590.9096 1051.928,-593.4668 1051.2786,-586.4969"/>
</g>
<!-- sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~tdhf_sf_lib.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1233.9029,-1025.0577C1224.5635,-1039.2599 1209.0753,-1063.7432 1198,-1086 1060.6348,-1362.0479 1191.3838,-1551.4564 940,-1730 748.3002,-1866.1534 646.4274,-1744.2183 411.5,-1754"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M701.5864,-924.2984C686.9225,-952.0966 649.3228,-1021.5869 612,-1076 601.5527,-1091.2311 588.5644,-1107.497 578.3099,-1119.8191"/>
<polygon fill="#000000" stroke="#000000" points="575.4735,-1117.7537 571.7122,-1127.6585 580.8292,-1122.2612 575.4735,-1117.7537"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M681.4922,-899.894C639.946,-879.7447 559.1713,-835.6729 510,-777 441.4483,-695.2018 515.9277,-580.0255 411.5,-558"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~atomic_structure.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~atomic_structure.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M691.8645,-924.0604C654.0672,-953.1868 559.2766,-1031.4601 510,-1119 501.2289,-1134.5819 436.649,-1387.0662 417.0948,-1463.954"/>
<polygon fill="#000000" stroke="#000000" points="413.6191,-1463.4209 414.5484,-1473.9749 420.4035,-1465.1449 413.6191,-1463.4209"/>
</g>
<!-- sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~functionals.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/functionals.f90.html" xlink:title="functionals.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="608,-570 514,-570 514,-546 608,-546 608,-570"/>
<text text-anchor="middle" x="561" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">functionals.F90</text>
</a>
</g>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~functionals.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~functionals.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M701.5275,-899.6715C689.4899,-876.3115 663.4798,-823.748 648,-777 625.0875,-707.806 644.819,-682.0823 612,-617 604.5435,-602.2132 592.5701,-588.0879 582.0981,-577.3674"/>
<polygon fill="#000000" stroke="#000000" points="584.4045,-574.7265 574.8243,-570.2022 579.4921,-579.7133 584.4045,-574.7265"/>
</g>
<!-- sourcefile~types.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~types.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M675.9876,-909.8406C624.0373,-906.3364 521.0535,-899.3898 460.0488,-895.2748"/>
<polygon fill="#000000" stroke="#000000" points="460.1137,-891.7713 449.9007,-894.5903 459.6425,-898.7554 460.1137,-891.7713"/>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1097.799,-16.3804C1033.0283,-26.8006 874.8218,-52.1869 872,-52"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-52C668.3038,-32.0133 591.5699,49.2957 411.5,-48"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-48C386.0254,-61.9269 371.9164,-49.1744 349,-67 276.4425,-123.4392 295.3866,-169.1679 242,-244"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-244C193.7309,-311.659 192.8489,-336.811 171,-417 97.6761,-686.1107 73.8706,-1026.7187 68.6854,-1115.8519"/>
<polygon fill="#000000" stroke="#000000" points="65.1884,-1115.702 68.1199,-1125.8832 72.1773,-1116.0961 65.1884,-1115.702"/>
</g>
<!-- sourcefile~atomic_structure.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~atomic_structure.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M348.8051,-1486C280.657,-1486 173.42,-1486 112.9366,-1486"/>
<polygon fill="#000000" stroke="#000000" points="112.9255,-1482.5001 102.9255,-1486 112.9254,-1489.5001 112.9255,-1482.5001"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M399.5112,-1203.7378C386.9242,-1190.8603 366.5604,-1170.0173 349,-1152 318.196,-1120.3945 282.4539,-1083.6321 261.0632,-1061.6209"/>
<polygon fill="#000000" stroke="#000000" points="263.3466,-1058.9484 253.8674,-1054.2158 258.3263,-1063.8267 263.3466,-1058.9484"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M395.6426,-1228.0596C357.0011,-1257.4907 254.9845,-1335.4579 171,-1402 142.9418,-1424.2309 111.0024,-1450.2656 90.1166,-1467.3903"/>
<polygon fill="#000000" stroke="#000000" points="87.6611,-1464.8777 82.1524,-1473.9279 92.1025,-1470.2883 87.6611,-1464.8777"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.1033,-1210.0535C340.3053,-1207.5994 316.1848,-1204.7534 295.1115,-1202.2668"/>
<polygon fill="#000000" stroke="#000000" points="295.3804,-1198.7744 285.0391,-1201.0784 294.56,-1205.7261 295.3804,-1198.7744"/>
</g>
<!-- sourcefile~basis_library.f90&#45;&gt;sourcefile~elements.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~basis_library.f90&#45;&gt;sourcefile~elements.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M405.5798,-1228.1014C391.8864,-1255.3208 355.8954,-1322.6105 313,-1369 300.4079,-1382.6179 284.0581,-1395.3128 270.2226,-1404.9679"/>
<polygon fill="#000000" stroke="#000000" points="267.8642,-1402.3388 261.5586,-1410.8529 271.7974,-1408.1293 267.8642,-1402.3388"/>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M547.2336,-60.2316C535.6032,-71.3181 519.3831,-88.6836 510,-107 478.5443,-168.4039 490.3353,-190.9697 474,-258 453.3178,-342.8674 427.9818,-443.6772 417.0048,-487.2055"/>
<polygon fill="#000000" stroke="#000000" points="413.5881,-486.4408 414.535,-496.9933 420.3754,-488.1536 413.5881,-486.4408"/>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.7569,-37.414C485.481,-32.3578 443.5828,-30.665 411.5,-48"/>
</g>
<!-- sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~mathlib_types.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/mathlib_types.f90.html" xlink:title="mathlib_types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="466,-100 357,-100 357,-76 466,-76 466,-100"/>
<text text-anchor="middle" x="411.5" y="-85.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mathlib_types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~blas_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~blas_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.9537,-59.785C501.1904,-64.0026 483.2224,-68.8101 466.6398,-73.2469"/>
<polygon fill="#000000" stroke="#000000" points="465.2815,-69.9871 456.526,-75.9529 467.0908,-76.7492 465.2815,-69.9871"/>
</g>
<!-- sourcefile~constants.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~constants.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M205.8435,-1183.9824C179.0536,-1175.078 142.341,-1162.8755 113.4672,-1153.2785"/>
<polygon fill="#000000" stroke="#000000" points="114.2037,-1149.8351 103.6102,-1150.0022 111.9958,-1156.4778 114.2037,-1149.8351"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-130C681.3052,-132.5492 526.7585,-247.0652 510,-268 454.547,-337.2722 426.2185,-442.0237 416.0232,-487.1039"/>
<polygon fill="#000000" stroke="#000000" points="412.5797,-486.468 413.8662,-496.9844 419.4186,-487.9611 412.5797,-486.468"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~oqp_linalg.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~oqp_linalg.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M839.2063,-122.0015C817.4207,-116.688 788.2818,-109.5809 762.9982,-103.4142"/>
<polygon fill="#000000" stroke="#000000" points="763.7042,-99.9838 753.1596,-101.0145 762.0454,-106.7845 763.7042,-99.9838"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-130C640.9964,-138.0123 625.4784,-148.095 561,-168"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561,-168C538.301,-175.0074 531.6372,-174.1929 510,-184 463.3118,-205.1616 462.5251,-239.0968 411.5,-244"/>
</g>
<!-- sourcefile~eigen.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~eigen.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M839.2652,-128.4465C806.1174,-127.2383 753.4065,-126.3177 708,-130"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-130C664.2694,-133.5464 655.2796,-114.1985 612,-107 566.9446,-99.5062 515.6648,-94.713 476.2442,-91.8155"/>
<polygon fill="#000000" stroke="#000000" points="476.4549,-88.3217 466.2312,-91.1014 475.9568,-95.304 476.4549,-88.3217"/>
</g>
<!-- sourcefile~elements.f90&#45;&gt;sourcefile~strings.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~elements.f90&#45;&gt;sourcefile~strings.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M208.3546,-1435.147C180.3829,-1445.2457 140.41,-1459.6772 110.1879,-1470.5883"/>
<polygon fill="#000000" stroke="#000000" points="108.963,-1467.3094 100.7457,-1473.9972 111.34,-1473.8934 108.963,-1467.3094"/>
</g>
<!-- sourcefile~elements.f90&#45;&gt;sourcefile~physical_constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~elements.f90&#45;&gt;sourcefile~physical_constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232.3696,-1435.0311C203.8345,-1470.6795 119.5016,-1576.0352 83.7808,-1620.6606"/>
<polygon fill="#000000" stroke="#000000" points="80.8325,-1618.7431 77.3158,-1628.7373 86.2974,-1623.1176 80.8325,-1618.7431"/>
</g>
<!-- sourcefile~functionals.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~functionals.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M524.0449,-545.8876C504.1146,-539.3553 479.3197,-531.2285 458.0794,-524.2668"/>
<polygon fill="#000000" stroke="#000000" points="458.8815,-520.8466 448.2887,-521.0578 456.7012,-527.4984 458.8815,-520.8466"/>
</g>
<!-- sourcefile~functionals.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~functionals.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M513.6844,-562.9553C484.016,-564.8478 445.1499,-565.0973 411.5,-558"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1012.3863,-608.0034C1005.1283,-660.8224 974.3617,-872.438 940,-929 919.5249,-962.7036 902.4728,-960.9687 872,-986"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-986C809.923,-1036.9919 779.8927,-1026.1508 708,-1062"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~constants_io.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~constants_io.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1005.2937,-608.0394C989.2417,-630.0217 955.2333,-675.5433 940,-688 873.3691,-742.4859 851.059,-754.4258 768,-777 691.4425,-797.8072 482.2192,-760.0448 411.5,-796"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1008.8928,-583.7798C998.6708,-560.4731 973.7495,-509.0527 940,-476 914.9493,-451.4665 903.0499,-452.2891 872,-436"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-436C805.5618,-401.1459 779.4215,-373.0258 708,-396"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1011.8753,-583.8458C1005.9109,-553.0253 986.3269,-470.8099 940,-422 881.4338,-360.2948 847.7378,-367.6549 768,-338 729.6044,-323.7205 452.2771,-240.0816 411.5,-244"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~printing.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~printing.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M986.2839,-596C967.5407,-596 942.2897,-596 920.2901,-596"/>
<polygon fill="#000000" stroke="#000000" points="920.1213,-592.5001 910.1212,-596 920.1212,-599.5001 920.1213,-592.5001"/>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M986.2794,-586.1653C972.5496,-581.8032 955.608,-577.1718 940,-575 811.4606,-557.1144 776.3644,-555.8988 648,-575 616.2936,-579.7181 531.0156,-592.7946 510,-617 441.8792,-695.4602 528.8404,-759.7449 474,-848 467.2699,-858.8308 456.786,-867.7302 446.3148,-874.6221"/>
<polygon fill="#000000" stroke="#000000" points="444.3175,-871.7406 437.6046,-879.9374 447.9639,-877.7159 444.3175,-871.7406"/>
</g>
<!-- sourcefile~ecp.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~ecp.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/ecp.f90.html" xlink:title="ecp.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="735.5,-768 680.5,-768 680.5,-744 735.5,-744 735.5,-768"/>
<text text-anchor="middle" x="708" y="-753.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ecp.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~ecp.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~ecp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M986.4052,-603.7922C931.0671,-619.5033 811.1855,-653.9991 804,-660 777.1482,-682.425 793.5416,-706.0933 768,-730 761.5066,-736.0778 753.3682,-740.8706 745.1999,-744.5958"/>
<polygon fill="#000000" stroke="#000000" points="743.62,-741.4607 735.694,-748.4913 746.2744,-747.9379 743.62,-741.4607"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~mod_1e_primitives.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/mod_1e_primitives.f90.html" xlink:title="mod_1e_primitives.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="940,-509 804,-509 804,-485 940,-485 940,-509"/>
<text text-anchor="middle" x="872" y="-494.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_1e_primitives.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~mod_1e_primitives.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~mod_1e_primitives.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M997.9851,-583.9871C983.099,-572.8993 960.2407,-556.0715 940,-542 926.8118,-532.8315 911.9564,-522.9506 899.5022,-514.7898"/>
<polygon fill="#000000" stroke="#000000" points="901.2035,-511.7207 890.9162,-509.1863 897.3777,-517.5827 901.2035,-511.7207"/>
</g>
<!-- sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~mod_shell_tools.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/mod_shell_tools.f90.html" xlink:title="mod_shell_tools.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="768,-448 648,-448 648,-424 768,-424 768,-448"/>
<text text-anchor="middle" x="708" y="-433.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_shell_tools.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int1.f90&#45;&gt;sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~int1.f90&#45;&gt;sourcefile~mod_shell_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M872,-436C841.3998,-419.9468 802.9539,-419.1147 770.9789,-422.6796"/>
<polygon fill="#000000" stroke="#000000" points="770.3172,-419.2357 760.8429,-423.9778 771.2066,-426.179 770.3172,-419.2357"/>
</g>
<!-- sourcefile~int2_pairs.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~int2_pairs.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M667.5611,-1355.9981C660.3369,-1352.4125 653.4027,-1347.8278 648,-1342 614.7461,-1306.1298 631.342,-1282.9264 612,-1238 600.2563,-1210.7225 584.0612,-1180.5903 573.0957,-1161.0359"/>
<polygon fill="#000000" stroke="#000000" points="576.0059,-1159.072 568.0324,-1152.0953 569.9148,-1162.5215 576.0059,-1159.072"/>
</g>
<!-- sourcefile~int2_pairs.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~int2_pairs.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M664.248,-1376.4235C579.2694,-1390.7435 387.4749,-1412.9917 242,-1355"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M831.8259,-1454.5035C797.5047,-1459.8215 747.5539,-1462.8491 708,-1446"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1446C614.3289,-1406.0983 647.5754,-1333.3982 612,-1238 601.6334,-1210.2011 585.1739,-1180.2157 573.7697,-1160.836"/>
<polygon fill="#000000" stroke="#000000" points="576.761,-1159.0185 568.6263,-1152.2304 570.7524,-1162.6097 576.761,-1159.0185"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M831.8789,-1453.2172C822.4789,-1455.6679 812.6803,-1458.8684 804,-1463 785.9412,-1471.5954 785.7954,-1480.8719 768,-1490 694.1135,-1527.8999 494.5347,-1601.0744 411.5,-1602"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-1602C292.8291,-1601.3385 247.9251,-1576.3645 171,-1486 127.5553,-1434.9651 84.8675,-1228.5742 71.6592,-1160.1561"/>
<polygon fill="#000000" stroke="#000000" points="75.0455,-1159.2292 69.7323,-1150.0629 68.1697,-1160.5419 75.0455,-1159.2292"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1446C551.8798,-1379.4964 488.0428,-1413.2797 349,-1316 309.3104,-1288.2316 274.2611,-1242.9672 255.7995,-1216.6878"/>
<polygon fill="#000000" stroke="#000000" points="258.5372,-1214.4923 249.9808,-1208.2441 252.7732,-1218.4643 258.5372,-1214.4923"/>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M846.7344,-1433.9834C818.805,-1420.7 773.6522,-1399.2248 742.4838,-1384.4008"/>
<polygon fill="#000000" stroke="#000000" points="743.8282,-1381.1646 733.2943,-1380.0302 740.8217,-1387.4861 743.8282,-1381.1646"/>
</g>
<!-- sourcefile~libint_f.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~libint_f.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/libint_f.f90.html" xlink:title="libint_f.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="743,-1574 673,-1574 673,-1550 743,-1550 743,-1574"/>
<text text-anchor="middle" x="708" y="-1559.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint_f.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int_libint.f90&#45;&gt;sourcefile~libint_f.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~int_libint.f90&#45;&gt;sourcefile~libint_f.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M860.4777,-1458.1088C842.2431,-1476.7485 804.9955,-1512.7473 768,-1536 762.3171,-1539.5719 756.0587,-1542.8807 749.7938,-1545.8575"/>
<polygon fill="#000000" stroke="#000000" points="748.3509,-1542.6687 740.6766,-1549.9732 751.2311,-1549.0488 748.3509,-1542.6687"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M855.2793,-1355.7417C803.6905,-1317.921 646.8139,-1202.9118 585.7207,-1158.1233"/>
<polygon fill="#000000" stroke="#000000" points="587.5602,-1155.132 577.4259,-1152.0422 583.4214,-1160.7774 587.5602,-1155.132"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M856.8734,-1380.1437C842.9114,-1391.4775 821.7212,-1408.9978 804,-1425 787.4378,-1439.9556 787.9468,-1449.9949 768,-1460 684.2499,-1502.0082 441.3431,-1522.8596 349,-1507 266.291,-1492.795 229.923,-1503.7549 171,-1444 90.5073,-1362.3709 72.5696,-1215.9959 68.6089,-1160.3221"/>
<polygon fill="#000000" stroke="#000000" points="72.0907,-1159.9199 67.9734,-1150.1578 65.1043,-1160.3567 72.0907,-1159.9199"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M826.5915,-1379.7019C781.0824,-1389.6902 709.1858,-1400.7284 648,-1389 507.5305,-1362.0741 475.0681,-1337.5539 349,-1270 318.5546,-1253.6858 286.2997,-1230.4552 265.2622,-1214.3936"/>
<polygon fill="#000000" stroke="#000000" points="267.2939,-1211.5405 257.2395,-1208.2 263.0162,-1217.0814 267.2939,-1211.5405"/>
</g>
<!-- sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~int_rotaxis.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M826.7521,-1368C806.6271,-1368 782.7782,-1368 761.7521,-1368"/>
<polygon fill="#000000" stroke="#000000" points="761.6857,-1364.5001 751.6856,-1368 761.6856,-1371.5001 761.6857,-1364.5001"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M836.6667,-1174.1364C792.5014,-1169.2524 714.6073,-1160.4582 648,-1152 638.3455,-1150.774 628.097,-1149.4134 618.1508,-1148.0615"/>
<polygon fill="#000000" stroke="#000000" points="618.3154,-1144.5514 607.9329,-1146.6618 617.3653,-1151.4867 618.3154,-1144.5514"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1328C607.3417,-1353.0533 337.3148,-1395.9248 242,-1355"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-1355C158.7161,-1307.7949 99.8657,-1203.7775 77.4814,-1159.0848"/>
<polygon fill="#000000" stroke="#000000" points="80.5784,-1157.4508 73.0335,-1150.0126 74.2931,-1160.5323 80.5784,-1157.4508"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M836.8626,-1189.4434C825.5405,-1194.2692 813.4815,-1200.7242 804,-1209 781.4265,-1228.7032 786.5163,-1242.4431 768,-1266 744.3032,-1296.1477 745.2108,-1318.7384 708,-1328"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708,-1328C636.6289,-1345.7639 634.4533,-1255.7416 561,-1252"/>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~int2_pairs.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~int2_pairs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M859.9496,-1190.0275C845.3059,-1205.126 820.5128,-1232.2958 804,-1259 782.8527,-1293.1992 796.4371,-1313.5725 768,-1342 764.5677,-1345.4312 760.6085,-1348.4415 756.3941,-1351.0757"/>
<polygon fill="#000000" stroke="#000000" points="754.557,-1348.0914 747.4723,-1355.9691 757.9232,-1354.2289 754.557,-1348.0914"/>
</g>
<!-- sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~rys.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/rys.f90.html" xlink:title="rys.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="735,-688 681,-688 681,-664 735,-664 735,-688"/>
<text text-anchor="middle" x="708" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rys.F90</text>
</a>
</g>
</g>
<!-- sourcefile~int_rys.f90&#45;&gt;sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~int_rys.f90&#45;&gt;sourcefile~rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M836.9169,-1172.4885C824.6176,-1168.7563 811.9115,-1162.4971 804,-1152 748.0181,-1077.7226 807.6138,-819.1538 768,-735 760.446,-718.9526 746.5625,-704.8565 734.0518,-694.47"/>
<polygon fill="#000000" stroke="#000000" points="736.1261,-691.6483 726.1091,-688.1971 731.7876,-697.1417 736.1261,-691.6483"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~messages.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~messages.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M548.9195,-140.2347C537.4706,-152.433 520.5061,-172.1624 510,-192 455.3571,-295.1768 425.5126,-433.577 415.438,-486.8358"/>
<polygon fill="#000000" stroke="#000000" points="411.9602,-486.3957 413.5864,-496.865 418.8438,-487.6666 411.9602,-486.3957"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.0161,-140.0608C526.0272,-144.0753 517.434,-148.8495 510,-154 461.2559,-187.7714 470.5281,-238.3277 411.5,-244"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-244C336.5121,-251.2059 285.7513,-182.6736 242,-244"/>
</g>
<!-- sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~lapack_wrap.f90&#45;&gt;sourcefile~mathlib_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.1451,-115.9987C500.5467,-111.8252 482.8689,-107.0954 466.542,-102.727"/>
<polygon fill="#000000" stroke="#000000" points="467.1463,-99.2656 456.5814,-100.0619 465.337,-106.0277 467.1463,-99.2656"/>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M410.6119,-879.6583C405.1752,-811.3234 372.1773,-485.0298 242,-558"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M692.9896,-768.1717C679.3306,-780.0282 659.5844,-799.2561 648,-820 591.001,-922.0671 569.688,-1063.5451 563.3104,-1117.6978"/>
<polygon fill="#000000" stroke="#000000" points="559.8046,-1117.5546 562.1687,-1127.8823 566.761,-1118.3345 559.8046,-1117.5546"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M691.1365,-743.8808C677.4198,-733.1156 658.651,-716.1511 648,-697 612.5728,-633.2999 659.9381,-591.9065 612,-537 596.0915,-518.779 583.841,-525.9608 561,-518"/>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.3575,-762.4469C608.5521,-779.3027 421.0156,-824.0664 411.5,-834"/>
</g>
<!-- sourcefile~ecpint.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~ecpint.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/ecpint.f90.html" xlink:title="ecpint.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="595,-768 527,-768 527,-744 595,-744 595,-768"/>
<text text-anchor="middle" x="561" y="-753.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ecpint.F90</text>
</a>
</g>
</g>
<!-- sourcefile~ecp.f90&#45;&gt;sourcefile~ecpint.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~ecp.f90&#45;&gt;sourcefile~ecpint.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.3504,-756C659.2464,-756 629.7455,-756 605.3545,-756"/>
<polygon fill="#000000" stroke="#000000" points="605.2534,-752.5001 595.2534,-756 605.2533,-759.5001 605.2534,-752.5001"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M857.4726,-509.1703C841.6502,-523.2919 816.8826,-548.1039 804,-575 764.6066,-657.2448 829.4494,-709.6203 768,-777 730.7275,-817.8695 693.9253,-779.171 648,-810 564.5961,-865.9879 570.4087,-908.7401 510,-989 493.7491,-1010.5912 495.4819,-1021.6049 474,-1038 426.693,-1074.1051 398.6828,-1053.241 349,-1086 311.1643,-1110.9475 276.366,-1151.3104 257.2746,-1175.5865"/>
<polygon fill="#000000" stroke="#000000" points="254.317,-1173.6901 250.9751,-1183.7441 259.8573,-1177.9685 254.317,-1173.6901"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_shell_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_shell_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M841.1482,-484.8506C820.5047,-476.7912 792.6967,-466.0689 768,-457 763.0758,-455.1918 757.9118,-453.3311 752.7668,-451.4998"/>
<polygon fill="#000000" stroke="#000000" points="753.5588,-448.0676 742.964,-448.0357 751.2264,-454.6676 753.5588,-448.0676"/>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~rys.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~rys.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M859.5622,-509.1164C844.983,-523.7715 820.6961,-549.6418 804,-575 783.6671,-605.8818 794.6447,-624.3647 768,-650 761.4022,-656.3479 753.0066,-661.2766 744.6009,-665.0502"/>
<polygon fill="#000000" stroke="#000000" points="743.171,-661.8529 735.2015,-668.8342 745.7851,-668.3464 743.171,-661.8529"/>
</g>
<!-- sourcefile~mod_gauss_hermite.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~mod_gauss_hermite.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/mod_gauss_hermite.f90.html" xlink:title="mod_gauss_hermite.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="313,-450 171,-450 171,-426 313,-426 313,-450"/>
<text text-anchor="middle" x="242" y="-435.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mod_gauss_hermite.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_gauss_hermite.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~mod_gauss_hermite.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M849.0918,-484.9456C834.8057,-476.5789 816.7733,-464.3753 804,-450 781.286,-424.4372 797.2961,-399.6386 768,-382 605.5274,-284.1783 362.8994,-380.6175 275.1592,-421.562"/>
<polygon fill="#000000" stroke="#000000" points="273.497,-418.4765 265.9571,-425.9196 276.4929,-424.803 273.497,-418.4765"/>
</g>
<!-- sourcefile~xyzorder.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~xyzorder.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/xyzorder.f90.html" xlink:title="xyzorder.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="748.5,-490 667.5,-490 667.5,-466 748.5,-466 748.5,-490"/>
<text text-anchor="middle" x="708" y="-475.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">xyzorder.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~xyzorder.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~mod_1e_primitives.f90&#45;&gt;sourcefile~xyzorder.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M803.874,-489.1074C788.8608,-487.368 773.2086,-485.5547 759.0098,-483.9097"/>
<polygon fill="#000000" stroke="#000000" points="759.2942,-480.4193 748.9578,-482.7451 758.4885,-487.3728 759.2942,-480.4193"/>
</g>
<!-- sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~basis_tools.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~basis_tools.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M658.0928,-448.0701C654.277,-450.5186 650.8208,-453.462 648,-457 603.3902,-512.9531 620.9789,-706.0058 612,-777 595.6429,-906.3318 572.8088,-1061.1078 564.3361,-1117.8008"/>
<polygon fill="#000000" stroke="#000000" points="560.8592,-1117.3869 562.8393,-1127.7951 567.782,-1118.4238 560.8592,-1117.3869"/>
</g>
<!-- sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~mod_shell_tools.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M647.8427,-441.9138C621.1986,-443.6418 589.4994,-444.4802 561,-442"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561,-442C464.9483,-433.641 437.9348,-450.7656 349,-488 296.5807,-509.9464 291.5713,-530.213 242,-558"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-558C138.667,-614.6248 82.5217,-1016.6161 70.138,-1115.8812"/>
<polygon fill="#000000" stroke="#000000" points="66.6439,-1115.6205 68.901,-1125.9721 73.5919,-1116.4722 66.6439,-1115.6205"/>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.8048,-669.6323C669.3027,-665.6961 656.6041,-659.5152 648,-650 612.6478,-610.904 648.3621,-575.1585 612,-537 595.3133,-519.4889 583.841,-525.9608 561,-518"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561,-518C496.0501,-495.3631 478.5013,-573.548 411.5,-558"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-558C338.1166,-540.971 307.7135,-521.1646 242,-558"/>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~constants.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~constants.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.7215,-677.2896C639.219,-680.6156 559.7942,-692.5078 510,-735 481.8743,-759.0012 501.1806,-784.9335 474,-810 452.1263,-830.1724 430.9122,-811.449 411.5,-834"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.5,-834C389.4741,-857.5984 367.5139,-844.5565 349,-871 299.2055,-942.1216 341.7772,-981.0876 313,-1063 298.2418,-1105.0082 271.7471,-1149.914 255.63,-1175.3181"/>
<polygon fill="#000000" stroke="#000000" points="252.67,-1173.4501 250.2025,-1183.7536 258.5568,-1177.2377 252.67,-1173.4501"/>
</g>
<!-- sourcefile~rys_lut.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~rys_lut.f90</title>
<g id="a_sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/rys_lut.f90.html" xlink:title="rys_lut.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="596,-650 526,-650 526,-626 596,-626 596,-650"/>
<text text-anchor="middle" x="561" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rys_lut.F90</text>
</a>
</g>
</g>
<!-- sourcefile~rys.f90&#45;&gt;sourcefile~rys_lut.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~rys.f90&#45;&gt;sourcefile~rys_lut.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.6949,-668.9415C659.751,-663.5275 630.3913,-655.9379 605.9917,-649.6305"/>
<polygon fill="#000000" stroke="#000000" points="606.7818,-646.2198 596.224,-647.1055 605.0298,-652.997 606.7818,-646.2198"/>
</g>
<!-- sourcefile~mod_gauss_hermite.f90&#45;&gt;sourcefile~precision.f90 -->
<g id="sourcefile~~tdhf_sf_energy.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~mod_gauss_hermite.f90&#45;&gt;sourcefile~precision.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M231.3929,-450.0715C215.5592,-468.7929 186.0029,-506.5836 171,-544 86.5249,-754.6761 70.8987,-1034.6168 68.0946,-1115.3394"/>
<polygon fill="#000000" stroke="#000000" points="64.5827,-1115.6669 67.7673,-1125.7717 71.5793,-1115.8865 64.5827,-1115.6669"/>
</g>
</g>
</svg>
</div>                <script>
                  var pansourcefiletdhf_sf_energyf90EfferentGraph = svgPanZoom('#sourcefiletdhf_sf_energyf90EfferentGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#EfferentGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="EfferentGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a file to a file which it depends on. A file
is dependent upon another if the latter must be compiled before the former
can be.
</p>
 </div>
            </div>
          </div>
        </div>
          </div>
        </div>
<br>
      <section>
        <h2><span class="anchor" id="src"></span>Source Code</h2>
        <div class="hl codehilite"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="k">module </span><span class="n">tdhf_sf_energy_mod</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="w">  </span><span class="k">implicit none</span>
<a id="ln-4" name="ln-4" href="#ln-4"></a>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">module_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tdhf_sf_energy_mod&quot;</span>
<a id="ln-6" name="ln-6" href="#ln-6"></a>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="k">contains</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="k">  subroutine </span><span class="n">tdhf_sf_energy_C</span><span class="p">(</span><span class="n">c_handle</span><span class="p">)</span><span class="w"> </span><span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tdhf_sf_energy&quot;</span><span class="p">)</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a><span class="w">    </span><span class="k">use </span><span class="n">c_interop</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">oqp_handle_t</span><span class="p">,</span><span class="w"> </span><span class="n">oqp_handle_get_info</span>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">oqp_handle_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c_handle</span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inf</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="w">    </span><span class="n">inf</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">oqp_handle_get_info</span><span class="p">(</span><span class="n">c_handle</span><span class="p">)</span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="w">    </span><span class="k">call </span><span class="n">tdhf_sf_energy</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
<a id="ln-16" name="ln-16" href="#ln-16"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">tdhf_sf_energy_C</span>
<a id="ln-17" name="ln-17" href="#ln-17"></a>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">tdhf_sf_energy</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="w">    </span><span class="k">use </span><span class="n">io_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">iw</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="w">    </span><span class="k">use </span><span class="n">oqp_tagarray_driver</span>
<a id="ln-21" name="ln-21" href="#ln-21"></a>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="w">    </span><span class="k">use </span><span class="n">strings</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">Cstring</span><span class="p">,</span><span class="w"> </span><span class="n">fstring</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="w">    </span><span class="k">use </span><span class="n">basis_tools</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">basis_set</span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="w">    </span><span class="k">use </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">show_message</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="w">    </span><span class="k">use </span><span class="n">util</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">measure_time</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="w">    </span><span class="k">use </span><span class="nb">precision</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="w">    </span><span class="k">use </span><span class="n">int2_compute</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int2_compute_t</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="w">    </span><span class="k">use </span><span class="n">tdhf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int2_td_data_t</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="w">    </span><span class="k">use </span><span class="n">tdhf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="w">      </span><span class="n">inivec</span><span class="p">,</span><span class="w"> </span><span class="n">iatogen</span><span class="p">,</span><span class="w"> </span><span class="n">mntoia</span><span class="p">,</span><span class="w"> </span><span class="n">rparedms</span><span class="p">,</span><span class="w"> </span><span class="n">rpaeig</span><span class="p">,</span><span class="w"> </span><span class="n">rpavnorm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="w">      </span><span class="n">rpaechk</span><span class="p">,</span><span class="w"> </span><span class="n">rpaprint</span><span class="p">,</span><span class="w"> </span><span class="n">rpanewb</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="w">    </span><span class="k">use </span><span class="n">tdhf_sf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="w">      </span><span class="n">sfroesum</span><span class="p">,</span><span class="w"> </span><span class="n">sfresvec</span><span class="p">,</span><span class="w"> </span><span class="n">sfqvec</span><span class="p">,</span><span class="w"> </span><span class="n">sfesum</span><span class="p">,</span><span class="w"> </span><span class="n">sfdmat</span><span class="p">,</span><span class="w"> </span><span class="n">trfrmb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="w">      </span><span class="n">print_results</span><span class="p">,</span><span class="w"> </span><span class="n">get_spin_square</span><span class="p">,</span><span class="w"> </span><span class="n">get_transition_density</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="w">      </span><span class="n">get_transitions</span><span class="p">,</span><span class="w"> </span><span class="n">get_transition_dipole</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">orthogonal_transform_sym</span>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unpack_matrix</span>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="w">    </span><span class="k">use </span><span class="n">oqp_linalg</span>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="w">    </span><span class="k">use </span><span class="n">printing</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">print_module_info</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a>
<a id="ln-43" name="ln-43" href="#ln-43"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-44" name="ln-44" href="#ln-44"></a>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subroutine_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tdhf_sf_energy&quot;</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">basis_set</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">infos</span>
<a id="ln-49" name="ln-49" href="#ln-49"></a>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">s_size</span><span class="p">,</span><span class="w"> </span><span class="n">ok</span>
<a id="ln-51" name="ln-51" href="#ln-51"></a>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scr2</span><span class="p">(:)</span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ab2_mo</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">scr3</span><span class="p">(:,:)</span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">eex</span><span class="p">(:),</span><span class="w"> </span><span class="n">spin_square</span><span class="p">(:)</span>
<a id="ln-55" name="ln-55" href="#ln-55"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">amb</span><span class="p">(:,:),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="w">                                  </span><span class="n">apb</span><span class="p">(:,:)</span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vl</span><span class="p">(:),</span><span class="w"> </span><span class="n">vr</span><span class="p">(:)</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vl_p</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">vr_p</span><span class="p">(:,:)</span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xm</span><span class="p">(:)</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">for_trnsf_b_vec</span><span class="p">(:,:)</span>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bvec</span><span class="p">(:,:,:)</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scr1</span><span class="p">(:,:)</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ab2</span><span class="p">(:,:,:)</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fa</span><span class="p">,</span><span class="w"> </span><span class="n">fb</span>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rnorm</span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:,:,:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">trden</span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">trans</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scr1t</span><span class="p">(:)</span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dip</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">abxc</span><span class="p">(:,:)</span>
<a id="ln-70" name="ln-70" href="#ln-70"></a>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">nvira</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nvirb</span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">mxvec</span><span class="p">,</span><span class="w"> </span><span class="n">nmax</span><span class="p">,</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="p">,</span><span class="w"> </span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="n">novec</span>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">istart</span><span class="p">,</span><span class="w"> </span><span class="n">nv</span><span class="p">,</span><span class="w"> </span><span class="n">iv</span><span class="p">,</span><span class="w"> </span><span class="n">ivec</span>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mxiter</span>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">imax</span>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">converged</span>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mxerr</span><span class="p">,</span><span class="w"> </span><span class="n">cnvtol</span><span class="p">,</span><span class="w"> </span><span class="n">scale_exch</span>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxvec</span><span class="p">,</span><span class="w"> </span><span class="n">target_state</span>
<a id="ln-81" name="ln-81" href="#ln-81"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">roref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-82" name="ln-82" href="#ln-82"></a>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">int2_compute_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int2_driver</span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">int2_td_data_t</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int2_data</span>
<a id="ln-85" name="ln-85" href="#ln-85"></a>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dft</span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scf_type</span><span class="p">,</span><span class="w"> </span><span class="n">mol_mult</span>
<a id="ln-88" name="ln-88" href="#ln-88"></a>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">    </span><span class="c">! tagarray</span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">contiguous</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="w">      </span><span class="n">fock_a</span><span class="p">(:),</span><span class="w"> </span><span class="n">dmat_a</span><span class="p">(:),</span><span class="w"> </span><span class="n">mo_a</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">mo_energy_a</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="w">      </span><span class="n">fock_b</span><span class="p">(:),</span><span class="w"> </span><span class="n">dmat_b</span><span class="p">(:),</span><span class="w"> </span><span class="n">mo_b</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">mo_energy_b</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="w">      </span><span class="n">smat</span><span class="p">(:),</span><span class="w"> </span><span class="n">ta</span><span class="p">(:),</span><span class="w"> </span><span class="n">tb</span><span class="p">(:),</span><span class="w"> </span><span class="n">bvec_mo_out</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">td_t</span><span class="p">(:,:),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="w">      </span><span class="n">sf_energies</span><span class="p">(:)</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tags_alloc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">      </span><span class="n">OQP_td_bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_energies</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tags_required</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">      </span><span class="n">OQP_FOCK_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_FOCK_B</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_B</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_B</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_B</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_SM</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<a id="ln-99" name="ln-99" href="#ln-99"></a>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">    </span><span class="n">mol_mult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">mult</span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mol_mult</span><span class="o">/=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;SF-TDDFT are available for ROHF/UHF ref. with ONLY triplet multiplicity(mult=3)&#39;</span><span class="p">,</span><span class="n">with_abort</span><span class="p">)</span>
<a id="ln-102" name="ln-102" href="#ln-102"></a>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="w">    </span><span class="n">scf_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">scftype</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scf_type</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">roref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a>
<a id="ln-106" name="ln-106" href="#ln-106"></a><span class="w">    </span><span class="n">dft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">hamilton</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">20</span>
<a id="ln-107" name="ln-107" href="#ln-107"></a>
<a id="ln-108" name="ln-108" href="#ln-108"></a><span class="w">  </span><span class="c">! Files open</span>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">  </span><span class="c">! 3. LOG: Write: Main output file</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="w">    </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">IW</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">log_filename</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">)</span>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">    </span><span class="k">call </span><span class="n">print_module_info</span><span class="p">(</span><span class="s1">&#39;SF_TDHF_Energy&#39;</span><span class="p">,</span><span class="s1">&#39;Computing Energy of SF-TDDFT&#39;</span><span class="p">)</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">  </span><span class="c">! Readings</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="w">  </span><span class="c">! Load basis set</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">    </span><span class="n">basis</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">basis</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">    </span><span class="n">basis</span><span class="p">%</span><span class="n">atoms</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span>
<a id="ln-118" name="ln-118" href="#ln-118"></a>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="w">  </span><span class="c">! Allocate H, S ,T and D matrices</span>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="w">    </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">nbf</span>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="w">    </span><span class="n">nbf2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">*</span><span class="p">(</span><span class="n">nbf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">    </span><span class="n">s_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">basis</span><span class="p">%</span><span class="n">nshell</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">basis</span><span class="p">%</span><span class="n">nshell</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="w">  </span><span class="c">! Allocate temporary matrices for diagonalization</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">    </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">FA</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="w">              </span><span class="n">FB</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">              </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ok</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="n">with_abort</span><span class="p">)</span>
<a id="ln-129" name="ln-129" href="#ln-129"></a>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="w">    </span><span class="n">nstates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">nstate</span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="w">    </span><span class="n">target_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">target_state</span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">    </span><span class="n">maxvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">maxvec</span>
<a id="ln-133" name="ln-133" href="#ln-133"></a><span class="w">    </span><span class="n">cnvtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cnvtol</span>
<a id="ln-134" name="ln-134" href="#ln-134"></a>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">    </span><span class="n">nocca</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">nelec_A</span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">    </span><span class="n">nvira</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">-</span><span class="n">noccA</span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="w">    </span><span class="n">noccb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">nelec_B</span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">    </span><span class="n">nvirb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">-</span><span class="n">noccB</span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">    </span><span class="n">xvec_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nocca</span><span class="o">*</span><span class="n">nvirb</span>
<a id="ln-140" name="ln-140" href="#ln-140"></a>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">    </span><span class="n">mxvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">maxvec</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span><span class="p">)</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="w">    </span><span class="n">nstates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">mxvec</span><span class="p">)</span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">    </span><span class="n">nvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nstates</span>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="w">    </span><span class="n">nvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">mxvec</span><span class="p">)</span>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">    </span><span class="n">nmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nvec</span>
<a id="ln-146" name="ln-146" href="#ln-146"></a>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">remove_records</span><span class="p">(</span><span class="n">tags_alloc</span><span class="p">)</span>
<a id="ln-148" name="ln-148" href="#ln-148"></a>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">        </span><span class="n">xvec_dim</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">xvec_dim</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="o">/</span><span class="p">),</span><span class="w"> </span><span class="n">comment</span><span class="o">=</span><span class="n">OQP_td_bvec_mo_comment</span><span class="p">)</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="n">nbf2</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="p">),</span><span class="w"> </span><span class="n">comment</span><span class="o">=</span><span class="n">OQP_td_t_comment</span><span class="p">)</span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_energies</span><span class="p">,</span><span class="w"> </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">comment</span><span class="o">=</span><span class="n">OQP_td_energies_comment</span><span class="p">)</span>
<a id="ln-153" name="ln-153" href="#ln-153"></a>
<a id="ln-154" name="ln-154" href="#ln-154"></a><span class="w">    </span><span class="k">call </span><span class="n">data_has_tags</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">tags_alloc</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="n">subroutine_name</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">bvec_mo_out</span><span class="p">)</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="n">td_t</span><span class="p">)</span>
<a id="ln-157" name="ln-157" href="#ln-157"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_energies</span><span class="p">,</span><span class="w"> </span><span class="n">sf_energies</span><span class="p">)</span>
<a id="ln-158" name="ln-158" href="#ln-158"></a>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="w">    </span><span class="k">call </span><span class="n">data_has_tags</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">tags_required</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="n">subroutine_name</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_SM</span><span class="p">,</span><span class="w"> </span><span class="n">smat</span><span class="p">)</span>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_FOCK_A</span><span class="p">,</span><span class="w"> </span><span class="n">fock_a</span><span class="p">)</span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_FOCK_B</span><span class="p">,</span><span class="w"> </span><span class="n">fock_b</span><span class="p">)</span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_A</span><span class="p">,</span><span class="w"> </span><span class="n">dmat_a</span><span class="p">)</span>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_B</span><span class="p">,</span><span class="w"> </span><span class="n">dmat_b</span><span class="p">)</span>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">mo_energy_a</span><span class="p">)</span>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_B</span><span class="p">,</span><span class="w"> </span><span class="n">mo_energy_b</span><span class="p">)</span>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">)</span>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_B</span><span class="p">,</span><span class="w"> </span><span class="n">mo_b</span><span class="p">)</span>
<a id="ln-169" name="ln-169" href="#ln-169"></a>
<a id="ln-170" name="ln-170" href="#ln-170"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">xm</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">             </span><span class="n">trden</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nstates</span><span class="p">,</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">             </span><span class="n">bvec_mo</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a><span class="w">             </span><span class="n">abxc</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="w">             </span><span class="n">ab2_mo</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">             </span><span class="n">bvec</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nmax</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">             </span><span class="n">eex</span><span class="p">(</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">             </span><span class="n">spin_square</span><span class="p">(</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="w">             </span><span class="n">apb</span><span class="p">(</span><span class="n">mxvec</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">             </span><span class="n">amb</span><span class="p">(</span><span class="n">mxvec</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">             </span><span class="n">for_trnsf_b_vec</span><span class="p">(</span><span class="n">mxvec</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">!</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="w">             </span><span class="n">dip</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nstates</span><span class="p">,</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="w">             </span><span class="n">vr</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="w">             </span><span class="n">vl</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="w">             </span><span class="n">scr1</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">             </span><span class="n">scr2</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">             </span><span class="n">scr3</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">,</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">             </span><span class="n">rnorm</span><span class="p">(</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a><span class="w">             </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0_dp</span><span class="p">,</span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ok</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-190" name="ln-190" href="#ln-190"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">trans</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="w">             </span><span class="n">source</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ok</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="w">    </span><span class="n">scale_exch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_dp</span>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">          </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">HFscale</span>
<a id="ln-197" name="ln-197" href="#ln-197"></a>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_flag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">            </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_alpha</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="w">            </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_beta</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="w">            </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_mu</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">    </span><span class="k">end if</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">dft</span><span class="p">)</span><span class="w"> </span><span class="n">scale_exch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span>
<a id="ln-208" name="ln-208" href="#ln-208"></a>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="w">    </span><span class="k">if</span><span class="p">(.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,5x,&quot;Input parameters:&quot;)&#39;</span><span class="p">)</span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of states:                 &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nstates</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of single excitations:     &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">xvec_dim</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of atomic orbitals:        &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nbf</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of electrons:              &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nocca</span><span class="o">+</span><span class="n">noccb</span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of occupied alpha orbitals:&quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nocca</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of occupied beta orbitals: &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">noccb</span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of virtual alpha orbitals: &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvira</span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of virtual beta orbitals:  &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvirb</span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Maximum vectors:                  &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">mxvec</span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Initial vectors:                  &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvec</span>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(/7x,&quot;Fitting parameters for SF-TDDFT&quot;)&#39;</span><span class="p">)</span>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_flag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(10x,&quot;Exact HF exchange:&quot;)&#39;</span><span class="p">)</span>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5x,&quot;Reference: |&quot;, t20, f6.3, t29, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">HFscale</span>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5x,&quot;Response:  |&quot;, t20, f6.3, t29, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">      </span><span class="k">else</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(10x,&quot;CAM parametres:&quot;)&#39;</span><span class="p">)</span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(16x,&quot;|   alpha   |    beta   |     mu    |&quot;)&#39;</span><span class="p">)</span>
<a id="ln-229" name="ln-229" href="#ln-229"></a><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5x,&quot;Reference: |&quot;, t20, f6.3, t29, &quot;|&quot;, t32, f6.3, t41, &quot;|&quot;, t44, f6.3, t53, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">           </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_mu</span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5x,&quot;Response:  |&quot;, t20, f6.3, t29, &quot;|&quot;, t32, f6.3, t41, &quot;|&quot;, t44, f6.3, t53, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">           </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a><span class="w">      </span><span class="k">end if</span>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="k">    end if</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,5x,46(&quot;=&quot;))&#39;</span><span class="p">)</span>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5X,&quot;Davidson algorithm for Spin-flip TDDFT&quot;)&#39;</span><span class="p">)</span>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,46(&quot;=&quot;))&#39;</span><span class="p">)</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a>
<a id="ln-240" name="ln-240" href="#ln-240"></a><span class="w">    </span><span class="n">ta</span><span class="w">          </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">td_t</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="w">    </span><span class="n">tb</span><span class="w">          </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">td_t</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-242" name="ln-242" href="#ln-242"></a>
<a id="ln-243" name="ln-243" href="#ln-243"></a><span class="w">  </span><span class="c">! Initialize ERI calculations</span>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">)</span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">set_screening</span><span class="p">()</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">  </span><span class="c">! Prepare for ROHF</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">roref</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="k">      </span><span class="n">scr1t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nbf</span><span class="o">*</span><span class="n">nbf</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">scr1</span><span class="p">(:,:)</span>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="w">  </span><span class="c">!   Alpha</span>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">      </span><span class="k">call </span><span class="n">orthogonal_transform_sym</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">fock_a</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">scr1</span><span class="p">)</span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="w">      </span><span class="k">call </span><span class="n">unpack_matrix</span><span class="p">(</span><span class="n">scr1t</span><span class="p">,</span><span class="n">fa</span><span class="p">)</span>
<a id="ln-253" name="ln-253" href="#ln-253"></a>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="w">  </span><span class="c">!   Beta</span>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="w">      </span><span class="k">call </span><span class="n">orthogonal_transform_sym</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">fock_b</span><span class="p">,</span><span class="w"> </span><span class="n">mo_b</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">scr1</span><span class="p">)</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="w">      </span><span class="k">call </span><span class="n">unpack_matrix</span><span class="p">(</span><span class="n">scr1t</span><span class="p">,</span><span class="n">fb</span><span class="p">)</span>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="w">    </span><span class="k">end if</span>
<a id="ln-258" name="ln-258" href="#ln-258"></a>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="w">  </span><span class="c">! Construct TD trial vector</span>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="w">    </span><span class="k">call </span><span class="n">inivec</span><span class="p">(</span><span class="n">mo_energy_a</span><span class="p">,</span><span class="n">mo_energy_b</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="w">                </span><span class="n">nocca</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="n">nvec</span><span class="p">)</span>
<a id="ln-262" name="ln-262" href="#ln-262"></a>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">    </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="w">    </span><span class="n">istart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="w">    </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nvec</span>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="w">    </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">    </span><span class="n">mxiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">maxit_dav</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="w">    </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="ln-269" name="ln-269" href="#ln-269"></a>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="w">    </span><span class="k">do </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">mxiter</span>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="w">      </span><span class="n">nv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-272" name="ln-272" href="#ln-272"></a>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="w">      </span><span class="k">do </span><span class="n">ivec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="w">        </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivec</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="w">        </span><span class="k">call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="n">abxc</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">noccb</span><span class="p">)</span>
<a id="ln-276" name="ln-276" href="#ln-276"></a><span class="w">        </span><span class="k">call </span><span class="n">dgemm</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">                   </span><span class="mf">1.0_dp</span><span class="p">,</span><span class="n">mo_a</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">abxc</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="w">                   </span><span class="mf">0.0_dp</span><span class="p">,</span><span class="n">scr1</span><span class="p">,</span><span class="n">nbf</span><span class="p">)</span>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="w">        </span><span class="k">call </span><span class="n">dgemm</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-280" name="ln-280" href="#ln-280"></a><span class="w">                   </span><span class="mf">1.0_dp</span><span class="p">,</span><span class="n">scr1</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">mo_b</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="w">                   </span><span class="mf">0.0_dp</span><span class="p">,</span><span class="n">bvec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iv</span><span class="p">),</span><span class="n">nbf</span><span class="p">)</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">      </span><span class="k">end do</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="k">      </span><span class="n">int2_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">int2_td_data_t</span><span class="p">(</span><span class="n">d2</span><span class="o">=</span><span class="n">bvec</span><span class="p">(:,:,:</span><span class="n">nv</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">              </span><span class="n">int_apb</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">int_amb</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="w">              </span><span class="n">scale_exchange</span><span class="o">=</span><span class="n">scale_exch</span><span class="p">)</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">      </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">run</span><span class="p">(</span><span class="n">int2_data</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">              </span><span class="n">cam</span><span class="o">=</span><span class="n">dft</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_flag</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="w">              </span><span class="n">alpha</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">              </span><span class="n">beta</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,&amp;</span>
<a id="ln-292" name="ln-292" href="#ln-292"></a><span class="w">              </span><span class="n">mu</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span><span class="p">)</span>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">      </span><span class="n">ab2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">int2_data</span><span class="p">%</span><span class="n">amb</span><span class="p">(:,:,:,</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-294" name="ln-294" href="#ln-294"></a>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="w">      </span><span class="k">do </span><span class="n">ivec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="w">        </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivec</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">  </span><span class="c">!     Product (A-B)*X</span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">        </span><span class="k">call </span><span class="n">mntoia</span><span class="p">(</span><span class="n">ab2</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">),</span><span class="n">ab2_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="n">mo_a</span><span class="p">,</span><span class="n">mo_b</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">noccb</span><span class="p">)</span>
<a id="ln-299" name="ln-299" href="#ln-299"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">roref</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="k">          call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="n">abxc</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">noccb</span><span class="p">)</span>
<a id="ln-301" name="ln-301" href="#ln-301"></a>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="w">          </span><span class="c">! faz</span>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="w">          </span><span class="k">call </span><span class="n">dgemm</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="w">                     </span><span class="mf">1.0_dp</span><span class="p">,</span><span class="n">fa</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">abxc</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-305" name="ln-305" href="#ln-305"></a><span class="w">                     </span><span class="mf">0.0_dp</span><span class="p">,</span><span class="n">scr1</span><span class="p">,</span><span class="n">nbf</span><span class="p">)</span>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="w">          </span><span class="c">! zfb - faz</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="w">          </span><span class="k">call </span><span class="n">dgemm</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">                     </span><span class="mf">1.0_dp</span><span class="p">,</span><span class="n">abxc</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">fb</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a><span class="w">                    </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">,</span><span class="n">scr1</span><span class="p">,</span><span class="n">nbf</span><span class="p">)</span>
<a id="ln-310" name="ln-310" href="#ln-310"></a>
<a id="ln-311" name="ln-311" href="#ln-311"></a><span class="w">          </span><span class="k">call </span><span class="n">sfroesum</span><span class="p">(</span><span class="n">scr1</span><span class="p">,</span><span class="n">ab2_mo</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="n">ivec</span><span class="p">)</span>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">        </span><span class="k">else</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="k">          call </span><span class="n">sfesum</span><span class="p">(</span><span class="n">mo_energy_a</span><span class="p">,</span><span class="n">mo_energy_b</span><span class="p">,</span><span class="n">ab2_mo</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="n">ivec</span><span class="p">)</span>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="w">        </span><span class="k">endif</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="k">      end do</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="k">      </span><span class="n">vl_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">vl</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="o">*</span><span class="n">nvec</span><span class="p">)</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">      </span><span class="n">vr_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">vr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="o">*</span><span class="n">nvec</span><span class="p">)</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">      </span><span class="k">call </span><span class="n">rparedms</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">ab2_mo</span><span class="p">,</span><span class="n">ab2_mo</span><span class="p">,</span><span class="n">apb</span><span class="p">,</span><span class="n">amb</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="w">      </span><span class="k">call </span><span class="n">rpaeig</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="n">vl_p</span><span class="p">,</span><span class="n">vr_p</span><span class="p">,</span><span class="n">apb</span><span class="p">,</span><span class="n">amb</span><span class="p">,</span><span class="n">scr2</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="w">      </span><span class="k">call </span><span class="n">rpavnorm</span><span class="p">(</span><span class="n">vr_p</span><span class="p">,</span><span class="n">vl_p</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a id="ln-322" name="ln-322" href="#ln-322"></a>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="w">      </span><span class="k">call </span><span class="n">rpaechk</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">nstates</span><span class="p">,</span><span class="n">imax</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a id="ln-324" name="ln-324" href="#ln-324"></a>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">      </span><span class="n">for_trnsf_b_vec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vr_p</span>
<a id="ln-326" name="ln-326" href="#ln-326"></a><span class="w">      </span><span class="k">call </span><span class="n">sfresvec</span><span class="p">(</span><span class="n">scr3</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">ab2_mo</span><span class="p">,</span><span class="n">vr_p</span><span class="p">,</span><span class="n">eex</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">rnorm</span><span class="p">,</span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">      </span><span class="k">call </span><span class="n">sfqvec</span><span class="p">(</span><span class="n">scr3</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">eex</span><span class="p">,</span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-328" name="ln-328" href="#ln-328"></a>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="w">      </span><span class="k">call </span><span class="n">rpaprint</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="w"> </span><span class="n">rnorm</span><span class="p">,</span><span class="w"> </span><span class="n">cnvtol</span><span class="p">,</span><span class="w"> </span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">imax</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">do_neg</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a id="ln-330" name="ln-330" href="#ln-330"></a>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="w">      </span><span class="n">mxerr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">rnorm</span><span class="p">)</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="c">!     Check convergence</span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="w">      </span><span class="n">converged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mxerr</span><span class="o">&lt;=</span><span class="n">cnvtol</span>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">converged</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<a id="ln-336" name="ln-336" href="#ln-336"></a>
<a id="ln-337" name="ln-337" href="#ln-337"></a><span class="c">!     No space left for new vectors, exit</span>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nvec</span><span class="o">==</span><span class="n">mxvec</span><span class="p">)</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<a id="ln-340" name="ln-340" href="#ln-340"></a>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="k">      call </span><span class="n">rpanewb</span><span class="p">(</span><span class="n">nstates</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">scr3</span><span class="p">,</span><span class="n">novec</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="w">  </span><span class="c">!   ierr=1 nvec over mxvec: not converged case</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<a id="ln-345" name="ln-345" href="#ln-345"></a>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="k">      </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">novec</span><span class="o">+</span><span class="mi">1</span>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="w">      </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nvec</span>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">    </span><span class="k">end do</span>
<a id="ln-349" name="ln-349" href="#ln-349"></a>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">iter</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">mxiter</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">converged</span><span class="p">)</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="w">    </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;SF-TD-DFT energies NOT CONVERGED after &quot;,I4,&quot; iterations&quot;/)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">mxiter</span>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="c">!      call show_message(&quot;Aborting. Try to increase maxit or check your system.&quot;, WITH_ABORT)</span>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="ln-358" name="ln-358" href="#ln-358"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;SF-TD-DFT energies converged in &quot;,I4,&quot; iterations&quot;/)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">iter</span>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;..something is wrong.. nvec = mxvec&quot;)&#39;</span><span class="p">)</span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,&quot;..something is wrong..  nvec &gt; mxvec&quot;)&#39;</span><span class="p">)</span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(3x,&quot;nvec/mxvec =&quot;,I4,&quot;/&quot;,I4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="n">mxvec</span>
<a id="ln-366" name="ln-366" href="#ln-366"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,&quot;..something is wrong.. No vectors were added&quot;)&#39;</span><span class="p">)</span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-370" name="ln-370" href="#ln-370"></a><span class="w">    </span><span class="k">end select</span>
<a id="ln-371" name="ln-371" href="#ln-371"></a><span class="k">    call </span><span class="nb">flush</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-372" name="ln-372" href="#ln-372"></a>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">    </span><span class="k">call </span><span class="n">trfrmb</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">for_trnsf_b_vec</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="w">    </span><span class="k">call </span><span class="n">get_transition_density</span><span class="p">(</span><span class="n">trden</span><span class="p">,</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-376" name="ln-376" href="#ln-376"></a>
<a id="ln-377" name="ln-377" href="#ln-377"></a><span class="w">    </span><span class="k">call </span><span class="n">get_transition_dipole</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">trden</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-378" name="ln-378" href="#ln-378"></a>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="w">    </span><span class="k">do </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="w">      </span><span class="k">call </span><span class="n">sfdmat</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="n">ist</span><span class="p">),</span><span class="n">abxc</span><span class="p">,</span><span class="n">mo_a</span><span class="p">,</span><span class="n">ta</span><span class="p">,</span><span class="n">tb</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">noccb</span><span class="p">)</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a><span class="w">      </span><span class="n">spin_square</span><span class="p">(</span><span class="n">ist</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_spin_square</span><span class="p">(</span><span class="n">dmat_a</span><span class="p">,</span><span class="n">dmat_b</span><span class="p">,</span><span class="n">ta</span><span class="p">,</span><span class="n">tb</span><span class="p">,</span><span class="n">abxc</span><span class="p">,</span><span class="n">Smat</span><span class="p">,</span><span class="n">noccb</span><span class="p">)</span>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">    </span><span class="k">end do</span>
<a id="ln-383" name="ln-383" href="#ln-383"></a>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="k">    call </span><span class="n">get_transitions</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(2x,35(&quot;=&quot;),/,2x,&quot;Alpha -&gt; Beta spin-flip excitations&quot;,/,2x,35(&quot;=&quot;))&#39;</span><span class="p">)</span>
<a id="ln-387" name="ln-387" href="#ln-387"></a>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">    </span><span class="n">sf_energies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eex</span><span class="p">(:</span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a><span class="w">    </span><span class="n">bvec_mo_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">(:,:</span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-390" name="ln-390" href="#ln-390"></a><span class="w">    </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">excited_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sf_energies</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">target_state</span><span class="p">)</span>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">    </span><span class="k">call </span><span class="n">print_results</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">eex</span><span class="p">,</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">,</span><span class="w"> </span><span class="n">spin_square</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="w">    </span><span class="k">call </span><span class="nb">flush</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-393" name="ln-393" href="#ln-393"></a>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">clean</span><span class="p">()</span>
<a id="ln-395" name="ln-395" href="#ln-395"></a>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="w">    </span><span class="k">call </span><span class="n">measure_time</span><span class="p">(</span><span class="n">print_total</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">log_unit</span><span class="o">=</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">    </span><span class="k">close</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>
<a id="ln-398" name="ln-398" href="#ln-398"></a>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">tdhf_sf_energy</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="k">end module </span><span class="n">tdhf_sf_energy_mod</span>
</pre></div>

      </section>
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              OPENQP
 was developed by OpenQP Team<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </body>
</html>