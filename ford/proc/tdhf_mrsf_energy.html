<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="">
    <meta name="author" content="OpenQP Team" >
    <link rel="icon" href="../favicon.png">

    <title>tdhf_mrsf_energy &ndash; OPENQP</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">OPENQP <small>v1.0-dev</small></a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">OPENQP</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>tdhf_mrsf_energy
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 2.1% of total for procedures.">316 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/tdhf_mrsf_energy.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/tdhf_mrsf_energy.f90.html'>tdhf_mrsf_energy.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/tdhf_mrsf_energy_mod.html'>tdhf_mrsf_energy_mod</a></li>
            <li class="breadcrumb-item active" aria-current="page">tdhf_mrsf_energy</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/tdhf_mrsf_energy.html#src">tdhf_mrsf_energy</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine tdhf_mrsf_energy(infos)  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/printing.html'>printing</a></li>
                  <li class="list-inline-item"><a href='../module/int2_compute.html'>int2_compute</a></li>
                  <li class="list-inline-item"><a href='../module/tdhf_lib.html'>tdhf_lib</a></li>
                  <li class="list-inline-item"><a href='../module/oqp_tagarray_driver.html'>oqp_tagarray_driver</a></li>
                  <li class="list-inline-item"><a href='../module/messages.html'>messages</a></li>
                  <li class="list-inline-item"><a href='../module/tdhf_mrsf_lib.html'>tdhf_mrsf_lib</a></li>
                  <li class="list-inline-item"><a href='../module/tdhf_sf_lib.html'>tdhf_sf_lib</a></li>
                  <li class="list-inline-item"><a href='../module/precision.html'>precision</a></li>
                  <li class="list-inline-item"><a href='../module/types.html'>types</a></li>
                  <li class="list-inline-item"><a href='../module/util.html'>util</a></li>
                  <li class="list-inline-item"><a href='../module/mathlib.html'>mathlib</a></li>
                  <li class="list-inline-item"><a href='../module/oqp_linalg.html'>oqp_linalg</a></li>
                  <li class="list-inline-item"><a href='../module/io_constants.html'>io_constants</a></li>
                  <li class="list-inline-item"><a href='../module/basis_tools.html'>basis_tools</a></li>
                  <li class="list-inline-item"><a href='../module/strings.html'>strings</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: proc~~tdhf_mrsf_energy~~UsesGraph Pages: 1 -->
<svg id="proctdhf_mrsf_energyUsesGraph" width="641pt" height="439pt"
 viewBox="0.00 0.00 641.00 439.29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~tdhf_mrsf_energy~~UsesGraph" class="graph" transform="scale(.6187 .6187) rotate(0) translate(4 705.9983)">
<title>proc~~tdhf_mrsf_energy~~UsesGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-705.9983 1032,-705.9983 1032,4 -4,4"/>
<!-- proc~tdhf_mrsf_energy -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node1" class="node">
<title>proc~tdhf_mrsf_energy</title>
<polygon fill="none" stroke="#000000" points="1028,-377.3731 922,-377.3731 922,-353.3731 1028,-353.3731 1028,-377.3731"/>
<text text-anchor="middle" x="975" y="-362.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">tdhf_mrsf_energy</text>
</g>
<!-- module~basis_tools -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node2" class="node">
<title>module~basis_tools</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node2"><a xlink:href="../module/basis_tools.html" xlink:title="basis_tools">
<polygon fill="#337ab7" stroke="#337ab7" points="482.5,-261.3731 412.5,-261.3731 412.5,-237.3731 482.5,-237.3731 482.5,-261.3731"/>
<text text-anchor="middle" x="447.5" y="-246.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_tools</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~basis_tools -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge1" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~basis_tools</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M845.5,-209.3731C793.8461,-173.7354 789.2539,-285.7246 726.5,-285.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M726.5,-285.3731C664.7232,-285.027 647.1597,-301.4111 587.5,-285.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M587.5,-285.3731C555.77,-276.8433 519.8782,-267.6224 492.3801,-260.6482"/>
<polygon fill="#000000" stroke="#000000" points="493.2054,-257.2468 482.6523,-258.1859 491.4877,-264.0328 493.2054,-257.2468"/>
</g>
<!-- module~int2_compute -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node3" class="node">
<title>module~int2_compute</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node3"><a xlink:href="../module/int2_compute.html" xlink:title="int2_compute">
<polygon fill="#337ab7" stroke="#337ab7" points="769,-375.3731 684,-375.3731 684,-351.3731 769,-351.3731 769,-375.3731"/>
<text text-anchor="middle" x="726.5" y="-360.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~int2_compute -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge2" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~int2_compute</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M932.802,-353.3045C918.1184,-349.6706 901.4539,-346.1716 886,-344.3731 850.2413,-340.2115 840.7465,-340.1086 805,-344.3731 796.199,-345.423 786.9582,-347.1128 778.0314,-349.0626"/>
<polygon fill="#000000" stroke="#000000" points="777.0802,-345.6901 768.1264,-351.354 778.6579,-352.51 777.0802,-345.6901"/>
</g>
<!-- module~io_constants -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node4" class="node">
<title>module~io_constants</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node4"><a xlink:href="../module/io_constants.html" xlink:title="io_constants">
<polygon fill="#337ab7" stroke="#337ab7" points="348.5,-537.3731 269.5,-537.3731 269.5,-513.3731 348.5,-513.3731 348.5,-537.3731"/>
<text text-anchor="middle" x="309" y="-522.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">io_constants</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~io_constants -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge3" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~io_constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M587.5,-641.3731C502.1942,-637.3723 476.5001,-629.5042 404,-584.3731 384.2496,-572.0785 387.4957,-559.0677 368,-546.3731 364.8538,-544.3244 361.4828,-542.4463 358.0051,-540.7301"/>
<polygon fill="#000000" stroke="#000000" points="359.1899,-537.4265 348.6306,-536.5591 356.3443,-543.822 359.1899,-537.4265"/>
</g>
<!-- module~mathlib -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node5" class="node">
<title>module~mathlib</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node5"><a xlink:href="../module/mathlib.html" xlink:title="mathlib">
<polygon fill="#337ab7" stroke="#337ab7" points="872.5,-491.3731 818.5,-491.3731 818.5,-467.3731 872.5,-467.3731 872.5,-491.3731"/>
<text text-anchor="middle" x="845.5" y="-476.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mathlib</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~mathlib -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge4" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~mathlib</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M961.1412,-377.5731C938.5529,-397.4578 893.6423,-436.993 866.9226,-460.5146"/>
<polygon fill="#000000" stroke="#000000" points="864.4525,-458.0261 859.2591,-467.2608 869.0778,-463.2803 864.4525,-458.0261"/>
</g>
<!-- module~messages -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node6" class="node">
<title>module~messages</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node6"><a xlink:href="../module/messages.html" xlink:title="messages">
<polygon fill="#337ab7" stroke="#337ab7" points="480.5,-575.3731 414.5,-575.3731 414.5,-551.3731 480.5,-551.3731 480.5,-575.3731"/>
<text text-anchor="middle" x="447.5" y="-560.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">messages</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~messages -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge5" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~messages</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M845.5,-619.3731C815.7866,-635.9052 803.0022,-618.5953 769,-618.3731 731.223,-618.1262 721.5196,-613.9636 684,-618.3731 640.2111,-623.5194 631.5876,-640.8936 587.5,-641.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M587.5,-641.3731C539.5998,-639.1266 492.7416,-604.552 467.2328,-582.1962"/>
<polygon fill="#000000" stroke="#000000" points="469.4959,-579.524 459.7267,-575.4236 464.8066,-584.7212 469.4959,-579.524"/>
</g>
<!-- module~oqp_linalg -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node7" class="node">
<title>module~oqp_linalg</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node7"><a xlink:href="../module/oqp_linalg.html" xlink:title="oqp_linalg">
<polygon fill="#337ab7" stroke="#337ab7" points="760,-531.3731 693,-531.3731 693,-507.3731 760,-507.3731 760,-531.3731"/>
<text text-anchor="middle" x="726.5" y="-516.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_linalg</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~oqp_linalg -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge6" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~oqp_linalg</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M973.4343,-377.6259C967.1465,-420.9571 939.3603,-567.1503 845.5,-619.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M845.5,-619.3731C823.42,-631.6581 769.9662,-572.4598 742.854,-539.7855"/>
<polygon fill="#000000" stroke="#000000" points="745.3017,-537.2503 736.2578,-531.7313 739.8861,-541.6856 745.3017,-537.2503"/>
</g>
<!-- module~oqp_tagarray_driver -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node8" class="node">
<title>module~oqp_tagarray_driver</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node8"><a xlink:href="../module/oqp_tagarray_driver.html" xlink:title="oqp_tagarray_driver">
<polygon fill="#337ab7" stroke="#337ab7" points="648,-57.3731 527,-57.3731 527,-33.3731 648,-33.3731 648,-57.3731"/>
<text text-anchor="middle" x="587.5" y="-42.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_tagarray_driver</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~oqp_tagarray_driver -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge7" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~oqp_tagarray_driver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M845.5,-209.3731C793.4486,-173.4612 783.7115,-158.3148 726.5,-131.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M726.5,-131.3731C684.7511,-111.7129 639.9543,-82.3282 612.8277,-63.5065"/>
<polygon fill="#000000" stroke="#000000" points="614.5342,-60.4285 604.3357,-57.5577 610.518,-66.1618 614.5342,-60.4285"/>
</g>
<!-- module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node9" class="node">
<title>module~precision</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node9"><a xlink:href="../module/precision.html" xlink:title="precision">
<polygon fill="#337ab7" stroke="#337ab7" points="202.5,-357.3731 141.5,-357.3731 141.5,-333.3731 202.5,-333.3731 202.5,-357.3731"/>
<text text-anchor="middle" x="172" y="-342.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge8" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M845.5,-619.3731C812.1298,-638.7246 805.8734,-649.0416 769,-660.3731 691.4708,-684.1983 667.8653,-668.4257 587.5,-679.3731"/>
</g>
<!-- module~printing -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node10" class="node">
<title>module~printing</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node10"><a xlink:href="../module/printing.html" xlink:title="printing">
<polygon fill="#337ab7" stroke="#337ab7" points="753.5,-651.3731 699.5,-651.3731 699.5,-627.3731 753.5,-627.3731 753.5,-651.3731"/>
<text text-anchor="middle" x="726.5" y="-636.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">printing</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~printing -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge9" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~printing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M845.5,-619.3731C820.5114,-633.2764 788.3384,-638.0393 763.747,-639.4563"/>
<polygon fill="#000000" stroke="#000000" points="763.56,-635.961 753.715,-639.8756 763.8525,-642.9549 763.56,-635.961"/>
</g>
<!-- module~strings -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node11" class="node">
<title>module~strings</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node11"><a xlink:href="../module/strings.html" xlink:title="strings">
<polygon fill="#337ab7" stroke="#337ab7" points="753.5,-60.3731 699.5,-60.3731 699.5,-36.3731 753.5,-36.3731 753.5,-60.3731"/>
<text text-anchor="middle" x="726.5" y="-45.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">strings</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~strings -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge10" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~strings</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M968.2091,-353.3C951.2823,-324.2676 904.3144,-249.951 845.5,-209.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M845.5,-209.3731C817.8221,-190.2772 764.0036,-108.0753 739.3705,-69.0687"/>
<polygon fill="#000000" stroke="#000000" points="742.3191,-67.1827 734.0373,-60.575 736.3908,-70.9051 742.3191,-67.1827"/>
</g>
<!-- module~tdhf_lib -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node12" class="node">
<title>module~tdhf_lib</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node12"><a xlink:href="../module/tdhf_lib.html" xlink:title="tdhf_lib">
<polygon fill="#337ab7" stroke="#337ab7" points="872.5,-377.3731 818.5,-377.3731 818.5,-353.3731 872.5,-353.3731 872.5,-377.3731"/>
<text text-anchor="middle" x="845.5" y="-362.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tdhf_lib</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~tdhf_lib -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge11" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~tdhf_lib</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M921.9537,-365.3731C908.8798,-365.3731 895.1473,-365.3731 882.9851,-365.3731"/>
<polygon fill="#000000" stroke="#000000" points="882.7573,-361.8732 872.7572,-365.3731 882.7572,-368.8732 882.7573,-361.8732"/>
</g>
<!-- module~tdhf_mrsf_lib -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node13" class="node">
<title>module~tdhf_mrsf_lib</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node13"><a xlink:href="../module/tdhf_mrsf_lib.html" xlink:title="tdhf_mrsf_lib">
<polygon fill="#337ab7" stroke="#337ab7" points="886,-297.3731 805,-297.3731 805,-273.3731 886,-273.3731 886,-297.3731"/>
<text text-anchor="middle" x="845.5" y="-282.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tdhf_mrsf_lib</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~tdhf_mrsf_lib -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge12" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~tdhf_mrsf_lib</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M955.3317,-353.2228C933.5277,-339.7531 898.184,-317.9192 873.4972,-302.6686"/>
<polygon fill="#000000" stroke="#000000" points="875.2761,-299.6536 864.929,-297.3756 871.5971,-305.6089 875.2761,-299.6536"/>
</g>
<!-- module~tdhf_sf_lib -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node14" class="node">
<title>module~tdhf_sf_lib</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node14"><a xlink:href="../module/tdhf_sf_lib.html" xlink:title="tdhf_sf_lib">
<polygon fill="#337ab7" stroke="#337ab7" points="878.5,-533.3731 812.5,-533.3731 812.5,-509.3731 878.5,-509.3731 878.5,-533.3731"/>
<text text-anchor="middle" x="845.5" y="-518.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tdhf_sf_lib</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~tdhf_sf_lib -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge13" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~tdhf_sf_lib</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M969.5453,-377.6825C957.6456,-403.3701 927.0939,-463.3639 886,-500.3731 884.8597,-501.4 883.6601,-502.3918 882.4165,-503.3479"/>
<polygon fill="#000000" stroke="#000000" points="880.117,-500.6743 873.7376,-509.1333 883.9997,-506.4988 880.117,-500.6743"/>
</g>
<!-- module~types -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node15" class="node">
<title>module~types</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node15"><a xlink:href="../module/types.html" xlink:title="types">
<polygon fill="#337ab7" stroke="#337ab7" points="614.5,-143.3731 560.5,-143.3731 560.5,-119.3731 614.5,-119.3731 614.5,-143.3731"/>
<text text-anchor="middle" x="587.5" y="-128.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">types</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~types -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge14" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M726.5,-131.3731C694.6112,-116.3562 653.8618,-118.4753 624.7436,-123.0647"/>
<polygon fill="#000000" stroke="#000000" points="623.8286,-119.6715 614.5801,-124.8402 625.0333,-126.5671 623.8286,-119.6715"/>
</g>
<!-- module~util -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node16" class="node">
<title>module~util</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node16"><a xlink:href="../module/util.html" xlink:title="util">
<polygon fill="#337ab7" stroke="#337ab7" points="753.5,-221.3731 699.5,-221.3731 699.5,-197.3731 753.5,-197.3731 753.5,-221.3731"/>
<text text-anchor="middle" x="726.5" y="-206.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">util</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;module~util -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge15" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;module~util</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M845.5,-209.3731C821.8854,-193.0806 788.8743,-194.4639 763.6096,-199.1405"/>
<polygon fill="#000000" stroke="#000000" points="762.7242,-195.7499 753.6528,-201.2235 764.1577,-202.6015 762.7242,-195.7499"/>
</g>
<!-- module~basis_tools&#45;&gt;module~io_constants -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge19" class="edge">
<title>module~basis_tools&#45;&gt;module~io_constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M440.9069,-261.6461C431.5749,-279.4404 414.4851,-313.6422 404,-344.3731 381.1628,-411.3069 413.1247,-444.9172 368,-499.3731 365.0271,-502.9607 361.4612,-506.0691 357.5736,-508.7591"/>
<polygon fill="#000000" stroke="#000000" points="355.5007,-505.9177 348.6547,-514.0037 359.0489,-511.9518 355.5007,-505.9177"/>
</g>
<!-- module~basis_tools&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge21" class="edge">
<title>module~basis_tools&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M412.3044,-242.4138C383.4828,-238.3246 342.1953,-236.2177 309,-249.3731"/>
</g>
<!-- iso_fortran_env -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node20" class="node">
<title>iso_fortran_env</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node20"><a xlink:href="http://fortranwiki.org/fortran/show/iso_fortran_env" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-290.3731 0,-290.3731 0,-266.3731 94,-266.3731 94,-290.3731"/>
<text text-anchor="middle" x="47" y="-275.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iso_fortran_env</text>
</a>
</g>
</g>
<!-- module~basis_tools&#45;&gt;iso_fortran_env -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge16" class="edge">
<title>module~basis_tools&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M421.6975,-237.3109C371.5682,-215.6802 258.3614,-175.7315 172,-211.3731"/>
</g>
<!-- module~atomic_structure_m -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node21" class="node">
<title>module~atomic_structure_m</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node21"><a xlink:href="../module/atomic_structure_m.html" xlink:title="atomic_structure_m">
<polygon fill="#337ab7" stroke="#337ab7" points="368,-99.3731 250,-99.3731 250,-75.3731 368,-75.3731 368,-99.3731"/>
<text text-anchor="middle" x="309" y="-84.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atomic_structure_m</text>
</a>
</g>
</g>
<!-- module~basis_tools&#45;&gt;module~atomic_structure_m -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge17" class="edge">
<title>module~basis_tools&#45;&gt;module~atomic_structure_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M443.9245,-237.2795C435.3351,-210.2674 410.9991,-144.5668 368,-108.3731 366.4404,-107.0603 364.7927,-105.8271 363.0782,-104.669"/>
<polygon fill="#000000" stroke="#000000" points="364.4626,-101.4279 354.048,-99.4822 360.9761,-107.4979 364.4626,-101.4279"/>
</g>
<!-- module~constants -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node23" class="node">
<title>module~constants</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node23"><a xlink:href="../module/constants.html" xlink:title="constants">
<polygon fill="#337ab7" stroke="#337ab7" points="341,-377.3731 277,-377.3731 277,-353.3731 341,-353.3731 341,-377.3731"/>
<text text-anchor="middle" x="309" y="-362.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants</text>
</a>
</g>
</g>
<!-- module~basis_tools&#45;&gt;module~constants -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge18" class="edge">
<title>module~basis_tools&#45;&gt;module~constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M432.9398,-261.5679C408.6664,-281.8979 359.7801,-322.8424 331.1939,-346.7847"/>
<polygon fill="#000000" stroke="#000000" points="328.7841,-344.2376 323.3651,-353.3417 333.2787,-349.604 328.7841,-344.2376"/>
</g>
<!-- module~parallel -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node29" class="node">
<title>module~parallel</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node29"><a xlink:href="../module/parallel.html" xlink:title="parallel">
<polygon fill="#337ab7" stroke="#337ab7" points="336,-141.3731 282,-141.3731 282,-117.3731 336,-117.3731 336,-141.3731"/>
<text text-anchor="middle" x="309" y="-126.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel</text>
</a>
</g>
</g>
<!-- module~basis_tools&#45;&gt;module~parallel -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge20" class="edge">
<title>module~basis_tools&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M439.0932,-237.3102C422.4746,-213.7496 385.516,-162.8272 368,-150.3731 361.3334,-145.6331 353.4896,-141.8654 345.7362,-138.9078"/>
<polygon fill="#000000" stroke="#000000" points="346.6536,-135.5223 336.0589,-135.5828 344.3789,-142.1424 346.6536,-135.5223"/>
</g>
<!-- module~int2_compute&#45;&gt;module~basis_tools -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge23" class="edge">
<title>module~int2_compute&#45;&gt;module~basis_tools</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M710.9676,-351.1697C686.4193,-332.7287 636.4031,-298.5195 587.5,-285.3731"/>
</g>
<!-- module~int2_compute&#45;&gt;module~messages -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge27" class="edge">
<title>module~int2_compute&#45;&gt;module~messages</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M722.8848,-375.3919C711.7045,-411.7344 676.7125,-519.2714 648,-540.3731 602.3903,-573.893 534.5007,-574.2666 490.6135,-569.9794"/>
<polygon fill="#000000" stroke="#000000" points="490.8674,-566.4863 480.545,-568.8731 490.1029,-573.4444 490.8674,-566.4863"/>
</g>
<!-- module~int2_compute&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge29" class="edge">
<title>module~int2_compute&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M683.8724,-363.8546C656.3451,-363.8952 619.7738,-363.4443 587.5,-361.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M587.5,-361.3731C523.3855,-357.2584 511.6292,-329.2524 447.5,-325.3731"/>
</g>
<!-- module~int2_compute&#45;&gt;module~atomic_structure_m -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge22" class="edge">
<title>module~int2_compute&#45;&gt;module~atomic_structure_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M724.503,-351.3556C718.6854,-320.1663 698.8285,-235.9669 648,-191.3731 642.4189,-186.4765 452.6351,-129.87 359.5179,-102.2921"/>
<polygon fill="#000000" stroke="#000000" points="360.3198,-98.8794 349.7377,-99.397 358.3329,-105.5915 360.3198,-98.8794"/>
</g>
<!-- module~int2_pairs -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node25" class="node">
<title>module~int2_pairs</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node25"><a xlink:href="../module/int2_pairs.html" xlink:title="int2_pairs">
<polygon fill="#337ab7" stroke="#337ab7" points="341,-457.3731 277,-457.3731 277,-433.3731 341,-433.3731 341,-457.3731"/>
<text text-anchor="middle" x="309" y="-442.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_pairs</text>
</a>
</g>
</g>
<!-- module~int2_compute&#45;&gt;module~int2_pairs -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge24" class="edge">
<title>module~int2_compute&#45;&gt;module~int2_pairs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M715.0718,-375.4535C700.8677,-389.5661 675.1641,-412.2683 648,-422.3731 546.7127,-460.0511 416.7853,-455.5813 351.0795,-449.9921"/>
<polygon fill="#000000" stroke="#000000" points="351.3739,-446.5045 341.0998,-449.0917 350.7448,-453.4762 351.3739,-446.5045"/>
</g>
<!-- module~int2e_libint -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node26" class="node">
<title>module~int2e_libint</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node26"><a xlink:href="../module/int2e_libint.html" xlink:title="int2e_libint">
<polygon fill="#337ab7" stroke="#337ab7" points="483,-377.3731 412,-377.3731 412,-353.3731 483,-353.3731 483,-377.3731"/>
<text text-anchor="middle" x="447.5" y="-362.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2e_libint</text>
</a>
</g>
</g>
<!-- module~int2_compute&#45;&gt;module~int2e_libint -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge25" class="edge">
<title>module~int2_compute&#45;&gt;module~int2e_libint</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M587.5,-361.3731C556.0856,-359.357 520.6406,-360.4029 493.2756,-361.9296"/>
<polygon fill="#000000" stroke="#000000" points="492.9812,-358.4408 483.2085,-362.5328 493.4,-365.4283 492.9812,-358.4408"/>
</g>
<!-- module~int2e_rys -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node27" class="node">
<title>module~int2e_rys</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node27"><a xlink:href="../module/int2e_rys.html" xlink:title="int2e_rys">
<polygon fill="#337ab7" stroke="#337ab7" points="618,-413.3731 557,-413.3731 557,-389.3731 618,-389.3731 618,-413.3731"/>
<text text-anchor="middle" x="587.5" y="-398.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2e_rys</text>
</a>
</g>
</g>
<!-- module~int2_compute&#45;&gt;module~int2e_rys -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge26" class="edge">
<title>module~int2_compute&#45;&gt;module~int2e_rys</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M683.6612,-375.0844C665.9239,-379.9334 645.4559,-385.529 627.9744,-390.3081"/>
<polygon fill="#000000" stroke="#000000" points="626.793,-387.0026 618.07,-393.0158 628.639,-393.7548 626.793,-387.0026"/>
</g>
<!-- module~int2_compute&#45;&gt;module~parallel -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge28" class="edge">
<title>module~int2_compute&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M718.5871,-351.2811C705.6736,-332.2847 678.4362,-295.1674 648,-271.3731 569.5489,-210.0418 544.8679,-192.2437 447.5,-171.3731"/>
</g>
<!-- module~mathlib&#45;&gt;module~oqp_linalg -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge30" class="edge">
<title>module~mathlib&#45;&gt;module~oqp_linalg</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M818.4971,-488.4497C804.1865,-493.26 786.258,-499.2863 770.0384,-504.7383"/>
<polygon fill="#000000" stroke="#000000" points="768.5715,-501.5389 760.2078,-508.0427 770.8019,-508.1741 768.5715,-501.5389"/>
</g>
<!-- module~mathlib&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge31" class="edge">
<title>module~mathlib&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M818.0336,-475.3846C793.5681,-472.7644 757.0238,-471.1603 726.5,-479.3731"/>
</g>
<!-- module~messages&#45;&gt;module~io_constants -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge34" class="edge">
<title>module~messages&#45;&gt;module~io_constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M414.3258,-554.2711C397.5704,-549.674 376.9057,-544.0042 358.3308,-538.9079"/>
<polygon fill="#000000" stroke="#000000" points="359.1228,-535.4959 348.5531,-536.2252 357.2706,-542.2464 359.1228,-535.4959"/>
</g>
<!-- module~messages&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge35" class="edge">
<title>module~messages&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M418.5678,-551.2374C413.5246,-548.6164 408.4687,-545.6387 404,-542.3731 385.2166,-528.6465 387.6864,-516.7699 368,-504.3731 344.6885,-489.6935 332.7879,-499.2674 309,-485.3731"/>
</g>
<!-- comm_IOFILE -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node17" class="node">
<title>comm_IOFILE</title>
<polygon fill="#337ab7" stroke="#337ab7" points="351.5,-579.3731 266.5,-579.3731 266.5,-555.3731 351.5,-555.3731 351.5,-579.3731"/>
<text text-anchor="middle" x="309" y="-564.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">comm_IOFILE</text>
</g>
<!-- module~messages&#45;&gt;comm_IOFILE -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge32" class="edge">
<title>module~messages&#45;&gt;comm_IOFILE</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M414.3258,-564.3312C398.6048,-564.7852 379.4423,-565.3386 361.7935,-565.8484"/>
<polygon fill="#000000" stroke="#000000" points="361.5093,-562.355 351.6146,-566.1423 361.7115,-569.3521 361.5093,-562.355"/>
</g>
<!-- comm_PAR -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node18" class="node">
<title>comm_PAR</title>
<polygon fill="#337ab7" stroke="#337ab7" points="345,-621.3731 273,-621.3731 273,-597.3731 345,-597.3731 345,-621.3731"/>
<text text-anchor="middle" x="309" y="-606.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">comm_PAR</text>
</g>
<!-- module~messages&#45;&gt;comm_PAR -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge33" class="edge">
<title>module~messages&#45;&gt;comm_PAR</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M414.3258,-574.3912C396.526,-580.3031 374.3143,-587.6802 354.8831,-594.1339"/>
<polygon fill="#000000" stroke="#000000" points="353.6943,-590.8407 345.3072,-597.3144 355.9007,-597.4839 353.6943,-590.8407"/>
</g>
<!-- module~blas_wrap -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node22" class="node">
<title>module~blas_wrap</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node22"><a xlink:href="../module/blas_wrap.html" xlink:title="blas_wrap">
<polygon fill="#337ab7" stroke="#337ab7" points="620.5,-611.3731 554.5,-611.3731 554.5,-587.3731 620.5,-587.3731 620.5,-611.3731"/>
<text text-anchor="middle" x="587.5" y="-596.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">blas_wrap</text>
</a>
</g>
</g>
<!-- module~oqp_linalg&#45;&gt;module~blas_wrap -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge36" class="edge">
<title>module~oqp_linalg&#45;&gt;module~blas_wrap</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M710.8564,-531.5034C695.4222,-543.1359 670.8832,-560.7462 648,-573.3731 641.8128,-576.7871 635.0863,-580.0683 628.4416,-583.0818"/>
<polygon fill="#000000" stroke="#000000" points="626.5923,-580.0708 618.8373,-587.2895 629.4014,-586.4824 626.5923,-580.0708"/>
</g>
<!-- module~lapack_wrap -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node28" class="node">
<title>module~lapack_wrap</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node28"><a xlink:href="../module/lapack_wrap.html" xlink:title="lapack_wrap">
<polygon fill="#337ab7" stroke="#337ab7" points="627,-531.3731 548,-531.3731 548,-507.3731 627,-507.3731 627,-531.3731"/>
<text text-anchor="middle" x="587.5" y="-516.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lapack_wrap</text>
</a>
</g>
</g>
<!-- module~oqp_linalg&#45;&gt;module~lapack_wrap -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge37" class="edge">
<title>module~oqp_linalg&#45;&gt;module~lapack_wrap</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M692.852,-519.3731C676.1073,-519.3731 655.539,-519.3731 637.0343,-519.3731"/>
<polygon fill="#000000" stroke="#000000" points="637.0036,-515.8732 627.0035,-519.3731 637.0035,-522.8732 637.0036,-515.8732"/>
</g>
<!-- iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node19" class="node">
<title>iso_c_binding</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node19"><a xlink:href="http://fortranwiki.org/fortran/show/iso_c_binding" xlink:title="iso_c_binding">
<polygon fill="#337ab7" stroke="#337ab7" points="214,-99.3731 130,-99.3731 130,-75.3731 214,-75.3731 214,-99.3731"/>
<text text-anchor="middle" x="172" y="-84.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iso_c_binding</text>
</a>
</g>
</g>
<!-- module~oqp_tagarray_driver&#45;&gt;iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge38" class="edge">
<title>module~oqp_tagarray_driver&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558.6428,-33.3159C530.7739,-22.5936 487.0869,-8.1864 447.5,-5.3731"/>
</g>
<!-- tagarray -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node30" class="node">
<title>tagarray</title>
<polygon fill="#337ab7" stroke="#337ab7" points="476.5,-57.3731 418.5,-57.3731 418.5,-33.3731 476.5,-33.3731 476.5,-57.3731"/>
<text text-anchor="middle" x="447.5" y="-42.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tagarray</text>
</g>
<!-- module~oqp_tagarray_driver&#45;&gt;tagarray -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge39" class="edge">
<title>module~oqp_tagarray_driver&#45;&gt;tagarray</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M526.9082,-45.3731C513.283,-45.3731 499.1734,-45.3731 486.6952,-45.3731"/>
<polygon fill="#000000" stroke="#000000" points="486.6436,-41.8732 476.6436,-45.3731 486.6436,-48.8732 486.6436,-41.8732"/>
</g>
<!-- module~precision&#45;&gt;iso_fortran_env -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge40" class="edge">
<title>module~precision&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M149.3634,-333.2399C129.541,-322.6151 100.5369,-307.0689 78.4591,-295.2351"/>
<polygon fill="#000000" stroke="#000000" points="79.9354,-292.0554 69.4682,-290.416 76.6284,-298.225 79.9354,-292.0554"/>
</g>
<!-- module~printing&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge41" class="edge">
<title>module~printing&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M699.4264,-650.8192C671.8535,-661.5968 627.5755,-676.5047 587.5,-679.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M587.5,-679.3731C463.8591,-688.2225 412.5103,-732.5712 309,-664.3731"/>
</g>
<!-- module~strings&#45;&gt;iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge42" class="edge">
<title>module~strings&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M699.2369,-38.5501C684.2938,-33.5457 665.3345,-27.8075 648,-24.3731 560.1964,-6.9768 536.7851,-11.7184 447.5,-5.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-5.3731C386.2037,.2705 370.0434,2.5513 309,-5.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309,-5.3731C281.6808,-8.9195 272.9391,-9.1182 250,-24.3731 229.5281,-37.9872 233.3784,-51.2429 214,-66.3731 212.4096,-67.6148 210.7342,-68.8127 209.005,-69.9637"/>
<polygon fill="#000000" stroke="#000000" points="206.844,-67.1778 200.0562,-75.3127 210.4355,-73.1862 206.844,-67.1778"/>
</g>
<!-- module~tdhf_lib&#45;&gt;module~basis_tools -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge43" class="edge">
<title>module~tdhf_lib&#45;&gt;module~basis_tools</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M836.1556,-353.2717C817.7838,-330.9755 774.5452,-285.6422 726.5,-285.3731"/>
</g>
<!-- module~tdhf_lib&#45;&gt;module~int2_compute -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge44" class="edge">
<title>module~tdhf_lib&#45;&gt;module~int2_compute</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M818.4971,-364.9192C806.9123,-364.7245 792.9567,-364.49 779.4559,-364.2631"/>
<polygon fill="#000000" stroke="#000000" points="779.3248,-360.7605 769.2673,-364.0919 779.2071,-367.7595 779.3248,-360.7605"/>
</g>
<!-- module~tdhf_lib&#45;&gt;module~oqp_linalg -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge45" class="edge">
<title>module~tdhf_lib&#45;&gt;module~oqp_linalg</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M840.5883,-377.6007C830.3101,-402.0062 804.5118,-457.4925 769,-493.3731 766.1383,-496.2644 762.8937,-498.971 759.5034,-501.463"/>
<polygon fill="#000000" stroke="#000000" points="757.285,-498.7357 750.911,-507.1987 761.1714,-504.5577 757.285,-498.7357"/>
</g>
<!-- module~tdhf_lib&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge46" class="edge">
<title>module~tdhf_lib&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M838.9184,-377.5323C823.5438,-404.2481 782.2988,-466.699 726.5,-479.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M726.5,-479.3731C605.5769,-506.8395 571.3513,-487.5085 447.5,-481.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-481.3731C386.0641,-477.1447 362.175,-516.4321 309,-485.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309,-485.3731C285.2121,-471.4788 271.8493,-483.1517 250,-466.3731 215.7243,-440.0518 192.1662,-394.086 180.4845,-367.0206"/>
<polygon fill="#000000" stroke="#000000" points="183.6613,-365.5442 176.5913,-357.6533 177.1973,-368.2308 183.6613,-365.5442"/>
</g>
<!-- module~tdhf_mrsf_lib&#45;&gt;module~basis_tools -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge47" class="edge">
<title>module~tdhf_mrsf_lib&#45;&gt;module~basis_tools</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M804.7436,-285.4859C781.7651,-285.5212 752.5308,-285.5189 726.5,-285.3731"/>
</g>
<!-- module~tdhf_mrsf_lib&#45;&gt;module~int2_compute -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge48" class="edge">
<title>module~tdhf_mrsf_lib&#45;&gt;module~int2_compute</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.9942,-297.5908C819.288,-301.8716 811.7669,-306.7624 805,-311.3731 788.6896,-322.4862 785.43,-326.4375 769,-337.3731 764.6999,-340.2352 760.0933,-343.1768 755.5571,-346.0051"/>
<polygon fill="#000000" stroke="#000000" points="753.7057,-343.0347 747.02,-351.2537 757.3719,-348.9979 753.7057,-343.0347"/>
</g>
<!-- module~tdhf_mrsf_lib&#45;&gt;module~oqp_linalg -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge49" class="edge">
<title>module~tdhf_mrsf_lib&#45;&gt;module~oqp_linalg</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M835.045,-297.6855C825.8635,-309.0965 812.7898,-326.8975 805,-344.3731 777.2627,-406.5987 809.1051,-438.3007 769,-493.3731 766.8996,-496.2573 764.3726,-498.8872 761.6111,-501.2696"/>
<polygon fill="#000000" stroke="#000000" points="759.3476,-498.5897 753.3667,-507.3351 763.4958,-504.2282 759.3476,-498.5897"/>
</g>
<!-- module~tdhf_mrsf_lib&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge50" class="edge">
<title>module~tdhf_mrsf_lib&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M804.9064,-293.7871C733.0102,-307.7191 578.5122,-333.2983 447.5,-325.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-325.3731C364.0298,-320.3238 266.4481,-331.4325 212.7066,-339.0299"/>
<polygon fill="#000000" stroke="#000000" points="211.9564,-335.6019 202.56,-340.4967 212.958,-342.5298 211.9564,-335.6019"/>
</g>
<!-- module~tdhf_sf_lib&#45;&gt;module~oqp_linalg -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge51" class="edge">
<title>module~tdhf_sf_lib&#45;&gt;module~oqp_linalg</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M812.3519,-520.816C799.4185,-520.5986 784.4034,-520.3462 770.5808,-520.1139"/>
<polygon fill="#000000" stroke="#000000" points="770.3547,-516.6097 760.2972,-519.9411 770.237,-523.6087 770.3547,-516.6097"/>
</g>
<!-- module~types&#45;&gt;module~basis_tools -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge54" class="edge">
<title>module~types&#45;&gt;module~basis_tools</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M576.3778,-143.5987C559.161,-162.1314 524.534,-197.8736 491,-223.3731 487.0912,-226.3454 482.8191,-229.2574 478.528,-231.9943"/>
<polygon fill="#000000" stroke="#000000" points="476.509,-229.1264 469.8034,-237.3291 480.1607,-235.0984 476.509,-229.1264"/>
</g>
<!-- module~types&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge57" class="edge">
<title>module~types&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M571.7897,-143.3936C546.9763,-161.59 496.4838,-195.4772 447.5,-209.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-209.3731C385.8609,-226.859 368.5644,-225.7676 309,-249.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309,-249.3731C262.9535,-267.6214 217.4572,-304.1611 192.2134,-326.5227"/>
<polygon fill="#000000" stroke="#000000" points="189.8405,-323.9496 184.754,-333.2437 194.5261,-329.1501 189.8405,-323.9496"/>
</g>
<!-- module~types&#45;&gt;iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge52" class="edge">
<title>module~types&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M560.2421,-122.052C532.1049,-112.5162 486.8858,-97.4308 447.5,-85.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-85.3731C427.3271,-79.1973 420.9597,-78.9211 404,-66.3731 384.236,-51.7502 388.4719,-37.9872 368,-24.3731 345.0609,-9.1182 336.3192,-1.8266 309,-5.3731"/>
</g>
<!-- module~types&#45;&gt;module~atomic_structure_m -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge53" class="edge">
<title>module~types&#45;&gt;module~atomic_structure_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-85.3731C425.5657,-78.658 400.7476,-77.225 378.2403,-78.0699"/>
<polygon fill="#000000" stroke="#000000" points="377.8814,-74.5839 368.0804,-78.6077 378.2514,-81.5741 377.8814,-74.5839"/>
</g>
<!-- module~functionals -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node24" class="node">
<title>module~functionals</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node24"><a xlink:href="../module/functionals.html" xlink:title="functionals">
<polygon fill="#337ab7" stroke="#337ab7" points="344.5,-57.3731 273.5,-57.3731 273.5,-33.3731 344.5,-33.3731 344.5,-57.3731"/>
<text text-anchor="middle" x="309" y="-42.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">functionals</text>
</a>
</g>
</g>
<!-- module~types&#45;&gt;module~functionals -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge55" class="edge">
<title>module~types&#45;&gt;module~functionals</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-85.3731C416.6242,-75.9206 381.6919,-65.8361 354.6341,-58.1575"/>
<polygon fill="#000000" stroke="#000000" points="355.2495,-54.6943 344.6743,-55.3387 353.3432,-61.4297 355.2495,-54.6943"/>
</g>
<!-- module~types&#45;&gt;module~parallel -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge56" class="edge">
<title>module~types&#45;&gt;module~parallel</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M567.7739,-143.3822C540.8603,-158.2946 491.0014,-180.6975 447.5,-171.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-171.3731C412.4901,-163.8688 373.542,-151.7052 345.8878,-142.3947"/>
<polygon fill="#000000" stroke="#000000" points="346.8331,-139.0192 336.2386,-139.1075 344.5757,-145.6453 346.8331,-139.0192"/>
</g>
<!-- module~types&#45;&gt;tagarray -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge58" class="edge">
<title>module~types&#45;&gt;tagarray</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M568.3366,-119.3205C548.9083,-107.1338 517.9507,-87.804 491,-71.3731 486.4222,-68.5822 481.5591,-65.6467 476.8057,-62.7937"/>
<polygon fill="#000000" stroke="#000000" points="478.2827,-59.5988 467.9042,-57.4685 474.689,-65.606 478.2827,-59.5988"/>
</g>
<!-- module~util&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge59" class="edge">
<title>module~util&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M699.2859,-204.5521C648.5881,-196.6167 536.7366,-184.0582 447.5,-209.3731"/>
</g>
<!-- module~atomic_structure_m&#45;&gt;iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge60" class="edge">
<title>module~atomic_structure_m&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M249.7066,-87.3731C241.1722,-87.3731 232.4436,-87.3731 224.0637,-87.3731"/>
<polygon fill="#000000" stroke="#000000" points="224.0516,-83.8732 214.0516,-87.3731 224.0516,-90.8732 224.0516,-83.8732"/>
</g>
<!-- module~blas_wrap&#45;&gt;module~messages -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge62" class="edge">
<title>module~blas_wrap&#45;&gt;module~messages</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M554.322,-590.8416C535.2821,-585.9456 511.1615,-579.7432 490.6604,-574.4715"/>
<polygon fill="#000000" stroke="#000000" points="491.4817,-571.0689 480.9251,-571.9681 489.7383,-577.8483 491.4817,-571.0689"/>
</g>
<!-- module~blas_wrap&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge63" class="edge">
<title>module~blas_wrap&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M557.7326,-611.5015C495.1433,-636.1735 352.1295,-687.9512 309,-664.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309,-664.3731C283.7275,-647.7222 268.4977,-654.3269 250,-630.3731 217.4518,-588.2245 186.3938,-426.9858 175.8171,-367.5469"/>
<polygon fill="#000000" stroke="#000000" points="179.2091,-366.6263 174.0325,-357.3822 172.3146,-367.8369 179.2091,-366.6263"/>
</g>
<!-- module~mathlib_types -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node32" class="node">
<title>module~mathlib_types</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node32"><a xlink:href="../module/mathlib_types.html" xlink:title="mathlib_types">
<polygon fill="#337ab7" stroke="#337ab7" points="491,-533.3731 404,-533.3731 404,-509.3731 491,-509.3731 491,-533.3731"/>
<text text-anchor="middle" x="447.5" y="-518.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mathlib_types</text>
</a>
</g>
</g>
<!-- module~blas_wrap&#45;&gt;module~mathlib_types -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge61" class="edge">
<title>module~blas_wrap&#45;&gt;module~mathlib_types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M568.1826,-587.3147C548.8938,-575.4292 518.2735,-556.9782 491,-542.3731 488.2785,-540.9157 485.4402,-539.4432 482.575,-537.9902"/>
<polygon fill="#000000" stroke="#000000" points="483.9551,-534.7678 473.4416,-533.4571 480.843,-541.038 483.9551,-534.7678"/>
</g>
<!-- module~constants&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge64" class="edge">
<title>module~constants&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.8796,-360.684C257.6649,-357.8789 233.0702,-354.2884 212.5278,-351.2895"/>
<polygon fill="#000000" stroke="#000000" points="212.9092,-347.8082 202.5084,-349.8269 211.8979,-354.7348 212.9092,-347.8082"/>
</g>
<!-- module~functionals&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge66" class="edge">
<title>module~functionals&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M273.4042,-51.712C264.6987,-54.8229 256.1337,-59.4603 250,-66.3731 201.9114,-120.5696 234.0003,-155.7328 214,-225.3731 203.969,-260.3007 189.4692,-299.9347 180.3972,-323.7759"/>
<polygon fill="#000000" stroke="#000000" points="177.0743,-322.666 176.7584,-333.2561 183.6095,-325.1744 177.0743,-322.666"/>
</g>
<!-- module~functionals&#45;&gt;iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge65" class="edge">
<title>module~functionals&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M273.3625,-56.2984C257.4565,-61.1747 238.4524,-67.0008 221.2204,-72.2836"/>
<polygon fill="#000000" stroke="#000000" points="219.851,-69.0426 211.316,-75.32 221.9027,-75.7351 219.851,-69.0426"/>
</g>
<!-- xc_f03_lib_m -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node34" class="node">
<title>xc_f03_lib_m</title>
<polygon fill="#337ab7" stroke="#337ab7" points="212.5,-57.3731 131.5,-57.3731 131.5,-33.3731 212.5,-33.3731 212.5,-57.3731"/>
<text text-anchor="middle" x="172" y="-42.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">xc_f03_lib_m</text>
</g>
<!-- module~functionals&#45;&gt;xc_f03_lib_m -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge67" class="edge">
<title>module~functionals&#45;&gt;xc_f03_lib_m</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M273.3625,-45.3731C257.9991,-45.3731 239.7453,-45.3731 222.9899,-45.3731"/>
<polygon fill="#000000" stroke="#000000" points="222.7901,-41.8732 212.79,-45.3731 222.79,-48.8732 222.7901,-41.8732"/>
</g>
<!-- module~int2_pairs&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge68" class="edge">
<title>module~int2_pairs&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M276.7176,-433.5273C267.7355,-429.6069 258.201,-424.8295 250,-419.3731 226.8406,-403.9643 204.2128,-381.419 189.3457,-365.2673"/>
<polygon fill="#000000" stroke="#000000" points="191.6139,-362.5564 182.3168,-357.4755 186.4162,-367.2451 191.6139,-362.5564"/>
</g>
<!-- module~int2e_libint&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge73" class="edge">
<title>module~int2e_libint&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.8593,-377.5748C398.9592,-391.3422 351.41,-411.1201 309,-405.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309,-405.3731C268.4904,-399.8836 225.9917,-378.4533 199.2716,-362.7653"/>
<polygon fill="#000000" stroke="#000000" points="200.8805,-359.6486 190.5076,-357.4912 197.2711,-365.6463 200.8805,-359.6486"/>
</g>
<!-- module~int2e_libint&#45;&gt;iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge69" class="edge">
<title>module~int2e_libint&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M428.6906,-353.2307C390.3813,-327.6672 302.5023,-264.6603 250,-192.3731 226.1309,-159.5091 241.8648,-137.9252 214,-108.3731 213.0877,-107.4055 212.1211,-106.476 211.1109,-105.5836"/>
<polygon fill="#000000" stroke="#000000" points="212.8329,-102.5081 202.6879,-99.4538 208.714,-108.168 212.8329,-102.5081"/>
</g>
<!-- module~int2e_libint&#45;&gt;module~constants -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge70" class="edge">
<title>module~int2e_libint&#45;&gt;module~constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.8328,-365.3731C393.3533,-365.3731 370.6641,-365.3731 351.3039,-365.3731"/>
<polygon fill="#000000" stroke="#000000" points="351.2319,-361.8732 341.2318,-365.3731 351.2318,-368.8732 351.2319,-361.8732"/>
</g>
<!-- module~int2e_libint&#45;&gt;module~int2_pairs -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge71" class="edge">
<title>module~int2e_libint&#45;&gt;module~int2_pairs</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.9335,-377.5586C418.8317,-381.7564 410.9716,-386.6047 404,-391.3731 387.2693,-402.8163 385.4058,-408.9854 368,-419.3731 362.1878,-422.8418 355.8295,-426.1225 349.5074,-429.1104"/>
<polygon fill="#000000" stroke="#000000" points="348.0016,-425.9501 340.3386,-433.2664 350.8916,-432.3257 348.0016,-425.9501"/>
</g>
<!-- module~libint_f -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node31" class="node">
<title>module~libint_f</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node31"><a xlink:href="../module/libint_f.html" xlink:title="libint_f">
<polygon fill="#337ab7" stroke="#337ab7" points="336,-183.3731 282,-183.3731 282,-159.3731 336,-159.3731 336,-183.3731"/>
<text text-anchor="middle" x="309" y="-168.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint_f</text>
</a>
</g>
</g>
<!-- module~int2e_libint&#45;&gt;module~libint_f -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge72" class="edge">
<title>module~int2e_libint&#45;&gt;module~libint_f</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M441.0162,-353.0317C428.3306,-329.316 398.7703,-276.1181 368,-235.3731 356.0467,-219.5449 340.8416,-203.1239 328.8612,-190.8786"/>
<polygon fill="#000000" stroke="#000000" points="331.0493,-188.1147 321.5205,-183.4828 326.081,-193.0459 331.0493,-188.1147"/>
</g>
<!-- module~int2e_rys&#45;&gt;module~basis_tools -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge74" class="edge">
<title>module~int2e_rys&#45;&gt;module~basis_tools</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.9546,-392.689C546.5942,-388.6542 535.5027,-383.0152 527,-375.3731 502.7275,-353.5572 508.3936,-338.9874 491,-311.3731 482.0649,-297.1876 471.2398,-281.7531 462.6237,-269.8323"/>
<polygon fill="#000000" stroke="#000000" points="465.2533,-267.4981 456.5333,-261.4803 459.5973,-271.6225 465.2533,-267.4981"/>
</g>
<!-- module~int2e_rys&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge76" class="edge">
<title>module~int2e_rys&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-405.3731C386.0459,-401.8402 369.998,-413.639 309,-405.3731"/>
</g>
<!-- module~int2e_rys&#45;&gt;module~constants -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge75" class="edge">
<title>module~int2e_rys&#45;&gt;module~constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.8904,-403.7597C528.5129,-405.6135 485.1269,-407.5362 447.5,-405.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.5,-405.3731C412.3392,-403.3518 373.985,-391.4666 346.5721,-381.1722"/>
<polygon fill="#000000" stroke="#000000" points="347.5832,-377.8108 336.9937,-377.4728 345.0611,-384.3407 347.5832,-377.8108"/>
</g>
<!-- module~lapack_wrap&#45;&gt;module~messages -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge78" class="edge">
<title>module~lapack_wrap&#45;&gt;module~messages</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.2444,-531.3963C531.1271,-537.0903 509.4105,-543.9155 490.7018,-549.7954"/>
<polygon fill="#000000" stroke="#000000" points="489.435,-546.5246 480.9445,-552.8619 491.5339,-553.2026 489.435,-546.5246"/>
</g>
<!-- module~lapack_wrap&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge79" class="edge">
<title>module~lapack_wrap&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M557.7963,-507.2978C529.8657,-496.915 486.6147,-483.3108 447.5,-481.3731"/>
</g>
<!-- module~lapack_wrap&#45;&gt;module~mathlib_types -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge77" class="edge">
<title>module~lapack_wrap&#45;&gt;module~mathlib_types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M547.7561,-519.9408C533.4373,-520.1454 517.027,-520.3798 501.686,-520.599"/>
<polygon fill="#000000" stroke="#000000" points="501.2239,-517.1051 491.2749,-520.7477 501.3239,-524.1044 501.2239,-517.1051"/>
</g>
<!-- module~parallel&#45;&gt;module~precision -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge82" class="edge">
<title>module~parallel&#45;&gt;module~precision</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.7278,-133.982C270.7235,-137.0375 258.6183,-142.0808 250,-150.3731 236.8121,-163.062 196.3355,-275.7833 179.4838,-323.8315"/>
<polygon fill="#000000" stroke="#000000" points="176.1705,-322.7036 176.1761,-333.2984 182.7787,-325.0126 176.1705,-322.7036"/>
</g>
<!-- module~parallel&#45;&gt;iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge80" class="edge">
<title>module~parallel&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.9332,-121.0752C264.5765,-115.7542 241.5349,-108.6903 221.0312,-102.4045"/>
<polygon fill="#000000" stroke="#000000" points="221.7924,-98.9772 211.2057,-99.3923 219.7406,-105.6697 221.7924,-98.9772"/>
</g>
<!-- module~parallel&#45;&gt;iso_fortran_env -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge81" class="edge">
<title>module~parallel&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.7791,-137.0285C271.5029,-140.4365 259.9079,-144.924 250,-150.3731 211.4382,-171.5811 212.6807,-194.584 172,-211.3731"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M172,-211.3731C137.691,-225.5325 100.4457,-246.2476 75.618,-260.8884"/>
<polygon fill="#000000" stroke="#000000" points="73.5423,-258.0509 66.7426,-266.1759 77.125,-264.0647 73.5423,-258.0509"/>
</g>
<!-- mpi -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_node33" class="node">
<title>mpi</title>
<g id="a_proc~~tdhf_mrsf_energy~~UsesGraph_node33"><a xlink:href="http://www.mpi-forum.org/docs/mpi-3.1/mpi31-report/node410.htm" xlink:title="mpi">
<polygon fill="#337ab7" stroke="#337ab7" points="199,-141.3731 145,-141.3731 145,-117.3731 199,-117.3731 199,-141.3731"/>
<text text-anchor="middle" x="172" y="-126.9731" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi</text>
</a>
</g>
</g>
<!-- module~parallel&#45;&gt;mpi -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge83" class="edge">
<title>module~parallel&#45;&gt;mpi</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.9332,-129.3731C261.1051,-129.3731 232.0908,-129.3731 209.0994,-129.3731"/>
<polygon fill="#000000" stroke="#000000" points="209.0106,-125.8732 199.0106,-129.3731 209.0105,-132.8732 209.0106,-125.8732"/>
</g>
<!-- module~libint_f&#45;&gt;iso_c_binding -->
<g id="proc~~tdhf_mrsf_energy~~UsesGraph_edge84" class="edge">
<title>module~libint_f&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M281.7526,-164.9153C271.2465,-161.6223 259.4985,-156.9001 250,-150.3731 229.7374,-136.4493 233.3784,-123.5033 214,-108.3731 212.4096,-107.1314 210.7342,-105.9335 209.005,-104.7825"/>
<polygon fill="#000000" stroke="#000000" points="210.4355,-101.5599 200.0562,-99.4334 206.844,-107.5684 210.4355,-101.5599"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproctdhf_mrsf_energyUsesGraph = svgPanZoom('#proctdhf_mrsf_energyUsesGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="517pt" height="32pt"
 viewBox="0.00 0.00 517.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 513,-28 513,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234.5,-24 163.5,-24 163.5,0 234.5,0 234.5,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="311,-24 253,-24 253,0 311,0 311,-24"/>
<text text-anchor="middle" x="282" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="387,-24 329,-24 329,0 387,0 387,-24"/>
<text text-anchor="middle" x="358" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="509,-24 405,-24 405,0 509,0 509,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 </div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>




    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-infos~47"></span>
              type(<a href='../type/information.html'>information</a>),
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              target
            </td>
            <td>::</td>
            <td><strong>infos</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: proc~~tdhf_mrsf_energy~~CallsGraph Pages: 1 -->
<svg id="proctdhf_mrsf_energyCallsGraph" width="641pt" height="1260pt"
 viewBox="0.00 0.00 641.00 1259.94" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~tdhf_mrsf_energy~~CallsGraph" class="graph" transform="scale(.4085 .4085) rotate(0) translate(4 3080)">
<title>proc~~tdhf_mrsf_energy~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-3080 1565,-3080 1565,4 -4,4"/>
<!-- proc~tdhf_mrsf_energy -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node1" class="node">
<title>proc~tdhf_mrsf_energy</title>
<polygon fill="none" stroke="#000000" points="106,-807 0,-807 0,-783 106,-783 106,-807"/>
<text text-anchor="middle" x="53" y="-792.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">tdhf_mrsf_energy</text>
</g>
<!-- interface~data_has_tags -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node2" class="node">
<title>interface~data_has_tags</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node2"><a xlink:href="../interface/data_has_tags.html" xlink:title="data_has_tags">
<polygon fill="#a7506f" stroke="#a7506f" points="265,-1907 177,-1907 177,-1883 265,-1883 265,-1907"/>
<text text-anchor="middle" x="221" y="-1892.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">data_has_tags</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;interface~data_has_tags -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge1" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;interface~data_has_tags</title>
<path fill="none" stroke="#000000" d="M53.2032,-807.0633C55.1973,-919.4464 72.7033,-1781.1291 142,-1869 148.3705,-1877.078 157.3144,-1882.6735 166.9059,-1886.5426"/>
<polygon fill="#000000" stroke="#000000" points="166.0473,-1889.9477 176.6418,-1889.8643 168.3076,-1883.3227 166.0473,-1889.9477"/>
</g>
<!-- interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node3" class="node">
<title>interface~show_message</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node3"><a xlink:href="../interface/show_message.html" xlink:title="show_message">
<polygon fill="#a7506f" stroke="#a7506f" points="1181.5,-844 1088.5,-844 1088.5,-820 1181.5,-820 1181.5,-844"/>
<text text-anchor="middle" x="1135" y="-829.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">show_message</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge2" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M53.7859,-782.9393C59.3811,-698.8273 94.3337,-201.9156 142,-157 193.1058,-108.8434 386.7799,-132 457,-132 457,-132 457,-132 703,-132 871.7537,-132 921.761,-205.3786 1018,-344 1031.8003,-363.8778 1109.7899,-716.9002 1130.1422,-809.7678"/>
<polygon fill="#000000" stroke="#000000" points="1126.7235,-810.5182 1132.281,-819.5384 1133.5615,-809.0212 1126.7235,-810.5182"/>
</g>
<!-- interface~tagarray_get_data -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node4" class="node">
<title>interface~tagarray_get_data</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node4"><a xlink:href="../interface/tagarray_get_data.html" xlink:title="tagarray_get_data">
<polygon fill="#a7506f" stroke="#a7506f" points="276,-1646 166,-1646 166,-1622 276,-1622 276,-1646"/>
<text text-anchor="middle" x="221" y="-1631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tagarray_get_data</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;interface~tagarray_get_data -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge3" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;interface~tagarray_get_data</title>
<path fill="none" stroke="#000000" d="M53.5506,-807.2974C57.9909,-904.2012 89.1507,-1542.7718 142,-1608 146.0563,-1613.0064 151.0989,-1617.0574 156.6608,-1620.3341"/>
<polygon fill="#000000" stroke="#000000" points="155.2501,-1623.5416 165.7611,-1624.8716 158.3737,-1617.2771 155.2501,-1623.5416"/>
</g>
<!-- interface~unpack_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node5" class="node">
<title>interface~unpack_matrix</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node5"><a xlink:href="../interface/unpack_matrix.html" xlink:title="unpack_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="266.5,-306 175.5,-306 175.5,-282 266.5,-282 266.5,-306"/>
<text text-anchor="middle" x="221" y="-291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">unpack_matrix</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;interface~unpack_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge4" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;interface~unpack_matrix</title>
<path fill="none" stroke="#000000" d="M53.539,-782.9282C56.7894,-715.5398 75.9098,-386.3484 142,-315 148.3741,-308.1188 156.7227,-303.391 165.6014,-300.1633"/>
<polygon fill="#000000" stroke="#000000" points="166.8101,-303.4546 175.3755,-297.2188 164.7909,-296.7522 166.8101,-303.4546"/>
</g>
<!-- none~clean~18 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node6" class="node">
<title>none~clean~18</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node6"><a xlink:href="../type/int2_compute_t.html#boundprocedure-clean~18" xlink:title="int2_compute_t%clean">
<polygon fill="#a7506f" stroke="#a7506f" points="287.5,-1546 154.5,-1546 154.5,-1522 287.5,-1522 287.5,-1546"/>
<text text-anchor="middle" x="221" y="-1531.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute_t%clean</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;none~clean~18 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge5" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;none~clean~18</title>
<path fill="none" stroke="#000000" d="M53.3272,-807.0311C55.7112,-888.0068 72.3346,-1353.9442 142,-1474 152.5024,-1492.0989 170.8308,-1506.5333 187.1909,-1516.7047"/>
<polygon fill="#000000" stroke="#000000" points="185.6242,-1519.8441 196.0151,-1521.913 189.1824,-1513.8159 185.6242,-1519.8441"/>
</g>
<!-- none~init~16 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node7" class="node">
<title>none~init~16</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node7"><a xlink:href="../type/int2_compute_t.html#boundprocedure-init~16" xlink:title="int2_compute_t%init">
<polygon fill="#a7506f" stroke="#a7506f" points="983.5,-2253 862.5,-2253 862.5,-2229 983.5,-2229 983.5,-2253"/>
<text text-anchor="middle" x="923" y="-2238.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute_t%init</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;none~init~16 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge6" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;none~init~16</title>
<path fill="none" stroke="#000000" d="M53.6783,-807.2271C59.2561,-906.4087 98.4494,-1577.4567 142,-1655 320.3624,-1972.5801 749.5259,-2169.8793 882.8154,-2225.0762"/>
<polygon fill="#000000" stroke="#000000" points="881.6777,-2228.3926 892.2577,-2228.9528 884.3363,-2221.9171 881.6777,-2228.3926"/>
</g>
<!-- none~run~6 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node8" class="node">
<title>none~run~6</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node8"><a xlink:href="../type/int2_compute_t.html#boundprocedure-run~6" xlink:title="int2_compute_t%run">
<polygon fill="#a7506f" stroke="#a7506f" points="282,-1465 160,-1465 160,-1441 282,-1441 282,-1465"/>
<text text-anchor="middle" x="221" y="-1450.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute_t%run</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;none~run~6 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge7" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;none~run~6</title>
<path fill="none" stroke="#000000" d="M54.1847,-807.2477C61.2233,-878.7939 98.7105,-1243.0548 142,-1346 156.3024,-1380.012 183.5284,-1413.2518 201.9727,-1433.4324"/>
<polygon fill="#000000" stroke="#000000" points="199.4207,-1435.8277 208.8028,-1440.7499 204.5379,-1431.0513 199.4207,-1435.8277"/>
</g>
<!-- none~set_screening~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node9" class="node">
<title>none~set_screening~2</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node9"><a xlink:href="../type/int2_compute_t.html#boundprocedure-set_screening~2" xlink:title="int2_compute_t%set_screening">
<polygon fill="#a7506f" stroke="#a7506f" points="792,-1827 614,-1827 614,-1803 792,-1803 792,-1827"/>
<text text-anchor="middle" x="703" y="-1812.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute_t%set_screening</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;none~set_screening~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge8" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;none~set_screening~2</title>
<path fill="none" stroke="#000000" d="M53.656,-807.0643C58.7793,-899.4952 93.4643,-1493.4566 142,-1555 188.3218,-1613.7362 232.2371,-1581.3165 300,-1613 445.9186,-1681.2263 464.2499,-1734.6538 614,-1794 619.7145,-1796.2647 625.7363,-1798.3247 631.8417,-1800.1901"/>
<polygon fill="#000000" stroke="#000000" points="630.8946,-1803.5595 641.4726,-1802.9628 632.8313,-1796.8327 630.8946,-1803.5595"/>
</g>
<!-- proc~get_mrsf_transition_density -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node10" class="node">
<title>proc~get_mrsf_transition_density</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node10"><a xlink:href="../proc/get_mrsf_transition_density.html" xlink:title="get_mrsf_transition_density">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-1279 142,-1279 142,-1255 300,-1255 300,-1279"/>
<text text-anchor="middle" x="221" y="-1264.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_mrsf_transition_density</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~get_mrsf_transition_density -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge9" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~get_mrsf_transition_density</title>
<path fill="none" stroke="#000000" d="M53.9075,-807.2246C58.886,-871.2706 84.7748,-1167.783 142,-1236 146.8173,-1241.7426 152.84,-1246.4271 159.3986,-1250.2472"/>
<polygon fill="#000000" stroke="#000000" points="158.1122,-1253.5198 168.6116,-1254.9388 161.2887,-1247.282 158.1122,-1253.5198"/>
</g>
<!-- proc~get_mrsf_transitions -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node11" class="node">
<title>proc~get_mrsf_transitions</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node11"><a xlink:href="../proc/get_mrsf_transitions.html" xlink:title="get_mrsf_transitions">
<polygon fill="#d9534f" stroke="#d9534f" points="281,-1194 161,-1194 161,-1170 281,-1170 281,-1194"/>
<text text-anchor="middle" x="221" y="-1179.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_mrsf_transitions</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~get_mrsf_transitions -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge10" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~get_mrsf_transitions</title>
<path fill="none" stroke="#000000" d="M54.4279,-807.2554C61.2964,-864.2351 92.6447,-1102.7312 142,-1156 145.1204,-1159.3678 148.6843,-1162.3001 152.5336,-1164.8531"/>
<polygon fill="#000000" stroke="#000000" points="150.9298,-1167.9672 161.3545,-1169.8581 154.3843,-1161.879 150.9298,-1167.9672"/>
</g>
<!-- proc~get_transition_density -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node12" class="node">
<title>proc~get_transition_density</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node12"><a xlink:href="../proc/get_transition_density.html" xlink:title="get_transition_density">
<polygon fill="#d9534f" stroke="#d9534f" points="285.5,-908 156.5,-908 156.5,-884 285.5,-884 285.5,-908"/>
<text text-anchor="middle" x="221" y="-893.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_transition_density</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~get_transition_density -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge11" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~get_transition_density</title>
<path fill="none" stroke="#000000" d="M63.1783,-807.2601C78.4711,-824.8818 109.1097,-857.2022 142,-875 145.6508,-876.9755 149.4987,-878.7738 153.4509,-880.4095"/>
<polygon fill="#000000" stroke="#000000" points="152.2267,-883.6884 162.8186,-883.938 154.6942,-877.1377 152.2267,-883.6884"/>
</g>
<!-- proc~get_transition_dipole -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node13" class="node">
<title>proc~get_transition_dipole</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node13"><a xlink:href="../proc/get_transition_dipole.html" xlink:title="get_transition_dipole">
<polygon fill="#d9534f" stroke="#d9534f" points="283,-1034 159,-1034 159,-1010 283,-1010 283,-1034"/>
<text text-anchor="middle" x="221" y="-1019.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_transition_dipole</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~get_transition_dipole -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge12" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~get_transition_dipole</title>
<path fill="none" stroke="#000000" d="M54.5482,-807.135C59.7444,-842.6863 79.8825,-947.4572 142,-1001 144.3951,-1003.0645 146.9717,-1004.9287 149.6802,-1006.6118"/>
<polygon fill="#000000" stroke="#000000" points="148.2419,-1009.8105 158.7176,-1011.3946 151.5162,-1003.6235 148.2419,-1009.8105"/>
</g>
<!-- proc~get_transitions -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node14" class="node">
<title>proc~get_transitions</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node14"><a xlink:href="../proc/get_transitions.html" xlink:title="get_transitions">
<polygon fill="#d9534f" stroke="#d9534f" points="266.5,-1076 175.5,-1076 175.5,-1052 266.5,-1052 266.5,-1076"/>
<text text-anchor="middle" x="221" y="-1061.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_transitions</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~get_transitions -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge13" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~get_transitions</title>
<path fill="none" stroke="#000000" d="M53.5615,-807.2055C56.0889,-847.367 69.7412,-976.619 142,-1043 148.754,-1049.2046 157.1324,-1053.6148 165.8847,-1056.7413"/>
<polygon fill="#000000" stroke="#000000" points="164.8838,-1060.0951 175.4694,-1059.6541 166.9192,-1053.3975 164.8838,-1060.0951"/>
</g>
<!-- proc~iatogen -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node15" class="node">
<title>proc~iatogen</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node15"><a xlink:href="../proc/iatogen.html" xlink:title="iatogen">
<polygon fill="#d9534f" stroke="#d9534f" points="484,-796 430,-796 430,-772 484,-772 484,-796"/>
<text text-anchor="middle" x="457" y="-781.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iatogen</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~iatogen -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge14" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~iatogen</title>
<path fill="none" stroke="#000000" d="M106.0073,-794.202C156.0288,-793.3838 233.119,-791.9548 300,-790 340.9084,-788.8044 387.7946,-786.9492 419.5993,-785.6183"/>
<polygon fill="#000000" stroke="#000000" points="419.9332,-789.1074 429.7767,-785.1888 419.638,-782.1137 419.9332,-789.1074"/>
</g>
<!-- proc~inivec -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node16" class="node">
<title>proc~inivec</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node16"><a xlink:href="../proc/inivec.html" xlink:title="inivec">
<polygon fill="#d9534f" stroke="#d9534f" points="248,-992 194,-992 194,-968 248,-968 248,-992"/>
<text text-anchor="middle" x="221" y="-977.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">inivec</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~inivec -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge15" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~inivec</title>
<path fill="none" stroke="#000000" d="M55.9755,-807.0435C64.1348,-837.4722 89.8114,-917.9329 142,-959 153.8462,-968.3218 169.4624,-973.5233 183.6807,-976.4189"/>
<polygon fill="#000000" stroke="#000000" points="183.264,-979.8986 193.7128,-978.1458 184.4515,-973 183.264,-979.8986"/>
</g>
<!-- proc~measure_time -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node17" class="node">
<title>proc~measure_time</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node17"><a xlink:href="../proc/measure_time.html" xlink:title="measure_time">
<polygon fill="#d9534f" stroke="#d9534f" points="265.5,-950 176.5,-950 176.5,-926 265.5,-926 265.5,-950"/>
<text text-anchor="middle" x="221" y="-935.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">measure_time</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~measure_time -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge16" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~measure_time</title>
<path fill="none" stroke="#000000" d="M58.3868,-807.1808C69.9521,-831.8816 99.5941,-887.9775 142,-917 149.4029,-922.0665 157.9665,-925.9113 166.6662,-928.8289"/>
<polygon fill="#000000" stroke="#000000" points="165.9092,-932.255 176.4917,-931.7446 167.9007,-925.5443 165.9092,-932.255"/>
</g>
<!-- proc~mntoia -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node18" class="node">
<title>proc~mntoia</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node18"><a xlink:href="../proc/mntoia.html" xlink:title="mntoia">
<polygon fill="#d9534f" stroke="#d9534f" points="484,-754 430,-754 430,-730 484,-730 484,-754"/>
<text text-anchor="middle" x="457" y="-739.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mntoia</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~mntoia -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge17" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~mntoia</title>
<path fill="none" stroke="#000000" d="M106.2314,-788.0167C189.3493,-777.1126 347.8752,-756.3159 419.8282,-746.8765"/>
<polygon fill="#000000" stroke="#000000" points="420.337,-750.3398 429.7967,-745.5687 419.4264,-743.3993 420.337,-750.3398"/>
</g>
<!-- proc~mrinivec -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node19" class="node">
<title>proc~mrinivec</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node19"><a xlink:href="../proc/mrinivec.html" xlink:title="mrinivec">
<polygon fill="#d9534f" stroke="#d9534f" points="250.5,-866 191.5,-866 191.5,-842 250.5,-842 250.5,-866"/>
<text text-anchor="middle" x="221" y="-851.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mrinivec</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~mrinivec -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge18" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~mrinivec</title>
<path fill="none" stroke="#000000" d="M84.6136,-807.0468C101.5742,-813.4276 122.8673,-821.3071 142,-828 154.7975,-832.4768 168.8353,-837.1674 181.4819,-841.3127"/>
<polygon fill="#000000" stroke="#000000" points="180.6832,-844.7336 191.2756,-844.5057 182.853,-838.0783 180.6832,-844.7336"/>
</g>
<!-- proc~mrsfcbc -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node20" class="node">
<title>proc~mrsfcbc</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node20"><a xlink:href="../proc/mrsfcbc.html" xlink:title="mrsfcbc">
<polygon fill="#d9534f" stroke="#d9534f" points="484.5,-1124 429.5,-1124 429.5,-1100 484.5,-1100 484.5,-1124"/>
<text text-anchor="middle" x="457" y="-1109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mrsfcbc</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~mrsfcbc -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge19" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~mrsfcbc</title>
<path fill="none" stroke="#000000" d="M53.6755,-807.121C57.4127,-869.2696 77.7725,-1151.2725 142,-1203 196.6906,-1247.0466 240.0566,-1239.578 300,-1203 329.8634,-1184.777 307.8105,-1153.7185 336,-1133 359.8572,-1115.4656 393.4363,-1110.775 419.1698,-1110.1534"/>
<polygon fill="#000000" stroke="#000000" points="419.3304,-1113.6528 429.3137,-1110.1053 419.2971,-1106.6529 419.3304,-1113.6528"/>
</g>
<!-- proc~mrsfesum -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node21" class="node">
<title>proc~mrsfesum</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node21"><a xlink:href="../proc/mrsfesum.html" xlink:title="mrsfesum">
<polygon fill="#d9534f" stroke="#d9534f" points="490,-1040 424,-1040 424,-1016 490,-1016 490,-1040"/>
<text text-anchor="middle" x="457" y="-1025.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mrsfesum</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~mrsfesum -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge20" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~mrsfesum</title>
<path fill="none" stroke="#000000" d="M54.805,-807.1486C62.5836,-857.6862 94.9896,-1050.2529 142,-1085 198.4709,-1126.7397 235.1231,-1111.8729 300,-1085 320.905,-1076.3409 315.9152,-1059.4212 336,-1049 359.9041,-1036.5972 389.6758,-1031.3211 413.7059,-1029.1585"/>
<polygon fill="#000000" stroke="#000000" points="414.2488,-1032.6277 423.9592,-1028.39 413.7255,-1025.6473 414.2488,-1032.6277"/>
</g>
<!-- proc~mrsfmntoia -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node22" class="node">
<title>proc~mrsfmntoia</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node22"><a xlink:href="../proc/mrsfmntoia.html" xlink:title="mrsfmntoia">
<polygon fill="#d9534f" stroke="#d9534f" points="494,-1368 420,-1368 420,-1344 494,-1344 494,-1368"/>
<text text-anchor="middle" x="457" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mrsfmntoia</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~mrsfmntoia -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge21" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~mrsfmntoia</title>
<path fill="none" stroke="#000000" d="M53.4346,-807.447C56.1166,-876.9227 72.6604,-1216.2187 142,-1288 212.34,-1360.8169 340.6341,-1364.6665 409.8024,-1360.6669"/>
<polygon fill="#000000" stroke="#000000" points="410.223,-1364.1468 419.9713,-1359.9971 409.7629,-1357.162 410.223,-1364.1468"/>
</g>
<!-- proc~mrsfqroesum -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node23" class="node">
<title>proc~mrsfqroesum</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node23"><a xlink:href="../proc/mrsfqroesum.html" xlink:title="mrsfqroesum">
<polygon fill="#d9534f" stroke="#d9534f" points="263,-710 179,-710 179,-686 263,-686 263,-710"/>
<text text-anchor="middle" x="221" y="-695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mrsfqroesum</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~mrsfqroesum -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge22" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~mrsfqroesum</title>
<path fill="none" stroke="#000000" d="M65.2324,-782.8477C81.5031,-767.2792 111.7465,-740.3574 142,-724 150.4841,-719.4128 159.9192,-715.4493 169.2315,-712.0964"/>
<polygon fill="#000000" stroke="#000000" points="170.5082,-715.3591 178.8464,-708.8227 168.2519,-708.7327 170.5082,-715.3591"/>
</g>
<!-- proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node24" class="node">
<title>proc~oqp_dgemm_i64</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node24"><a xlink:href="../proc/oqp_dgemm_i64.html" xlink:title="oqp_dgemm_i64">
<polygon fill="#d9534f" stroke="#d9534f" points="753.5,-712 652.5,-712 652.5,-688 753.5,-688 753.5,-712"/>
<text text-anchor="middle" x="703" y="-697.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_dgemm_i64</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge23" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M55.5549,-782.5638C62.7272,-751.2932 86.2785,-669.5661 142,-637 225.6501,-588.1112 483.7387,-614.5889 578,-637 587.833,-639.3378 637.6729,-665.2417 671.3711,-683.096"/>
<polygon fill="#000000" stroke="#000000" points="669.9276,-686.2924 680.401,-687.8921 673.2112,-680.1103 669.9276,-686.2924"/>
</g>
<!-- proc~orthogonal_transform -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node25" class="node">
<title>proc~orthogonal_transform</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node25"><a xlink:href="../proc/orthogonal_transform.html" xlink:title="orthogonal_transform">
<polygon fill="#d9534f" stroke="#d9534f" points="521.5,-1082 392.5,-1082 392.5,-1058 521.5,-1058 521.5,-1082"/>
<text text-anchor="middle" x="457" y="-1067.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">orthogonal_transform</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~orthogonal_transform -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge24" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~orthogonal_transform</title>
<path fill="none" stroke="#000000" d="M54.4775,-807.1645C61.237,-860.5823 91.0905,-1073.4153 142,-1112 197.9646,-1154.416 232.2114,-1130.3266 300,-1112 317.8813,-1107.1658 318.5995,-1097.3509 336,-1091 350.6225,-1085.6631 366.7458,-1081.6622 382.3246,-1078.6695"/>
<polygon fill="#000000" stroke="#000000" points="383.2406,-1082.0609 392.4623,-1076.8444 382.0004,-1075.1716 383.2406,-1082.0609"/>
</g>
<!-- proc~orthogonal_transform_sym -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node26" class="node">
<title>proc~orthogonal_transform_sym</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node26"><a xlink:href="../proc/orthogonal_transform_sym.html" xlink:title="orthogonal_transform_sym">
<polygon fill="#d9534f" stroke="#d9534f" points="535,-536 379,-536 379,-512 535,-512 535,-536"/>
<text text-anchor="middle" x="457" y="-521.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">orthogonal_transform_sym</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~orthogonal_transform_sym -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge25" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~orthogonal_transform_sym</title>
<path fill="none" stroke="#000000" d="M54.0664,-782.8599C59.3885,-725.3749 85.1127,-481.4765 142,-437 233.0041,-365.8498 378.5085,-462.9104 434.2542,-505.6191"/>
<polygon fill="#000000" stroke="#000000" points="432.3689,-508.5872 442.4083,-511.9729 436.6715,-503.0656 432.3689,-508.5872"/>
</g>
<!-- proc~print_module_info -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node27" class="node">
<title>proc~print_module_info</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node27"><a xlink:href="../proc/print_module_info.html" xlink:title="print_module_info">
<polygon fill="#d9534f" stroke="#d9534f" points="275.5,-554 166.5,-554 166.5,-530 275.5,-530 275.5,-554"/>
<text text-anchor="middle" x="221" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">print_module_info</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~print_module_info -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge26" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~print_module_info</title>
<path fill="none" stroke="#000000" d="M54.175,-782.9186C58.4667,-745.4155 76.6475,-629.8099 142,-568 146.5436,-563.7027 151.8111,-560.1153 157.4275,-557.1205"/>
<polygon fill="#000000" stroke="#000000" points="158.9099,-560.2911 166.4866,-552.8854 155.9454,-553.9499 158.9099,-560.2911"/>
</g>
<!-- proc~print_results~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node28" class="node">
<title>proc~print_results~2</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node28"><a xlink:href="../proc/print_results~2.html" xlink:title="print_results">
<polygon fill="#d9534f" stroke="#d9534f" points="260,-512 182,-512 182,-488 260,-488 260,-512"/>
<text text-anchor="middle" x="221" y="-497.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">print_results</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~print_results~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge27" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~print_results~2</title>
<path fill="none" stroke="#000000" d="M55.3501,-782.8419C64.8687,-734.7936 101.9651,-558.9198 142,-521 150.2041,-513.2293 160.9474,-508.261 171.8566,-505.1034"/>
<polygon fill="#000000" stroke="#000000" points="172.9575,-508.4381 181.8538,-502.6843 171.3111,-501.6345 172.9575,-508.4381"/>
</g>
<!-- proc~rpaechk -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node29" class="node">
<title>proc~rpaechk</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node29"><a xlink:href="../proc/rpaechk.html" xlink:title="rpaechk">
<polygon fill="#d9534f" stroke="#d9534f" points="249,-470 193,-470 193,-446 249,-446 249,-470"/>
<text text-anchor="middle" x="221" y="-455.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rpaechk</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~rpaechk -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge28" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~rpaechk</title>
<path fill="none" stroke="#000000" d="M54.7989,-782.8246C62.7962,-730.2818 96.7339,-523.6047 142,-479 152.7372,-468.4197 168.1646,-463.004 182.5417,-460.2887"/>
<polygon fill="#000000" stroke="#000000" points="183.375,-463.7028 192.7427,-458.7534 182.3332,-456.7807 183.375,-463.7028"/>
</g>
<!-- proc~rpaeig -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node30" class="node">
<title>proc~rpaeig</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node30"><a xlink:href="../proc/rpaeig.html" xlink:title="rpaeig">
<polygon fill="#d9534f" stroke="#d9534f" points="484,-276 430,-276 430,-252 484,-252 484,-276"/>
<text text-anchor="middle" x="457" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rpaeig</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~rpaeig -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge29" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~rpaeig</title>
<path fill="none" stroke="#000000" d="M53.8344,-782.9831C59.6243,-701.2992 94.9758,-229.6224 142,-189 228.2128,-114.524 375.3331,-204.9647 432.8999,-245.8878"/>
<polygon fill="#000000" stroke="#000000" points="431.1931,-248.9729 441.347,-251.9977 435.2957,-243.301 431.1931,-248.9729"/>
</g>
<!-- proc~rpanewb -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node31" class="node">
<title>proc~rpanewb</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node31"><a xlink:href="../proc/rpanewb.html" xlink:title="rpanewb">
<polygon fill="#d9534f" stroke="#d9534f" points="250.5,-390 191.5,-390 191.5,-366 250.5,-366 250.5,-390"/>
<text text-anchor="middle" x="221" y="-375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rpanewb</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~rpanewb -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge30" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~rpanewb</title>
<path fill="none" stroke="#000000" d="M54.1592,-782.9433C60.1,-723.5178 88.9347,-462.3117 142,-404 152.0879,-392.9147 166.984,-386.5444 181.1302,-382.888"/>
<polygon fill="#000000" stroke="#000000" points="182.2002,-386.2366 191.2189,-380.6765 180.7014,-379.3989 182.2002,-386.2366"/>
</g>
<!-- proc~rpaprint -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node32" class="node">
<title>proc~rpaprint</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node32"><a xlink:href="../proc/rpaprint.html" xlink:title="rpaprint">
<polygon fill="#d9534f" stroke="#d9534f" points="248.5,-348 193.5,-348 193.5,-324 248.5,-324 248.5,-348"/>
<text text-anchor="middle" x="221" y="-333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rpaprint</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~rpaprint -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge31" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~rpaprint</title>
<path fill="none" stroke="#000000" d="M53.7839,-782.7374C58.1332,-718.51 81.3334,-421.3782 142,-357 152.5966,-345.7551 168.4689,-340.2766 183.2129,-337.6936"/>
<polygon fill="#000000" stroke="#000000" points="183.7279,-341.1558 193.1613,-336.3327 182.7791,-334.2204 183.7279,-341.1558"/>
</g>
<!-- proc~rparedms -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node33" class="node">
<title>proc~rparedms</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node33"><a xlink:href="../proc/rparedms.html" xlink:title="rparedms">
<polygon fill="#d9534f" stroke="#d9534f" points="489,-590 425,-590 425,-566 489,-566 489,-590"/>
<text text-anchor="middle" x="457" y="-575.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rparedms</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~rparedms -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge32" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~rparedms</title>
<path fill="none" stroke="#000000" d="M54.6141,-782.6165C59.8612,-747.9095 79.8557,-649.404 142,-606 184.9894,-575.9745 339.2006,-575.1674 414.722,-576.6925"/>
<polygon fill="#000000" stroke="#000000" points="414.7601,-580.1941 424.8364,-576.9203 414.9178,-573.1959 414.7601,-580.1941"/>
</g>
<!-- proc~rpavnorm -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node34" class="node">
<title>proc~rpavnorm</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node34"><a xlink:href="../proc/rpavnorm.html" xlink:title="rpavnorm">
<polygon fill="#d9534f" stroke="#d9534f" points="253.5,-264 188.5,-264 188.5,-240 253.5,-240 253.5,-264"/>
<text text-anchor="middle" x="221" y="-249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rpavnorm</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~rpavnorm -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge33" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~rpavnorm</title>
<path fill="none" stroke="#000000" d="M53.3469,-782.823C55.6158,-711.7755 70.5631,-351.2477 142,-273 151.3023,-262.8108 164.9326,-257.3319 178.262,-254.4552"/>
<polygon fill="#000000" stroke="#000000" points="179.0567,-257.8701 188.3199,-252.7278 177.8717,-250.9711 179.0567,-257.8701"/>
</g>
<!-- proc~sfqvec -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node35" class="node">
<title>proc~sfqvec</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node35"><a xlink:href="../proc/sfqvec.html" xlink:title="sfqvec">
<polygon fill="#d9534f" stroke="#d9534f" points="248,-222 194,-222 194,-198 248,-198 248,-222"/>
<text text-anchor="middle" x="221" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sfqvec</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~sfqvec -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge34" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~sfqvec</title>
<path fill="none" stroke="#000000" d="M53.1782,-782.833C54.5129,-708.5232 65.1629,-316.2148 142,-231 152.5014,-219.3537 168.6559,-213.8488 183.6267,-211.3535"/>
<polygon fill="#000000" stroke="#000000" points="184.2404,-214.8037 193.718,-210.0683 183.3559,-207.8598 184.2404,-214.8037"/>
</g>
<!-- proc~sfresvec -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node36" class="node">
<title>proc~sfresvec</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node36"><a xlink:href="../proc/sfresvec.html" xlink:title="sfresvec">
<polygon fill="#d9534f" stroke="#d9534f" points="485.5,-712 428.5,-712 428.5,-688 485.5,-688 485.5,-712"/>
<text text-anchor="middle" x="457" y="-697.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">sfresvec</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~sfresvec -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge35" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~sfresvec</title>
<path fill="none" stroke="#000000" d="M79.0106,-782.9423C96.5114,-775.2146 120.2715,-765.4581 142,-759 239.3535,-730.0649 358.0291,-712.3963 418.1215,-704.6387"/>
<polygon fill="#000000" stroke="#000000" points="418.8147,-708.0789 428.2947,-703.3482 417.9337,-701.1345 418.8147,-708.0789"/>
</g>
<!-- proc~trfrmb -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node37" class="node">
<title>proc~trfrmb</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node37"><a xlink:href="../proc/trfrmb.html" xlink:title="trfrmb">
<polygon fill="#d9534f" stroke="#d9534f" points="484,-670 430,-670 430,-646 484,-646 484,-670"/>
<text text-anchor="middle" x="457" y="-655.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">trfrmb</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;proc~trfrmb -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge36" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;proc~trfrmb</title>
<path fill="none" stroke="#000000" d="M57.9049,-782.894C68.7641,-757.8924 97.4558,-700.8978 142,-677 231.9061,-628.7657 357.6999,-640.6528 419.5921,-650.7156"/>
<polygon fill="#000000" stroke="#000000" points="419.2272,-654.2038 429.6728,-652.4318 420.4021,-647.3031 419.2272,-654.2038"/>
</g>
<!-- remove_records -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node38" class="node">
<title>remove_records</title>
<polygon fill="#777777" stroke="#777777" points="271,-104 171,-104 171,-80 271,-80 271,-104"/>
<text text-anchor="middle" x="221" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">remove_records</text>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;remove_records -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge37" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;remove_records</title>
<path fill="none" stroke="#000000" d="M53.8205,-782.8877C59.7943,-696.1669 97.6196,-171.578 142,-118 147.1811,-111.7452 153.8994,-106.9838 161.2293,-103.3616"/>
<polygon fill="#000000" stroke="#000000" points="162.9055,-106.4539 170.7712,-99.3559 160.1959,-99.9995 162.9055,-106.4539"/>
</g>
<!-- reserve_data -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node39" class="node">
<title>reserve_data</title>
<polygon fill="#777777" stroke="#777777" points="262,-62 180,-62 180,-38 262,-38 262,-62"/>
<text text-anchor="middle" x="221" y="-47.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">reserve_data</text>
</g>
<!-- proc~tdhf_mrsf_energy&#45;&gt;reserve_data -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge38" class="edge">
<title>proc~tdhf_mrsf_energy&#45;&gt;reserve_data</title>
<path fill="none" stroke="#000000" d="M53.6786,-782.8971C58.8395,-692.6933 93.0247,-127.2188 142,-71 149.2798,-62.6435 159.4697,-57.4311 170.1168,-54.2223"/>
<polygon fill="#000000" stroke="#000000" points="171.0767,-57.5906 179.9529,-51.8059 169.4066,-50.7928 171.0767,-57.5906"/>
</g>
<!-- proc~unpack_f90 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node62" class="node">
<title>proc~unpack_f90</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node62"><a xlink:href="../proc/unpack_f90.html" xlink:title="UNPACK_F90">
<polygon fill="#d9534f" stroke="#d9534f" points="496.5,-410 417.5,-410 417.5,-386 496.5,-386 496.5,-410"/>
<text text-anchor="middle" x="457" y="-395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UNPACK_F90</text>
</a>
</g>
</g>
<!-- interface~unpack_matrix&#45;&gt;proc~unpack_f90 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge39" class="edge">
<title>interface~unpack_matrix&#45;&gt;proc~unpack_f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M266.686,-304.2619C277.7482,-307.2596 289.4277,-310.8621 300,-315 346.8344,-333.3306 397.7295,-362.0012 428.494,-380.3915"/>
<polygon fill="#000000" stroke="#000000" points="426.9982,-383.5766 437.3686,-385.7459 430.6144,-377.583 426.9982,-383.5766"/>
</g>
<!-- none~clean~5 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node43" class="node">
<title>none~clean~5</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node43"><a xlink:href="../type/int2_pair_storage.html#boundprocedure-clean~5" xlink:title="int2_pair_storage%clean">
<polygon fill="#a7506f" stroke="#a7506f" points="529,-1566 385,-1566 385,-1542 529,-1542 529,-1566"/>
<text text-anchor="middle" x="457" y="-1551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_pair_storage%clean</text>
</a>
</g>
</g>
<!-- none~clean~18&#45;&gt;none~clean~5 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge40" class="edge">
<title>none~clean~18&#45;&gt;none~clean~5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M287.6818,-1539.651C314.6318,-1541.9349 346.0171,-1544.5947 374.3932,-1546.9994"/>
<polygon fill="#000000" stroke="#000000" points="374.4378,-1550.5157 384.6977,-1547.8727 375.029,-1543.5407 374.4378,-1550.5157"/>
</g>
<!-- none~alloc -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node42" class="node">
<title>none~alloc</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node42"><a xlink:href="../type/int2_pair_storage.html#boundprocedure-alloc" xlink:title="int2_pair_storage%alloc">
<polygon fill="#a7506f" stroke="#a7506f" points="1205,-2127 1065,-2127 1065,-2103 1205,-2103 1205,-2127"/>
<text text-anchor="middle" x="1135" y="-2112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_pair_storage%alloc</text>
</a>
</g>
</g>
<!-- none~init~16&#45;&gt;none~alloc -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge41" class="edge">
<title>none~init~16&#45;&gt;none~alloc</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M944.1167,-2228.9418C964.139,-2217.0223 994.5589,-2197.6235 1018,-2177 1036.2064,-2160.982 1033.3514,-2148.7155 1054,-2136 1056.8451,-2134.248 1059.8328,-2132.6412 1062.9145,-2131.1679"/>
<polygon fill="#000000" stroke="#000000" points="1064.5612,-2134.271 1072.3931,-2127.1358 1061.821,-2127.8296 1064.5612,-2134.271"/>
</g>
<!-- none~compute -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node44" class="node">
<title>none~compute</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node44"><a xlink:href="../type/int2_pair_storage.html#boundprocedure-compute" xlink:title="int2_pair_storage%compute">
<polygon fill="#a7506f" stroke="#a7506f" points="1216,-2253 1054,-2253 1054,-2229 1216,-2229 1216,-2253"/>
<text text-anchor="middle" x="1135" y="-2238.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_pair_storage%compute</text>
</a>
</g>
</g>
<!-- none~init~16&#45;&gt;none~compute -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge42" class="edge">
<title>none~init~16&#45;&gt;none~compute</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.7507,-2241C1002.3821,-2241 1023.3095,-2241 1043.5192,-2241"/>
<polygon fill="#000000" stroke="#000000" points="1043.6866,-2244.5001 1053.6865,-2241 1043.6865,-2237.5001 1043.6866,-2244.5001"/>
</g>
<!-- none~init_shell_centers -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node45" class="node">
<title>none~init_shell_centers</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node45"><a xlink:href="../type/basis_set.html#boundprocedure-init_shell_centers" xlink:title="basis_set%init_shell_centers">
<polygon fill="#a7506f" stroke="#a7506f" points="1216,-2901 1054,-2901 1054,-2877 1216,-2877 1216,-2901"/>
<text text-anchor="middle" x="1135" y="-2886.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_set%init_shell_centers</text>
</a>
</g>
</g>
<!-- none~init~16&#45;&gt;none~init_shell_centers -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge43" class="edge">
<title>none~init~16&#45;&gt;none~init_shell_centers</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M923.8174,-2253.0032C929.4181,-2331.7542 964.6029,-2774.2331 1054,-2868 1054.9304,-2868.9759 1055.8998,-2869.9086 1056.9042,-2870.8"/>
<polygon fill="#000000" stroke="#000000" points="1055.0771,-2873.7991 1065.2215,-2876.8556 1059.1972,-2868.1401 1055.0771,-2873.7991"/>
</g>
<!-- none~init~14 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node46" class="node">
<title>none~init~14</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node46"><a xlink:href="../type/par_env_t.html#boundprocedure-init~14" xlink:title="par_env_t%init">
<polygon fill="#a7506f" stroke="#a7506f" points="1180.5,-2859 1089.5,-2859 1089.5,-2835 1180.5,-2835 1180.5,-2859"/>
<text text-anchor="middle" x="1135" y="-2844.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">par_env_t%init</text>
</a>
</g>
</g>
<!-- none~init~16&#45;&gt;none~init~14 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge44" class="edge">
<title>none~init~16&#45;&gt;none~init~14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M926.4841,-2253.2318C940.8055,-2303.2053 997.0722,-2496.5893 1054,-2652 1077.4113,-2715.9119 1109.4717,-2789.6919 1125.32,-2825.4061"/>
<polygon fill="#000000" stroke="#000000" points="1122.2489,-2827.1132 1129.5155,-2834.8235 1128.6431,-2824.2646 1122.2489,-2827.1132"/>
</g>
<!-- none~set -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node49" class="node">
<title>none~set</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node49"><a xlink:href="../type/int2_cutoffs_t.html#boundprocedure-set" xlink:title="int2_cutoffs_t%set">
<polygon fill="#a7506f" stroke="#a7506f" points="1189.5,-2211 1080.5,-2211 1080.5,-2187 1189.5,-2187 1189.5,-2211"/>
<text text-anchor="middle" x="1135" y="-2196.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_cutoffs_t%set</text>
</a>
</g>
</g>
<!-- none~init~16&#45;&gt;none~set -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge45" class="edge">
<title>none~init~16&#45;&gt;none~set</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M983.7507,-2228.9645C1010.8848,-2223.5889 1042.8887,-2217.2485 1070.4534,-2211.7875"/>
<polygon fill="#000000" stroke="#000000" points="1071.2616,-2215.1955 1080.3907,-2209.8188 1069.9012,-2208.329 1071.2616,-2215.1955"/>
</g>
<!-- proc~libint_static_init -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node54" class="node">
<title>proc~libint_static_init</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node54"><a xlink:href="../proc/libint_static_init.html" xlink:title="libint_static_init">
<polygon fill="#d9534f" stroke="#d9534f" points="1182,-2643 1088,-2643 1088,-2619 1182,-2619 1182,-2643"/>
<text text-anchor="middle" x="1135" y="-2628.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint_static_init</text>
</a>
</g>
</g>
<!-- none~init~16&#45;&gt;proc~libint_static_init -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge46" class="edge">
<title>none~init~16&#45;&gt;proc~libint_static_init</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M929.5772,-2253.0996C959.6813,-2308.4798 1084.5246,-2538.1443 1123.3941,-2609.6496"/>
<polygon fill="#000000" stroke="#000000" points="1120.4384,-2611.5408 1128.2894,-2618.6551 1126.5885,-2608.1976 1120.4384,-2611.5408"/>
</g>
<!-- none~run~6&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge47" class="edge">
<title>none~run~6&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M282.3095,-1450.3782C466.6547,-1442.3679 1004.1239,-1418.0313 1018,-1406 1103.74,-1331.659 1128.9057,-950.7344 1133.9509,-854.2386"/>
<polygon fill="#000000" stroke="#000000" points="1137.4515,-854.3142 1134.4581,-844.1511 1130.4603,-853.9627 1137.4515,-854.3142"/>
</g>
<!-- none~run_cam -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node47" class="node">
<title>none~run_cam</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node47"><a xlink:href="../type/int2_compute_t.html#boundprocedure-run_cam" xlink:title="int2_compute_t%run_cam">
<polygon fill="#a7506f" stroke="#a7506f" points="532.5,-1524 381.5,-1524 381.5,-1500 532.5,-1500 532.5,-1524"/>
<text text-anchor="middle" x="457" y="-1509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute_t%run_cam</text>
</a>
</g>
</g>
<!-- none~run~6&#45;&gt;none~run_cam -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge48" class="edge">
<title>none~run~6&#45;&gt;none~run_cam</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M260.4721,-1465.0432C282.5825,-1471.6085 310.7143,-1479.6632 336,-1486 352.5514,-1490.1479 370.4779,-1494.2244 387.3336,-1497.8746"/>
<polygon fill="#000000" stroke="#000000" points="386.6042,-1501.2977 397.1157,-1499.9718 388.0717,-1494.4532 386.6042,-1501.2977"/>
</g>
<!-- none~run_generic -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node48" class="node">
<title>none~run_generic</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node48"><a xlink:href="../type/int2_compute_t.html#boundprocedure-run_generic" xlink:title="int2_compute_t%run_generic">
<polygon fill="#a7506f" stroke="#a7506f" points="787,-1785 619,-1785 619,-1761 787,-1761 787,-1785"/>
<text text-anchor="middle" x="703" y="-1770.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute_t%run_generic</text>
</a>
</g>
</g>
<!-- none~run~6&#45;&gt;none~run_generic -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge49" class="edge">
<title>none~run~6&#45;&gt;none~run_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M282.1225,-1452.3164C371.5032,-1452.4943 532.2253,-1457.6389 578,-1491 666.2654,-1555.3288 693.2296,-1696.1427 700.5455,-1750.7448"/>
<polygon fill="#000000" stroke="#000000" points="697.0823,-1751.2585 701.7914,-1760.7493 704.0287,-1750.3934 697.0823,-1751.2585"/>
</g>
<!-- proc~ints_exchange -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node53" class="node">
<title>proc~ints_exchange</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node53"><a xlink:href="../proc/ints_exchange.html" xlink:title="ints_exchange">
<polygon fill="#d9534f" stroke="#d9534f" points="967.5,-1966 878.5,-1966 878.5,-1942 967.5,-1942 967.5,-1966"/>
<text text-anchor="middle" x="923" y="-1951.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ints_exchange</text>
</a>
</g>
</g>
<!-- none~set_screening~2&#45;&gt;proc~ints_exchange -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge50" class="edge">
<title>none~set_screening~2&#45;&gt;proc~ints_exchange</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M769.7062,-1827.1737C777.8301,-1830.6814 785.5303,-1835.1946 792,-1841 823.1453,-1868.9478 796.6171,-1900.3192 828,-1928 839.253,-1937.9255 853.9535,-1944.1015 868.4158,-1947.9322"/>
<polygon fill="#000000" stroke="#000000" points="867.8135,-1951.3852 878.3449,-1950.2268 869.3897,-1944.5649 867.8135,-1951.3852"/>
</g>
<!-- proc~get_mrsf_transition_density&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge51" class="edge">
<title>proc~get_mrsf_transition_density&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M277.4954,-1279.0389C296.0492,-1282.5304 316.8286,-1285.9507 336,-1288 537.5579,-1309.5455 590.1487,-1315.5969 792,-1297 804.7167,-1295.8284 1008.5896,-1263.6331 1018,-1255 1078.8733,-1199.1548 1120.5653,-934.4381 1131.897,-854.7499"/>
<polygon fill="#000000" stroke="#000000" points="1135.4281,-854.7705 1133.3473,-844.3821 1128.4956,-853.8008 1135.4281,-854.7705"/>
</g>
<!-- proc~get_trans_den -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node52" class="node">
<title>proc~get_trans_den</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node52"><a xlink:href="../proc/get_trans_den.html" xlink:title="get_trans_den">
<polygon fill="#d9534f" stroke="#d9534f" points="501,-1279 413,-1279 413,-1255 501,-1255 501,-1279"/>
<text text-anchor="middle" x="457" y="-1264.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_trans_den</text>
</a>
</g>
</g>
<!-- proc~get_mrsf_transition_density&#45;&gt;proc~get_trans_den -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge52" class="edge">
<title>proc~get_mrsf_transition_density&#45;&gt;proc~get_trans_den</title>
<path fill="none" stroke="#000000" d="M300.2411,-1267C333.7807,-1267 372.0199,-1267 402.3341,-1267"/>
<polygon fill="#000000" stroke="#000000" points="402.7055,-1270.5001 412.7054,-1267 402.7054,-1263.5001 402.7055,-1270.5001"/>
</g>
<!-- proc~get_transition_density&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge53" class="edge">
<title>proc~get_transition_density&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M279.1629,-883.9036C286.381,-881.4351 293.5,-878.494 300,-875 318.8557,-864.8643 316.6427,-852.1414 336,-843 434.4478,-796.5086 480.2652,-852.9723 578,-805 597.7563,-795.3028 593.5492,-779.1308 614,-771 687.514,-741.7724 713.0186,-766.4718 792,-771 892.9412,-776.7873 918.9611,-776.6549 1018,-797 1042.4935,-802.0316 1069.2509,-809.8555 1090.9878,-816.831"/>
<polygon fill="#000000" stroke="#000000" points="1090.0032,-820.1912 1100.5956,-819.9632 1092.1729,-813.536 1090.0032,-820.1912"/>
</g>
<!-- proc~get_transition_density&#45;&gt;proc~iatogen -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge54" class="edge">
<title>proc~get_transition_density&#45;&gt;proc~iatogen</title>
<path fill="none" stroke="#000000" d="M285.2568,-883.8342C290.5179,-881.4042 295.5239,-878.4912 300,-875 326.0396,-854.6898 309.4789,-829.6774 336,-810 360.114,-792.1086 393.9577,-786.0027 419.7229,-784.1467"/>
<polygon fill="#000000" stroke="#000000" points="420.0681,-787.6333 429.8659,-783.6019 419.6925,-780.6434 420.0681,-787.6333"/>
</g>
<!-- proc~get_transition_dipole&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge56" class="edge">
<title>proc~get_transition_dipole&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M283.1773,-1011.2713C289.2515,-1008.5704 295.0032,-1005.201 300,-1001 329.2244,-976.4295 305.5373,-946.0174 336,-923 422.865,-857.3654 480.9603,-934.3632 578,-885 598.168,-874.7407 593.239,-857.9989 614,-849 695.8111,-813.5388 960.3662,-822.5968 1077.8629,-828.6484"/>
<polygon fill="#000000" stroke="#000000" points="1077.9203,-832.1562 1088.0905,-829.1868 1078.2884,-825.1659 1077.9203,-832.1562"/>
</g>
<!-- proc~get_transition_dipole&#45;&gt;proc~orthogonal_transform -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge59" class="edge">
<title>proc~get_transition_dipole&#45;&gt;proc~orthogonal_transform</title>
<path fill="none" stroke="#000000" d="M269.5428,-1034.0643C289.9976,-1038.9741 314.0971,-1044.5322 336,-1049 350.9092,-1052.0412 366.9094,-1055.0189 382.2337,-1057.732"/>
<polygon fill="#000000" stroke="#000000" points="381.7343,-1061.1977 392.1881,-1059.4748 382.9415,-1054.3026 381.7343,-1061.1977"/>
</g>
<!-- interface~pack_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node41" class="node">
<title>interface~pack_matrix</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node41"><a xlink:href="../interface/pack_matrix.html" xlink:title="pack_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="496,-876 418,-876 418,-852 496,-852 496,-876"/>
<text text-anchor="middle" x="457" y="-861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pack_matrix</text>
</a>
</g>
</g>
<!-- proc~get_transition_dipole&#45;&gt;interface~pack_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge55" class="edge">
<title>proc~get_transition_dipole&#45;&gt;interface~pack_matrix</title>
<path fill="none" stroke="#000000" d="M283.3082,-1012.0373C289.4318,-1009.1989 295.1584,-1005.5879 300,-1001 337.6459,-965.327 297.5061,-924.7563 336,-890 355.3266,-872.5499 383.471,-865.7947 407.7535,-863.5191"/>
<polygon fill="#000000" stroke="#000000" points="408.1598,-866.9992 417.887,-862.8 407.6643,-860.0168 408.1598,-866.9992"/>
</g>
<!-- proc~atomic_structure_center -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node50" class="node">
<title>proc~atomic_structure_center</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node50"><a xlink:href="../proc/atomic_structure_center.html" xlink:title="atomic_structure%atomic_structure_center">
<polygon fill="#d94e8f" stroke="#d94e8f" points="578,-1224 336,-1224 336,-1200 578,-1200 578,-1224"/>
<text text-anchor="middle" x="457" y="-1209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atomic_structure%atomic_structure_center</text>
</a>
</g>
</g>
<!-- proc~get_transition_dipole&#45;&gt;proc~atomic_structure_center -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge57" class="edge">
<title>proc~get_transition_dipole&#45;&gt;proc~atomic_structure_center</title>
<path fill="none" stroke="#000000" d="M283.1393,-1031.5533C289.3702,-1034.4597 295.1677,-1038.1987 300,-1043 343.1369,-1085.8601 293.6621,-1131.3505 336,-1175 344.8098,-1184.0827 355.7811,-1190.9513 367.495,-1196.1424"/>
<polygon fill="#000000" stroke="#000000" points="366.437,-1199.4888 377.0216,-1199.9561 369.0386,-1192.9902 366.437,-1199.4888"/>
</g>
<!-- proc~multipole_integrals -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node55" class="node">
<title>proc~multipole_integrals</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node55"><a xlink:href="../proc/multipole_integrals.html" xlink:title="multipole_integrals">
<polygon fill="#d9534f" stroke="#d9534f" points="514.5,-1166 399.5,-1166 399.5,-1142 514.5,-1142 514.5,-1166"/>
<text text-anchor="middle" x="457" y="-1151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">multipole_integrals</text>
</a>
</g>
</g>
<!-- proc~get_transition_dipole&#45;&gt;proc~multipole_integrals -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge58" class="edge">
<title>proc~get_transition_dipole&#45;&gt;proc~multipole_integrals</title>
<path fill="none" stroke="#000000" d="M283.0069,-1032.2915C289.1857,-1035.0696 295.0077,-1038.5766 300,-1043 332.2449,-1071.5704 302.53,-1105.8751 336,-1133 350.9535,-1145.1187 370.4074,-1151.3018 389.3283,-1154.2285"/>
<polygon fill="#000000" stroke="#000000" points="389.0892,-1157.726 399.4489,-1155.5065 389.9662,-1150.7812 389.0892,-1157.726"/>
</g>
<!-- proc~symmetrize_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node60" class="node">
<title>proc~symmetrize_matrix</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node60"><a xlink:href="../proc/symmetrize_matrix.html" xlink:title="symmetrize_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="514.5,-998 399.5,-998 399.5,-974 514.5,-974 514.5,-998"/>
<text text-anchor="middle" x="457" y="-983.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">symmetrize_matrix</text>
</a>
</g>
</g>
<!-- proc~get_transition_dipole&#45;&gt;proc~symmetrize_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge60" class="edge">
<title>proc~get_transition_dipole&#45;&gt;proc~symmetrize_matrix</title>
<path fill="none" stroke="#000000" d="M283.0062,-1012.5414C315.6801,-1007.5573 355.8104,-1001.4357 389.2941,-996.328"/>
<polygon fill="#000000" stroke="#000000" points="390.0987,-999.7458 399.4566,-994.7778 389.0431,-992.8259 390.0987,-999.7458"/>
</g>
<!-- proc~traceprod_sym_packed -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node61" class="node">
<title>proc~traceprod_sym_packed</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node61"><a xlink:href="../proc/traceprod_sym_packed.html" xlink:title="traceprod_sym_packed">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-956 389,-956 389,-932 525,-932 525,-956"/>
<text text-anchor="middle" x="457" y="-941.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">traceprod_sym_packed</text>
</a>
</g>
</g>
<!-- proc~get_transition_dipole&#45;&gt;proc~traceprod_sym_packed -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge61" class="edge">
<title>proc~get_transition_dipole&#45;&gt;proc~traceprod_sym_packed</title>
<path fill="none" stroke="#000000" d="M280.1922,-1009.9705C287.0909,-1007.5012 293.8513,-1004.5418 300,-1001 319.6071,-989.7057 315.9152,-975.4212 336,-965 349.0702,-958.2184 363.8946,-953.5675 378.5755,-950.3912"/>
<polygon fill="#000000" stroke="#000000" points="379.5469,-953.7678 388.6929,-948.4197 378.2081,-946.897 379.5469,-953.7678"/>
</g>
<!-- proc~mntoia&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge62" class="edge">
<title>proc~mntoia&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M484.2662,-737.3448C522.0679,-730.8908 591.4411,-719.0466 641.9512,-710.423"/>
<polygon fill="#000000" stroke="#000000" points="642.8373,-713.8224 652.1056,-708.6893 641.6592,-706.9223 642.8373,-713.8224"/>
</g>
<!-- proc~mrsfcbc&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge63" class="edge">
<title>proc~mrsfcbc&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M484.5295,-1114.9177C511.6133,-1116.2026 552.5052,-1113.666 578,-1091 619.932,-1053.7206 572.6017,-1007.8712 614,-970 647.7961,-939.0832 974.5692,-902.5531 1018,-888 1048.5899,-877.7497 1081.5835,-861.4343 1104.7106,-849.0522"/>
<polygon fill="#000000" stroke="#000000" points="1106.5578,-852.032 1113.6759,-844.1844 1103.2177,-845.8802 1106.5578,-852.032"/>
</g>
<!-- proc~mrsfcbc&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge64" class="edge">
<title>proc~mrsfcbc&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M484.64,-1115.7745C512.4138,-1117.8629 554.3909,-1116.0652 578,-1091 627.0647,-1038.9092 579.3959,-833.6366 614,-771 626.7646,-747.8949 650.4316,-729.5745 670.1525,-717.3344"/>
<polygon fill="#000000" stroke="#000000" points="672.0762,-720.2626 678.8824,-712.1431 668.4983,-714.246 672.0762,-720.2626"/>
</g>
<!-- proc~mrsfesum&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge65" class="edge">
<title>proc~mrsfesum&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M490.196,-1031.003C516.9943,-1031.567 554.056,-1027.8784 578,-1007 617.7274,-972.3589 573.3588,-927.5644 614,-894 683.7095,-836.429 928.2267,-856.7041 1018,-846 1037.6295,-843.6595 1059.1106,-841.0911 1078.2485,-838.8004"/>
<polygon fill="#000000" stroke="#000000" points="1078.8027,-842.2592 1088.3157,-837.5952 1077.9705,-835.3088 1078.8027,-842.2592"/>
</g>
<!-- proc~mrsfesum&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge66" class="edge">
<title>proc~mrsfesum&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M490.2706,-1031.9182C517.6716,-1033.1496 555.5437,-1029.9207 578,-1007 652.2539,-931.2106 560.8752,-862.8446 614,-771 627.3024,-748.0021 651.1716,-729.5811 670.844,-717.2708"/>
<polygon fill="#000000" stroke="#000000" points="672.7646,-720.2001 679.5344,-712.0502 669.1598,-714.1996 672.7646,-720.2001"/>
</g>
<!-- proc~mrsfmntoia&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge67" class="edge">
<title>proc~mrsfmntoia&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M494.2957,-1363.4788C606.4321,-1385.054 937.7404,-1441.8582 1018,-1377 1101.7208,-1309.3448 1128.2877,-947.7337 1133.8124,-854.1334"/>
<polygon fill="#000000" stroke="#000000" points="1137.3103,-854.2679 1134.3842,-844.0851 1130.3216,-853.8701 1137.3103,-854.2679"/>
</g>
<!-- proc~mrsfmntoia&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge68" class="edge">
<title>proc~mrsfmntoia&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M494.1145,-1345.6934C522.226,-1335.7891 559.1238,-1317.8316 578,-1288 639.5805,-1190.6794 560.4637,-872.9673 614,-771 626.191,-747.7806 649.6519,-729.5579 669.4262,-717.3896"/>
<polygon fill="#000000" stroke="#000000" points="671.3543,-720.3161 678.1985,-712.2286 667.8047,-714.2828 671.3543,-720.3161"/>
</g>
<!-- proc~oqp_dgemv_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node56" class="node">
<title>proc~oqp_dgemv_i64</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node56"><a xlink:href="../proc/oqp_dgemv_i64.html" xlink:title="oqp_dgemv_i64">
<polygon fill="#d9534f" stroke="#d9534f" points="751.5,-1368 654.5,-1368 654.5,-1344 751.5,-1344 751.5,-1368"/>
<text text-anchor="middle" x="703" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_dgemv_i64</text>
</a>
</g>
</g>
<!-- proc~mrsfmntoia&#45;&gt;proc~oqp_dgemv_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge69" class="edge">
<title>proc~mrsfmntoia&#45;&gt;proc~oqp_dgemv_i64</title>
<path fill="none" stroke="#000000" d="M494.095,-1356C533.7769,-1356 597.2849,-1356 643.8728,-1356"/>
<polygon fill="#000000" stroke="#000000" points="644.1353,-1359.5001 654.1352,-1356 644.1352,-1352.5001 644.1353,-1359.5001"/>
</g>
<!-- proc~oqp_dgemm_i64&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge71" class="edge">
<title>proc~oqp_dgemm_i64&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M753.6289,-698.826C817.6517,-699.0899 930.1256,-705.4545 1018,-742 1057.4086,-758.3894 1095.0606,-791.5459 1116.5621,-812.7163"/>
<polygon fill="#000000" stroke="#000000" points="1114.1931,-815.2977 1123.7263,-819.9204 1119.1566,-810.3617 1114.1931,-815.2977"/>
</g>
<!-- dgemm -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node40" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="950,-690 896,-690 896,-666 950,-666 950,-690"/>
<text text-anchor="middle" x="923" y="-675.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dgemm</text>
</g>
<!-- proc~oqp_dgemm_i64&#45;&gt;dgemm -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge70" class="edge">
<title>proc~oqp_dgemm_i64&#45;&gt;dgemm</title>
<path fill="none" stroke="#000000" d="M753.7487,-694.9251C794.0569,-690.8943 849.4948,-685.3505 885.775,-681.7225"/>
<polygon fill="#000000" stroke="#000000" points="886.3239,-685.1852 895.9259,-680.7074 885.6273,-678.2199 886.3239,-685.1852"/>
</g>
<!-- proc~orthogonal_transform&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge72" class="edge">
<title>proc~orthogonal_transform&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M521.7147,-1071.4979C541.7843,-1068.8634 562.6399,-1062.5282 578,-1049 618.8283,-1013.041 573.1667,-967.9533 614,-932 648.1925,-901.8939 973.4554,-871.5541 1018,-862 1038.9602,-857.5044 1061.8377,-851.8153 1081.7588,-846.6028"/>
<polygon fill="#000000" stroke="#000000" points="1082.8041,-849.9468 1091.5791,-844.0097 1081.0169,-843.1788 1082.8041,-849.9468"/>
</g>
<!-- proc~orthogonal_transform&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge73" class="edge">
<title>proc~orthogonal_transform&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M521.5489,-1073.1564C542.2117,-1070.7706 563.4731,-1064.1663 578,-1049 664.1794,-959.0273 552.8422,-879.5435 614,-771 626.9576,-748.0027 650.6163,-729.6775 670.285,-717.4083"/>
<polygon fill="#000000" stroke="#000000" points="672.2032,-720.3393 678.9884,-712.2023 668.6098,-714.332 672.2032,-720.3393"/>
</g>
<!-- proc~orthogonal_transform_sym&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge74" class="edge">
<title>proc~orthogonal_transform_sym&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M515.8782,-536.014C536.067,-541.182 558.4793,-548.1152 578,-557 595.502,-564.966 596.1923,-573.743 614,-581 635.1494,-589.6188 998.9433,-644.4134 1018,-657 1047.9184,-676.7607 1100.7082,-769.0373 1123.7327,-811.0587"/>
<polygon fill="#000000" stroke="#000000" points="1120.6926,-812.7946 1128.5465,-819.9056 1126.8413,-809.4489 1120.6926,-812.7946"/>
</g>
<!-- proc~orthogonal_transform_sym&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge75" class="edge">
<title>proc~orthogonal_transform_sym&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M535.1148,-533.7947C550.7262,-538.7393 565.9925,-546.0929 578,-557 611.4222,-587.3591 584.2543,-618.0307 614,-652 625.9881,-665.6903 642.8596,-676.1636 658.6944,-683.7805"/>
<polygon fill="#000000" stroke="#000000" points="657.3007,-686.9915 667.8531,-687.9379 660.194,-680.6175 657.3007,-686.9915"/>
</g>
<!-- proc~oqp_dsymm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node57" class="node">
<title>proc~oqp_dsymm_i64</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node57"><a xlink:href="../proc/oqp_dsymm_i64.html" xlink:title="oqp_dsymm_i64">
<polygon fill="#d9534f" stroke="#d9534f" points="752.5,-572 653.5,-572 653.5,-548 752.5,-548 752.5,-572"/>
<text text-anchor="middle" x="703" y="-557.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_dsymm_i64</text>
</a>
</g>
</g>
<!-- proc~orthogonal_transform_sym&#45;&gt;proc~oqp_dsymm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge76" class="edge">
<title>proc~orthogonal_transform_sym&#45;&gt;proc~oqp_dsymm_i64</title>
<path fill="none" stroke="#000000" d="M535.1739,-535.4401C570.085,-540.549 610.5773,-546.4747 643.0406,-551.2255"/>
<polygon fill="#000000" stroke="#000000" points="642.8798,-554.7391 653.2813,-552.7241 643.8935,-547.8129 642.8798,-554.7391"/>
</g>
<!-- proc~oqp_dtpttr_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node58" class="node">
<title>proc~oqp_dtpttr_i64</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node58"><a xlink:href="../proc/oqp_dtpttr_i64.html" xlink:title="oqp_dtpttr_i64">
<polygon fill="#d9534f" stroke="#d9534f" points="747.5,-529 658.5,-529 658.5,-505 747.5,-505 747.5,-529"/>
<text text-anchor="middle" x="703" y="-514.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_dtpttr_i64</text>
</a>
</g>
</g>
<!-- proc~orthogonal_transform_sym&#45;&gt;proc~oqp_dtpttr_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge77" class="edge">
<title>proc~orthogonal_transform_sym&#45;&gt;proc~oqp_dtpttr_i64</title>
<path fill="none" stroke="#000000" d="M535.1739,-521.7755C572.0211,-520.727 615.0858,-519.5016 648.3653,-518.5546"/>
<polygon fill="#000000" stroke="#000000" points="648.4652,-522.0533 658.3616,-518.2702 648.266,-515.0561 648.4652,-522.0533"/>
</g>
<!-- proc~oqp_dtrttp_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node59" class="node">
<title>proc~oqp_dtrttp_i64</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node59"><a xlink:href="../proc/oqp_dtrttp_i64.html" xlink:title="oqp_dtrttp_i64">
<polygon fill="#d9534f" stroke="#d9534f" points="967.5,-450 878.5,-450 878.5,-426 967.5,-426 967.5,-450"/>
<text text-anchor="middle" x="923" y="-435.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oqp_dtrttp_i64</text>
</a>
</g>
</g>
<!-- proc~orthogonal_transform_sym&#45;&gt;proc~oqp_dtrttp_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge78" class="edge">
<title>proc~orthogonal_transform_sym&#45;&gt;proc~oqp_dtrttp_i64</title>
<path fill="none" stroke="#000000" d="M522.286,-511.9515C614.8099,-494.8763 782.3931,-463.9489 868.5788,-448.0434"/>
<polygon fill="#000000" stroke="#000000" points="869.2248,-451.4834 878.4236,-446.2266 867.9544,-444.5996 869.2248,-451.4834"/>
</g>
<!-- proc~rpaeig&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge80" class="edge">
<title>proc~rpaeig&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M476.5958,-276.2456C504.0821,-294.5494 553.4636,-331.7776 578,-377 621.9069,-457.9236 577.435,-496.5048 614,-581 630.8819,-620.0111 662.9004,-658.1006 683.5779,-680.2948"/>
<polygon fill="#000000" stroke="#000000" points="681.2097,-682.8836 690.6338,-687.7247 686.2855,-678.0633 681.2097,-682.8836"/>
</g>
<!-- proc~diag_symm_packed -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node51" class="node">
<title>proc~diag_symm_packed</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node51"><a xlink:href="../proc/diag_symm_packed.html" xlink:title="diag_symm_packed">
<polygon fill="#d9534f" stroke="#d9534f" points="762,-85 644,-85 644,-61 762,-61 762,-85"/>
<text text-anchor="middle" x="703" y="-70.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">diag_symm_packed</text>
</a>
</g>
</g>
<!-- proc~rpaeig&#45;&gt;proc~diag_symm_packed -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge79" class="edge">
<title>proc~rpaeig&#45;&gt;proc~diag_symm_packed</title>
<path fill="none" stroke="#000000" d="M472.7626,-251.7615C514.7654,-219.1497 629.5701,-130.0127 679.3996,-91.3239"/>
<polygon fill="#000000" stroke="#000000" points="681.6164,-94.0339 687.3686,-85.1365 677.3235,-88.5048 681.6164,-94.0339"/>
</g>
<!-- proc~rpaeig&#45;&gt;proc~oqp_dtrttp_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge81" class="edge">
<title>proc~rpaeig&#45;&gt;proc~oqp_dtrttp_i64</title>
<path fill="none" stroke="#000000" d="M484.0684,-274.1071C562.0204,-303.2136 787.4216,-387.3763 881.2473,-422.41"/>
<polygon fill="#000000" stroke="#000000" points="880.1093,-425.721 890.7019,-425.9402 882.558,-419.1632 880.1093,-425.721"/>
</g>
<!-- proc~rparedms&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge82" class="edge">
<title>proc~rparedms&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M489.1362,-578.8229C514.9616,-580.8429 551.2186,-586.8538 578,-604 600.4582,-618.3784 593.7936,-634.5985 614,-652 628.7895,-664.7366 647.5196,-675.4637 663.9779,-683.5244"/>
<polygon fill="#000000" stroke="#000000" points="662.8221,-686.8493 673.3588,-687.9574 665.8129,-680.5204 662.8221,-686.8493"/>
</g>
<!-- proc~sfresvec&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge83" class="edge">
<title>proc~sfresvec&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M485.7008,-700C523.8814,-700 592.3581,-700 642.2628,-700"/>
<polygon fill="#000000" stroke="#000000" points="642.2967,-703.5001 652.2967,-700 642.2966,-696.5001 642.2967,-703.5001"/>
</g>
<!-- proc~trfrmb&#45;&gt;proc~oqp_dgemm_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge84" class="edge">
<title>proc~trfrmb&#45;&gt;proc~oqp_dgemm_i64</title>
<path fill="none" stroke="#000000" d="M484.2662,-662.6552C522.0679,-669.1092 591.4411,-680.9534 641.9512,-689.577"/>
<polygon fill="#000000" stroke="#000000" points="641.6592,-693.0777 652.1056,-691.3107 642.8373,-686.1776 641.6592,-693.0777"/>
</g>
<!-- proc~pack_f90 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node90" class="node">
<title>proc~pack_f90</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node90"><a xlink:href="../proc/pack_f90.html" xlink:title="PACK_F90">
<polygon fill="#d9534f" stroke="#d9534f" points="735,-804 671,-804 671,-780 735,-780 735,-804"/>
<text text-anchor="middle" x="703" y="-789.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PACK_F90</text>
</a>
</g>
</g>
<!-- interface~pack_matrix&#45;&gt;proc~pack_f90 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge85" class="edge">
<title>interface~pack_matrix&#45;&gt;proc~pack_f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M496.252,-858.5838C520.3467,-854.5256 551.5504,-847.9369 578,-838 595.134,-831.5629 597.1107,-825.0545 614,-818 628.8443,-811.7997 645.6621,-806.478 660.6503,-802.2939"/>
<polygon fill="#000000" stroke="#000000" points="661.9467,-805.5692 670.6877,-799.5821 660.121,-798.8115 661.9467,-805.5692"/>
</g>
<!-- mpi_comm_rank -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node73" class="node">
<title>mpi_comm_rank</title>
<polygon fill="#777777" stroke="#777777" points="1457,-3076 1356,-3076 1356,-3052 1457,-3052 1457,-3076"/>
<text text-anchor="middle" x="1406.5" y="-3061.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_comm_rank</text>
</g>
<!-- none~init~14&#45;&gt;mpi_comm_rank -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge86" class="edge">
<title>none~init~14&#45;&gt;mpi_comm_rank</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1180.799,-2849.8855C1193.7416,-2852.8756 1206.7924,-2858.3124 1216,-2868 1270.705,-2925.5565 1193.9806,-2988.7862 1252,-3043 1276.6292,-3066.0137 1313.8534,-3071.6074 1345.5924,-3071.2829"/>
<polygon fill="#000000" stroke="#000000" points="1345.7897,-3074.7787 1355.6817,-3070.9842 1345.5824,-3067.7818 1345.7897,-3074.7787"/>
</g>
<!-- mpi_comm_size -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node74" class="node">
<title>mpi_comm_size</title>
<polygon fill="#777777" stroke="#777777" points="1455,-3034 1358,-3034 1358,-3010 1455,-3010 1455,-3034"/>
<text text-anchor="middle" x="1406.5" y="-3019.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_comm_size</text>
</g>
<!-- none~init~14&#45;&gt;mpi_comm_size -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge87" class="edge">
<title>none~init~14&#45;&gt;mpi_comm_size</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1180.8595,-2850.3383C1193.6508,-2853.3609 1206.6024,-2858.7021 1216,-2868 1259.5323,-2911.0704 1205.992,-2960.5848 1252,-3001 1277.7834,-3023.6491 1315.9211,-3029.0155 1347.8531,-3028.6622"/>
<polygon fill="#000000" stroke="#000000" points="1348.0875,-3032.1569 1357.9791,-3028.3612 1347.8794,-3025.16 1348.0875,-3032.1569"/>
</g>
<!-- none~run_cam&#45;&gt;none~run_generic -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge88" class="edge">
<title>none~run_cam&#45;&gt;none~run_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.6213,-1514.2981C548.7295,-1517.6265 564.8325,-1523.3745 578,-1533 653.4734,-1588.1713 687.142,-1702.5906 698.3935,-1750.8086"/>
<polygon fill="#000000" stroke="#000000" points="695.0315,-1751.8135 700.6239,-1760.8121 701.8638,-1750.2901 695.0315,-1751.8135"/>
</g>
<!-- none~run_generic&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge89" class="edge">
<title>none~run_generic&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M704.5261,-1760.803C710.7075,-1716.8058 738.0244,-1564.9676 828,-1491 894.8811,-1436.018 957.8552,-1510.2793 1018,-1448 1102.7365,-1360.2562 1128.7778,-954.0413 1133.9505,-854.2069"/>
<polygon fill="#000000" stroke="#000000" points="1137.4538,-854.2275 1134.4577,-844.0651 1130.4625,-853.8778 1137.4538,-854.2275"/>
</g>
<!-- none~run_generic&#45;&gt;proc~ints_exchange -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge101" class="edge">
<title>none~run_generic&#45;&gt;proc~ints_exchange</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M780.2132,-1785.211C784.4844,-1787.6696 788.4669,-1790.5739 792,-1794 836.2705,-1836.93 784.4968,-1884.2926 828,-1928 838.7812,-1938.8318 853.6137,-1945.2694 868.3545,-1949.0608"/>
<polygon fill="#000000" stroke="#000000" points="867.9765,-1952.561 878.4942,-1951.2843 869.476,-1945.7235 867.9765,-1952.561"/>
</g>
<!-- libint2_cleanup_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node70" class="node">
<title>libint2_cleanup_eri</title>
<polygon fill="#777777" stroke="#777777" points="1191.5,-1648 1078.5,-1648 1078.5,-1624 1191.5,-1624 1191.5,-1648"/>
<text text-anchor="middle" x="1135" y="-1633.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint2_cleanup_eri</text>
</g>
<!-- none~run_generic&#45;&gt;libint2_cleanup_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge90" class="edge">
<title>none~run_generic&#45;&gt;libint2_cleanup_eri</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M787.1748,-1770.3004C867.7236,-1766.1831 982.1135,-1755.8455 1018,-1730 1047.3546,-1708.8588 1025.9432,-1679.8354 1054,-1657 1058.5474,-1653.2989 1063.6742,-1650.2428 1069.0846,-1647.7204"/>
<polygon fill="#000000" stroke="#000000" points="1070.4418,-1650.9471 1078.4057,-1643.9595 1067.8225,-1644.4555 1070.4418,-1650.9471"/>
</g>
<!-- libint2_init_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node71" class="node">
<title>libint2_init_eri</title>
<polygon fill="#777777" stroke="#777777" points="1178.5,-1606 1091.5,-1606 1091.5,-1582 1178.5,-1582 1178.5,-1606"/>
<text text-anchor="middle" x="1135" y="-1591.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint2_init_eri</text>
</g>
<!-- none~run_generic&#45;&gt;libint2_init_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge91" class="edge">
<title>none~run_generic&#45;&gt;libint2_init_eri</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M733.661,-1760.9172C758.7133,-1751.4195 795.2156,-1738.4287 828,-1730 911.0092,-1708.6588 950.53,-1749.8561 1018,-1697 1049.3322,-1672.4543 1023.6964,-1640.8049 1054,-1615 1061.7977,-1608.3599 1071.4436,-1603.7844 1081.3284,-1600.6399"/>
<polygon fill="#000000" stroke="#000000" points="1082.5006,-1603.9484 1091.2332,-1597.949 1080.6654,-1597.1933 1082.5006,-1603.9484"/>
</g>
<!-- none~clean~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node76" class="node">
<title>none~clean~2</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node76"><a xlink:href="../type/int2_rys_data_t.html#boundprocedure-clean~2" xlink:title="int2_rys_data_t%clean">
<polygon fill="#a7506f" stroke="#a7506f" points="1200.5,-1564 1069.5,-1564 1069.5,-1540 1200.5,-1540 1200.5,-1564"/>
<text text-anchor="middle" x="1135" y="-1549.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_rys_data_t%clean</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;none~clean~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge92" class="edge">
<title>none~run_generic&#45;&gt;none~clean~2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M706.2331,-1760.8709C716.6588,-1724.448 753.1524,-1615.7881 828,-1571 898.79,-1528.6399 995.9401,-1530.4859 1061.8569,-1538.6108"/>
<polygon fill="#000000" stroke="#000000" points="1061.7886,-1542.1317 1072.1591,-1539.9629 1062.6996,-1535.1913 1061.7886,-1542.1317"/>
</g>
<!-- none~init~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node78" class="node">
<title>none~init~2</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node78"><a xlink:href="../type/int2_rys_data_t.html#boundprocedure-init~2" xlink:title="int2_rys_data_t%init">
<polygon fill="#a7506f" stroke="#a7506f" points="1194,-2085 1076,-2085 1076,-2061 1194,-2061 1194,-2085"/>
<text text-anchor="middle" x="1135" y="-2070.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_rys_data_t%init</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;none~init~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge93" class="edge">
<title>none~run_generic&#45;&gt;none~init~2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781.4922,-1785.249C785.3392,-1787.7132 788.8882,-1790.6069 792,-1794 866.6863,-1875.4355 748.3871,-1963.3739 828,-2040 860.8715,-2071.6383 985.7599,-2075.7926 1065.7641,-2075.0244"/>
<polygon fill="#000000" stroke="#000000" points="1065.8165,-2078.5241 1075.7724,-2074.9006 1065.7298,-2071.5246 1065.8165,-2078.5241"/>
</g>
<!-- none~screen_ij -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node79" class="node">
<title>none~screen_ij</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node79"><a xlink:href="../type/int2_compute_data_t.html#boundprocedure-screen_ij" xlink:title="int2_compute_data_t%screen_ij">
<polygon fill="#a7506f" stroke="#a7506f" points="1013.5,-2168 832.5,-2168 832.5,-2144 1013.5,-2144 1013.5,-2168"/>
<text text-anchor="middle" x="923" y="-2153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute_data_t%screen_ij</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;none~screen_ij -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge94" class="edge">
<title>none~run_generic&#45;&gt;none~screen_ij</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781.653,-1785.1045C785.4601,-1787.6045 788.9563,-1790.5457 792,-1794 892.458,-1908.0121 727.3056,-2020.1966 828,-2134 829.1955,-2135.3511 830.456,-2136.6278 831.7742,-2137.8341"/>
<polygon fill="#000000" stroke="#000000" points="829.8186,-2140.7436 839.9011,-2143.9983 834.0488,-2135.1664 829.8186,-2140.7436"/>
</g>
<!-- none~screen_ijkl -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node80" class="node">
<title>none~screen_ijkl</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node80"><a xlink:href="../type/int2_compute_data_t.html#boundprocedure-screen_ijkl" xlink:title="int2_compute_data_t%screen_ijkl">
<polygon fill="#a7506f" stroke="#a7506f" points="1018,-2125 828,-2125 828,-2101 1018,-2101 1018,-2125"/>
<text text-anchor="middle" x="923" y="-2110.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_compute_data_t%screen_ijkl</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;none~screen_ijkl -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge95" class="edge">
<title>none~run_generic&#45;&gt;none~screen_ijkl</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M781.5833,-1785.1665C785.4077,-1787.6511 788.9268,-1790.5719 792,-1794 879.2852,-1891.363 742.9369,-1986.6897 828,-2086 831.0953,-2089.6137 834.6357,-2092.7612 838.4886,-2095.5011"/>
<polygon fill="#000000" stroke="#000000" points="837.002,-2098.6923 847.3704,-2100.871 840.6237,-2092.702 837.002,-2098.6923"/>
</g>
<!-- none~set_ids -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node81" class="node">
<title>none~set_ids</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node81"><a xlink:href="../type/int2_rys_data_t.html#boundprocedure-set_ids" xlink:title="int2_rys_data_t%set_ids">
<polygon fill="#a7506f" stroke="#a7506f" points="1204,-2043 1066,-2043 1066,-2019 1204,-2019 1204,-2043"/>
<text text-anchor="middle" x="1135" y="-2028.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_rys_data_t%set_ids</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;none~set_ids -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge96" class="edge">
<title>none~run_generic&#45;&gt;none~set_ids</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M780.9836,-1785.0976C785.0112,-1787.5911 788.734,-1790.5335 792,-1794 856.0361,-1861.966 759.5475,-1937.4842 828,-2001 893.4784,-2061.7563 1003.9588,-2056.0766 1073.0024,-2044.7415"/>
<polygon fill="#000000" stroke="#000000" points="1073.62,-2048.1867 1082.8782,-2043.0353 1072.4283,-2041.2889 1073.62,-2048.1867"/>
</g>
<!-- parallel_start -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node83" class="node">
<title>parallel_start</title>
<polygon fill="#777777" stroke="#777777" points="964,-1886 882,-1886 882,-1862 964,-1862 964,-1886"/>
<text text-anchor="middle" x="923" y="-1871.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel_start</text>
</g>
<!-- none~run_generic&#45;&gt;parallel_start -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge97" class="edge">
<title>none~run_generic&#45;&gt;parallel_start</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M776.0739,-1785.0456C781.7207,-1787.5063 787.1159,-1790.4589 792,-1794 816.8694,-1812.031 803.0035,-1835.1456 828,-1853 840.6196,-1862.0139 856.4067,-1867.2634 871.4661,-1870.2892"/>
<polygon fill="#000000" stroke="#000000" points="871.2802,-1873.8083 881.7277,-1872.0477 872.4625,-1866.9088 871.2802,-1873.8083"/>
</g>
<!-- parallel_stop -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node84" class="node">
<title>parallel_stop</title>
<polygon fill="#777777" stroke="#777777" points="963.5,-1844 882.5,-1844 882.5,-1820 963.5,-1820 963.5,-1844"/>
<text text-anchor="middle" x="923" y="-1829.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel_stop</text>
</g>
<!-- none~run_generic&#45;&gt;parallel_stop -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge98" class="edge">
<title>none~run_generic&#45;&gt;parallel_stop</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M757.7989,-1785.111C769.1538,-1787.8496 781.0044,-1790.877 792,-1794 808.2238,-1798.6079 811.8604,-1801.1055 828,-1806 842.3591,-1810.3546 858.0363,-1814.7787 872.4408,-1818.7131"/>
<polygon fill="#000000" stroke="#000000" points="871.6107,-1822.1143 882.178,-1821.3518 873.4416,-1815.358 871.6107,-1822.1143"/>
</g>
<!-- proc~genr22 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node86" class="node">
<title>proc~genr22</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node86"><a xlink:href="../proc/genr22.html" xlink:title="genr22">
<polygon fill="#d9534f" stroke="#d9534f" points="1162,-1959 1108,-1959 1108,-1935 1162,-1935 1162,-1959"/>
<text text-anchor="middle" x="1135" y="-1944.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">genr22</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;proc~genr22 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge99" class="edge">
<title>none~run_generic&#45;&gt;proc~genr22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M779.058,-1785.0894C783.72,-1787.5639 788.0963,-1790.5061 792,-1794 827.5095,-1825.7818 791.4929,-1864.3692 828,-1895 848.468,-1912.1734 1020.4175,-1933.8346 1097.6721,-1942.8098"/>
<polygon fill="#000000" stroke="#000000" points="1097.5841,-1946.3228 1107.919,-1943.9903 1098.3853,-1939.3688 1097.5841,-1946.3228"/>
</g>
<!-- proc~int2_rys_compute -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node87" class="node">
<title>proc~int2_rys_compute</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node87"><a xlink:href="../proc/int2_rys_compute.html" xlink:title="int2_rys_compute">
<polygon fill="#d9534f" stroke="#d9534f" points="1188,-2001 1082,-2001 1082,-1977 1188,-1977 1188,-2001"/>
<text text-anchor="middle" x="1135" y="-1986.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">int2_rys_compute</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;proc~int2_rys_compute -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge100" class="edge">
<title>none~run_generic&#45;&gt;proc~int2_rys_compute</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M780.8863,-1785.1903C784.9377,-1787.6612 788.6924,-1790.5732 792,-1794 848.9619,-1853.014 765.8,-1921.5354 828,-1975 863.1891,-2005.2471 992.2886,-2000.8543 1071.4375,-1994.9303"/>
<polygon fill="#000000" stroke="#000000" points="1072.0846,-1998.3907 1081.7832,-1994.1261 1071.542,-1991.4117 1072.0846,-1998.3907"/>
</g>
<!-- proc~libint_compute_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node88" class="node">
<title>proc~libint_compute_eri</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node88"><a xlink:href="../proc/libint_compute_eri.html" xlink:title="libint_compute_eri">
<polygon fill="#d9534f" stroke="#d9534f" points="1190.5,-1690 1079.5,-1690 1079.5,-1666 1190.5,-1666 1190.5,-1690"/>
<text text-anchor="middle" x="1135" y="-1675.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint_compute_eri</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;proc~libint_compute_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge102" class="edge">
<title>none~run_generic&#45;&gt;proc~libint_compute_eri</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M780.1274,-1785.0073C845.3908,-1792.0938 940.4111,-1795.0785 1018,-1768 1058.5127,-1753.8611 1096.0813,-1719.7167 1117.2264,-1697.7845"/>
<polygon fill="#000000" stroke="#000000" points="1119.9481,-1699.9993 1124.2486,-1690.3165 1114.8485,-1695.2041 1119.9481,-1699.9993"/>
</g>
<!-- proc~libint_print_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node89" class="node">
<title>proc~libint_print_eri</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node89"><a xlink:href="../proc/libint_print_eri.html" xlink:title="libint_print_eri">
<polygon fill="#d9534f" stroke="#d9534f" points="967,-1688 879,-1688 879,-1664 967,-1664 967,-1688"/>
<text text-anchor="middle" x="923" y="-1673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint_print_eri</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;proc~libint_print_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge103" class="edge">
<title>none~run_generic&#45;&gt;proc~libint_print_eri</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M720.9055,-1760.9176C744.5417,-1745.4247 787.865,-1718.5845 828,-1702 840.9712,-1696.64 855.3904,-1692.0444 868.9957,-1688.2739"/>
<polygon fill="#000000" stroke="#000000" points="869.9681,-1691.637 878.7263,-1685.6751 868.1618,-1684.874 869.9681,-1691.637"/>
</g>
<!-- proc~rys_print_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node92" class="node">
<title>proc~rys_print_eri</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node92"><a xlink:href="../proc/rys_print_eri.html" xlink:title="rys_print_eri">
<polygon fill="#d9534f" stroke="#d9534f" points="962,-1646 884,-1646 884,-1622 962,-1622 962,-1646"/>
<text text-anchor="middle" x="923" y="-1631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rys_print_eri</text>
</a>
</g>
</g>
<!-- none~run_generic&#45;&gt;proc~rys_print_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge104" class="edge">
<title>none~run_generic&#45;&gt;proc~rys_print_eri</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M712.1497,-1760.733C730.9649,-1736.4459 776.5731,-1682.2377 828,-1655 842.0814,-1647.542 858.685,-1642.7288 874.0399,-1639.6241"/>
<polygon fill="#000000" stroke="#000000" points="874.7032,-1643.061 883.9109,-1637.8199 873.4445,-1636.175 874.7032,-1643.061"/>
</g>
<!-- update -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node95" class="node">
<title>update</title>
<polygon fill="#777777" stroke="#777777" points="950,-1604 896,-1604 896,-1580 950,-1580 950,-1604"/>
<text text-anchor="middle" x="923" y="-1589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">update</text>
</g>
<!-- none~run_generic&#45;&gt;update -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge105" class="edge">
<title>none~run_generic&#45;&gt;update</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M708.848,-1760.6246C723.9126,-1730.1829 767.1726,-1651.3542 828,-1613 845.1596,-1602.1802 867.127,-1596.8904 885.6146,-1594.3234"/>
<polygon fill="#000000" stroke="#000000" points="886.2308,-1597.7751 895.7542,-1593.1323 885.4141,-1590.8229 886.2308,-1597.7751"/>
</g>
<!-- proc~to_upper -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node93" class="node">
<title>proc~to_upper</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node93"><a xlink:href="../proc/to_upper.html" xlink:title="to_upper">
<polygon fill="#d94e8f" stroke="#d94e8f" points="733,-1288 673,-1288 673,-1264 733,-1264 733,-1288"/>
<text text-anchor="middle" x="703" y="-1273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">to_upper</text>
</a>
</g>
</g>
<!-- proc~atomic_structure_center&#45;&gt;proc~to_upper -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge106" class="edge">
<title>proc~atomic_structure_center&#45;&gt;proc~to_upper</title>
<path fill="none" stroke="#000000" d="M499.5379,-1224.0913C531.0604,-1232.9439 575.1125,-1245.0901 614,-1255 629.8744,-1259.0453 647.4115,-1263.2414 662.6917,-1266.8094"/>
<polygon fill="#000000" stroke="#000000" points="662.3293,-1270.3183 672.8617,-1269.1697 663.9118,-1263.4995 662.3293,-1270.3183"/>
</g>
<!-- proc~diag_symm_packed&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge109" class="edge">
<title>proc~diag_symm_packed&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M762.0374,-73.1031C843.3528,-74.5855 983.6867,-82.4032 1018,-118 1070.8826,-172.8607 1041.897,-383.7684 1054,-459 1075.6549,-593.6056 1114.82,-752.7704 1129.3636,-810.0789"/>
<polygon fill="#000000" stroke="#000000" points="1125.9945,-811.0316 1131.8575,-819.8563 1132.7773,-809.3014 1125.9945,-811.0316"/>
</g>
<!-- dspev -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node64" class="node">
<title>dspev</title>
<polygon fill="#777777" stroke="#777777" points="950,-66 896,-66 896,-42 950,-42 950,-66"/>
<text text-anchor="middle" x="923" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dspev</text>
</g>
<!-- proc~diag_symm_packed&#45;&gt;dspev -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge107" class="edge">
<title>proc~diag_symm_packed&#45;&gt;dspev</title>
<path fill="none" stroke="#000000" d="M762.2454,-67.8834C801.5202,-64.4914 851.8511,-60.1447 885.6421,-57.2264"/>
<polygon fill="#000000" stroke="#000000" points="886.3353,-60.6796 895.997,-56.3321 885.7329,-53.7056 886.3353,-60.6796"/>
</g>
<!-- dspevx -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node65" class="node">
<title>dspevx</title>
<polygon fill="#777777" stroke="#777777" points="950,-24 896,-24 896,0 950,0 950,-24"/>
<text text-anchor="middle" x="923" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dspevx</text>
</g>
<!-- proc~diag_symm_packed&#45;&gt;dspevx -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge108" class="edge">
<title>proc~diag_symm_packed&#45;&gt;dspevx</title>
<path fill="none" stroke="#000000" d="M737.7665,-60.9245C762.7057,-52.4962 797.2025,-41.3126 828,-33 846.9487,-27.8855 868.2676,-23.0876 885.9014,-19.3724"/>
<polygon fill="#000000" stroke="#000000" points="886.7319,-22.7747 895.8122,-17.3159 885.3097,-15.9207 886.7319,-22.7747"/>
</g>
<!-- proc~ints_exchange&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge110" class="edge">
<title>proc~ints_exchange&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M957.3996,-1941.8773C978.5941,-1932.5077 1004.2614,-1917.321 1018,-1895 1065.4773,-1817.864 1044.4571,-1579.0721 1054,-1489 1080.4517,-1239.3315 1120.7433,-937.3386 1131.9917,-854.1353"/>
<polygon fill="#000000" stroke="#000000" points="1135.4803,-854.4544 1133.3545,-844.0751 1128.5437,-853.5147 1135.4803,-854.4544"/>
</g>
<!-- proc~ints_exchange&#45;&gt;none~alloc -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge113" class="edge">
<title>proc~ints_exchange&#45;&gt;none~alloc</title>
<path fill="none" stroke="#000000" d="M930.8472,-1966.2849C949.0047,-1993.6728 996.7675,-2059.9931 1054,-2094 1057.1847,-2095.8923 1060.5387,-2097.616 1063.9965,-2099.1859"/>
<polygon fill="#000000" stroke="#000000" points="1062.7659,-2102.4638 1073.3475,-2102.9924 1065.4051,-2095.9804 1062.7659,-2102.4638"/>
</g>
<!-- proc~ints_exchange&#45;&gt;none~compute -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge115" class="edge">
<title>proc~ints_exchange&#45;&gt;none~compute</title>
<path fill="none" stroke="#000000" d="M933.3976,-1966.0822C952.706,-1989.0942 994.287,-2041.4384 1018,-2092 1043.093,-2145.5041 1011.7868,-2178.6431 1054,-2220 1055.1026,-2221.0802 1056.2532,-2222.1069 1057.4459,-2223.0827"/>
<polygon fill="#000000" stroke="#000000" points="1055.6298,-2226.0804 1065.8666,-2228.8112 1059.5671,-2220.2926 1055.6298,-2226.0804"/>
</g>
<!-- proc~ints_exchange&#45;&gt;none~set -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge117" class="edge">
<title>proc~ints_exchange&#45;&gt;none~set</title>
<path fill="none" stroke="#000000" d="M932.5416,-1966.0069C950.7659,-1989.3125 991.1027,-2042.7264 1018,-2092 1037.8535,-2128.37 1022.6852,-2150.8647 1054,-2178 1058.8994,-2182.2455 1064.5519,-2185.6489 1070.5462,-2188.3749"/>
<polygon fill="#000000" stroke="#000000" points="1069.5994,-2191.762 1080.188,-2192.1247 1072.1366,-2185.238 1069.5994,-2191.762"/>
</g>
<!-- proc~ints_exchange&#45;&gt;libint2_cleanup_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge111" class="edge">
<title>proc~ints_exchange&#45;&gt;libint2_cleanup_eri</title>
<path fill="none" stroke="#000000" d="M956.4766,-1941.7962C977.5692,-1932.3221 1003.4728,-1917.0488 1018,-1895 1076.859,-1805.666 982.3693,-1736.4606 1054,-1657 1058.2769,-1652.2556 1063.474,-1648.5215 1069.1492,-1645.5906"/>
<polygon fill="#000000" stroke="#000000" points="1070.5917,-1648.7802 1078.3972,-1641.6161 1067.8277,-1642.349 1070.5917,-1648.7802"/>
</g>
<!-- proc~ints_exchange&#45;&gt;libint2_init_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge112" class="edge">
<title>proc~ints_exchange&#45;&gt;libint2_init_eri</title>
<path fill="none" stroke="#000000" d="M956.6389,-1941.9018C977.8001,-1932.4724 1003.719,-1917.2091 1018,-1895 1085.8606,-1789.4663 971.0326,-1709.1214 1054,-1615 1061.1342,-1606.9066 1070.946,-1601.7417 1081.2814,-1598.4873"/>
<polygon fill="#000000" stroke="#000000" points="1082.4657,-1601.7968 1091.2807,-1595.9192 1080.7244,-1595.0168 1082.4657,-1601.7968"/>
</g>
<!-- proc~ints_exchange&#45;&gt;none~clean~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge114" class="edge">
<title>proc~ints_exchange&#45;&gt;none~clean~2</title>
<path fill="none" stroke="#000000" d="M956.7603,-1941.9791C977.9726,-1932.5823 1003.9031,-1917.3264 1018,-1895 1094.8811,-1773.2376 959.673,-1681.8081 1054,-1573 1056.0073,-1570.6846 1058.2337,-1568.6081 1060.6295,-1566.747"/>
<polygon fill="#000000" stroke="#000000" points="1062.7842,-1569.5251 1069.3557,-1561.2145 1059.036,-1563.6132 1062.7842,-1569.5251"/>
</g>
<!-- proc~ints_exchange&#45;&gt;none~init~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge116" class="edge">
<title>proc~ints_exchange&#45;&gt;none~init~2</title>
<path fill="none" stroke="#000000" d="M935.6311,-1966.1747C957.7827,-1986.8609 1005.8717,-2028.8714 1054,-2052 1058.276,-2054.0549 1062.7791,-2055.9272 1067.3819,-2057.6302"/>
<polygon fill="#000000" stroke="#000000" points="1066.3341,-2060.9708 1076.9287,-2060.892 1068.5974,-2054.3467 1066.3341,-2060.9708"/>
</g>
<!-- proc~ints_exchange&#45;&gt;none~set_ids -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge118" class="edge">
<title>proc~ints_exchange&#45;&gt;none~set_ids</title>
<path fill="none" stroke="#000000" d="M948.161,-1966.0991C974.2148,-1978.3065 1016.3119,-1997.1405 1054,-2010 1060.374,-2012.1749 1067.0958,-2014.2507 1073.8303,-2016.1921"/>
<polygon fill="#000000" stroke="#000000" points="1073.0946,-2019.6204 1083.6673,-2018.936 1074.9755,-2012.8778 1073.0946,-2019.6204"/>
</g>
<!-- proc~ints_exchange&#45;&gt;proc~genr22 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge119" class="edge">
<title>proc~ints_exchange&#45;&gt;proc~genr22</title>
<path fill="none" stroke="#000000" d="M967.7007,-1952.524C1006.2885,-1951.2499 1061.3894,-1949.4305 1097.6616,-1948.2329"/>
<polygon fill="#000000" stroke="#000000" points="1097.9398,-1951.7257 1107.8188,-1947.8975 1097.7087,-1944.7295 1097.9398,-1951.7257"/>
</g>
<!-- proc~ints_exchange&#45;&gt;proc~int2_rys_compute -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge120" class="edge">
<title>proc~ints_exchange&#45;&gt;proc~int2_rys_compute</title>
<path fill="none" stroke="#000000" d="M967.7007,-1961.3798C997.866,-1966.36 1038.1225,-1973.0061 1071.5867,-1978.5308"/>
<polygon fill="#000000" stroke="#000000" points="1071.2988,-1982.0306 1081.7354,-1980.2063 1072.4391,-1975.1241 1071.2988,-1982.0306"/>
</g>
<!-- proc~ints_exchange&#45;&gt;proc~libint_compute_eri -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge121" class="edge">
<title>proc~ints_exchange&#45;&gt;proc~libint_compute_eri</title>
<path fill="none" stroke="#000000" d="M950.2145,-1941.9083C970.7968,-1931.7112 998.7128,-1915.5066 1018,-1895 1074.7685,-1834.6425 1112.587,-1741.4754 1127.6519,-1699.6387"/>
<polygon fill="#000000" stroke="#000000" points="1130.9697,-1700.7543 1130.9894,-1690.1594 1124.367,-1698.4295 1130.9697,-1700.7543"/>
</g>
<!-- libint2_static_init -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node72" class="node">
<title>libint2_static_init</title>
<polygon fill="#777777" stroke="#777777" points="1457,-2992 1356,-2992 1356,-2968 1457,-2968 1457,-2992"/>
<text text-anchor="middle" x="1406.5" y="-2977.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">libint2_static_init</text>
</g>
<!-- proc~libint_static_init&#45;&gt;libint2_static_init -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge122" class="edge">
<title>proc~libint_static_init&#45;&gt;libint2_static_init</title>
<path fill="none" stroke="#000000" d="M1140.6774,-2643.1083C1154.7477,-2673.4219 1191.8362,-2755.2277 1216,-2826 1235.7871,-2883.9534 1205.992,-2918.5848 1252,-2959 1277.2329,-2981.1655 1314.2981,-2986.7784 1345.7993,-2986.6769"/>
<polygon fill="#000000" stroke="#000000" points="1345.8888,-2990.1759 1355.8095,-2986.4569 1345.7349,-2983.1775 1345.8888,-2990.1759"/>
</g>
<!-- proc~multipole_integrals&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge124" class="edge">
<title>proc~multipole_integrals&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M514.7654,-1156.5359C536.9598,-1154.559 561.0163,-1148.391 578,-1133 622.4244,-1092.7416 570.2977,-1044.0412 614,-1003 630.7191,-987.2989 997.0633,-927.3652 1018,-918 1055.7112,-901.1314 1093.0854,-870.6185 1115.101,-850.8422"/>
<polygon fill="#000000" stroke="#000000" points="1117.4707,-853.4179 1122.4893,-844.0871 1112.7473,-848.2518 1117.4707,-853.4179"/>
</g>
<!-- interface~bas_norm_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node69" class="node">
<title>interface~bas_norm_matrix</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node69"><a xlink:href="../interface/bas_norm_matrix.html" xlink:title="bas_norm_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="755.5,-1204 650.5,-1204 650.5,-1180 755.5,-1180 755.5,-1204"/>
<text text-anchor="middle" x="703" y="-1189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bas_norm_matrix</text>
</a>
</g>
</g>
<!-- proc~multipole_integrals&#45;&gt;interface~bas_norm_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge123" class="edge">
<title>proc~multipole_integrals&#45;&gt;interface~bas_norm_matrix</title>
<path fill="none" stroke="#000000" d="M514.6761,-1162.9093C552.3509,-1168.729 601.5444,-1176.328 640.2049,-1182.2999"/>
<polygon fill="#000000" stroke="#000000" points="639.884,-1185.7918 650.3011,-1183.8595 640.9527,-1178.8739 639.884,-1185.7918"/>
</g>
<!-- none~alloc~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node75" class="node">
<title>none~alloc~2</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node75"><a xlink:href="../type/shpair_t.html#boundprocedure-alloc~2" xlink:title="shpair_t%alloc">
<polygon fill="#a7506f" stroke="#a7506f" points="748,-1162 658,-1162 658,-1138 748,-1138 748,-1162"/>
<text text-anchor="middle" x="703" y="-1147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">shpair_t%alloc</text>
</a>
</g>
</g>
<!-- proc~multipole_integrals&#45;&gt;none~alloc~2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge125" class="edge">
<title>proc~multipole_integrals&#45;&gt;none~alloc~2</title>
<path fill="none" stroke="#000000" d="M514.6761,-1153.0622C554.9132,-1152.4079 608.2892,-1151.54 647.9399,-1150.8953"/>
<polygon fill="#000000" stroke="#000000" points="648.0231,-1154.3945 657.9648,-1150.7323 647.9092,-1147.3954 648.0231,-1154.3945"/>
</g>
<!-- none~fetch_by_id -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node77" class="node">
<title>none~fetch_by_id</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node77"><a xlink:href="../type/shell_t.html#boundprocedure-fetch_by_id" xlink:title="shell_t%fetch_by_id">
<polygon fill="#a7506f" stroke="#a7506f" points="761,-1120 645,-1120 645,-1096 761,-1096 761,-1120"/>
<text text-anchor="middle" x="703" y="-1105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">shell_t%fetch_by_id</text>
</a>
</g>
</g>
<!-- proc~multipole_integrals&#45;&gt;none~fetch_by_id -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge126" class="edge">
<title>proc~multipole_integrals&#45;&gt;none~fetch_by_id</title>
<path fill="none" stroke="#000000" d="M514.6023,-1144.3121C534.6845,-1140.8527 557.3557,-1136.8552 578,-1133 596.4476,-1129.555 616.389,-1125.6493 634.8104,-1121.966"/>
<polygon fill="#000000" stroke="#000000" points="635.7534,-1125.3466 644.869,-1119.947 634.3758,-1118.4835 635.7534,-1125.3466"/>
</g>
<!-- none~shell_pair -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node82" class="node">
<title>none~shell_pair</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node82"><a xlink:href="../type/shpair_t.html#boundprocedure-shell_pair" xlink:title="shpair_t%shell_pair">
<polygon fill="#a7506f" stroke="#a7506f" points="760.5,-1078 645.5,-1078 645.5,-1054 760.5,-1054 760.5,-1078"/>
<text text-anchor="middle" x="703" y="-1063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">shpair_t%shell_pair</text>
</a>
</g>
</g>
<!-- proc~multipole_integrals&#45;&gt;none~shell_pair -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge127" class="edge">
<title>proc~multipole_integrals&#45;&gt;none~shell_pair</title>
<path fill="none" stroke="#000000" d="M514.8067,-1152.5476C535.8883,-1149.8796 559.1563,-1144.2775 578,-1133 600.2764,-1119.6682 592.1326,-1100.9926 614,-1087 620.5817,-1082.7885 627.9224,-1079.4201 635.487,-1076.7264"/>
<polygon fill="#000000" stroke="#000000" points="636.6741,-1080.0217 645.1482,-1073.6624 634.558,-1073.3492 636.6741,-1080.0217"/>
</g>
<!-- proc~comp_allmult_int1_prim -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node85" class="node">
<title>proc~comp_allmult_int1_prim</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node85"><a xlink:href="../proc/comp_allmult_int1_prim.html" xlink:title="comp_allmult_int1_prim">
<polygon fill="#d9534f" stroke="#d9534f" points="773,-1505 633,-1505 633,-1481 773,-1481 773,-1505"/>
<text text-anchor="middle" x="703" y="-1490.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">comp_allmult_int1_prim</text>
</a>
</g>
</g>
<!-- proc~multipole_integrals&#45;&gt;proc~comp_allmult_int1_prim -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge128" class="edge">
<title>proc~multipole_integrals&#45;&gt;proc~comp_allmult_int1_prim</title>
<path fill="none" stroke="#000000" d="M514.7193,-1158.9139C537.4494,-1163.7636 561.9123,-1173.1175 578,-1191 634.3147,-1253.5974 579.45,-1300.2141 614,-1377 631.0685,-1414.934 662.7546,-1451.836 683.3496,-1473.4829"/>
<polygon fill="#000000" stroke="#000000" points="680.9138,-1475.9986 690.3878,-1480.7415 685.9392,-1471.1258 680.9138,-1475.9986"/>
</g>
<!-- proc~print_sym_labeled -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node91" class="node">
<title>proc~print_sym_labeled</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node91"><a xlink:href="../proc/print_sym_labeled.html" xlink:title="print_sym_labeled">
<polygon fill="#d9534f" stroke="#d9534f" points="757.5,-1246 648.5,-1246 648.5,-1222 757.5,-1222 757.5,-1246"/>
<text text-anchor="middle" x="703" y="-1231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">print_sym_labeled</text>
</a>
</g>
</g>
<!-- proc~multipole_integrals&#45;&gt;proc~print_sym_labeled -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge129" class="edge">
<title>proc~multipole_integrals&#45;&gt;proc~print_sym_labeled</title>
<path fill="none" stroke="#000000" d="M506.3051,-1166.0417C528.6684,-1172.2673 555.1611,-1180.728 578,-1191 595.1011,-1198.6914 596.6579,-1205.8687 614,-1213 621.8094,-1216.2113 630.2155,-1218.9947 638.6333,-1221.3894"/>
<polygon fill="#000000" stroke="#000000" points="637.9206,-1224.8217 648.4854,-1224.0243 639.7293,-1218.0594 637.9206,-1224.8217"/>
</g>
<!-- proc~update_triang_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node94" class="node">
<title>proc~update_triang_matrix</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node94"><a xlink:href="../proc/update_triang_matrix.html" xlink:title="update_triang_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="766.5,-1036 639.5,-1036 639.5,-1012 766.5,-1012 766.5,-1036"/>
<text text-anchor="middle" x="703" y="-1021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">update_triang_matrix</text>
</a>
</g>
</g>
<!-- proc~multipole_integrals&#45;&gt;proc~update_triang_matrix -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge130" class="edge">
<title>proc~multipole_integrals&#45;&gt;proc~update_triang_matrix</title>
<path fill="none" stroke="#000000" d="M514.8026,-1155.4049C536.6139,-1153.1952 560.3864,-1147.1609 578,-1133 610.9335,-1106.5223 581.8739,-1072.4516 614,-1045 618.6392,-1041.0358 623.8917,-1037.7886 629.4688,-1035.1325"/>
<polygon fill="#000000" stroke="#000000" points="631.1736,-1038.2171 639.1099,-1031.1982 628.5287,-1031.7359 631.1736,-1038.2171"/>
</g>
<!-- proc~oqp_dgemv_i64&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge132" class="edge">
<title>proc~oqp_dgemv_i64&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M751.7444,-1347.4945C837.7544,-1332.2924 1008.3527,-1301.1893 1018,-1292 1083.317,-1229.784 1122.4872,-937.5396 1132.4601,-854.2219"/>
<polygon fill="#000000" stroke="#000000" points="1135.9585,-854.4399 1133.65,-844.0997 1129.0064,-853.6226 1135.9585,-854.4399"/>
</g>
<!-- dgemv -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node63" class="node">
<title>dgemv</title>
<polygon fill="#777777" stroke="#777777" points="950,-1368 896,-1368 896,-1344 950,-1344 950,-1368"/>
<text text-anchor="middle" x="923" y="-1353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dgemv</text>
</g>
<!-- proc~oqp_dgemv_i64&#45;&gt;dgemv -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge131" class="edge">
<title>proc~oqp_dgemv_i64&#45;&gt;dgemv</title>
<path fill="none" stroke="#000000" d="M751.5523,-1356C791.9769,-1356 848.7032,-1356 885.65,-1356"/>
<polygon fill="#000000" stroke="#000000" points="885.9785,-1359.5001 895.9785,-1356 885.9785,-1352.5001 885.9785,-1359.5001"/>
</g>
<!-- proc~oqp_dsymm_i64&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge134" class="edge">
<title>proc~oqp_dsymm_i64&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M752.5401,-568.9506C838.5171,-584.6402 1007.2721,-616.1876 1018,-624 1083.1475,-671.4428 1116.8418,-766.875 1129.2688,-809.9789"/>
<polygon fill="#000000" stroke="#000000" points="1125.9327,-811.0468 1131.9762,-819.749 1132.6785,-809.1775 1125.9327,-811.0468"/>
</g>
<!-- dsymm -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node66" class="node">
<title>dsymm</title>
<polygon fill="#777777" stroke="#777777" points="950,-572 896,-572 896,-548 950,-548 950,-572"/>
<text text-anchor="middle" x="923" y="-557.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dsymm</text>
</g>
<!-- proc~oqp_dsymm_i64&#45;&gt;dsymm -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge133" class="edge">
<title>proc~oqp_dsymm_i64&#45;&gt;dsymm</title>
<path fill="none" stroke="#000000" d="M752.6466,-560C793.0176,-560 849.0974,-560 885.7108,-560"/>
<polygon fill="#000000" stroke="#000000" points="885.9505,-563.5001 895.9505,-560 885.9505,-556.5001 885.9505,-563.5001"/>
</g>
<!-- proc~oqp_dtpttr_i64&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge136" class="edge">
<title>proc~oqp_dtpttr_i64&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M747.532,-514.4713C823.9983,-511.0331 976.0936,-508.4259 1018,-539 1108.6592,-605.1431 1129.1456,-753.0887 1133.7123,-809.532"/>
<polygon fill="#000000" stroke="#000000" points="1130.2447,-810.1125 1134.4472,-819.8382 1137.227,-809.6145 1130.2447,-810.1125"/>
</g>
<!-- dtpttr -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node67" class="node">
<title>dtpttr</title>
<polygon fill="#777777" stroke="#777777" points="950,-492 896,-492 896,-468 950,-468 950,-492"/>
<text text-anchor="middle" x="923" y="-477.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dtpttr</text>
</g>
<!-- proc~oqp_dtpttr_i64&#45;&gt;dtpttr -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge135" class="edge">
<title>proc~oqp_dtpttr_i64&#45;&gt;dtpttr</title>
<path fill="none" stroke="#000000" d="M747.5203,-509.5125C788.1474,-502.6797 847.5111,-492.6959 885.7018,-486.2729"/>
<polygon fill="#000000" stroke="#000000" points="886.598,-489.6714 895.879,-484.5613 885.4369,-482.7683 886.598,-489.6714"/>
</g>
<!-- proc~oqp_dtrttp_i64&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge138" class="edge">
<title>proc~oqp_dtrttp_i64&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M967.5764,-438.5109C985.1944,-440.9012 1004.4311,-446.5555 1018,-459 1071.7601,-508.305 1117.7323,-737.8114 1131.0891,-810.1214"/>
<polygon fill="#000000" stroke="#000000" points="1127.6476,-810.7592 1132.8849,-819.969 1134.534,-809.5033 1127.6476,-810.7592"/>
</g>
<!-- dtrttp -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node68" class="node">
<title>dtrttp</title>
<polygon fill="#777777" stroke="#777777" points="1162,-450 1108,-450 1108,-426 1162,-426 1162,-450"/>
<text text-anchor="middle" x="1135" y="-435.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dtrttp</text>
</g>
<!-- proc~oqp_dtrttp_i64&#45;&gt;dtrttp -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge137" class="edge">
<title>proc~oqp_dtrttp_i64&#45;&gt;dtrttp</title>
<path fill="none" stroke="#000000" d="M967.7007,-438C1006.2885,-438 1061.3894,-438 1097.6616,-438"/>
<polygon fill="#000000" stroke="#000000" points="1097.8188,-441.5001 1107.8188,-438 1097.8187,-434.5001 1097.8188,-441.5001"/>
</g>
<!-- proc~unpack_f90&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge139" class="edge">
<title>proc~unpack_f90&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M494.0496,-385.9297C591.7314,-356.6207 859.6337,-292.8358 1018,-417 1081.8687,-467.0751 1121.4818,-730.057 1132.1073,-809.3494"/>
<polygon fill="#000000" stroke="#000000" points="1128.6903,-810.2099 1133.4641,-819.6682 1135.6305,-809.2972 1128.6903,-810.2099"/>
</g>
<!-- proc~unpack_f90&#45;&gt;proc~oqp_dtpttr_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge140" class="edge">
<title>proc~unpack_f90&#45;&gt;proc~oqp_dtpttr_i64</title>
<path fill="none" stroke="#000000" d="M481.9416,-410.0652C526.2364,-431.4924 618.6766,-476.2094 668.8437,-500.4772"/>
<polygon fill="#000000" stroke="#000000" points="667.4662,-503.6988 677.9924,-504.9028 670.5145,-497.3974 667.4662,-503.6988"/>
</g>
<!-- unused_dummy -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node158" class="node">
<title>unused_dummy</title>
<polygon fill="#777777" stroke="#777777" points="1183.5,-2169 1086.5,-2169 1086.5,-2145 1183.5,-2145 1183.5,-2169"/>
<text text-anchor="middle" x="1135" y="-2154.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">unused_dummy</text>
</g>
<!-- none~screen_ij&#45;&gt;unused_dummy -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge141" class="edge">
<title>none~screen_ij&#45;&gt;unused_dummy</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1013.522,-2156.427C1034.6999,-2156.5269 1056.7203,-2156.6308 1076.1029,-2156.7222"/>
<polygon fill="#000000" stroke="#000000" points="1076.2613,-2160.2229 1086.2777,-2156.7702 1076.2944,-2153.2229 1076.2613,-2160.2229"/>
</g>
<!-- none~screen_ijkl&#45;&gt;unused_dummy -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge142" class="edge">
<title>none~screen_ijkl&#45;&gt;unused_dummy</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M980.9299,-2125.0232C1010.6691,-2131.1955 1046.8128,-2138.697 1076.6167,-2144.8827"/>
<polygon fill="#000000" stroke="#000000" points="1075.96,-2148.3209 1086.4626,-2146.9262 1077.3826,-2141.467 1075.96,-2148.3209"/>
</g>
<!-- proc~mulquadgausshermite -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node142" class="node">
<title>proc~mulquadgausshermite</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node142"><a xlink:href="../proc/mulquadgausshermite.html" xlink:title="mulQuadGaussHermite">
<polygon fill="#d9534f" stroke="#d9534f" points="991.5,-1524 854.5,-1524 854.5,-1500 991.5,-1500 991.5,-1524"/>
<text text-anchor="middle" x="923" y="-1509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mulQuadGaussHermite</text>
</a>
</g>
</g>
<!-- proc~comp_allmult_int1_prim&#45;&gt;proc~mulquadgausshermite -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge143" class="edge">
<title>proc~comp_allmult_int1_prim&#45;&gt;proc~mulquadgausshermite</title>
<path fill="none" stroke="#000000" d="M773.2142,-1499.064C795.7797,-1501.0128 820.9267,-1503.1846 844.0739,-1505.1837"/>
<polygon fill="#000000" stroke="#000000" points="843.9397,-1508.685 854.2038,-1506.0585 844.5421,-1501.711 843.9397,-1508.685"/>
</g>
<!-- fgrid -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node131" class="node">
<title>fgrid</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2824 1379.5,-2824 1379.5,-2800 1433.5,-2800 1433.5,-2824"/>
<text text-anchor="middle" x="1406.5" y="-2809.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fgrid</text>
</g>
<!-- proc~genr22&#45;&gt;fgrid -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge144" class="edge">
<title>proc~genr22&#45;&gt;fgrid</title>
<path fill="none" stroke="#000000" d="M1162.3315,-1946.314C1180.5079,-1947.4615 1203.2961,-1952.3037 1216,-1968 1273.5844,-2039.1486 1190.3009,-2723.3886 1252,-2791 1281.0631,-2822.8481 1333.769,-2823.195 1369.4473,-2818.9109"/>
<polygon fill="#000000" stroke="#000000" points="1370.0457,-2822.3617 1379.4761,-2817.5327 1369.0926,-2815.4268 1370.0457,-2822.3617"/>
</g>
<!-- rfinc -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node146" class="node">
<title>rfinc</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2782 1379.5,-2782 1379.5,-2758 1433.5,-2758 1433.5,-2782"/>
<text text-anchor="middle" x="1406.5" y="-2767.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rfinc</text>
</g>
<!-- proc~genr22&#45;&gt;rfinc -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge145" class="edge">
<title>proc~genr22&#45;&gt;rfinc</title>
<path fill="none" stroke="#000000" d="M1162.32,-1946.3234C1180.491,-1947.4751 1203.2777,-1952.3186 1216,-1968 1270.7307,-2035.4606 1193.3681,-2684.901 1252,-2749 1281.1004,-2780.8139 1333.7973,-2781.1692 1369.4633,-2776.8963"/>
<polygon fill="#000000" stroke="#000000" points="1370.0567,-2780.3478 1379.4884,-2775.5214 1369.1056,-2773.4127 1370.0567,-2780.3478"/>
</g>
<!-- rmr -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node151" class="node">
<title>rmr</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2866 1379.5,-2866 1379.5,-2842 1433.5,-2842 1433.5,-2866"/>
<text text-anchor="middle" x="1406.5" y="-2851.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rmr</text>
</g>
<!-- proc~genr22&#45;&gt;rmr -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge146" class="edge">
<title>proc~genr22&#45;&gt;rmr</title>
<path fill="none" stroke="#000000" d="M1162.3419,-1946.3056C1180.5231,-1947.4492 1203.3128,-1952.2902 1216,-1968 1276.4383,-2042.8369 1187.2334,-2761.8759 1252,-2833 1281.0293,-2864.8788 1333.7435,-2865.2183 1369.4328,-2860.9241"/>
<polygon fill="#000000" stroke="#000000" points="1370.0358,-2864.3742 1379.4649,-2859.5429 1369.081,-2857.4396 1370.0358,-2864.3742"/>
</g>
<!-- xgrid -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node165" class="node">
<title>xgrid</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2908 1379.5,-2908 1379.5,-2884 1433.5,-2884 1433.5,-2908"/>
<text text-anchor="middle" x="1406.5" y="-2893.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">xgrid</text>
</g>
<!-- proc~genr22&#45;&gt;xgrid -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge147" class="edge">
<title>proc~genr22&#45;&gt;xgrid</title>
<path fill="none" stroke="#000000" d="M1162.3514,-1946.2979C1180.5369,-1947.438 1203.3279,-1952.278 1216,-1968 1279.2924,-2046.5254 1184.1658,-2800.363 1252,-2875 1280.9986,-2906.9068 1333.7203,-2907.2394 1369.4197,-2902.9361"/>
<polygon fill="#000000" stroke="#000000" points="1370.0268,-2906.3856 1379.4548,-2901.5521 1369.0704,-2899.4512 1370.0268,-2906.3856"/>
</g>
<!-- none~evaluate -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node135" class="node">
<title>none~evaluate</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node135"><a xlink:href="../type/rys_root_t.html#boundprocedure-evaluate" xlink:title="rys_root_t%evaluate">
<polygon fill="#a7506f" stroke="#a7506f" points="1467,-2950 1346,-2950 1346,-2926 1467,-2926 1467,-2950"/>
<text text-anchor="middle" x="1406.5" y="-2935.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rys_root_t%evaluate</text>
</a>
</g>
</g>
<!-- proc~int2_rys_compute&#45;&gt;none~evaluate -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge148" class="edge">
<title>proc~int2_rys_compute&#45;&gt;none~evaluate</title>
<path fill="none" stroke="#000000" d="M1188.1281,-1992.6692C1198.8552,-1995.9208 1208.9802,-2001.2907 1216,-2010 1279.2924,-2088.5254 1184.1658,-2842.363 1252,-2917 1272.7738,-2939.8571 1305.7219,-2946.5107 1335.865,-2946.8642"/>
<polygon fill="#000000" stroke="#000000" points="1335.9961,-2950.3631 1345.9583,-2946.7569 1335.9217,-2943.3635 1335.9961,-2950.3631"/>
</g>
<!-- ab_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node96" class="node">
<title>ab_x</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2404 1379.5,-2404 1379.5,-2380 1433.5,-2380 1433.5,-2404"/>
<text text-anchor="middle" x="1406.5" y="-2389.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ab_x</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;ab_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge149" class="edge">
<title>proc~libint_compute_eri&#45;&gt;ab_x</title>
<path fill="none" stroke="#000000" d="M1140.0918,-1690.1114C1154.7631,-1725.6042 1197.2704,-1832.7451 1216,-1926 1225.768,-1974.6348 1217.8897,-2334.9828 1252,-2371 1281.5627,-2402.2154 1333.9104,-2402.7816 1369.3929,-2398.7134"/>
<polygon fill="#000000" stroke="#000000" points="1369.9127,-2402.1752 1379.3695,-2397.3982 1368.9978,-2395.2353 1369.9127,-2402.1752"/>
</g>
<!-- ab_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node97" class="node">
<title>ab_y</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2362 1379.5,-2362 1379.5,-2338 1433.5,-2338 1433.5,-2362"/>
<text text-anchor="middle" x="1406.5" y="-2347.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ab_y</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;ab_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge150" class="edge">
<title>proc~libint_compute_eri&#45;&gt;ab_y</title>
<path fill="none" stroke="#000000" d="M1140.054,-1690.1191C1154.6229,-1725.6327 1196.8802,-1832.8243 1216,-1926 1234.0735,-2014.0769 1189.9015,-2263.9771 1252,-2329 1281.6931,-2360.0914 1334.0094,-2360.6874 1369.4493,-2356.6598"/>
<polygon fill="#000000" stroke="#000000" points="1369.9513,-2360.124 1379.413,-2355.3568 1369.0436,-2353.1831 1369.9513,-2360.124"/>
</g>
<!-- ab_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node98" class="node">
<title>ab_z</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2320 1379.5,-2320 1379.5,-2296 1433.5,-2296 1433.5,-2320"/>
<text text-anchor="middle" x="1406.5" y="-2305.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ab_z</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;ab_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge151" class="edge">
<title>proc~libint_compute_eri&#45;&gt;ab_z</title>
<path fill="none" stroke="#000000" d="M1140.0076,-1690.1287C1154.4505,-1725.6685 1196.4006,-1832.9241 1216,-1926 1232.6122,-2004.89 1196.0196,-2228.9845 1252,-2287 1281.8528,-2317.9381 1334.1306,-2318.571 1369.5183,-2314.5935"/>
<polygon fill="#000000" stroke="#000000" points="1369.9986,-2318.0606 1379.4664,-2313.3055 1369.0998,-2311.1185 1369.9986,-2318.0606"/>
</g>
<!-- alpha1over_zetapluseta -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node99" class="node">
<title>alpha1over_zetapluseta</title>
<polygon fill="#777777" stroke="#777777" points="1476.5,-2278 1336.5,-2278 1336.5,-2254 1476.5,-2254 1476.5,-2278"/>
<text text-anchor="middle" x="1406.5" y="-2263.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alpha1over_zetapluseta</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;alpha1over_zetapluseta -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge152" class="edge">
<title>proc~libint_compute_eri&#45;&gt;alpha1over_zetapluseta</title>
<path fill="none" stroke="#000000" d="M1139.9491,-1690.1413C1154.2336,-1725.7149 1195.7968,-1833.0532 1216,-1926 1231.1526,-1995.7111 1202.132,-2193.9861 1252,-2245 1271.044,-2264.4816 1298.9931,-2271.8911 1325.902,-2273.7094"/>
<polygon fill="#000000" stroke="#000000" points="1326.0035,-2277.2168 1336.1435,-2274.146 1326.3017,-2270.2232 1326.0035,-2277.2168"/>
</g>
<!-- alpha1rho_over_zeta2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node100" class="node">
<title>alpha1rho_over_zeta2</title>
<polygon fill="#777777" stroke="#777777" points="1472,-2236 1341,-2236 1341,-2212 1472,-2212 1472,-2236"/>
<text text-anchor="middle" x="1406.5" y="-2221.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alpha1rho_over_zeta2</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;alpha1rho_over_zeta2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge153" class="edge">
<title>proc~libint_compute_eri&#45;&gt;alpha1rho_over_zeta2</title>
<path fill="none" stroke="#000000" d="M1139.8732,-1690.1581C1153.9522,-1725.7773 1195.0139,-1833.2269 1216,-1926 1229.6955,-1986.5435 1208.2363,-2158.9793 1252,-2203 1272.2271,-2223.3458 1302.1869,-2230.4446 1330.3539,-2231.7777"/>
<polygon fill="#000000" stroke="#000000" points="1330.5485,-2235.2832 1340.6288,-2232.0218 1330.7148,-2228.2852 1330.5485,-2235.2832"/>
</g>
<!-- alpha2over_zetapluseta -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node101" class="node">
<title>alpha2over_zetapluseta</title>
<polygon fill="#777777" stroke="#777777" points="1476.5,-2194 1336.5,-2194 1336.5,-2170 1476.5,-2170 1476.5,-2194"/>
<text text-anchor="middle" x="1406.5" y="-2179.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alpha2over_zetapluseta</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;alpha2over_zetapluseta -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge154" class="edge">
<title>proc~libint_compute_eri&#45;&gt;alpha2over_zetapluseta</title>
<path fill="none" stroke="#000000" d="M1139.7711,-1690.1818C1153.5731,-1725.8654 1193.959,-1833.4718 1216,-1926 1228.2423,-1977.3934 1214.3279,-2123.9598 1252,-2161 1271.3407,-2180.0163 1299.2103,-2187.3637 1325.9693,-2189.2633"/>
<polygon fill="#000000" stroke="#000000" points="1325.9984,-2192.7684 1336.1504,-2189.7377 1326.3242,-2185.776 1325.9984,-2192.7684"/>
</g>
<!-- alpha2rho_over_zeta2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node102" class="node">
<title>alpha2rho_over_zeta2</title>
<polygon fill="#777777" stroke="#777777" points="1472,-2152 1341,-2152 1341,-2128 1472,-2128 1472,-2152"/>
<text text-anchor="middle" x="1406.5" y="-2137.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alpha2rho_over_zeta2</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;alpha2rho_over_zeta2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge155" class="edge">
<title>proc~libint_compute_eri&#45;&gt;alpha2rho_over_zeta2</title>
<path fill="none" stroke="#000000" d="M1139.6262,-1690.2176C1153.0355,-1725.998 1192.4631,-1833.841 1216,-1926 1237.592,-2010.5436 1188.7974,-2058.8398 1252,-2119 1272.6932,-2138.6971 1302.5832,-2145.7226 1330.57,-2147.1769"/>
<polygon fill="#000000" stroke="#000000" points="1330.6766,-2150.6814 1340.7742,-2147.4737 1330.8802,-2143.6843 1330.6766,-2150.6814"/>
</g>
<!-- alpha3over_zetapluseta -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node103" class="node">
<title>alpha3over_zetapluseta</title>
<polygon fill="#777777" stroke="#777777" points="1476.5,-2110 1336.5,-2110 1336.5,-2086 1476.5,-2086 1476.5,-2110"/>
<text text-anchor="middle" x="1406.5" y="-2095.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alpha3over_zetapluseta</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;alpha3over_zetapluseta -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge156" class="edge">
<title>proc~libint_compute_eri&#45;&gt;alpha3over_zetapluseta</title>
<path fill="none" stroke="#000000" d="M1139.3143,-1690.0214C1152.0354,-1725.7026 1190.1221,-1834.2354 1216,-1926 1234.7257,-1992.4022 1200.8624,-2030.6875 1252,-2077 1271.9263,-2095.0461 1299.644,-2102.2511 1326.1091,-2104.3104"/>
<polygon fill="#000000" stroke="#000000" points="1325.996,-2107.8094 1336.1719,-2104.8596 1326.3775,-2100.8198 1325.996,-2107.8094"/>
</g>
<!-- alpha3rho_over_eta2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node104" class="node">
<title>alpha3rho_over_eta2</title>
<polygon fill="#777777" stroke="#777777" points="1469.5,-2068 1343.5,-2068 1343.5,-2044 1469.5,-2044 1469.5,-2068"/>
<text text-anchor="middle" x="1406.5" y="-2053.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alpha3rho_over_eta2</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;alpha3rho_over_eta2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge157" class="edge">
<title>proc~libint_compute_eri&#45;&gt;alpha3rho_over_eta2</title>
<path fill="none" stroke="#000000" d="M1139.0108,-1690.275C1159.5015,-1752.981 1251.5547,-2034.629 1252,-2035 1274.2277,-2053.5177 1304.824,-2060.234 1332.9273,-2061.775"/>
<polygon fill="#000000" stroke="#000000" points="1333.0355,-2065.2806 1343.1482,-2062.1209 1333.2724,-2058.2846 1333.0355,-2065.2806"/>
</g>
<!-- alpha4over_zetapluseta -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node105" class="node">
<title>alpha4over_zetapluseta</title>
<polygon fill="#777777" stroke="#777777" points="1476.5,-2026 1336.5,-2026 1336.5,-2002 1476.5,-2002 1476.5,-2026"/>
<text text-anchor="middle" x="1406.5" y="-2011.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alpha4over_zetapluseta</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;alpha4over_zetapluseta -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge158" class="edge">
<title>proc~libint_compute_eri&#45;&gt;alpha4over_zetapluseta</title>
<path fill="none" stroke="#000000" d="M1138.7174,-1690.2046C1155.7315,-1745.7143 1226.4405,-1972.5362 1252,-1993 1272.6137,-2009.504 1299.9515,-2016.4794 1325.8957,-2018.7915"/>
<polygon fill="#000000" stroke="#000000" points="1325.9233,-2022.3011 1336.1349,-2019.4772 1326.3911,-2015.3168 1325.9233,-2022.3011"/>
</g>
<!-- alpha4rho_over_eta2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node106" class="node">
<title>alpha4rho_over_eta2</title>
<polygon fill="#777777" stroke="#777777" points="1469.5,-1984 1343.5,-1984 1343.5,-1960 1469.5,-1960 1469.5,-1984"/>
<text text-anchor="middle" x="1406.5" y="-1969.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">alpha4rho_over_eta2</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;alpha4rho_over_eta2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge159" class="edge">
<title>proc~libint_compute_eri&#45;&gt;alpha4rho_over_eta2</title>
<path fill="none" stroke="#000000" d="M1136.0869,-1690.058C1140.7004,-1733.5101 1162.7498,-1883.0812 1252,-1951 1274.8306,-1968.3739 1305.2382,-1974.9615 1333.036,-1976.7161"/>
<polygon fill="#000000" stroke="#000000" points="1332.9979,-1980.2176 1343.1404,-1977.1548 1333.3017,-1973.2242 1332.9979,-1980.2176"/>
</g>
<!-- cd_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node107" class="node">
<title>cd_x</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-1942 1379.5,-1942 1379.5,-1918 1433.5,-1918 1433.5,-1942"/>
<text text-anchor="middle" x="1406.5" y="-1927.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cd_x</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;cd_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge160" class="edge">
<title>proc~libint_compute_eri&#45;&gt;cd_x</title>
<path fill="none" stroke="#000000" d="M1137.0852,-1690.1085C1144.523,-1729.2755 1173.62,-1853.2175 1252,-1909 1286.1296,-1933.2898 1335.4539,-1935.8871 1369.1309,-1934.1421"/>
<polygon fill="#000000" stroke="#000000" points="1369.7341,-1937.6095 1379.4761,-1933.445 1369.2634,-1930.6253 1369.7341,-1937.6095"/>
</g>
<!-- cd_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node108" class="node">
<title>cd_y</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-1900 1379.5,-1900 1379.5,-1876 1433.5,-1876 1433.5,-1900"/>
<text text-anchor="middle" x="1406.5" y="-1885.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cd_y</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;cd_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge161" class="edge">
<title>proc~libint_compute_eri&#45;&gt;cd_y</title>
<path fill="none" stroke="#000000" d="M1138.5422,-1690.3316C1149.1769,-1724.9023 1184.3497,-1823.0834 1252,-1867 1286.9314,-1889.6764 1335.6779,-1892.6815 1369.0183,-1891.4692"/>
<polygon fill="#000000" stroke="#000000" points="1369.4558,-1894.9515 1379.2647,-1890.9469 1369.0995,-1887.9606 1369.4558,-1894.9515"/>
</g>
<!-- cd_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node109" class="node">
<title>cd_z</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-1858 1379.5,-1858 1379.5,-1834 1433.5,-1834 1433.5,-1858"/>
<text text-anchor="middle" x="1406.5" y="-1843.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cd_z</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;cd_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge162" class="edge">
<title>proc~libint_compute_eri&#45;&gt;cd_z</title>
<path fill="none" stroke="#000000" d="M1140.5659,-1690.0862C1154.5946,-1719.0194 1194.4341,-1792.2825 1252,-1825 1288.101,-1845.518 1336.4117,-1848.9868 1369.3375,-1848.4716"/>
<polygon fill="#000000" stroke="#000000" points="1369.5568,-1851.9669 1379.4521,-1848.1809 1369.3557,-1844.9697 1369.5568,-1851.9669"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_0 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node110" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_0</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1816 1255.5,-1816 1255.5,-1792 1557.5,-1792 1557.5,-1816"/>
<text text-anchor="middle" x="1406.5" y="-1801.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_0</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_0 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge163" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_0</title>
<path fill="none" stroke="#000000" d="M1144.3636,-1690.2814C1162.4071,-1712.9378 1204.4393,-1761.0005 1252,-1783 1256.4492,-1785.058 1261.0421,-1786.9299 1265.736,-1788.6318"/>
<polygon fill="#000000" stroke="#000000" points="1264.9056,-1792.0444 1275.4993,-1791.8914 1267.1224,-1785.4047 1264.9056,-1792.0444"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_1 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node111" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_1</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1774 1255.5,-1774 1255.5,-1750 1557.5,-1750 1557.5,-1774"/>
<text text-anchor="middle" x="1406.5" y="-1759.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_1</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_1 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge164" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_1</title>
<path fill="none" stroke="#000000" d="M1152.7231,-1690.1878C1174.8847,-1704.7862 1214.4854,-1728.7959 1252,-1741 1259.8633,-1743.5581 1268.0498,-1745.8046 1276.3705,-1747.7777"/>
<polygon fill="#000000" stroke="#000000" points="1275.666,-1751.2065 1286.1885,-1749.9704 1277.1919,-1744.3748 1275.666,-1751.2065"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_10 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node112" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_10</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1732 1252,-1732 1252,-1708 1561,-1708 1561,-1732"/>
<text text-anchor="middle" x="1406.5" y="-1717.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_10</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_10 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge165" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_10</title>
<path fill="none" stroke="#000000" d="M1190.5644,-1688.4714C1209.9715,-1691.9964 1231.9204,-1695.8348 1252,-1699 1268.5408,-1701.6074 1286.109,-1704.1808 1303.2421,-1706.5845"/>
<polygon fill="#000000" stroke="#000000" points="1302.8817,-1710.068 1313.2686,-1707.9791 1303.8461,-1703.1347 1302.8817,-1710.068"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_11 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node113" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_11</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1690 1252,-1690 1252,-1666 1561,-1666 1561,-1690"/>
<text text-anchor="middle" x="1406.5" y="-1675.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_11</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_11 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge166" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_11</title>
<path fill="none" stroke="#000000" d="M1190.5972,-1678C1205.9778,-1678 1223.497,-1678 1241.75,-1678"/>
<polygon fill="#000000" stroke="#000000" points="1241.9571,-1681.5001 1251.9571,-1678 1241.9571,-1674.5001 1241.9571,-1681.5001"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_12 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node114" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_12</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1648 1252,-1648 1252,-1624 1561,-1624 1561,-1648"/>
<text text-anchor="middle" x="1406.5" y="-1633.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_12</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_12 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge167" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_12</title>
<path fill="none" stroke="#000000" d="M1190.5644,-1667.5286C1209.9715,-1664.0036 1231.9204,-1660.1652 1252,-1657 1268.5408,-1654.3926 1286.109,-1651.8192 1303.2421,-1649.4155"/>
<polygon fill="#000000" stroke="#000000" points="1303.8461,-1652.8653 1313.2686,-1648.0209 1302.8817,-1645.932 1303.8461,-1652.8653"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_13 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node115" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_13</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1606 1252,-1606 1252,-1582 1561,-1582 1561,-1606"/>
<text text-anchor="middle" x="1406.5" y="-1591.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_13</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_13 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge168" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_13</title>
<path fill="none" stroke="#000000" d="M1190.8837,-1668.314C1199.6678,-1665.4591 1208.3588,-1661.7685 1216,-1657 1236.8572,-1643.9839 1230.4081,-1626.7574 1252,-1615 1255.3469,-1613.1775 1258.7929,-1611.492 1262.317,-1609.9339"/>
<polygon fill="#000000" stroke="#000000" points="1263.8507,-1613.0892 1271.8135,-1606.1004 1261.2303,-1606.5982 1263.8507,-1613.0892"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_14 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node116" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_14</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1564 1252,-1564 1252,-1540 1561,-1540 1561,-1564"/>
<text text-anchor="middle" x="1406.5" y="-1549.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_14</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_14 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge169" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_14</title>
<path fill="none" stroke="#000000" d="M1190.6064,-1670.7932C1199.8209,-1667.6707 1208.7274,-1663.2483 1216,-1657 1246.8083,-1630.5307 1219.6774,-1597.5973 1252,-1573 1253.656,-1571.7398 1255.3519,-1570.5363 1257.0837,-1569.3874"/>
<polygon fill="#000000" stroke="#000000" points="1259.2082,-1572.1968 1266.0247,-1564.0859 1255.638,-1566.1756 1259.2082,-1572.1968"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_15 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node117" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_15</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1522 1252,-1522 1252,-1498 1561,-1498 1561,-1522"/>
<text text-anchor="middle" x="1406.5" y="-1507.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_15</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_15 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge170" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_15</title>
<path fill="none" stroke="#000000" d="M1190.8676,-1671.6771C1200.1649,-1668.475 1209.0332,-1663.7973 1216,-1657 1257.6865,-1616.3277 1207.9767,-1569.1307 1252,-1531 1253.3364,-1529.8425 1254.7051,-1528.7304 1256.1038,-1527.6621"/>
<polygon fill="#000000" stroke="#000000" points="1258.1168,-1530.5259 1264.4228,-1522.0121 1254.1839,-1524.7351 1258.1168,-1530.5259"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_16 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node118" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_16</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1480 1252,-1480 1252,-1456 1561,-1456 1561,-1480"/>
<text text-anchor="middle" x="1406.5" y="-1465.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_16</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_16 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge171" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_16</title>
<path fill="none" stroke="#000000" d="M1190.8324,-1672.1975C1200.2461,-1668.9574 1209.165,-1664.1324 1216,-1657 1268.8341,-1601.8668 1195.9918,-1540.9056 1252,-1489 1253.0051,-1488.0685 1254.0309,-1487.1656 1255.0762,-1486.2906"/>
<polygon fill="#000000" stroke="#000000" points="1257.4795,-1488.8671 1263.4508,-1480.1152 1253.3251,-1483.2332 1257.4795,-1488.8671"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_17 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node119" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_17</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1438 1252,-1438 1252,-1414 1561,-1414 1561,-1438"/>
<text text-anchor="middle" x="1406.5" y="-1423.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_17</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_17 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge172" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_17</title>
<path fill="none" stroke="#000000" d="M1190.6585,-1672.5663C1200.2038,-1669.3058 1209.2155,-1664.379 1216,-1657 1280.0925,-1587.2916 1183.8896,-1512.7881 1252,-1447 1252.9583,-1446.0744 1253.9369,-1445.1766 1254.9345,-1444.3059"/>
<polygon fill="#000000" stroke="#000000" points="1257.1463,-1447.0203 1262.9393,-1438.1495 1252.8788,-1441.4716 1257.1463,-1447.0203"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_18 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node120" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_18</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1396 1252,-1396 1252,-1372 1561,-1372 1561,-1396"/>
<text text-anchor="middle" x="1406.5" y="-1381.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_18</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_18 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge173" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_18</title>
<path fill="none" stroke="#000000" d="M1190.8242,-1672.7166C1200.3551,-1669.443 1209.319,-1664.4728 1216,-1657 1291.4063,-1572.6562 1171.7284,-1484.7274 1252,-1405 1252.9453,-1404.0611 1253.9114,-1403.1506 1254.897,-1402.2676"/>
<polygon fill="#000000" stroke="#000000" points="1257.1297,-1404.9644 1262.819,-1396.0266 1252.7978,-1399.4657 1257.1297,-1404.9644"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_19 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node121" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_19</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1354 1252,-1354 1252,-1330 1561,-1330 1561,-1354"/>
<text text-anchor="middle" x="1406.5" y="-1339.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_19</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_19 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge174" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_19</title>
<path fill="none" stroke="#000000" d="M1190.5304,-1672.9649C1200.2057,-1669.6847 1209.2985,-1664.6487 1216,-1657 1302.7519,-1557.9854 1159.5334,-1456.7001 1252,-1363 1252.8081,-1362.1811 1253.6319,-1361.3837 1254.4708,-1360.6071"/>
<polygon fill="#000000" stroke="#000000" points="1256.8447,-1363.1881 1262.4054,-1354.1698 1252.4345,-1357.7521 1256.8447,-1363.1881"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node122" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_2</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1312 1255.5,-1312 1255.5,-1288 1557.5,-1288 1557.5,-1312"/>
<text text-anchor="middle" x="1406.5" y="-1297.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_2</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge175" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_2</title>
<path fill="none" stroke="#000000" d="M1190.6222,-1673.0447C1200.29,-1669.7579 1209.3565,-1664.6991 1216,-1657 1265.0586,-1600.1461 1199.6587,-1374.847 1252,-1321 1252.8019,-1320.1751 1253.6197,-1319.3717 1254.4528,-1318.5895"/>
<polygon fill="#000000" stroke="#000000" points="1256.8376,-1321.1599 1262.3404,-1312.1062 1252.3927,-1315.7522 1256.8376,-1321.1599"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_20 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node123" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_20</title>
<polygon fill="#777777" stroke="#777777" points="1561,-1270 1252,-1270 1252,-1246 1561,-1246 1561,-1270"/>
<text text-anchor="middle" x="1406.5" y="-1255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_20</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_20 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge176" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_20</title>
<path fill="none" stroke="#000000" d="M1190.6942,-1673.1065C1200.3561,-1669.8146 1209.402,-1664.7381 1216,-1657 1270.7478,-1592.7919 1193.5438,-1339.8512 1252,-1279 1252.797,-1278.1703 1253.6101,-1277.3624 1254.4386,-1276.5758"/>
<polygon fill="#000000" stroke="#000000" points="1256.8318,-1279.138 1262.2895,-1270.0569 1252.36,-1273.7525 1256.8318,-1279.138"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_3 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node124" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_3</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1228 1255.5,-1228 1255.5,-1204 1557.5,-1204 1557.5,-1228"/>
<text text-anchor="middle" x="1406.5" y="-1213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_3</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_3 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge177" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_3</title>
<path fill="none" stroke="#000000" d="M1190.7522,-1673.1557C1200.4093,-1669.8598 1209.4386,-1664.7692 1216,-1657 1276.4415,-1585.4323 1187.4239,-1304.8605 1252,-1237 1252.7931,-1236.1666 1253.6024,-1235.3551 1254.4272,-1234.5649"/>
<polygon fill="#000000" stroke="#000000" points="1256.8271,-1237.1204 1262.2484,-1228.0177 1252.3338,-1231.7529 1256.8271,-1237.1204"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_4 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node125" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_4</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1186 1255.5,-1186 1255.5,-1162 1557.5,-1162 1557.5,-1186"/>
<text text-anchor="middle" x="1406.5" y="-1171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_4</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_4 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge178" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_4</title>
<path fill="none" stroke="#000000" d="M1190.7999,-1673.1958C1200.453,-1669.8966 1209.4687,-1664.7946 1216,-1657 1282.1386,-1578.0688 1181.3005,-1269.8734 1252,-1195 1252.6708,-1194.2896 1253.3534,-1193.5951 1254.0473,-1192.9161"/>
<polygon fill="#000000" stroke="#000000" points="1256.5578,-1195.375 1261.8945,-1186.2224 1252.0149,-1190.0494 1256.5578,-1195.375"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_5 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node126" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_5</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1144 1255.5,-1144 1255.5,-1120 1557.5,-1120 1557.5,-1144"/>
<text text-anchor="middle" x="1406.5" y="-1129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_5</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_5 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge179" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_5</title>
<path fill="none" stroke="#000000" d="M1190.8398,-1673.2291C1200.4897,-1669.9272 1209.4939,-1664.8156 1216,-1657 1287.8382,-1570.7024 1175.1745,-1234.8892 1252,-1153 1252.6685,-1152.2874 1253.3488,-1151.5908 1254.0406,-1150.9098"/>
<polygon fill="#000000" stroke="#000000" points="1256.5555,-1153.3638 1261.8669,-1144.1965 1251.998,-1148.0507 1256.5555,-1153.3638"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_6 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node127" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_6</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1102 1255.5,-1102 1255.5,-1078 1557.5,-1078 1557.5,-1102"/>
<text text-anchor="middle" x="1406.5" y="-1087.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_6</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_6 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge180" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_6</title>
<path fill="none" stroke="#000000" d="M1190.8737,-1673.2573C1200.5207,-1669.953 1209.5153,-1664.8334 1216,-1657 1293.5396,-1563.3337 1169.0464,-1199.9071 1252,-1111 1252.6665,-1110.2856 1253.345,-1109.5872 1254.0349,-1108.9045"/>
<polygon fill="#000000" stroke="#000000" points="1256.5536,-1111.3543 1261.8435,-1102.1746 1251.9836,-1106.0519 1256.5536,-1111.3543"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_7 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node128" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_7</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1060 1255.5,-1060 1255.5,-1036 1557.5,-1036 1557.5,-1060"/>
<text text-anchor="middle" x="1406.5" y="-1045.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_7</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_7 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge181" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_7</title>
<path fill="none" stroke="#000000" d="M1190.9028,-1673.2813C1200.5475,-1669.975 1209.5337,-1664.8485 1216,-1657 1299.2426,-1555.9631 1162.9167,-1164.9268 1252,-1069 1252.6649,-1068.2841 1253.3417,-1067.5841 1254.03,-1066.8999"/>
<polygon fill="#000000" stroke="#000000" points="1256.5519,-1069.3462 1261.8234,-1060.1558 1251.9713,-1064.0529 1256.5519,-1069.3462"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_8 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node129" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_8</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-1018 1255.5,-1018 1255.5,-994 1557.5,-994 1557.5,-1018"/>
<text text-anchor="middle" x="1406.5" y="-1003.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_8</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_8 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge182" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_8</title>
<path fill="none" stroke="#000000" d="M1190.5145,-1673.4428C1200.3136,-1670.1402 1209.4575,-1664.974 1216,-1657 1304.9467,-1548.5912 1156.7858,-1129.9478 1252,-1027 1252.6634,-1026.2827 1253.3388,-1025.5815 1254.0258,-1024.896"/>
<polygon fill="#000000" stroke="#000000" points="1256.5504,-1027.3391 1261.8059,-1018.1396 1251.9606,-1022.0539 1256.5504,-1027.3391"/>
</g>
<!-- f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_9 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node130" class="node">
<title>f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_9</title>
<polygon fill="#777777" stroke="#777777" points="1557.5,-976 1255.5,-976 1255.5,-952 1557.5,-952 1557.5,-976"/>
<text text-anchor="middle" x="1406.5" y="-961.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_9</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_9 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge183" class="edge">
<title>proc~libint_compute_eri&#45;&gt;f_ab_s___0__s___1___twoprep_s___0__s___1___ab__up_9</title>
<path fill="none" stroke="#000000" d="M1190.5367,-1673.461C1200.3342,-1670.157 1209.4717,-1664.9856 1216,-1657 1310.6518,-1541.218 1150.6538,-1094.97 1252,-985 1252.6621,-984.2815 1253.3363,-983.5791 1254.022,-982.8925"/>
<polygon fill="#000000" stroke="#000000" points="1256.5491,-985.333 1261.7905,-976.1255 1251.9512,-980.0547 1256.5491,-985.333"/>
</g>
<!-- proc~libint_compute_eri&#45;&gt;fgrid -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge184" class="edge">
<title>proc~libint_compute_eri&#45;&gt;fgrid</title>
<path fill="none" stroke="#000000" d="M1140.2689,-1690.0777C1155.42,-1725.4789 1199.0983,-1832.3966 1216,-1926 1224.5466,-1973.3317 1219.6167,-2755.438 1252,-2791 1281.0293,-2822.8788 1333.7435,-2823.2183 1369.4328,-2818.9241"/>
<polygon fill="#000000" stroke="#000000" points="1370.0358,-2822.3742 1379.4649,-2817.5429 1369.081,-2815.4396 1370.0358,-2822.3742"/>
</g>
<!-- igrid -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node132" class="node">
<title>igrid</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-934 1379.5,-934 1379.5,-910 1433.5,-910 1433.5,-934"/>
<text text-anchor="middle" x="1406.5" y="-919.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">igrid</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;igrid -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge185" class="edge">
<title>proc~libint_compute_eri&#45;&gt;igrid</title>
<path fill="none" stroke="#000000" d="M1190.5564,-1673.477C1200.3523,-1670.1718 1209.4843,-1664.9959 1216,-1657 1266.1789,-1595.4219 1198.2605,-1001.4965 1252,-943 1281.0857,-911.3397 1333.5482,-910.8806 1369.1867,-915.0943"/>
<polygon fill="#000000" stroke="#000000" points="1368.8305,-918.5779 1379.2101,-916.4532 1369.771,-911.6414 1368.8305,-918.5779"/>
</g>
<!-- irgrd -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node133" class="node">
<title>irgrd</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-892 1379.5,-892 1379.5,-868 1433.5,-868 1433.5,-892"/>
<text text-anchor="middle" x="1406.5" y="-877.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">irgrd</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;irgrd -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge186" class="edge">
<title>proc~libint_compute_eri&#45;&gt;irgrd</title>
<path fill="none" stroke="#000000" d="M1190.5739,-1673.4913C1200.3685,-1670.185 1209.4955,-1665.005 1216,-1657 1269.0322,-1591.7345 1195.1937,-963.0084 1252,-901 1281.1246,-869.2082 1333.8155,-868.8475 1369.4736,-873.1132"/>
<polygon fill="#000000" stroke="#000000" points="1369.1139,-876.5965 1379.4964,-874.4859 1370.0638,-869.6612 1369.1139,-876.5965"/>
</g>
<!-- oo2e -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node136" class="node">
<title>oo2e</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-850 1379.5,-850 1379.5,-826 1433.5,-826 1433.5,-850"/>
<text text-anchor="middle" x="1406.5" y="-835.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oo2e</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;oo2e -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge187" class="edge">
<title>proc~libint_compute_eri&#45;&gt;oo2e</title>
<path fill="none" stroke="#000000" d="M1190.5896,-1673.504C1200.3829,-1670.1967 1209.5055,-1665.0131 1216,-1657 1271.8857,-1588.0467 1192.1266,-924.5207 1252,-859 1281.0849,-827.1718 1333.7855,-826.82 1369.4566,-831.0976"/>
<polygon fill="#000000" stroke="#000000" points="1369.1002,-834.5814 1379.4832,-832.4739 1370.0521,-827.6464 1369.1002,-834.5814"/>
</g>
<!-- oo2z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node137" class="node">
<title>oo2z</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-808 1379.5,-808 1379.5,-784 1433.5,-784 1433.5,-808"/>
<text text-anchor="middle" x="1406.5" y="-793.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oo2z</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;oo2z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge188" class="edge">
<title>proc~libint_compute_eri&#45;&gt;oo2z</title>
<path fill="none" stroke="#000000" d="M1190.6037,-1673.5155C1200.396,-1670.2073 1209.5145,-1665.0204 1216,-1657 1274.7395,-1584.3586 1189.0593,-886.0332 1252,-817 1281.049,-785.1391 1333.7584,-784.7953 1369.4413,-789.0836"/>
<polygon fill="#000000" stroke="#000000" points="1369.0878,-792.5678 1379.4714,-790.4631 1370.0416,-785.6331 1369.0878,-792.5678"/>
</g>
<!-- oo2ze -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node138" class="node">
<title>oo2ze</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-766 1379.5,-766 1379.5,-742 1433.5,-742 1433.5,-766"/>
<text text-anchor="middle" x="1406.5" y="-751.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">oo2ze</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;oo2ze -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge189" class="edge">
<title>proc~libint_compute_eri&#45;&gt;oo2ze</title>
<path fill="none" stroke="#000000" d="M1190.6165,-1673.5258C1200.4078,-1670.2168 1209.5227,-1665.027 1216,-1657 1277.5935,-1580.6702 1185.9918,-847.5459 1252,-775 1281.0165,-743.1095 1333.7339,-742.7729 1369.4273,-747.0709"/>
<polygon fill="#000000" stroke="#000000" points="1369.0765,-750.5556 1379.4607,-748.4533 1370.032,-743.6211 1369.0765,-750.5556"/>
</g>
<!-- pa_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node139" class="node">
<title>pa_x</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-724 1379.5,-724 1379.5,-700 1433.5,-700 1433.5,-724"/>
<text text-anchor="middle" x="1406.5" y="-709.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pa_x</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;pa_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge190" class="edge">
<title>proc~libint_compute_eri&#45;&gt;pa_x</title>
<path fill="none" stroke="#000000" d="M1190.6282,-1673.5352C1200.4185,-1670.2255 1209.5301,-1665.033 1216,-1657 1280.4477,-1576.9816 1182.9241,-809.0589 1252,-733 1280.987,-701.0827 1333.7115,-700.7526 1369.4147,-705.0594"/>
<polygon fill="#000000" stroke="#000000" points="1369.0663,-708.5444 1379.451,-706.4444 1370.0233,-701.6101 1369.0663,-708.5444"/>
</g>
<!-- pa_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node140" class="node">
<title>pa_y</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-682 1379.5,-682 1379.5,-658 1433.5,-658 1433.5,-682"/>
<text text-anchor="middle" x="1406.5" y="-667.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pa_y</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;pa_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge191" class="edge">
<title>proc~libint_compute_eri&#45;&gt;pa_y</title>
<path fill="none" stroke="#000000" d="M1190.6388,-1673.5438C1200.4284,-1670.2334 1209.5369,-1665.0385 1216,-1657 1283.302,-1573.2929 1179.8562,-770.5721 1252,-691 1280.96,-659.0582 1333.6911,-658.7341 1369.4031,-663.0489"/>
<polygon fill="#000000" stroke="#000000" points="1369.057,-666.5343 1379.442,-664.4364 1370.0154,-659.6002 1369.057,-666.5343"/>
</g>
<!-- pa_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node141" class="node">
<title>pa_z</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-640 1379.5,-640 1379.5,-616 1433.5,-616 1433.5,-640"/>
<text text-anchor="middle" x="1406.5" y="-625.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pa_z</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;pa_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge192" class="edge">
<title>proc~libint_compute_eri&#45;&gt;pa_z</title>
<path fill="none" stroke="#000000" d="M1190.6486,-1673.5516C1200.4374,-1670.2406 1209.5432,-1665.0435 1216,-1657 1286.1565,-1569.604 1176.7881,-732.0853 1252,-649 1280.9352,-617.0357 1333.6724,-616.7171 1369.3925,-621.0393"/>
<polygon fill="#000000" stroke="#000000" points="1369.0484,-624.525 1379.4339,-622.4289 1370.0081,-617.5911 1369.0484,-624.525"/>
</g>
<!-- qc_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node143" class="node">
<title>qc_x</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-598 1379.5,-598 1379.5,-574 1433.5,-574 1433.5,-598"/>
<text text-anchor="middle" x="1406.5" y="-583.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">qc_x</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;qc_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge193" class="edge">
<title>proc~libint_compute_eri&#45;&gt;qc_x</title>
<path fill="none" stroke="#000000" d="M1190.6576,-1673.5588C1200.4457,-1670.2473 1209.5489,-1665.0481 1216,-1657 1289.0111,-1565.9149 1173.72,-693.5988 1252,-607 1280.9124,-575.0151 1333.6552,-574.7016 1369.3828,-579.0305"/>
<polygon fill="#000000" stroke="#000000" points="1369.0406,-582.5164 1379.4263,-580.4221 1370.0014,-575.5827 1369.0406,-582.5164"/>
</g>
<!-- qc_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node144" class="node">
<title>qc_y</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-556 1379.5,-556 1379.5,-532 1433.5,-532 1433.5,-556"/>
<text text-anchor="middle" x="1406.5" y="-541.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">qc_y</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;qc_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge194" class="edge">
<title>proc~libint_compute_eri&#45;&gt;qc_y</title>
<path fill="none" stroke="#000000" d="M1190.6659,-1673.5655C1200.4533,-1670.2534 1209.5542,-1665.0523 1216,-1657 1291.8657,-1562.2257 1170.6517,-655.1123 1252,-565 1280.8913,-532.9961 1333.6392,-532.6872 1369.3737,-537.0223"/>
<polygon fill="#000000" stroke="#000000" points="1369.0333,-540.5085 1379.4194,-538.4159 1369.9952,-533.5749 1369.0333,-540.5085"/>
</g>
<!-- qc_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node145" class="node">
<title>qc_z</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-514 1379.5,-514 1379.5,-490 1433.5,-490 1433.5,-514"/>
<text text-anchor="middle" x="1406.5" y="-499.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">qc_z</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;qc_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge195" class="edge">
<title>proc~libint_compute_eri&#45;&gt;qc_z</title>
<path fill="none" stroke="#000000" d="M1190.6736,-1673.5716C1200.4604,-1670.2591 1209.5591,-1665.0563 1216,-1657 1294.7205,-1558.5364 1167.5834,-616.626 1252,-523 1280.8718,-490.9784 1333.6245,-490.6739 1369.3654,-495.0148"/>
<polygon fill="#000000" stroke="#000000" points="1369.0266,-498.5012 1379.4129,-496.41 1369.9894,-491.5678 1369.0266,-498.5012"/>
</g>
<!-- proc~libint_compute_eri&#45;&gt;rfinc -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge196" class="edge">
<title>proc~libint_compute_eri&#45;&gt;rfinc</title>
<path fill="none" stroke="#000000" d="M1140.2593,-1690.0794C1155.3844,-1725.4854 1198.9991,-1832.4145 1216,-1926 1232.3601,-2016.0579 1190.3009,-2681.3886 1252,-2749 1281.0631,-2780.8481 1333.769,-2781.195 1369.4473,-2776.9109"/>
<polygon fill="#000000" stroke="#000000" points="1370.0457,-2780.3617 1379.4761,-2775.5327 1369.0926,-2773.4268 1370.0457,-2780.3617"/>
</g>
<!-- rho12_over_alpha1 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node147" class="node">
<title>rho12_over_alpha1</title>
<polygon fill="#777777" stroke="#777777" points="1464,-472 1349,-472 1349,-448 1464,-448 1464,-472"/>
<text text-anchor="middle" x="1406.5" y="-457.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rho12_over_alpha1</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;rho12_over_alpha1 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge197" class="edge">
<title>proc~libint_compute_eri&#45;&gt;rho12_over_alpha1</title>
<path fill="none" stroke="#000000" d="M1190.6808,-1673.5774C1200.467,-1670.2644 1209.5637,-1665.0599 1216,-1657 1297.5753,-1554.847 1164.5149,-578.1398 1252,-481 1273.3209,-457.3261 1307.6937,-450.9815 1338.6106,-451.0359"/>
<polygon fill="#000000" stroke="#000000" points="1338.858,-454.5428 1348.9391,-451.2839 1339.0261,-447.5448 1338.858,-454.5428"/>
</g>
<!-- rho12_over_alpha2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node148" class="node">
<title>rho12_over_alpha2</title>
<polygon fill="#777777" stroke="#777777" points="1464,-430 1349,-430 1349,-406 1464,-406 1464,-430"/>
<text text-anchor="middle" x="1406.5" y="-415.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rho12_over_alpha2</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;rho12_over_alpha2 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge198" class="edge">
<title>proc~libint_compute_eri&#45;&gt;rho12_over_alpha2</title>
<path fill="none" stroke="#000000" d="M1190.6874,-1673.5827C1200.4732,-1670.2693 1209.5679,-1665.0633 1216,-1657 1300.4303,-1551.1575 1161.4464,-539.6536 1252,-439 1273.3084,-415.3149 1307.6802,-408.9694 1338.5997,-409.0261"/>
<polygon fill="#000000" stroke="#000000" points="1338.8478,-412.533 1348.9292,-409.275 1339.0164,-405.535 1338.8478,-412.533"/>
</g>
<!-- rho34_over_alpha3 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node149" class="node">
<title>rho34_over_alpha3</title>
<polygon fill="#777777" stroke="#777777" points="1464,-388 1349,-388 1349,-364 1464,-364 1464,-388"/>
<text text-anchor="middle" x="1406.5" y="-373.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rho34_over_alpha3</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;rho34_over_alpha3 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge199" class="edge">
<title>proc~libint_compute_eri&#45;&gt;rho34_over_alpha3</title>
<path fill="none" stroke="#000000" d="M1190.6936,-1673.5876C1200.4789,-1670.2739 1209.5719,-1665.0665 1216,-1657 1303.2853,-1547.4679 1158.3778,-501.1676 1252,-397 1273.2968,-373.3044 1307.6676,-366.9581 1338.5895,-367.0169"/>
<polygon fill="#000000" stroke="#000000" points="1338.8382,-370.5239 1348.9199,-367.2666 1339.0075,-363.5259 1338.8382,-370.5239"/>
</g>
<!-- rho34_over_alpha4 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node150" class="node">
<title>rho34_over_alpha4</title>
<polygon fill="#777777" stroke="#777777" points="1464,-346 1349,-346 1349,-322 1464,-322 1464,-346"/>
<text text-anchor="middle" x="1406.5" y="-331.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">rho34_over_alpha4</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;rho34_over_alpha4 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge200" class="edge">
<title>proc~libint_compute_eri&#45;&gt;rho34_over_alpha4</title>
<path fill="none" stroke="#000000" d="M1190.6995,-1673.5923C1200.4843,-1670.2781 1209.5756,-1665.0694 1216,-1657 1306.1403,-1543.7782 1155.3091,-462.6816 1252,-355 1273.2859,-331.2946 1307.6558,-324.9475 1338.5799,-325.0083"/>
<polygon fill="#000000" stroke="#000000" points="1338.8293,-328.5153 1348.9112,-325.2588 1338.999,-321.5174 1338.8293,-328.5153"/>
</g>
<!-- proc~libint_compute_eri&#45;&gt;rmr -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge201" class="edge">
<title>proc~libint_compute_eri&#45;&gt;rmr</title>
<path fill="none" stroke="#000000" d="M1140.2776,-1690.0761C1155.4524,-1725.4731 1199.1884,-1832.3804 1216,-1926 1224.9131,-1975.6346 1218.0829,-2795.6815 1252,-2833 1280.9986,-2864.9068 1333.7203,-2865.2394 1369.4197,-2860.9361"/>
<polygon fill="#000000" stroke="#000000" points="1370.0268,-2864.3856 1379.4548,-2859.5521 1369.0704,-2857.4512 1370.0268,-2864.3856"/>
</g>
<!-- roe -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node152" class="node">
<title>roe</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-304 1379.5,-304 1379.5,-280 1433.5,-280 1433.5,-304"/>
<text text-anchor="middle" x="1406.5" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">roe</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;roe -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge202" class="edge">
<title>proc~libint_compute_eri&#45;&gt;roe</title>
<path fill="none" stroke="#000000" d="M1190.7049,-1673.5966C1200.4893,-1670.2822 1209.5791,-1665.0722 1216,-1657 1308.9954,-1540.0885 1152.2404,-424.1956 1252,-313 1280.7924,-280.907 1333.5645,-280.6199 1369.3313,-284.9842"/>
<polygon fill="#000000" stroke="#000000" points="1368.9991,-288.4716 1379.3867,-286.3865 1369.966,-281.5387 1368.9991,-288.4716"/>
</g>
<!-- roz -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node153" class="node">
<title>roz</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-262 1379.5,-262 1379.5,-238 1433.5,-238 1433.5,-262"/>
<text text-anchor="middle" x="1406.5" y="-247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">roz</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;roz -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge203" class="edge">
<title>proc~libint_compute_eri&#45;&gt;roz</title>
<path fill="none" stroke="#000000" d="M1190.71,-1673.6007C1200.494,-1670.2859 1209.5824,-1665.0748 1216,-1657 1311.8506,-1536.3987 1149.1716,-385.7097 1252,-271 1280.7794,-238.8953 1333.5546,-238.611 1369.3258,-242.9792"/>
<polygon fill="#000000" stroke="#000000" points="1368.9946,-246.4668 1379.3824,-244.3826 1369.9622,-239.534 1368.9946,-246.4668"/>
</g>
<!-- two_alpha0_bra -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node154" class="node">
<title>two_alpha0_bra</title>
<polygon fill="#777777" stroke="#777777" points="1455,-220 1358,-220 1358,-196 1455,-196 1455,-220"/>
<text text-anchor="middle" x="1406.5" y="-205.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">two_alpha0_bra</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;two_alpha0_bra -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge204" class="edge">
<title>proc~libint_compute_eri&#45;&gt;two_alpha0_bra</title>
<path fill="none" stroke="#000000" d="M1190.7149,-1673.6045C1200.4985,-1670.2895 1209.5855,-1665.0772 1216,-1657 1265.3529,-1594.8544 1199.0514,-288.112 1252,-229 1275.4059,-202.8696 1314.7073,-197.8134 1347.8127,-199.1911"/>
<polygon fill="#000000" stroke="#000000" points="1347.6675,-202.6886 1357.8634,-199.809 1348.0971,-195.7018 1347.6675,-202.6886"/>
</g>
<!-- two_alpha0_ket -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node155" class="node">
<title>two_alpha0_ket</title>
<polygon fill="#777777" stroke="#777777" points="1454,-178 1359,-178 1359,-154 1454,-154 1454,-178"/>
<text text-anchor="middle" x="1406.5" y="-163.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">two_alpha0_ket</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;two_alpha0_ket -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge205" class="edge">
<title>proc~libint_compute_eri&#45;&gt;two_alpha0_ket</title>
<path fill="none" stroke="#000000" d="M1190.7194,-1673.6081C1200.5027,-1670.2928 1209.5884,-1665.0796 1216,-1657 1266.7805,-1593.0095 1197.517,-247.8691 1252,-187 1275.6419,-160.5869 1315.5243,-155.7013 1348.8456,-157.2304"/>
<polygon fill="#000000" stroke="#000000" points="1348.7429,-160.7311 1358.9509,-157.8942 1349.2018,-153.7462 1348.7429,-160.7311"/>
</g>
<!-- two_alpha1bra -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node156" class="node">
<title>two_alpha1bra</title>
<polygon fill="#777777" stroke="#777777" points="1452,-2740 1361,-2740 1361,-2716 1452,-2716 1452,-2740"/>
<text text-anchor="middle" x="1406.5" y="-2725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">two_alpha1bra</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;two_alpha1bra -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge206" class="edge">
<title>proc~libint_compute_eri&#45;&gt;two_alpha1bra</title>
<path fill="none" stroke="#000000" d="M1140.2486,-1690.0813C1155.3449,-1725.4926 1198.8892,-1832.4346 1216,-1926 1231.6272,-2011.4528 1193.3681,-2642.901 1252,-2707 1276.3395,-2733.609 1317.1859,-2738.2109 1350.7682,-2736.5044"/>
<polygon fill="#000000" stroke="#000000" points="1351.201,-2739.9827 1360.9307,-2735.7896 1350.7098,-2732.9999 1351.201,-2739.9827"/>
</g>
<!-- two_alpha1ket -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node157" class="node">
<title>two_alpha1ket</title>
<polygon fill="#777777" stroke="#777777" points="1451.5,-2698 1361.5,-2698 1361.5,-2674 1451.5,-2674 1451.5,-2698"/>
<text text-anchor="middle" x="1406.5" y="-2683.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">two_alpha1ket</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;two_alpha1ket -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge207" class="edge">
<title>proc~libint_compute_eri&#45;&gt;two_alpha1ket</title>
<path fill="none" stroke="#000000" d="M1140.2368,-1690.0835C1155.301,-1725.5007 1198.767,-1832.457 1216,-1926 1230.8943,-2006.848 1196.4351,-2604.4131 1252,-2665 1276.4571,-2691.6676 1317.4973,-2696.2115 1351.1345,-2694.4649"/>
<polygon fill="#000000" stroke="#000000" points="1351.5841,-2697.9418 1361.3094,-2693.7384 1351.0855,-2690.9595 1351.5841,-2697.9418"/>
</g>
<!-- wp_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node159" class="node">
<title>wp_x</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2656 1379.5,-2656 1379.5,-2632 1433.5,-2632 1433.5,-2656"/>
<text text-anchor="middle" x="1406.5" y="-2641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wp_x</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;wp_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge208" class="edge">
<title>proc~libint_compute_eri&#45;&gt;wp_x</title>
<path fill="none" stroke="#000000" d="M1140.2235,-1690.086C1155.2518,-1725.5098 1198.63,-1832.4823 1216,-1926 1230.1615,-2002.2437 1199.5017,-2565.9249 1252,-2623 1281.1051,-2654.6425 1333.563,-2655.1058 1369.1951,-2650.898"/>
<polygon fill="#000000" stroke="#000000" points="1369.7768,-2654.3513 1379.2166,-2649.5409 1368.8373,-2647.4146 1369.7768,-2654.3513"/>
</g>
<!-- wp_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node160" class="node">
<title>wp_y</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2614 1379.5,-2614 1379.5,-2590 1433.5,-2590 1433.5,-2614"/>
<text text-anchor="middle" x="1406.5" y="-2599.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wp_y</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;wp_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge209" class="edge">
<title>proc~libint_compute_eri&#45;&gt;wp_y</title>
<path fill="none" stroke="#000000" d="M1140.2086,-1690.0887C1155.1963,-1725.5201 1198.4756,-1832.5111 1216,-1926 1229.4288,-1997.6399 1202.568,-2527.4362 1252,-2581 1281.1573,-2612.5944 1333.6026,-2613.0693 1369.2177,-2608.8772"/>
<polygon fill="#000000" stroke="#000000" points="1369.7923,-2612.3315 1379.2341,-2607.5248 1368.8556,-2605.3944 1369.7923,-2612.3315"/>
</g>
<!-- wp_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node161" class="node">
<title>wp_z</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2572 1379.5,-2572 1379.5,-2548 1433.5,-2548 1433.5,-2572"/>
<text text-anchor="middle" x="1406.5" y="-2557.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wp_z</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;wp_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge210" class="edge">
<title>proc~libint_compute_eri&#45;&gt;wp_z</title>
<path fill="none" stroke="#000000" d="M1140.1916,-1690.092C1155.1332,-1725.532 1198.3002,-1832.5442 1216,-1926 1228.6962,-1993.0368 1205.6337,-2488.9471 1252,-2539 1281.2166,-2570.5396 1333.6476,-2571.0277 1369.2433,-2566.8535"/>
<polygon fill="#000000" stroke="#000000" points="1369.81,-2570.3089 1379.2538,-2565.5065 1368.8764,-2563.3714 1369.81,-2570.3089"/>
</g>
<!-- wq_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node162" class="node">
<title>wq_x</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2530 1379.5,-2530 1379.5,-2506 1433.5,-2506 1433.5,-2530"/>
<text text-anchor="middle" x="1406.5" y="-2515.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wq_x</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;wq_x -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge211" class="edge">
<title>proc~libint_compute_eri&#45;&gt;wq_x</title>
<path fill="none" stroke="#000000" d="M1140.1721,-1690.0957C1155.061,-1725.5458 1198.0992,-1832.5825 1216,-1926 1227.9638,-1988.4345 1208.699,-2450.4573 1252,-2497 1281.2844,-2528.4767 1333.6991,-2528.9799 1369.2726,-2524.8263"/>
<polygon fill="#000000" stroke="#000000" points="1369.8301,-2528.283 1379.2765,-2523.4855 1368.9001,-2521.345 1369.8301,-2528.283"/>
</g>
<!-- wq_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node163" class="node">
<title>wq_y</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2488 1379.5,-2488 1379.5,-2464 1433.5,-2464 1433.5,-2488"/>
<text text-anchor="middle" x="1406.5" y="-2473.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wq_y</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;wq_y -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge212" class="edge">
<title>proc~libint_compute_eri&#45;&gt;wq_y</title>
<path fill="none" stroke="#000000" d="M1140.1495,-1690.1C1154.9773,-1725.5619 1197.8664,-1832.6274 1216,-1926 1227.2316,-1983.8332 1211.7635,-2411.9668 1252,-2455 1281.3627,-2486.4036 1333.7586,-2486.9244 1369.3065,-2482.7947"/>
<polygon fill="#000000" stroke="#000000" points="1369.8534,-2486.2529 1379.3027,-2481.461 1368.9276,-2479.3143 1369.8534,-2486.2529"/>
</g>
<!-- wq_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node164" class="node">
<title>wq_z</title>
<polygon fill="#777777" stroke="#777777" points="1433.5,-2446 1379.5,-2446 1379.5,-2422 1433.5,-2422 1433.5,-2446"/>
<text text-anchor="middle" x="1406.5" y="-2431.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wq_z</text>
</g>
<!-- proc~libint_compute_eri&#45;&gt;wq_z -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge213" class="edge">
<title>proc~libint_compute_eri&#45;&gt;wq_z</title>
<path fill="none" stroke="#000000" d="M1140.1231,-1690.1052C1154.8794,-1725.5811 1197.5938,-1832.6808 1216,-1926 1226.4996,-1979.2332 1214.8272,-2373.4754 1252,-2413 1281.4543,-2444.3177 1333.8281,-2444.8593 1369.3461,-2440.7576"/>
<polygon fill="#000000" stroke="#000000" points="1369.8806,-2444.2174 1379.3333,-2439.4324 1368.9597,-2437.2783 1369.8806,-2444.2174"/>
</g>
<!-- proc~pack_f90&#45;&gt;interface~show_message -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge214" class="edge">
<title>proc~pack_f90&#45;&gt;interface~show_message</title>
<path fill="none" stroke="#000000" d="M735.2319,-794.2676C792.2953,-798.3699 914.8148,-807.5716 1018,-818 1037.6684,-819.9878 1059.159,-822.4697 1078.2937,-824.7894"/>
<polygon fill="#000000" stroke="#000000" points="1078.007,-828.2804 1088.358,-826.0207 1078.857,-821.3322 1078.007,-828.2804"/>
</g>
<!-- proc~pack_f90&#45;&gt;proc~oqp_dtrttp_i64 -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge215" class="edge">
<title>proc~pack_f90&#45;&gt;proc~oqp_dtrttp_i64</title>
<path fill="none" stroke="#000000" d="M726.9626,-779.77C747.8039,-767.7796 776.955,-747.4612 792,-721 850.0951,-618.8224 748.3212,-545.4095 828,-459 838.3269,-447.8008 853.1682,-441.8861 868.0614,-438.9224"/>
<polygon fill="#000000" stroke="#000000" points="868.9882,-442.3199 878.3255,-437.3134 867.9041,-435.4044 868.9882,-442.3199"/>
</g>
<!-- none~bf_label -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node134" class="node">
<title>none~bf_label</title>
<g id="a_proc~~tdhf_mrsf_energy~~CallsGraph_node134"><a xlink:href="../type/basis_set.html#boundprocedure-bf_label" xlink:title="basis_set%bf_label">
<polygon fill="#a7506f" stroke="#a7506f" points="979,-1246 867,-1246 867,-1222 979,-1222 979,-1246"/>
<text text-anchor="middle" x="923" y="-1231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">basis_set%bf_label</text>
</a>
</g>
</g>
<!-- proc~print_sym_labeled&#45;&gt;none~bf_label -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge216" class="edge">
<title>proc~print_sym_labeled&#45;&gt;none~bf_label</title>
<path fill="none" stroke="#000000" d="M757.6647,-1234C787.6353,-1234 825.0164,-1234 856.6493,-1234"/>
<polygon fill="#000000" stroke="#000000" points="856.7011,-1237.5001 866.701,-1234 856.701,-1230.5001 856.7011,-1237.5001"/>
</g>
<!-- abrt -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_node166" class="node">
<title>abrt</title>
<polygon fill="#777777" stroke="#777777" points="1162,-1522 1108,-1522 1108,-1498 1162,-1498 1162,-1522"/>
<text text-anchor="middle" x="1135" y="-1507.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">abrt</text>
</g>
<!-- proc~mulquadgausshermite&#45;&gt;abrt -->
<g id="proc~~tdhf_mrsf_energy~~CallsGraph_edge217" class="edge">
<title>proc~mulquadgausshermite&#45;&gt;abrt</title>
<path fill="none" stroke="#000000" d="M991.5376,-1511.3534C1026.7694,-1511.021 1068.338,-1510.6289 1097.6351,-1510.3525"/>
<polygon fill="#000000" stroke="#000000" points="1097.8725,-1513.8505 1107.839,-1510.2562 1097.8064,-1506.8508 1097.8725,-1513.8505"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproctdhf_mrsf_energyCallsGraph = svgPanZoom('#proctdhf_mrsf_energyCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="27pt"
 viewBox="0.00 0.00 641.00 27.37" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(.8552 .8552) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 745.5,-28 745.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="147.5,-24 89.5,-24 89.5,0 147.5,0 147.5,-24"/>
<text text-anchor="middle" x="118.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="227,-24 166,-24 166,0 227,0 227,-24"/>
<text text-anchor="middle" x="196.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="378,-24 245,-24 245,0 378,0 378,-24"/>
<text text-anchor="middle" x="311.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="543,-24 396,-24 396,0 543,0 543,-24"/>
<text text-anchor="middle" x="469.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="619.5,-24 561.5,-24 561.5,0 619.5,0 619.5,-24"/>
<text text-anchor="middle" x="590.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="741.5,-24 637.5,-24 637.5,0 741.5,0 741.5,-24"/>
<text text-anchor="middle" x="689.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: proc~~tdhf_mrsf_energy~~CalledByGraph Pages: 1 -->
<svg id="proctdhf_mrsf_energyCalledByGraph" width="268pt" height="32pt"
 viewBox="0.00 0.00 268.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~tdhf_mrsf_energy~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~tdhf_mrsf_energy~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 264,-28 264,4 -4,4"/>
<!-- proc~tdhf_mrsf_energy -->
<g id="proc~~tdhf_mrsf_energy~~CalledByGraph_node1" class="node">
<title>proc~tdhf_mrsf_energy</title>
<polygon fill="none" stroke="#000000" points="260,-24 154,-24 154,0 260,0 260,-24"/>
<text text-anchor="middle" x="207" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">tdhf_mrsf_energy</text>
</g>
<!-- proc~tdhf_mrsf_energy_c -->
<g id="proc~~tdhf_mrsf_energy~~CalledByGraph_node2" class="node">
<title>proc~tdhf_mrsf_energy_c</title>
<g id="a_proc~~tdhf_mrsf_energy~~CalledByGraph_node2"><a xlink:href="../proc/tdhf_mrsf_energy_c.html" xlink:title="tdhf_mrsf_energy_C">
<polygon fill="#d9534f" stroke="#d9534f" points="118,-24 0,-24 0,0 118,0 118,-24"/>
<text text-anchor="middle" x="59" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tdhf_mrsf_energy_C</text>
</a>
</g>
</g>
<!-- proc~tdhf_mrsf_energy_c&#45;&gt;proc~tdhf_mrsf_energy -->
<g id="proc~~tdhf_mrsf_energy~~CalledByGraph_edge1" class="edge">
<title>proc~tdhf_mrsf_energy_c&#45;&gt;proc~tdhf_mrsf_energy</title>
<path fill="none" stroke="#000000" d="M118.3445,-12C126.6918,-12 135.2982,-12 143.7157,-12"/>
<polygon fill="#000000" stroke="#000000" points="143.8594,-15.5001 153.8593,-12 143.8593,-8.5001 143.8594,-15.5001"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="27pt"
 viewBox="0.00 0.00 641.00 27.37" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(.8552 .8552) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 745.5,-28 745.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="147.5,-24 89.5,-24 89.5,0 147.5,0 147.5,-24"/>
<text text-anchor="middle" x="118.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="227,-24 166,-24 166,0 227,0 227,-24"/>
<text text-anchor="middle" x="196.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="378,-24 245,-24 245,0 378,0 378,-24"/>
<text text-anchor="middle" x="311.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="543,-24 396,-24 396,0 543,0 543,-24"/>
<text text-anchor="middle" x="469.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="619.5,-24 561.5,-24 561.5,0 619.5,0 619.5,-24"/>
<text text-anchor="middle" x="590.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="741.5,-24 637.5,-24 637.5,0 741.5,0 741.5,-24"/>
<text text-anchor="middle" x="689.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">tdhf_mrsf_energy</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
<span class="w">    </span><span class="k">use </span><span class="n">io_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">iw</span>
<span class="w">    </span><span class="k">use </span><span class="n">oqp_tagarray_driver</span>

<span class="w">    </span><span class="k">use </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">information</span>
<span class="w">    </span><span class="k">use </span><span class="n">strings</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cstring</span><span class="p">,</span><span class="w"> </span><span class="n">fstring</span>
<span class="w">    </span><span class="k">use </span><span class="n">basis_tools</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">basis_set</span>
<span class="w">    </span><span class="k">use </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">show_message</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span>
<span class="w">    </span><span class="k">use </span><span class="n">util</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">measure_time</span>

<span class="w">    </span><span class="k">use </span><span class="nb">precision</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp</span>
<span class="w">    </span><span class="k">use </span><span class="n">int2_compute</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int2_compute_t</span>
<span class="w">    </span><span class="k">use </span><span class="n">tdhf_mrsf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int2_mrsf_data_t</span>
<span class="w">    </span><span class="k">use </span><span class="n">tdhf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int2_td_data_t</span>
<span class="w">    </span><span class="k">use </span><span class="n">tdhf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">iatogen</span><span class="p">,</span><span class="w"> </span><span class="n">mntoia</span><span class="p">,</span><span class="w"> </span><span class="n">rparedms</span><span class="p">,</span><span class="w"> </span><span class="n">rpaeig</span><span class="p">,</span><span class="w"> </span><span class="n">rpavnorm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">rpaechk</span><span class="p">,</span><span class="w"> </span><span class="n">rpanewb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">rpaprint</span><span class="p">,</span><span class="w"> </span><span class="n">inivec</span>
<span class="w">    </span><span class="k">use </span><span class="n">tdhf_sf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">sfresvec</span><span class="p">,</span><span class="w"> </span><span class="n">sfqvec</span><span class="p">,</span><span class="w"> </span><span class="n">sfdmat</span><span class="p">,</span><span class="w"> </span><span class="n">trfrmb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">get_transition_density</span><span class="p">,</span><span class="w"> </span><span class="n">get_transitions</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">get_transition_dipole</span><span class="p">,</span><span class="w"> </span><span class="n">print_results</span>
<span class="w">    </span><span class="k">use </span><span class="n">tdhf_mrsf_lib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">mrinivec</span><span class="p">,</span><span class="w"> </span><span class="n">mrsfcbc</span><span class="p">,</span><span class="w"> </span><span class="n">mrsfmntoia</span><span class="p">,</span><span class="w"> </span><span class="n">mrsfesum</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">mrsfqroesum</span><span class="p">,</span><span class="w"> </span><span class="n">get_mrsf_transitions</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">get_mrsf_transition_density</span>
<span class="w">    </span><span class="k">use </span><span class="n">mathlib</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">orthogonal_transform</span><span class="p">,</span><span class="w"> </span><span class="n">orthogonal_transform_sym</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">unpack_matrix</span>
<span class="w">    </span><span class="k">use </span><span class="n">oqp_linalg</span>
<span class="w">    </span><span class="k">use </span><span class="n">printing</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">print_module_info</span>

<span class="w">    </span><span class="k">implicit none</span>

<span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subroutine_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tdhf_mrsf_energy&quot;</span>

<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">basis_set</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">information</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">infos</span>

<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">s_size</span><span class="p">,</span><span class="w"> </span><span class="n">ok</span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scr2</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wrk1</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">qvec</span><span class="p">(:,:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">amo</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">wrk2</span><span class="p">(:,:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">squared_S</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">amb</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">apb</span><span class="p">(:,:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vl</span><span class="p">(:),</span><span class="w"> </span><span class="n">vr</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vl_p</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">vr_p</span><span class="p">(:,:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xm</span><span class="p">(:),</span><span class="w"> </span><span class="n">scr</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">for_trnsf_b_vec</span><span class="p">(:,:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fa</span><span class="p">,</span><span class="w"> </span><span class="n">fb</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rnorm</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:,:,:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">trden</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:,:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">trans</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mrsf_density</span><span class="p">(:,:,:,:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fmrst2</span><span class="p">(:,:,:,:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fmrq1</span><span class="p">(:,:,:)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dip</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">bvec_mo_tmp</span><span class="p">(:),</span><span class="w"> </span><span class="n">eex</span><span class="p">(:)</span>

<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">nvira</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nvirb</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mxvec</span><span class="p">,</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">jst</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="p">,</span><span class="w"> </span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="n">novec</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">nv</span><span class="p">,</span><span class="w"> </span><span class="n">iv</span><span class="p">,</span><span class="w"> </span><span class="n">ivec</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mxiter</span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tamm_dancoff</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">imax</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">converged</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mxerr</span><span class="p">,</span><span class="w"> </span><span class="n">cnvtol</span><span class="p">,</span><span class="w"> </span><span class="n">scale_exch</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxvec</span><span class="p">,</span><span class="w"> </span><span class="n">mrst</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">target_state</span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">roref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">debug_mode</span>

<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">int2_compute_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int2_driver</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">int2_mrsf_data_t</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int2_data_st</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">int2_td_data_t</span><span class="p">),</span><span class="w"> </span><span class="k">target</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int2_data_q</span>

<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scf_type</span><span class="p">,</span><span class="w"> </span><span class="n">mol_mult</span>

<span class="w">    </span><span class="c">! tagarray</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">contiguous</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">fock_a</span><span class="p">(:),</span><span class="w"> </span><span class="n">dmat_a</span><span class="p">(:),</span><span class="w"> </span><span class="n">mo_A</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">mo_energy_a</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">fock_b</span><span class="p">(:),</span><span class="w"> </span><span class="n">dmat_b</span><span class="p">(:),</span><span class="w"> </span><span class="n">mo_b</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">mo_energy_b</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">smat</span><span class="p">(:),</span><span class="w"> </span><span class="n">ta</span><span class="p">(:),</span><span class="w"> </span><span class="n">tb</span><span class="p">(:),</span><span class="w"> </span><span class="n">td_t</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">bvec_mo_out</span><span class="p">(:,:),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">mrsf_energies</span><span class="p">(:)</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tags_alloc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">OQP_td_bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_energies</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tags_required</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">      </span><span class="n">OQP_FOCK_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_FOCK_B</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_B</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_B</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_B</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_SM</span><span class="w"> </span><span class="o">/</span><span class="p">)</span>

<span class="w">  </span><span class="c">! Readings</span>
<span class="w">  </span><span class="c">! Files open</span>
<span class="w">  </span><span class="c">! 3. LOG: Write: Main output file</span>
<span class="w">    </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">iw</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="n">infos</span><span class="p">%</span><span class="n">log_filename</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="c">!</span>
<span class="w">    </span><span class="k">call </span><span class="n">print_module_info</span><span class="p">(</span><span class="s1">&#39;MRSF_TDHF_Energy&#39;</span><span class="p">,</span><span class="s1">&#39;Computing Energy of MRSF-TDDFT&#39;</span><span class="p">)</span>

<span class="w">  </span><span class="c">! Load basis set</span>
<span class="w">    </span><span class="n">basis</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">basis</span>
<span class="w">    </span><span class="n">basis</span><span class="p">%</span><span class="n">atoms</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">atoms</span>

<span class="w">   </span><span class="c">! Input parameters</span>
<span class="w">    </span><span class="n">dft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">hamilton</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="c">! dft or hf</span>
<span class="w">    </span><span class="n">mrst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">mult</span>
<span class="w">    </span><span class="n">nstates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">nstate</span>
<span class="w">    </span><span class="n">target_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">target_state</span>
<span class="w">    </span><span class="n">maxvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">maxvec</span>
<span class="w">    </span><span class="n">cnvtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cnvtol</span>
<span class="c">!   infos%tddft%debug_mode = .True.</span>
<span class="w">    </span><span class="n">debug_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">debug_mode</span>

<span class="w">    </span><span class="n">mol_mult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">mult</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mol_mult</span><span class="o">/=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;MRSF-TDDFT are available for ROHF ref.&amp;</span>
<span class="s1">        &amp;with ONLY triplet multiplicity(mult=3)&#39;</span><span class="p">,</span><span class="n">with_abort</span><span class="p">)</span>

<span class="w">    </span><span class="n">scf_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">scftype</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scf_type</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">roref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>

<span class="w">    </span><span class="n">nbf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basis</span><span class="p">%</span><span class="n">nbf</span>
<span class="w">    </span><span class="n">nbf2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">*</span><span class="p">(</span><span class="n">nbf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="w">    </span><span class="n">s_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">basis</span><span class="p">%</span><span class="n">nshell</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">basis</span><span class="p">%</span><span class="n">nshell</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

<span class="w">    </span><span class="n">tamm_dancoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w">  </span><span class="c">! tamm_dancoff: 0/1 means not doing/doing Tamm/Dancoff run</span>

<span class="w">    </span><span class="n">nocca</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">nelec_a</span>
<span class="w">    </span><span class="n">nvira</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">-</span><span class="n">nocca</span>
<span class="w">    </span><span class="n">noccb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_prop</span><span class="p">%</span><span class="n">nelec_b</span>
<span class="w">    </span><span class="n">nvirb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbf</span><span class="o">-</span><span class="n">noccb</span>


<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">xvec_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nocca</span><span class="o">*</span><span class="n">nvirb</span>
<span class="w">    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">xvec_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">noccb</span><span class="o">*</span><span class="n">nvira</span>
<span class="w">    </span><span class="k">end if</span>


<span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">nstates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">mxvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">maxvec</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">maxit_dav</span><span class="o">*</span><span class="n">nstates</span><span class="p">)</span>
<span class="w">    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">nstates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="w">      </span><span class="n">mxvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">maxvec</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">maxit_dav</span><span class="o">*</span><span class="n">nstates</span><span class="p">)</span>
<span class="w">    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">nstates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span><span class="p">)</span>
<span class="w">      </span><span class="n">mxvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">maxvec</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">xvec_dim</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">maxit_dav</span><span class="o">*</span><span class="n">nstates</span><span class="p">)</span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">nstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nstates</span>
<span class="w">    </span><span class="n">nvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nstates</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="w"> </span><span class="n">mxvec</span><span class="p">)</span>

<span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">remove_records</span><span class="p">(</span><span class="n">tags_alloc</span><span class="p">)</span>

<span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">xvec_dim</span><span class="o">*</span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">xvec_dim</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="o">/</span><span class="p">),</span><span class="w"> </span><span class="n">comment</span><span class="o">=</span><span class="n">OQP_td_bvec_mo_comment</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="n">nbf2</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="n">nbf2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="p">),</span><span class="w"> </span><span class="n">comment</span><span class="o">=</span><span class="n">OQP_td_t_comment</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">%</span><span class="n">reserve_data</span><span class="p">(</span><span class="n">OQP_td_energies</span><span class="p">,</span><span class="w"> </span><span class="n">TA_TYPE_REAL64</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">comment</span><span class="o">=</span><span class="n">OQP_td_energies_comment</span><span class="p">)</span>

<span class="w">    </span><span class="k">call </span><span class="n">data_has_tags</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">tags_alloc</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="n">subroutine_name</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">bvec_mo_out</span><span class="p">)</span>

<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_t</span><span class="p">,</span><span class="w"> </span><span class="n">td_t</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_td_energies</span><span class="p">,</span><span class="w"> </span><span class="n">mrsf_energies</span><span class="p">)</span>

<span class="w">    </span><span class="k">call </span><span class="n">data_has_tags</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">tags_required</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="n">subroutine_name</span><span class="p">,</span><span class="w"> </span><span class="n">WITH_ABORT</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_SM</span><span class="p">,</span><span class="w"> </span><span class="n">smat</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_FOCK_A</span><span class="p">,</span><span class="w"> </span><span class="n">fock_a</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_FOCK_B</span><span class="p">,</span><span class="w"> </span><span class="n">fock_b</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_A</span><span class="p">,</span><span class="w"> </span><span class="n">dmat_a</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_DM_B</span><span class="p">,</span><span class="w"> </span><span class="n">dmat_b</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">mo_energy_a</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_E_MO_B</span><span class="p">,</span><span class="w"> </span><span class="n">mo_energy_b</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_A</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">tagarray_get_data</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">OQP_VEC_MO_B</span><span class="p">,</span><span class="w"> </span><span class="n">mo_b</span><span class="p">)</span>

<span class="w">  </span><span class="c">! Allocate temporary matrices for diagonalization</span>
<span class="w">    </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">fa</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">              </span><span class="n">fb</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">              </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ok</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="n">with_abort</span><span class="p">)</span>

<span class="w">  </span><span class="c">! Allocate TDDFT variables</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">xm</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">bvec_mo</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">trden</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nstates</span><span class="p">,</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">wrk1</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">wrk2</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">amo</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">EEX</span><span class="p">(</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">squared_S</span><span class="p">(</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">APB</span><span class="p">(</span><span class="n">mxvec</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">AMB</span><span class="p">(</span><span class="n">mxvec</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">VR</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">VL</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">for_trnsf_b_vec</span><span class="p">(</span><span class="n">mxvec</span><span class="p">,</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">!</span>
<span class="w">             </span><span class="n">dip</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">nstates</span><span class="p">,</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">scr</span><span class="p">(</span><span class="n">nbf2</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">bvec_mo_tmp</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">scr2</span><span class="p">(</span><span class="n">mxvec</span><span class="o">*</span><span class="n">mxvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">qvec</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">,</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">RNORM</span><span class="p">(</span><span class="n">nstates</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0_dp</span><span class="p">,</span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">trans</span><span class="p">(</span><span class="n">xvec_dim</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="n">source</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ok</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span><span class="p">)</span>

<span class="w">    </span><span class="n">ta</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">td_t</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">tb</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">td_t</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">      allocate</span><span class="p">(</span><span class="n">mrsf_density</span><span class="p">(</span><span class="n">nvec</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0_dp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>

<span class="w">    </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="w">  </span><span class="p">)</span><span class="k">then</span>

<span class="k">      allocate</span><span class="p">(</span><span class="n">fmrq1</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nvec</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="n">source</span><span class="o">=</span><span class="mf">0.0_dp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="nb">stat</span><span class="o">=</span><span class="n">ok</span><span class="p">)</span>

<span class="w">    </span><span class="k">end if</span>

<span class="k">    if</span><span class="p">(</span><span class="w"> </span><span class="n">ok</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">show_message</span><span class="p">(</span><span class="s1">&#39;Cannot allocate memory&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">with_abort</span><span class="p">)</span>

<span class="w">    </span><span class="n">scale_exch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_dp</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">HFscale</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_flag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">            </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_alpha</span>
<span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">            </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_beta</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">            </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_mu</span>
<span class="w">    </span><span class="k">end if</span>
<span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">dft</span><span class="p">)</span><span class="w"> </span><span class="n">scale_exch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span>
<span class="w">    </span><span class="c">! set spin-pair coupling</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coco</span><span class="o">==-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coco</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_ovov</span><span class="o">==-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_ovov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coov</span><span class="o">==-</span><span class="mf">1.0_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">debug_mode</span><span class="p">.</span><span class="nb">or</span><span class="p">..</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,5x,&quot;Input parameters:&quot;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of states:                 &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nstates</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of single excitations:     &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">xvec_dim</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of atomic orbitals:        &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nbf</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of electrons:              &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nocca</span><span class="o">+</span><span class="n">noccb</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of occupied alpha orbitals:&quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nocca</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of occupied beta orbitals: &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">noccb</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of virtual alpha orbitals: &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvira</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Number of virtual beta orbitals:  &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvirb</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Maximum vectors:                  &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">mxvec</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,&quot;Initial vectors:                  &quot;,1x,I0)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvec</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(/7x,&quot;Fitting parameters for MRSF-TDDFT&quot;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_flag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(10x,&quot;Exact HF exchange:&quot;)&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5x,&quot;Reference: |&quot;, t20, f6.3, t29, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">HFscale</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5x,&quot;Response:  |&quot;, t20, f6.3, t29, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">HFscale</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(10x,&quot;CAM parametres:&quot;)&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(16x,&quot;|   alpha   |    beta   |     mu    |&quot;)&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5x,&quot;Reference: |&quot;, t20, f6.3, t29, &quot;|&quot;, t32, f6.3, t41, &quot;|&quot;, t44, f6.3, t53, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_mu</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(5x,&quot;Response:  |&quot;, t20, f6.3, t29, &quot;|&quot;, t32, f6.3, t41, &quot;|&quot;, t44, f6.3, t53, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span>
<span class="w">      </span><span class="k">end if</span>
<span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(10x,&quot;Spin-pair coupling parametres:&quot;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(16x,&quot;|   CO-CO   |   OV-OV   |   CO-OV   |&quot;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(16x,&quot;|&quot;, t20, f6.3, t29, &quot;|&quot;, t32, f6.3, t41, &quot;|&quot;, t44, f6.3, t53, &quot;|&quot;)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">         </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coco</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_ovov</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coov</span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,5x,46(&quot;=&quot;))&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(  5X,&quot;Davidson algorithm for Singlet response states&quot;)&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(  5x,&quot;Davidson algorithm for Triplet response states&quot;)&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(  5x,&quot;Davidson algorithm for Quintet response states&quot;)&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(5x,46(&quot;=&quot;))&#39;</span><span class="p">)</span>

<span class="w">    </span><span class="c">! Initialize ERI (Electron Repulsion Integrals) calculations</span>
<span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">infos</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">set_screening</span><span class="p">()</span>
<span class="w">    </span><span class="k">call </span><span class="nb">flush</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>

<span class="w">  </span><span class="c">! Prepare for ROHF</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">roref</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="c">!   Alapha</span>
<span class="w">      </span><span class="k">call </span><span class="n">orthogonal_transform_sym</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">fock_a</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">scr</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">unpack_matrix</span><span class="p">(</span><span class="n">scr</span><span class="p">,</span><span class="n">fa</span><span class="p">)</span>

<span class="w">  </span><span class="c">!   Beta</span>
<span class="w">      </span><span class="k">call </span><span class="n">orthogonal_transform_sym</span><span class="p">(</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">fock_b</span><span class="p">,</span><span class="w"> </span><span class="n">mo_b</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">scr</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">unpack_matrix</span><span class="p">(</span><span class="n">scr</span><span class="p">,</span><span class="n">fb</span><span class="p">)</span>
<span class="w">    </span><span class="k">end if</span>

<span class="w">  </span><span class="c">! Construct TD trial vector</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">      call </span><span class="n">mrinivec</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">mo_energy_a</span><span class="p">,</span><span class="w"> </span><span class="n">mo_energy_a</span><span class="p">,</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">xm</span><span class="p">,</span><span class="w"> </span><span class="n">nvec</span><span class="p">)</span>

<span class="w">    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">      call </span><span class="n">inivec</span><span class="p">(</span><span class="n">mo_energy_a</span><span class="p">,</span><span class="n">mo_energy_a</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="n">nocca</span><span class="p">,</span><span class="n">nvec</span><span class="p">)</span>

<span class="w">    </span><span class="k">end if</span>

<span class="k">    </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nvec</span>
<span class="w">    </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="n">mxiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">control</span><span class="p">%</span><span class="n">maxit_dav</span>
<span class="w">    </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="k">do </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">mxiter</span>
<span class="w">      </span><span class="n">nv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>

<span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">        </span><span class="n">mrsf_density</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w">   </span><span class="c">! bo2v, bo1v, bco1, bco2, o21v, co12, ball</span>

<span class="w">      </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">        </span><span class="n">fmrq1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>

<span class="w">      </span><span class="k">end if</span>

<span class="k">      do </span><span class="n">ivec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span>

<span class="w">        </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivec</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">          call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">mrsfcbc</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">mo_b</span><span class="p">,</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">mrsf_density</span><span class="p">(</span><span class="n">iv</span><span class="p">,:,:,:))</span>

<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">          call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">orthogonal_transform</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">fmrq1</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">),</span><span class="w"> </span><span class="n">wrk2</span><span class="p">)</span>

<span class="w">        </span><span class="k">end if</span>

<span class="k">      end do</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">        </span><span class="n">int2_data_st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">int2_mrsf_data_t</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">d3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mrsf_density</span><span class="p">(:</span><span class="n">iv</span><span class="p">,:,:,:),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">tamm_dancoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tamm_dancoff</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">scale_exchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale_exch</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">scale_coulomb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale_exch</span><span class="p">)</span>

<span class="w">        </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">run</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">int2_data_st</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">cam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dft</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_flag</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">alpha_coulomb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">beta_coulomb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span><span class="p">)</span>

<span class="w">        </span><span class="n">fmrst2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">int2_data_st</span><span class="p">%</span><span class="n">f3</span><span class="p">(:,:,:,:,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c">! ado2v, ado1v, adco1, adco2, ao21v, aco12, agdlr</span>

<span class="w">        </span><span class="c">! Scaling factor if triplet</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">fmrst2</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">fmrst2</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,:,:)</span>

<span class="w">        </span><span class="c">! Spin pair coupling</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coco</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">hfscale</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">fmrst2</span><span class="p">(:,</span><span class="mi">6</span><span class="p">,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmrst2</span><span class="p">(:,</span><span class="mi">6</span><span class="p">,:,:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coco</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">hfscale</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_ovov</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">hfscale</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">fmrst2</span><span class="p">(:,</span><span class="mi">5</span><span class="p">,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmrst2</span><span class="p">(:,</span><span class="mi">5</span><span class="p">,:,:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_ovov</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">hfscale</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coov</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">hfscale</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">fmrst2</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmrst2</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,:,:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">spc_coov</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">hfscale</span>

<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">        </span><span class="n">int2_data_q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">int2_td_data_t</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">d2</span><span class="o">=</span><span class="n">fmrq1</span><span class="p">(:,:,:</span><span class="n">iv</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">int_apb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">int_amb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">tamm_dancoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tamm_dancoff</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">scale_exchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale_exch</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">run</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">int2_data_q</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">cam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dft</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">infos</span><span class="p">%</span><span class="n">dft</span><span class="p">%</span><span class="n">cam_flag</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_alpha</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">          </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_beta</span><span class="p">,&amp;</span>
<span class="w">          </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">cam_mu</span><span class="p">)</span>

<span class="w">      </span><span class="k">end if</span>

<span class="k">      do </span><span class="n">ivec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span>

<span class="w">        </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivec</span><span class="o">-</span><span class="n">ist</span><span class="o">+</span><span class="mi">1</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">          </span><span class="c">! Product (A-B)*X</span>
<span class="w">          </span><span class="k">call </span><span class="n">mrsfmntoia</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">fmrst2</span><span class="p">(</span><span class="n">iv</span><span class="p">,:,:,:),</span><span class="w"> </span><span class="n">amo</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">mo_b</span><span class="p">,</span><span class="w"> </span><span class="n">ivec</span><span class="p">)</span>

<span class="w">          </span><span class="k">call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">)</span>

<span class="w">          </span><span class="k">call </span><span class="n">mrsfesum</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">wrk1</span><span class="p">,</span><span class="w"> </span><span class="n">fa</span><span class="p">,</span><span class="w"> </span><span class="n">fb</span><span class="p">,</span><span class="w"> </span><span class="n">amo</span><span class="p">,</span><span class="w"> </span><span class="n">ivec</span><span class="p">)</span>

<span class="w">        </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">mrst</span><span class="o">==</span><span class="mi">5</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>

<span class="k">          call </span><span class="n">mntoia</span><span class="p">(</span><span class="n">int2_data_q</span><span class="p">%</span><span class="n">amb</span><span class="p">(:,:,</span><span class="n">iv</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">amo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">mo_b</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">)</span>

<span class="w">          </span><span class="c">! Z(I+,A-)</span>
<span class="w">          </span><span class="k">call </span><span class="n">iatogen</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="n">ivec</span><span class="p">),</span><span class="n">wrk1</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="n">nocca</span><span class="p">)</span>

<span class="w">          </span><span class="c">! FB(I+,J+)*Z(J+,A-)</span>
<span class="w">          </span><span class="k">call </span><span class="n">dgemm</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="mf">1.0_dp</span><span class="p">,</span><span class="n">fb</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">wrk1</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="mf">0.0_dp</span><span class="p">,</span><span class="n">wrk2</span><span class="p">,</span><span class="n">noccb</span><span class="p">)</span>

<span class="w">          </span><span class="c">! Z(I+,B-)*FA(B-,A-)</span>
<span class="w">          </span><span class="k">call </span><span class="n">dgemm</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="mf">1.0_dp</span><span class="p">,</span><span class="n">wrk1</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">fa</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="o">-</span><span class="mf">1.0_dp</span><span class="p">,</span><span class="n">wrk2</span><span class="p">,</span><span class="n">noccb</span><span class="p">)</span>

<span class="w">          </span><span class="k">call </span><span class="n">mrsfqroesum</span><span class="p">(</span><span class="n">wrk2</span><span class="p">,</span><span class="n">amo</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">nocca</span><span class="p">,</span><span class="n">noccb</span><span class="p">,</span><span class="n">nbf</span><span class="p">,</span><span class="n">ivec</span><span class="p">)</span>

<span class="w">        </span><span class="k">end if</span>
<span class="k">      end do</span>

<span class="k">      </span><span class="n">vl_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">vl</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="o">*</span><span class="n">nvec</span><span class="p">)</span>
<span class="w">      </span><span class="n">vr_p</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">vr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvec</span><span class="o">*</span><span class="n">nvec</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">rparedms</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">amo</span><span class="p">,</span><span class="n">amo</span><span class="p">,</span><span class="n">apb</span><span class="p">,</span><span class="n">amb</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<span class="w">      </span><span class="k">call </span><span class="n">rpaeig</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="n">vl_p</span><span class="p">,</span><span class="n">vr_p</span><span class="p">,</span><span class="n">apb</span><span class="p">,</span><span class="n">amb</span><span class="p">,</span><span class="n">scr2</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<span class="w">      </span><span class="k">call </span><span class="n">rpavnorm</span><span class="p">(</span><span class="n">vr_p</span><span class="p">,</span><span class="n">vl_p</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<span class="w">      </span><span class="k">call </span><span class="n">rpaechk</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">nstates</span><span class="p">,</span><span class="n">imax</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>

<span class="w">      </span><span class="n">for_trnsf_b_vec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vr_p</span>
<span class="w">      </span><span class="k">call </span><span class="n">sfresvec</span><span class="p">(</span><span class="n">qvec</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">amo</span><span class="p">,</span><span class="n">vr_p</span><span class="p">,</span><span class="n">eex</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">rnorm</span><span class="p">,</span><span class="n">nstates</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">sfqvec</span><span class="p">(</span><span class="n">qvec</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">eex</span><span class="p">,</span><span class="n">nstates</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">rpaprint</span><span class="p">(</span><span class="n">eex</span><span class="p">,</span><span class="w"> </span><span class="n">rnorm</span><span class="p">,</span><span class="w"> </span><span class="n">cnvtol</span><span class="p">,</span><span class="w"> </span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">imax</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">,</span><span class="w"> </span><span class="n">do_neg</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>

<span class="w">      </span><span class="n">mxerr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">rnorm</span><span class="p">)</span>

<span class="c">!     Check convergence</span>
<span class="w">      </span><span class="n">converged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mxerr</span><span class="o">&lt;=</span><span class="n">cnvtol</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">converged</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="c">!     No space left for new vectors, exit</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nvec</span><span class="o">==</span><span class="n">mxvec</span><span class="p">)</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="k">      call </span><span class="n">rpanewb</span><span class="p">(</span><span class="n">nstates</span><span class="p">,</span><span class="n">bvec_mo</span><span class="p">,</span><span class="n">qvec</span><span class="p">,</span><span class="n">novec</span><span class="p">,</span><span class="n">nvec</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">tamm_dancoff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>

<span class="w">  </span><span class="c">!   ierr=1 nvec over mxvec: not converged case</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="k">      </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">novec</span><span class="o">+</span><span class="mi">1</span>
<span class="w">      </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nvec</span>

<span class="w">    </span><span class="k">end do</span>

<span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">iter</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">mxiter</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">converged</span><span class="p">)</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>

<span class="w">    </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;MRSF-TD-DFT energies NOT CONVERGED after &quot;,I4,&quot; iterations&quot;/)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">mxiter</span>
<span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;MRSF-TD-DFT energies converged in &quot;,I4,&quot; iterations&quot;/)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">iter</span>
<span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2X,&quot;..something is wrong.. nvec = mxvec&quot;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,&quot;..something is wrong..  nvec &gt; mxvec&quot;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(3x,&quot;nvec/mxvec =&quot;,I4,&quot;/&quot;,I4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="n">mxvec</span>
<span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,&quot;..something is wrong.. No vectors were added&quot;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">Davidson_converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">    </span><span class="k">end select</span>
<span class="k">    call </span><span class="nb">flush</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>

<span class="w">    </span><span class="k">call </span><span class="n">trfrmb</span><span class="p">(</span><span class="n">bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">for_trnsf_b_vec</span><span class="p">,</span><span class="w"> </span><span class="n">nvec</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>

<span class="w">    </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">mrst</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">do </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<span class="w">          </span><span class="k">do </span><span class="n">jst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<span class="w">            </span><span class="k">call </span><span class="n">get_mrsf_transition_density</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="n">trden</span><span class="p">(:,:,</span><span class="n">ist</span><span class="p">,</span><span class="n">jst</span><span class="p">),</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">jst</span><span class="p">)</span>
<span class="w">          </span><span class="k">end do</span>
<span class="k">        end do</span>
<span class="k">        </span><span class="n">squared_S</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">        </span><span class="k">call </span><span class="n">get_mrsf_transitions</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,35(&quot;=&quot;),/,2x,&amp;</span>
<span class="s1">            &amp;&quot;Spin-adapted spin-flip excitations&quot;,/,2x,35(&quot;=&quot;))&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">        </span><span class="k">do </span><span class="n">ist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<span class="w">          </span><span class="k">do </span><span class="n">jst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span>
<span class="w">            </span><span class="k">call </span><span class="n">get_mrsf_transition_density</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">trden</span><span class="p">(:,:,</span><span class="n">ist</span><span class="p">,</span><span class="n">jst</span><span class="p">),</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">ist</span><span class="p">,</span><span class="w"> </span><span class="n">jst</span><span class="p">)</span>
<span class="w">          </span><span class="k">end do</span>
<span class="k">        end do</span>
<span class="k">        </span><span class="n">squared_S</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0_dp</span>
<span class="w">        </span><span class="k">call </span><span class="n">get_mrsf_transitions</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,35(&quot;=&quot;),/,2x,&amp;</span>
<span class="s1">            &amp;&quot;Spin-adapted spin-flip excitations&quot;,/,2x,35(&quot;=&quot;))&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">get_transition_density</span><span class="p">(</span><span class="n">trden</span><span class="p">,</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>
<span class="w">        </span><span class="n">squared_S</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.0_dp</span>
<span class="w">        </span><span class="k">call </span><span class="n">get_transitions</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span><span class="w"> </span><span class="n">noccb</span><span class="p">,</span><span class="w"> </span><span class="n">nocca</span><span class="p">,</span><span class="w"> </span><span class="n">nbf</span><span class="p">)</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(/,2x,35(&quot;=&quot;),/,2x,&amp;</span>
<span class="s1">            &amp;&quot;Beta -&gt; Alpha spin-flip excitations&quot;,/,2x,35(&quot;=&quot;))&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">case </span><span class="n">default</span>
<span class="w">        </span><span class="k">error stop</span><span class="w"> </span><span class="s2">&quot;Unknown mrst value&quot;</span>
<span class="w">    </span><span class="k">end select</span>

<span class="k">    call </span><span class="n">get_transition_dipole</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">,</span><span class="w"> </span><span class="n">mo_a</span><span class="p">,</span><span class="w"> </span><span class="n">trden</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>

<span class="w">    </span><span class="n">mrsf_energies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nstates</span><span class="p">)</span>
<span class="w">    </span><span class="n">bvec_mo_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nstates</span><span class="p">)</span>
<span class="w">    </span><span class="n">infos</span><span class="p">%</span><span class="n">mol_energy</span><span class="p">%</span><span class="n">excited_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mrsf_energies</span><span class="p">(</span><span class="n">infos</span><span class="p">%</span><span class="n">tddft</span><span class="p">%</span><span class="n">target_state</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="n">print_results</span><span class="p">(</span><span class="n">infos</span><span class="p">,</span><span class="w"> </span><span class="n">bvec_mo</span><span class="p">,</span><span class="w"> </span><span class="n">eex</span><span class="p">,</span><span class="w"> </span><span class="n">trans</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="p">,</span><span class="w"> </span><span class="n">squared_S</span><span class="p">,</span><span class="w"> </span><span class="n">nstates</span><span class="p">)</span>
<span class="w">    </span><span class="k">call </span><span class="nb">flush</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>

<span class="w">    </span><span class="k">call </span><span class="n">int2_driver</span><span class="p">%</span><span class="n">clean</span><span class="p">()</span>

<span class="w">    </span><span class="k">call </span><span class="n">measure_time</span><span class="p">(</span><span class="n">print_total</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">log_unit</span><span class="o">=</span><span class="n">iw</span><span class="p">)</span>
<span class="w">    </span><span class="k">close</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span>

<span class="w">  </span><span class="k">end subroutine </span><span class="n">tdhf_mrsf_energy</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              OPENQP
 was developed by OpenQP Team<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </body>
</html>